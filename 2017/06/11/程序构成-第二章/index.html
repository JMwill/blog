<!DOCTYPE html>
<html lang="en" dir="ltr">

<head prefix="og: http://ogp.me/ns#">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>ç¨‹åºæ„æˆ-ç¬¬äºŒç«  â€“ Will&#39;s Blog</title>
    


<script src="/blog/js/enquire.min.dfb99dee1e029d51d6cfb672d847929890b1585402de17f5ed092edd72a688b4.js"></script>

<script defer src="/blog/js/lazysizes.min.31dd6a2d3a1ec0f78a8df007535cf23f03aeb5c70f026e6d6a19dac3b3acc340.js"></script>

<script defer src="/blog/js/fuse.min.94c78ad70b02749822921660cf4e9f0b3701bc0680c421afb784a78228de0275.js"></script>

<script defer src="/blog/js/helper/getParents.min.1618c696be7c98933f9a92677f518b512a74e55bdbb976b09936b4182e93181b.js"></script>

<script defer src="/blog/js/helper/fadeinout.min.93a331f96194789a542f33690bbe4f0c102c7e78ffc018217f5a1c33010bad91.js"></script>

<script defer src="/blog/js/helper/closest.min.js"></script>
  
<script>
  "use strict";

  
  
  if (window.NodeList && !NodeList.prototype.forEach) {
    NodeList.prototype.forEach = Array.prototype.forEach;
  }

  
  if (!String.prototype.includes) {
    String.prototype.includes = function (search, start) {
      'use strict';

      if (search instanceof RegExp) {
        throw TypeError('first argument must not be a RegExp');
      }
      if (start === undefined) { start = 0; }
      return this.indexOf(search, start) !== -1;
    };
  }

  
  Document.prototype.append = Element.prototype.append = function append() {
    this.appendChild(_mutation(arguments));
  };
  function _mutation(nodes) {
    if (!nodes.length) {
      throw new Error('DOM Exception 8');
    } else if (nodes.length === 1) {
      return typeof nodes[0] === 'string' ? document.createTextNode(nodes[0]) : nodes[0];
    } else {
      var
      fragment = document.createDocumentFragment(),
      length = nodes.length,
      index = -1,
      node;

      while (++index < length) {
        node = nodes[index];

        fragment.appendChild(typeof node === 'string' ? document.createTextNode(node) : node);
      }

      return fragment;
    }
  }

  
  if (!String.prototype.startsWith) {
    String.prototype.startsWith = function (searchString, position) {
      position = position || 0;
      return this.indexOf(searchString, position) === position;
    };
  }
  


  document.addEventListener('DOMContentLoaded', function () {
    
    var navCollapseBtn = document.querySelector('.navbar__burger');
    navCollapseBtn ? navCollapseBtn.addEventListener('click', function (e) {
      var navCollapse = document.querySelector('.navbarm__collapse');

      if (navCollapse) {
        var dataOpen = navCollapse.getAttribute('data-open');

        if (dataOpen === 'true') {
          navCollapse.setAttribute('data-open', 'false');
          navCollapse.style.maxHeight = 0;
          navCollapseBtn.classList.remove('is-active');
        } else {
          navCollapse.setAttribute('data-open', 'true');
          navCollapse.style.maxHeight = navCollapse.scrollHeight + "px";
          navCollapseBtn.classList.add('is-active');
        }
      }
    }) : null;
    


    
    var summaryContainer = document.querySelector('.summary__container');
    var searchResult = document.querySelector('.search-result');
    var searchResultCloseBtn = document.querySelector('.search-result__close');
    searchResultCloseBtn ? searchResultCloseBtn.addEventListener('click', function (e) {
      searchResult.setAttribute('data-display', 'none');
      summaryContainer.setAttribute('data-display', 'block');
    }) : null;
    


    
    document.querySelectorAll('.tab') ? 
    document.querySelectorAll('.tab').forEach(function(elem, idx) {
      var containerId = elem.getAttribute('id');
      var containerElem = elem;
      var tabLinks = elem.querySelectorAll('.tab__link');
      var tabContents = elem.querySelectorAll('.tab__content');
      var ids = [];

      tabLinks && tabLinks.length > 0 ?
      tabLinks.forEach(function(link, index, self) {
        link.onclick = function(e) {
          for (var i = 0; i < self.length; i++) {
            if (index === parseInt(i, 10)) {
              if (!self[i].classList.contains('active')) {
                self[i].classList.add('active');
                tabContents[i].style.display = 'block';
              }
            } else {
              self[i].classList.remove('active');
              tabContents[i].style.display = 'none';
            }
          }
        }
      }) : null;
    }) : null;
    


    
    document.querySelectorAll('.codetab') ? 
    document.querySelectorAll('.codetab').forEach(function(elem, idx) {
      var containerId = elem.getAttribute('id');
      var containerElem = elem;
      var codetabLinks = elem.querySelectorAll('.codetab__link');
      var codetabContents = elem.querySelectorAll('.codetab__content');
      var ids = [];

      codetabLinks && codetabLinks.length > 0 ?
      codetabLinks.forEach(function(link, index, self) {
        link.onclick = function(e) {
          for (var i = 0; i < self.length; i++) {
            if (index === parseInt(i, 10)) {
              if (!self[i].classList.contains('active')) {
                self[i].classList.add('active');
                codetabContents[i].style.display = 'block';
              }
            } else {
              self[i].classList.remove('active');
              codetabContents[i].style.display = 'none';
            }
          }
        }
      }) : null;
    }) : null;
    


    
    var gttBtn = document.getElementById("gtt");
    gttBtn.style.display = "none";
    gttBtn.addEventListener('click', function () {
      if (window.document.documentMode) {
        document.documentElement.scrollTop = 0;
      } else {
        scrollToTop(250);
      }
    });

    function scrollToTop(scrollDuration) {
      var scrollStep = -window.scrollY / (scrollDuration / 15);
      var scrollInterval = setInterval(function () {
        if (window.scrollY != 0) {
          window.scrollBy(0, scrollStep);
        }
        else clearInterval(scrollInterval);
      }, 15);
    }

    var scrollFunction = function () {
      if (document.body.scrollTop > 250 || document.documentElement.scrollTop > 250) {
        gttBtn.style.display = "block";
      } else {
        gttBtn.style.display = "none";
      }
    }
    


    
    var expandBtn = document.querySelectorAll('.expand__button');

    for (let i = 0; i < expandBtn.length; i++) {
      expandBtn[i].addEventListener("click", function () {
        var content = this.nextElementSibling;
        if (content.style.maxHeight) {
          content.style.maxHeight = null;
          this.querySelector('svg').classList.add('expand-icon__right');
          this.querySelector('svg').classList.remove('expand-icon__down');
        } else {
          content.style.maxHeight = content.scrollHeight + "px";
          this.querySelector('svg').classList.remove('expand-icon__right');
          this.querySelector('svg').classList.add('expand-icon__down');
        }
      });
    }
    


    
    var lastScrollTop = window.pageYOffset || document.documentElement.scrollTop;
    var tocElem = document.querySelector('.toc');
    var tableOfContentsElem = tocElem ? tocElem.querySelector('#TableOfContents') : null;
    var toggleTocElem = document.getElementById('toggle-toc');
    var singleContentsElem = document.querySelector('.single__contents');
    var navbar = document.querySelector('.navbar');
    var tocFlexbox = document.querySelector('.toc__flexbox');
    var tocFlexboxOuter = document.querySelector('.toc__flexbox--outer');
    var expandContents = document.querySelectorAll('.expand__content');
    var boxContents = document.querySelectorAll('.box');
    var notAllowedTitleIds = null;

    
    var tocFolding = JSON.parse("false");
    
    var tocLevels = JSON.parse("[\"h2\",\"h3\",\"h4\"]");
    
    if (tocLevels) {
      tocLevels = tocLevels.toString();
    } else {
      tocLevels = "h1, h2, h3, h4, h5, h6";
    }

    
    singleContentsElem && singleContentsElem.querySelectorAll(".tab") ?
    singleContentsElem.querySelectorAll(".tab").forEach(function (elem) {
      elem.querySelectorAll(tocLevels).forEach(function (element) {
        notAllowedTitleIds = Array.isArray(notAllowedTitleIds) ?
          notAllowedTitleIds.concat(element.getAttribute('id')) :
          [element.getAttribute('id')];
      });
    }) : null;

    
    expandContents ? expandContents.forEach(function(elem) {
      elem.querySelectorAll(tocLevels).forEach(function (element) {
        notAllowedTitleIds = Array.isArray(notAllowedTitleIds) ?
          notAllowedTitleIds.concat(element.getAttribute('id')) :
          [element.getAttribute('id')];
      });
    }) : null;

    
    boxContents ? boxContents.forEach(function(elem) {
      elem.querySelectorAll(tocLevels).forEach(function (element) {
        notAllowedTitleIds = Array.isArray(notAllowedTitleIds) ?
          notAllowedTitleIds.concat(element.getAttribute('id')) :
          [element.getAttribute('id')];
      });
    }) : null;

    
    window.onscroll = function () {
      scrollFunction();
      
      var st = window.pageYOffset || document.documentElement.scrollTop;
      if (st > lastScrollTop) { 
        if (st < 250) {
          gttBtn.style.display = "none";
        } else {
          gttBtn.style.display = "block";
        }

        if (st < 45) {
          return null;
        }
        
        if (!navbar.classList.contains('navbar--hide')) {
          navbar.classList.add('navbar--hide');
        } else if (navbar.classList.contains('navbar--show')) {
          navbar.classList.remove('navbar--show');
        }

        if (singleContentsElem) {
          if (singleContentsElem.querySelectorAll(tocLevels).length > 0) {
            singleContentsElem.querySelectorAll(tocLevels).forEach(function (elem) {
              if (toggleTocElem && !toggleTocElem.checked) {
                return null;
              }

              if (notAllowedTitleIds && notAllowedTitleIds.includes(elem.getAttribute('id'))) {
                return null;
              }
              
              if (document.documentElement.scrollTop >= elem.offsetTop) {
                if (tableOfContentsElem) {
                  var id = elem.getAttribute('id');
                  tocElem.querySelectorAll('a').forEach(function (elem) {
                    elem.classList.remove('active');
                  });
                  tocElem.querySelector('a[href="#' + id + '"]') ?
                    tocElem.querySelector('a[href="#' + id + '"]').classList.add('active') : null;

                  if (false === tocFolding) {
                    
                  } else {
                    tableOfContentsElem.querySelectorAll('ul') ?
                      tableOfContentsElem.querySelectorAll('ul').forEach(function (rootUl) {
                        rootUl.querySelectorAll('li').forEach(function (liElem) {
                          liElem.querySelectorAll('ul').forEach(function (ulElem) {
                            ulElem.style.display = 'none';
                          });
                        });
                      }) : null;
                  }

                  var curElem = tableOfContentsElem.querySelector("[href='#" + id + "']");
                  if (curElem && curElem.nextElementSibling) {
                    curElem.nextElementSibling.style.display = 'block';
                  }
                  getParents(curElem, 'ul') ?
                    getParents(curElem, 'ul').forEach(function (elem) {
                      elem.style.display = 'block';
                    }) : null;
                }
              }
            });
          } else {
            if (tocFlexbox) {
              tocFlexbox.setAttribute('data-position', '');
              if (!tocFlexbox.classList.contains('hide')) {
                tocFlexbox.classList.add('hide');
              }
            }
            if (tocFlexboxOuter) {
              tocFlexboxOuter.setAttribute('data-position', '');
              if (!tocFlexboxOuter.classList.contains('hide')) {
                tocFlexboxOuter.classList.add('hide');
              }
            }
          }
        }
      } else { 
        if (st < 250) {
          gttBtn.style.display = "none";
        }

        if (navbar.classList.contains('navbar--hide')) {
          navbar.classList.remove('navbar--hide');
        } else if (!navbar.classList.contains('navbar--show')) {
          navbar.classList.add('navbar--show');
        }

        if (singleContentsElem) {
          if (singleContentsElem.querySelectorAll(tocLevels).length > 0) {
            singleContentsElem.querySelectorAll(tocLevels).forEach(function (elem) {
              if (toggleTocElem && !toggleTocElem.checked) {
                return null;
              }
              
              if (notAllowedTitleIds && notAllowedTitleIds.includes(elem.getAttribute('id'))) {
                return null;
              }

              if (document.documentElement.scrollTop >= elem.offsetTop) {
                if (tableOfContentsElem) {
                  var id = elem.getAttribute('id');
                  tocElem.querySelectorAll('a').forEach(function (elem) {
                    elem.classList.remove('active');
                  });
                  tocElem.querySelector('a[href="#' + id + '"]') ?
                    tocElem.querySelector('a[href="#' + id + '"]').classList.add('active') : null;

                  if (false === tocFolding) {
                    
                  } else {
                    tableOfContentsElem.querySelectorAll('ul') ?
                      tableOfContentsElem.querySelectorAll('ul').forEach(function (rootUl) {
                        rootUl.querySelectorAll('li').forEach(function (liElem) {
                          liElem.querySelectorAll('ul').forEach(function (ulElem) {
                            ulElem.style.display = 'none';
                          });
                        });
                      }) : null;
                  }

                  var curElem = tableOfContentsElem.querySelector("[href='#" + id + "']");
                  if (curElem && curElem.nextElementSibling) {
                    curElem.nextElementSibling.style.display = 'block';
                  }
                  getParents(curElem, 'ul') ?
                    getParents(curElem, 'ul').forEach(function (elem) {
                      elem.style.display = 'block';
                    }) : null;
                }
              }
            });
          } else {
            if (tocFlexbox && !tocFlexbox.classList.contains('hide')) {
              tocFlexbox.classList.add('hide');
            }
            if (tocFlexboxOuter && !tocFlexboxOuter.classList.contains('hide')) {
              tocFlexboxOuter.classList.add('hide');
            }
          }
          
        }

        if (tableOfContentsElem && document.documentElement.scrollTop < 250) {
          if (false === tocFolding) {

          } else {
            tableOfContentsElem.querySelector('ul') ?
              tableOfContentsElem.querySelector('ul').querySelectorAll('li').forEach(function (liElem) {
                liElem.querySelectorAll('ul').forEach(function (ulElem) {
                  ulElem.style.display = 'none';
                });
              }) : null;
          }
        }
      }
      lastScrollTop = st <= 0 ? 0 : st;
    };
  


  
    var localTheme = localStorage.getItem('theme');
    var rootEleme = document.getElementById('root');
    var selectThemeElem = document.querySelectorAll('.select-theme');
    var selectThemeItemElem = document.querySelectorAll('.select-theme__item');

    var setMetaColor = function(themeColor) {
      var metaMsapplicationTileColor = document.getElementsByName('msapplication-TileColor')[0];
      var metaThemeColor = document.getElementsByName('theme-color')[0];
      var metaMsapplicationNavbuttonColor = document.getElementsByName('msapplication-navbutton-color')[0];
      var metaAppleMobileWebAappStatusBarStyle = document.getElementsByName('apple-mobile-web-app-status-bar-style')[0];

      if (themeColor.includes('dark')) {
        metaMsapplicationTileColor.setAttribute('content', '#fcfcfa');
        metaThemeColor.setAttribute('content', '#403E41');
        metaMsapplicationNavbuttonColor.setAttribute('content', '#403E41');
        metaAppleMobileWebAappStatusBarStyle.setAttribute('content', '#403E41');
      } else if (themeColor.includes('light')) {
        metaMsapplicationTileColor.setAttribute('content', '#555');
        metaThemeColor.setAttribute('content', '#eee');
        metaMsapplicationNavbuttonColor.setAttribute('content', '#eee');
        metaAppleMobileWebAappStatusBarStyle.setAttribute('content', '#eee');
      } else if (themeColor.includes('hacker')) {
        metaMsapplicationTileColor.setAttribute('content', '#e3cd26');
        metaThemeColor.setAttribute('content', '#252526');
        metaMsapplicationNavbuttonColor.setAttribute('content', '#252526');
        metaAppleMobileWebAappStatusBarStyle.setAttribute('content', '#252526');
      } else if (themeColor.includes('solarized')) {
        metaMsapplicationTileColor.setAttribute('content', '#d3af86');
        metaThemeColor.setAttribute('content', '#51412c');
        metaMsapplicationNavbuttonColor.setAttribute('content', '#51412c');
        metaAppleMobileWebAappStatusBarStyle.setAttribute('content', '#51412c');
      } else if (themeColor.includes('kimbie')) {
        metaMsapplicationTileColor.setAttribute('content', '#586e75');
        metaThemeColor.setAttribute('content', '#eee8d5');
        metaMsapplicationNavbuttonColor.setAttribute('content', '#eee8d5');
        metaAppleMobileWebAappStatusBarStyle.setAttribute('content', '#eee8d5');
      } 
    }
    
    if (localTheme) {
      selectThemeItemElem ? 
      selectThemeItemElem.forEach(function (elem) {
        if (elem.text.trim() === localTheme) {
          elem.classList.add('is-active');
        } else {
          elem.classList.remove('is-active');
        }
      }) : null;

      setMetaColor(localTheme);
    } else {
      setMetaColor(rootEleme.className);
    }

    selectThemeItemElem ? 
    selectThemeItemElem.forEach(function (v, i) {
      v.addEventListener('click', function (e) {
        var selectedThemeVariant = e.target.text.trim();
        localStorage.setItem('theme', selectedThemeVariant);
        setMetaColor(selectedThemeVariant);

        rootEleme.removeAttribute('class');
        rootEleme.classList.add('theme__' + selectedThemeVariant);
        selectThemeElem.forEach(function(rootElem) {
          rootElem.querySelectorAll('a').forEach(function (elem) {
            if (elem.classList) {
              if (elem.text.trim() === selectedThemeVariant) {
                if (!elem.classList.contains('is-active')) {
                  elem.classList.add('is-active');
                }
              } else {
                if (elem.classList.contains('is-active')) {
                  elem.classList.remove('is-active');
                }
              }
            }
          });
        });

        if (window.mermaid) {
          if (selectedThemeVariant === "dark" || selectedThemeVariant === "hacker") {
            mermaid.initialize({ theme: 'dark' });
            location.reload();
          } else {
            mermaid.initialize({ theme: 'default' });
            location.reload();
          }
        }

        var utterances = document.getElementById('utterances');
        if (utterances) {
          utterances.querySelector('iframe').contentWindow.postMessage({
            type: 'set-theme',
            theme: selectedThemeVariant === "dark" || selectedThemeVariant === "hacker" ? 'photon-dark' : selectedThemeVariant === 'kimbie' ? 'github-dark-orange' : 'github-light',
          }, 'https://utteranc.es');
        }

        var twitterCards = document.querySelectorAll('.twitter-timeline');
        if (twitterCards) {
          window.postMessage({
            type: 'set-twitter-theme',
            theme: selectedThemeVariant === 'light' || selectedThemeVariant === 'solarized' ? 'light' : 'dark',
          });
        }
      });
    }) : null;
  


  
    
    var permalink = JSON.parse("\"https://jmwill.github.io/blog/2017/06/11/%E7%A8%8B%E5%BA%8F%E6%9E%84%E6%88%90-%E7%AC%AC%E4%BA%8C%E7%AB%A0/\"");
    var searchResults = null;
    var searchMenu = null;
    var searchText = null;
    
    
    var enableSearchHighlight = JSON.parse("true");
    
    var searchResultPosition = JSON.parse("null");
    
    var sectionType = JSON.parse("\"posts\"");

    var fuse = null;

    (function initFuse() {
      var xhr = new XMLHttpRequest();
      xhr.open('GET', permalink + "index.json");
      xhr.setRequestHeader('Content-Type', 'application/json; charset=utf-8');
      xhr.onload = function () {
        if (xhr.status === 200) {
          fuse = new Fuse(JSON.parse(xhr.response.toString('utf-8')), {
            keys: sectionType.includes('publication') ? ['title', 'abstract'] : ['title', 'description', 'content'],
            includeMatches: enableSearchHighlight,
            shouldSort: true,
            threshold: 0.4,
            location: 0,
            distance: 100,
            maxPatternLength: 32,
            minMatchCharLength: 1,
          });
          window.fuse = fuse;
        }
        else {
          console.error('[' + xhr.status + ']Error:', xhr.statusText);
        }
      };
      xhr.send();
    })();

    function makeLi(ulElem, obj) {
      var li = document.createElement('li');
      li.className = 'search-result__item';
      
      var a = document.createElement('a');
      a.innerHTML = obj.title;
      a.setAttribute('class', 'search-result__item--title');
      a.setAttribute('href', obj.permalink);

      var descDiv = document.createElement('div');
      descDiv.setAttribute('class', 'search-result__item--desc');
      if (obj.description) {
        descDiv.innerHTML = obj.description;
      } else if (obj.content) {
        descDiv.innerHTML = obj.content.substring(0, 225);
      }
      
      li.appendChild(a);
      li.appendChild(descDiv);
      ulElem.appendChild(li);
    }

    function makeHighlightLi(ulElem, obj) {
      var li = document.createElement('li');
      li.className = 'search-result__item';
      var descDiv = null;

      var a = document.createElement('a');
      a.innerHTML = obj.item.title;
      a.setAttribute('class', 'search-result__item--title');
      a.setAttribute('href', obj.item.uri);

      if (obj.matches && obj.matches.length) {
        for (var i = 0; i < obj.matches.length; i++) {
          if ('title' === obj.matches[i].key) {
            a = document.createElement('a');
            a.innerHTML = generateHighlightedText(obj.matches[i].value, obj.matches[i].indices);
            a.setAttribute('class', 'search-result__item--title');
            a.setAttribute('href', obj.item.uri);
          }
          
          if ('description' === obj.matches[i].key) {
            descDiv = document.createElement('div');
            descDiv.setAttribute('class', 'search-result__item--desc');
            descDiv.innerHTML = generateHighlightedText(obj.item.description, obj.matches[i].indices);
          } else if ('content' === obj.matches[i].key) {
            if (!descDiv) {
              descDiv = document.createElement('div');
              descDiv.setAttribute('class', 'search-result__item--desc');
              descDiv.innerHTML = generateHighlightedText(obj.item.content.substring(0, 150), obj.matches[i].indices);
            }
          } else {
            if (obj.item.description) {
              descDiv = document.createElement('div');
              descDiv.setAttribute('class', 'search-result__item--desc');
              descDiv.innerHTML = obj.item.description;
            } else {
              descDiv = document.createElement('div');
              descDiv.setAttribute('class', 'search-result__item--desc');
              descDiv.innerHTML = obj.item.content.substring(0, 150);
            }
          }
        }

        li.appendChild(a);
        if (descDiv) {
          li.appendChild(descDiv);
        }
        if (li) {
          ulElem.appendChild(li);
        }
      }
    }

    function renderSearchResultsSide(searchText, results) {
      searchResults = document.getElementById('search-results');
      searchMenu = document.getElementById('search-menu');
      searchResults.setAttribute('class', 'dropdown is-active');
      
      var ul = document.createElement('ul');
      ul.setAttribute('class', 'dropdown-content search-content');

      if (results.length) {
        results.forEach(function (result) {
          var li = document.createElement('li');
          var a = document.createElement('a');
          a.setAttribute('href', result.uri);
          a.setAttribute('class', 'dropdown-item');
          a.appendChild(li);

          var titleDiv = document.createElement('div');
          titleDiv.innerHTML = result.title;
          titleDiv.setAttribute('class', 'menu-item__title');

          var descDiv = document.createElement('div');
          descDiv.setAttribute('class', 'menu-item__desc');
          if (result.description) {
            descDiv.innerHTML = result.description;
          } else if (result.content) {
            descDiv.innerHTML = result.content.substring(0, 150);
          }

          li.appendChild(titleDiv);
          li.appendChild(descDiv);
          ul.appendChild(a);
        });
      } else {
        var li = document.createElement('li');
        li.setAttribute('class', 'dropdown-item');
        li.innerText = 'No results found';
        ul.appendChild(li);
      }

      while (searchMenu.hasChildNodes()) {
        searchMenu.removeChild(
          searchMenu.lastChild
        );
      }
      
      searchMenu.appendChild(ul);
    }

    function renderSearchHighlightResultsSide(searchText, results) {
      searchResults = document.getElementById('search-results');
      searchMenu = document.getElementById('search-menu');
      searchResults.setAttribute('class', 'dropdown is-active');

      var ul = document.createElement('ul');
      ul.setAttribute('class', 'dropdown-content search-content');

      if (results.length) {
        results.forEach(function (result) {
          var li = document.createElement('li');
          var a = document.createElement('a');
          var descDiv = null;

          a.setAttribute('href', result.item.uri);
          a.setAttribute('class', 'dropdown-item');
          a.appendChild(li);

          var titleDiv = document.createElement('div');
          titleDiv.innerHTML = result.item.title;
          titleDiv.setAttribute('class', 'menu-item__title');
          
          if (result.matches && result.matches.length) {
            for (var i = 0; i < result.matches.length; i++) {
              if ('title' === result.matches[i].key) {
                titleDiv.innerHTML = generateHighlightedText(result.matches[i].value, result.matches[i].indices);
              }

              if ('description' === result.matches[i].key) {
                descDiv = document.createElement('div');
                descDiv.setAttribute('class', 'menu-item__desc');
                descDiv.innerHTML = generateHighlightedText(result.item.description, result.matches[i].indices);
              } else if ('content' === result.matches[i].key) {
                if (!descDiv) {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'menu-item__desc');
                  descDiv.innerHTML = generateHighlightedText(result.item.content.substring(0, 150), result.matches[i].indices);
                }
              } else {
                if (result.item.description) {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'menu-item__desc');
                  descDiv.innerHTML = result.item.description;
                } else {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'menu-item__desc');
                  descDiv.innerHTML = result.item.content.substring(0, 150);
                }
              }
            }
            
            li.appendChild(titleDiv);
            if (descDiv) {
              li.appendChild(descDiv);
            }
            ul.appendChild(a);
          }
        });
      } else {
        var li = document.createElement('li');
        li.setAttribute('class', 'dropdown-item');
        li.innerText = 'No results found';
        ul.appendChild(li);
      }

      while (searchMenu.hasChildNodes()) {
        searchMenu.removeChild(
          searchMenu.lastChild
        );
      }
      searchMenu.appendChild(ul);
    }

    function renderSearchResultsMobile(searchText, results) {
      searchResults = document.getElementById('search-mobile-results');

      var content = document.createElement('div');
      content.setAttribute('class', 'mobile-search__content');

      if (results.length > 0) {
        results.forEach(function (result) {
          var item = document.createElement('a');
          item.setAttribute('href', result.uri);
          item.innerHTML = '<div class="mobile-search__item"><div class="mobile-search__item--title">ğŸ“„ ' + result.title + '</div><div class="mobile-search__item--desc">' + (result.description ? result.description : result.content) + '</div></div>';
          content.appendChild(item);
        });
      } else {
        var item = document.createElement('span');
        content.appendChild(item);
      }

      let wrap = document.getElementById('search-mobile-results');
      while (wrap.firstChild) {
        wrap.removeChild(wrap.firstChild)
      }
      searchResults.appendChild(content);      
    }

    function renderSearchHighlightResultsMobile(searchText, results) {
      searchResults = document.getElementById('search-mobile-results');

      var ul = document.createElement('div');
      ul.setAttribute('class', 'mobile-search__content');

      if (results.length) {
        results.forEach(function (result) {
          var li = document.createElement('li');
          var a = document.createElement('a');
          var descDiv = null;

          a.setAttribute('href', result.item.uri);
          a.appendChild(li);
          li.setAttribute('class', 'mobile-search__item');

          var titleDiv = document.createElement('div');
          titleDiv.innerHTML = result.item.title;
          titleDiv.setAttribute('class', 'mobile-search__item--title');
          
          if (result.matches && result.matches.length) {
            for (var i = 0; i < result.matches.length; i++) {
              if ('title' === result.matches[i].key) {
                titleDiv.innerHTML = generateHighlightedText(result.matches[i].value, result.matches[i].indices);
              }

              if ('description' === result.matches[i].key) {
                descDiv = document.createElement('div');
                descDiv.setAttribute('class', 'mobile-search__item--desc');
                descDiv.innerHTML = generateHighlightedText(result.item.description, result.matches[i].indices);
              } else if ('content' === result.matches[i].key) {
                if (!descDiv) {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'mobile-search__item--desc');
                  descDiv.innerHTML = generateHighlightedText(result.item.content.substring(0, 150), result.matches[i].indices);
                }
              } else {
                if (result.item.description) {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'mobile-search__item--desc');
                  descDiv.innerHTML = result.item.description;
                } else {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'mobile-search__item--desc');
                  descDiv.innerHTML = result.item.content.substring(0, 150);
                }
              }
            }
            
            li.appendChild(titleDiv);
            if (descDiv) {
              li.appendChild(descDiv);
            }
            ul.appendChild(a);
          }
        });
      } else {
        var item = document.createElement('span');
        ul.appendChild(item);
      }

      let wrap = document.getElementById('search-mobile-results');
      while (wrap.firstChild) {
        wrap.removeChild(wrap.firstChild)
      }
      searchResults.appendChild(ul);
    }

    function generateHighlightedText(text, regions) {
      if (!regions) {
        return text;
      }

      var content = '', nextUnhighlightedRegionStartingIndex = 0;

      regions.forEach(function(region) {
        if (region[0] === region[1]) {
          return null;
        }
        
        content += '' +
          text.substring(nextUnhighlightedRegionStartingIndex, region[0]) +
          '<span class="search__highlight">' +
            text.substring(region[0], region[1] + 1) +
          '</span>' +
        '';
        nextUnhighlightedRegionStartingIndex = region[1] + 1;
      });

      content += text.substring(nextUnhighlightedRegionStartingIndex);

      return content;
    };

    var searchElem = document.getElementById('search');
    var searchMobile = document.getElementById('search-mobile');
    var searchResultsContainer = document.getElementById('search-results');

    searchElem ?
    searchElem.addEventListener('input', function(e) {
      if (!e.target.value | window.innerWidth < 770) {
        searchResultsContainer ? searchResultsContainer.setAttribute('class', 'dropdown') : null;
        searchResult ? searchResult.setAttribute('data-display', 'none') : null;
        summaryContainer ? summaryContainer.setAttribute('data-display', 'block') : null;
        return null;
      }

      searchText = e.target.value;
      var results = fuse.search(e.target.value);
      
      if (searchResultPosition === "main") {
        if (enableSearchHighlight) {
          renderSearchHighlightResultsMain(searchText, results);
        } else {
          renderSearchResultsMain(searchText, results);
        }
      } else {
        if (enableSearchHighlight) {
          renderSearchHighlightResultsSide(searchText, results);
        } else {
          renderSearchResultsSide(searchText, results);
        }
        
        var dropdownItems = searchResultsContainer.querySelectorAll('.dropdown-item');
        dropdownItems ? dropdownItems.forEach(function(item) {
          item.addEventListener('mousedown', function(e) {
            e.target.click();
          });
        }) : null;
      }
    }) : null;

    searchElem ? 
    searchElem.addEventListener('blur', function() {
      if (window.innerWidth < 770) {
        return null;
      }
      searchResultsContainer ? searchResultsContainer.setAttribute('class', 'dropdown') : null;
    }) : null;

    searchElem ? 
    searchElem.addEventListener('click', function(e) {
      if (window.innerWidth < 770) {
        return null;
      }
      if (!e.target.value) {
        searchResultsContainer ? searchResultsContainer.setAttribute('class', 'dropdown') : null;
        return null;
      }

      searchText = e.target.value;
      var results = fuse.search(e.target.value);

      if (searchResultPosition === "main") {
        if (enableSearchHighlight) {
          renderSearchHighlightResultsMain(searchText, results);
        } else {
          renderSearchResultsMain(searchText, results);
        }
      } else{
        if (enableSearchHighlight) {
          renderSearchHighlightResultsSide(searchText, results);
        } else {
          renderSearchResultsSide(searchText, results);
        }

        var dropdownItems = searchResultsContainer.querySelectorAll('.dropdown-item');
        dropdownItems ? dropdownItems.forEach(function (item) {
          item.addEventListener('mousedown', function (e) {
            e.target.click();
          });
        }) : null;
      }
    }) : null;

    var searchMenuElem = document.getElementById("search-menu");
    var activeItem = document.querySelector('#search-menu .dropdown-item.is-active');
    var activeIndex = null;
    var items = null;
    var searchContainerMaxHeight = 350;

    searchElem ? 
    searchElem.addEventListener('keydown', function(e) {
      if (window.innerWidth < 770) {
        return null;
      }

      if (e.key === 'Escape') {
        searchResult ? searchResult.setAttribute('data-display', 'none') : null;
        summaryContainer ? summaryContainer.setAttribute('data-display', 'block') : null;
      }

      var items = document.querySelectorAll('#search-menu .dropdown-item');
      var keyCode = e.which || e.keyCode;

      if (!items || !items.length) {
        return null;
      }
      
      if (e.key === 'ArrowDown' || keyCode === 40) {
        if (activeIndex === null) {
          activeIndex = 0;
          items[activeIndex].classList.remove('is-active');
        } else {
          items[activeIndex].classList.remove('is-active');
          activeIndex = activeIndex === items.length - 1 ? 0 : activeIndex + 1;
        }
        items[activeIndex].classList.add('is-active');

        let overflowedPixel = items[activeIndex].offsetTop + items[activeIndex].clientHeight - searchContainerMaxHeight;
        if (overflowedPixel > 0) {
          document.querySelector(".search-content").scrollTop += items[activeIndex].getBoundingClientRect().height;
        } else if (activeIndex === 0) {
          document.querySelector(".search-content").scrollTop = 0;
        }
      } else if (e.key === 'ArrowUp' || keyCode === 38) {
        if (activeIndex === null) {
          activeIndex = items.length - 1;
          items[activeIndex].classList.remove('is-active');
        } else {
          items[activeIndex].classList.remove('is-active');
          activeIndex = activeIndex === 0 ? items.length - 1 : activeIndex - 1;
        }
        items[activeIndex].classList.add('is-active');
        
        let overflowedPixel = items[activeIndex].offsetTop + items[activeIndex].clientHeight - searchContainerMaxHeight;
        if (overflowedPixel < 0) {
          document.querySelector(".search-content").scrollTop -= items[activeIndex].getBoundingClientRect().height;
        } else {
          document.querySelector(".search-content").scrollTop = overflowedPixel + items[activeIndex].getBoundingClientRect().height;
        }
      } else if (e.key === 'Enter' || keyCode === 13) {
        if (items[activeIndex] && items[activeIndex].getAttribute('href')) {
          location.href = items[activeIndex].getAttribute('href');
        }
      } else if (e.key === 'Escape' || keyCode === 27) {
        e.target.value = null;
        if (searchResults) {
          searchResults.classList.remove('is-active');
        }
      }
    }) : null;

    searchMobile ? 
    searchMobile.addEventListener('input', function(e) {
      if (!e.target.value) {
        let wrap = document.getElementById('search-mobile-results');
        while (wrap.firstChild) {
          wrap.removeChild(wrap.firstChild);
        }
        return null;
      }

      searchText = e.target.value;
      var results = fuse.search(e.target.value);
      renderSearchResultsMobile(searchText, results);
      if (enableSearchHighlight) {
        renderSearchHighlightResultsMobile(searchText, results);
      } else {
        renderSearchResultsMobile(searchText, results);
      }
    }) : null;
  


  
    var mobileSearchInputElem = document.querySelector('#search-mobile');
    var mobileSearchClassElem = document.querySelector('.mobile-search');
    var mobileSearchBtnElem = document.querySelector('#mobileSearchBtn');
    var mobileSearchCloseBtnElem = document.querySelector('#search-mobile-close');
    var mobileSearchContainer = document.querySelector('#search-mobile-container');
    var mobileSearchResultsElem = document.querySelector('#search-mobile-results');
    var htmlElem = document.querySelector('html');

    if (mobileSearchClassElem) {
      mobileSearchClassElem.style.display = 'none';
    }

    mobileSearchBtnElem ? 
    mobileSearchBtnElem.addEventListener('click', function () {
      if (mobileSearchContainer) {
        mobileSearchContainer.style.display = 'block';
      }

      if (mobileSearchInputElem) {
        mobileSearchInputElem.focus();
      }

      if (htmlElem) {
        htmlElem.style.overflowY = 'hidden';
      }
    }) : null;

    mobileSearchCloseBtnElem ? 
    mobileSearchCloseBtnElem.addEventListener('click', function() {
      if (mobileSearchContainer) {
        mobileSearchContainer.style.display = 'none';
      }

      if (mobileSearchInputElem) {
        mobileSearchInputElem.value = '';
      }
      
      if (mobileSearchResultsElem) {
        while (mobileSearchResultsElem.firstChild) {
          mobileSearchResultsElem.removeChild(mobileSearchResultsElem.firstChild);
        }
      }

      if (htmlElem) {
        htmlElem.style.overflowY = 'visible';
      }
    }) : null;

    mobileSearchInputElem ?
    mobileSearchInputElem.addEventListener('keydown', function(e) {
      var keyCode = e.which || e.keyCode;
      if (e.key === 'Escape' || keyCode === 27) {
        if (mobileSearchContainer) {
          mobileSearchContainer.style.display = 'none';
        }
        
        if (mobileSearchInputElem) {
          mobileSearchInputElem.value = '';
        }

        if (mobileSearchResultsElem) {
          while (mobileSearchResultsElem.firstChild) {
            mobileSearchResultsElem.removeChild(mobileSearchResultsElem.firstChild);
          }
        }
        if (htmlElem) {
          htmlElem.style.overflowY = 'visible';
        }
      }
    }) : null;
  


  
    function renderSearchResultsMain(searchText, results) {
      var searchBody = document.querySelector('.search-result__body');
      var originUl = searchBody.querySelector('ul');
      var ul = document.createElement('ul');
      
      if (!searchText) {
        searchResult ? searchResult.setAttribute('data-display', 'none') : null;
        summaryContainer ? summaryContainer.setAttribute('data-display', 'block') : null;
      } else if (results) {
        if (results && results.length) {
          results.forEach(function (result) {
            makeLi(ul, result);
          });

          searchResult ? searchResult.setAttribute('data-display', 'block') : null;
          summaryContainer ? summaryContainer.setAttribute('data-display', 'none') : null;
        }
      }

      originUl.parentNode.replaceChild(ul, originUl);
    }

    function renderSearchHighlightResultsMain(searchText, results) {
      var searchBody = document.querySelector('.search-result__body');
      var originUl = searchBody.querySelector('ul');
      var ul = document.createElement('ul');

      if (!searchText) {
        searchResult ? searchResult.setAttribute('data-display', 'none') : null;
        summaryContainer ? summaryContainer.setAttribute('data-display', 'block') : null;
      } else if (results) {
        if (results && results.length) {
          results.forEach(function (result) {
            makeHighlightLi(ul, result);
          });

          searchResult ? searchResult.setAttribute('data-display', 'block') : null;
          summaryContainer ? summaryContainer.setAttribute('data-display', 'none') : null;
        }
      }

      originUl.parentNode.replaceChild(ul, originUl);
    }
  
  });
</script>    
    


<link rel="stylesheet" href="/blog/css/main.min.css">


    
<meta name="description" content="JMwill&#39;s github site. Build with hugo" />


<meta name="keywords" content="è¯‘æ–‡,Design Programs">

<meta name="created" content="2017-06-11T16:57:25&#43;0800">
<meta name="modified" content="2017-06-11T16:57:25&#43;0800">
<meta property="article:published_time" content="2017-06-11T16:57:25&#43;0800">

<meta name="author" content="Will">


<meta property="og:site_name" content="Will&#39;s Blog">
<meta property="og:title" content="ç¨‹åºæ„æˆ-ç¬¬äºŒç« ">
<meta property="og:url" content="https://jmwill.github.io/blog/2017/06/11/%E7%A8%8B%E5%BA%8F%E6%9E%84%E6%88%90-%E7%AC%AC%E4%BA%8C%E7%AB%A0/">
<meta property="og:type" content="article">
<meta property="og:description" content="JMwill&#39;s github site. Build with hugo">

<meta name="generator" content="Hugo 0.74.2" />
<meta name="msapplication-TileColor" content="#fff">

<meta name="theme-color" content="#fff">

<meta name="msapplication-navbutton-color" content="#fff">

<meta name="apple-mobile-web-app-status-bar-style" content="#fff">

<link rel="canonical" href="https://jmwill.github.io/blog/2017/06/11/%E7%A8%8B%E5%BA%8F%E6%9E%84%E6%88%90-%E7%AC%AC%E4%BA%8C%E7%AB%A0/">

<link rel="manifest" href="/blog/manifest.json">

  
  <link rel="shortcut icon" href="/blog/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/blog/favicon.png" sizes="any" type="image/png" />
  


    <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebPage",
    "headline": "ç¨‹åºæ„æˆ-ç¬¬äºŒç« ",
    "datePublished": "2017-06-11T16:57:25+08:00",
    "dateModified": "2017-06-11T16:57:25+08:00",
    "url" : "https://jmwill.github.io/blog/2017/06/11/%E7%A8%8B%E5%BA%8F%E6%9E%84%E6%88%90-%E7%AC%AC%E4%BA%8C%E7%AB%A0/",
    "description": "\u003ch2 id=\"ç¬¬äºŒç« -æ„ç­‘æŠ½è±¡æ•°æ®\"\u003eç¬¬äºŒç« : æ„ç­‘æŠ½è±¡æ•°æ®\u003c/h2\u003e \u003ch3 id=\"21-ä»‹ç»\"\u003e2.1 ä»‹ç»\u003c/h3\u003e \u003cp\u003eåœ¨ç¬¬ä¸€ç« æˆ‘ä»¬é›†ä¸­å…³æ³¨è®¡ç®—è¿‡ç¨‹, ä»¥åŠå‡½æ•°å¯¹ç¨‹åºè®¾è®¡çš„ä½œç”¨ä¸å½±å“. æˆ‘ä»¬å·²ç»è§è¯†è¿‡å¦‚ä½•ä½¿ç”¨åŸå§‹æ•°æ®(numbers)ä»¥åŠåŸå§‹æ“ä½œç¬¦(ç®—æœ¯), å¦‚ä½•é€šè¿‡ç»„åˆå’Œæ§åˆ¶æ¥ç»„æˆå¤åˆå‡½æ•°, ä»¥åŠé€šè¿‡ç»™è®¡ç®—è¿‡ç¨‹èµ‹äºˆåç§°æ¥åˆ›å»ºå‡½æ•°æŠ½æŠ½è±¡. æˆ‘ä»¬ä¹Ÿçœ‹åˆ°é«˜é˜¶å‡½æ•°é€šè¿‡å…è®¸æˆ‘ä»¬è‡ªè¡Œæ§åˆ¶, ä»è€Œæ¨ç†å‡ºä¸€èˆ¬è®¡ç®—æ–¹æ³•æ¥å¢å¼ºæˆ‘ä»¬çš„è¯­è¨€ â€¦\u003c/p\u003e",
    "keywords": ["è¯‘æ–‡","Design Programs"],
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https://jmwill.github.io/blog/"
    },
    "publisher": {
      "@type": "Organization",
      "name": "Will's Blog",
      "url": "https://jmwill.github.io/blog/"
    }
  }
</script>

    
  
  







    
</head>

<body id="root" class="theme__solarized">
    <script>
        var localTheme = localStorage.getItem('theme');
        if (localTheme) {
            document.getElementById('root').className = 'theme__' + localTheme;
        }
    </script>
    <div id="container">
        





        <div class="wrapper" data-type="posts" data-kind="page">
            <nav class="navbar" role="navigation" aria-label="main navigation" data-dir="ltr">
  <div class="navbar__brand">
    
    <a href="/blog/" title="Home" rel="home" class="navbar__logo-link">
      <img src="/blog/logo.png" alt="Home" class="navbar__logo">
    </a>
    
    
      <a href="/blog/" title="Home" rel="home" class="navbar__title-link">
        <h6 class="navbar__title">Will</h6>
      </a>
    
  </div>

  
<div class="theme theme-mobile" data-ani="true">
  <div class="dropdown">
    <button class="dropdown-trigger navbar__slide-down" aria-label="Select Theme Button" style="" data-ani="true">
      <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"><path fill="none" d="M24 0H0v24h24V0z"/><path fill="currentColor" d="M6.34 7.93c-3.12 3.12-3.12 8.19 0 11.31C7.9 20.8 9.95 21.58 12 21.58s4.1-.78 5.66-2.34c3.12-3.12 3.12-8.19 0-11.31l-4.95-4.95c-.39-.39-1.02-.39-1.41 0L6.34 7.93zM12 19.59c-1.6 0-3.11-.62-4.24-1.76C6.62 16.69 6 15.19 6 13.59s.62-3.11 1.76-4.24L12 5.1v14.49z"/></svg>      
    </button>
    <div class="dropdown-content select-theme">
      
        
        <a href="#" class="dropdown-item select-theme__item is-active">
          solarized
        </a>
        
        <a href="#" class="dropdown-item select-theme__item ">
          dark
        </a>
        
        <a href="#" class="dropdown-item select-theme__item ">
          light
        </a>
        
        <a href="#" class="dropdown-item select-theme__item ">
          hacker
        </a>
        
        <a href="#" class="dropdown-item select-theme__item ">
          kimbie
        </a>
        
      
    </div>
  </div>
</div>


<div id="mobileSearchBtn" class="mobile-search__btn" data-ani="true">
  <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M15.5 14h-.79l-.28-.27c1.2-1.4 1.82-3.31 1.48-5.34-.47-2.78-2.79-5-5.59-5.34-4.23-.52-7.79 3.04-7.27 7.27.34 2.8 2.56 5.12 5.34 5.59 2.03.34 3.94-.28 5.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
</div>

<div id="search-mobile-container" class="mobile-search hide" data-dir="ltr">
  <div class="mobile-search__top">
    <input id="search-mobile" type="text" aria-label="Mobile Search" placeholder="Search" class="mobile-search__top--input"/>
    <div id="search-mobile-close" class="mobile-search__top--icon">
      <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"><path opacity=".87" fill="none" d="M0 0h24v24H0V0z"/><path fill="currentColor" d="M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm3.59-13L12 10.59 8.41 7 7 8.41 10.59 12 7 15.59 8.41 17 12 13.41 15.59 17 17 15.59 13.41 12 17 8.41z"/></svg>
    </div>
  </div>
  <div id="search-mobile-results" class="mobile-search__body">
    
  </div>
</div>


<a role="button" class="navbar__burger" aria-label="menu" aria-expanded="false"
  data-ani="true">
  <span aria-hidden="true"></span>
  <span aria-hidden="true"></span>
  <span aria-hidden="true"></span>
</a>
<div class="navbarm__collapse" data-open="false">
  <ul dir="ltr">
    
    
      
      
      
      

      
        <li class="navbarm__menu--item active">
          <a href="/blog/posts">posts</a>
        </li>
      
      
    
      
      
      
      

      
        <li class="navbarm__menu--item ">
          <a href="/blog/archive">archive</a>
        </li>
      
      
    
      
      
      
      

      
        <li class="navbarm__menu--item ">
          <a href="/blog/about">about</a>
        </li>
      
      
    

    
      <li class="navbarm__menu--item ">
        <a href="/blog/tags" class="navbarm__menu--term" data-index="0">
          Tags
        </a>
      </li>
    
  </ul>
</div>
  <div class="navbar__menu">
  
<div class="theme" data-ani="true">
  <div class="dropdown">
    <button class="dropdown-trigger navbar__slide-down" aria-label="Select Theme Button" data-ani="true">
      <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"><path fill="none" d="M24 0H0v24h24V0z"/><path fill="currentColor" d="M6.34 7.93c-3.12 3.12-3.12 8.19 0 11.31C7.9 20.8 9.95 21.58 12 21.58s4.1-.78 5.66-2.34c3.12-3.12 3.12-8.19 0-11.31l-4.95-4.95c-.39-.39-1.02-.39-1.41 0L6.34 7.93zM12 19.59c-1.6 0-3.11-.62-4.24-1.76C6.62 16.69 6 15.19 6 13.59s.62-3.11 1.76-4.24L12 5.1v14.49z"/></svg>      
    </button>
    <div class="dropdown-content select-theme">
      
        
        <a href="#" class="dropdown-item select-theme__item is-active">
          solarized
        </a>
        
        <a href="#" class="dropdown-item select-theme__item ">
          dark
        </a>
        
        <a href="#" class="dropdown-item select-theme__item ">
          light
        </a>
        
        <a href="#" class="dropdown-item select-theme__item ">
          hacker
        </a>
        
        <a href="#" class="dropdown-item select-theme__item ">
          kimbie
        </a>
        
      
    </div>
  </div>
</div>

  
  
  
  
  
  
  
  <a href="/blog/posts" class="navbar__menu-item navbar__slide-down active" dir="ltr" data-ani="true">posts</a>
  
  
  
  
  
  
  
  <a href="/blog/archive" class="navbar__menu-item navbar__slide-down " dir="ltr" data-ani="true">archive</a>
  
  
  
  
  
  
  
  <a href="/blog/about" class="navbar__menu-item navbar__slide-down " dir="ltr" data-ani="true">about</a>
  
  
</div>
</nav>
            
            

<main class="single__main main-main">
  
    <nav class="breadcrumb hide" aria-label="breadcrumbs">
  <script>document.querySelector('.breadcrumb').classList.remove('hide')</script>
  <ol>
    
  
  
  
  
  
  <li >
    
      <a href="https://jmwill.github.io/blog/" class="capitalize">Will&#39;s Blog</a>
    
  </li>
  
  
  <li >
    
      <a href="https://jmwill.github.io/blog/posts/" class="capitalize">Posts</a>
    
  </li>
  
  
  <li  class="is-active" >
    
      <span>ç¨‹åºæ„æˆ-ç¬¬äºŒç« </span>
    
  </li>
  
  </ol>
  
</nav>
  
  
  <div class="single ">
    <div class="single__nojs">This page looks best with JavaScript enabled</div>
    <script>document.querySelector('.single').classList.remove('hide'); document.querySelector('.single__nojs').classList.add('hide');</script>
    <h2 class="single__title" data-ani="true">ç¨‹åºæ„æˆ-ç¬¬äºŒç« </h2>
    <div class="single__meta">
      
<div class="single__infos">
  <time class="single__info" title="Written At">ğŸ“…&nbsp;Jun 11, 2017 </time>
  
  &nbsp;&middot;&nbsp; <span class="single__info" title="Reading Time"> â˜•&nbsp;126&nbsp;min read </span>
  
  <span class="single__info">
    
  </span>
</div>
      
<ul class="single__tags caption">
  
  ğŸ·ï¸
  

  <li><a href="https://jmwill.github.io/blog/tags/%E8%AF%91%E6%96%87/" class="single__tag" title="è¯‘æ–‡">#è¯‘æ–‡</a></li>

  <li><a href="https://jmwill.github.io/blog/tags/design-programs/" class="single__tag" title="Design Programs">#Design Programs</a></li>

</ul>
    </div>
    <article class="single__contents" data-dir="ltr" data-ani="true">
      
      <h2 id="ç¬¬äºŒç« -æ„ç­‘æŠ½è±¡æ•°æ®">ç¬¬äºŒç« : æ„ç­‘æŠ½è±¡æ•°æ®</h2>
<h3 id="21-ä»‹ç»">2.1 ä»‹ç»</h3>
<p>åœ¨ç¬¬ä¸€ç« æˆ‘ä»¬é›†ä¸­å…³æ³¨è®¡ç®—è¿‡ç¨‹, ä»¥åŠå‡½æ•°å¯¹ç¨‹åºè®¾è®¡çš„ä½œç”¨ä¸å½±å“. æˆ‘ä»¬å·²ç»è§è¯†è¿‡å¦‚ä½•ä½¿ç”¨åŸå§‹æ•°æ®(numbers)ä»¥åŠåŸå§‹æ“ä½œç¬¦(ç®—æœ¯), å¦‚ä½•é€šè¿‡ç»„åˆå’Œæ§åˆ¶æ¥ç»„æˆå¤åˆå‡½æ•°, ä»¥åŠé€šè¿‡ç»™è®¡ç®—è¿‡ç¨‹èµ‹äºˆåç§°æ¥åˆ›å»ºå‡½æ•°æŠ½æŠ½è±¡. æˆ‘ä»¬ä¹Ÿçœ‹åˆ°é«˜é˜¶å‡½æ•°é€šè¿‡å…è®¸æˆ‘ä»¬è‡ªè¡Œæ§åˆ¶, ä»è€Œæ¨ç†å‡ºä¸€èˆ¬è®¡ç®—æ–¹æ³•æ¥å¢å¼ºæˆ‘ä»¬çš„è¯­è¨€çš„åŠ›é‡. è¿™å°±æ˜¯ç¼–ç¨‹çš„æœ¬è´¨.</p>
<p>è¿™ä¸€ç« ä¸»è¦å…³æ³¨æ•°æ®. æˆ‘ä»¬åœ¨è¿™é‡Œæ¢è®¨çš„æŠ€æœ¯å…è®¸æˆ‘ä»¬è¡¨è¾¾ä»¥åŠæ“ä½œè®¸å¤šä¸åŒé¢†åŸŸçš„ä¿¡æ¯. ç”±äºå› ç‰¹ç½‘çš„çˆ†ç‚¸æ€§å¢é•¿, æä¾›ç»™æˆ‘ä»¬å¤§é‡åœ¨çº¿ä¸”å…è´¹çš„ç»“æ„åŒ–ä¿¡æ¯, å¹¶ä¸”å¯ä»¥åœ¨å¤§èŒƒå›´ä¸åŒé—®é¢˜ä¸Šè¿›è¡Œè®¡ç®—. æœ‰æ•ˆä½¿ç”¨å…§å»ºçš„ä»¥åŠç”¨æˆ·å®šä¹‰çš„æ•°æ®ç±»å‹æ˜¯æ•°æ®å¤„ç†ç¨‹åºçš„æ ¹æœ¬.</p>
<h4 id="211-åŸºæœ¬æ•°æ®ç±»å‹">2.1.1 åŸºæœ¬æ•°æ®ç±»å‹</h4>
<p>æ¯ä¸€ç§æ•°æ®åœ¨Pythonä¸­éƒ½æœ‰ä¸€ä¸ªç±»å±, è¿™ä¸ªç±»å±å†³å®šäº†è¿™ä¸ªå€¼æ˜¯ä»€ä¹ˆç±»å‹. å…±äº«çš„æ•°æ®åŒæ—¶å…·æœ‰å…±äº«çš„è¡Œä¸º. ä¾‹å¦‚, æ•´æ•°1ä»¥åŠ2éƒ½æ˜¯intç±»çš„å®ä¾‹. è¿™ä¸¤ä¸ªå€¼èƒ½å¤Ÿè¿›è¡Œç±»ä¼¼çš„å¤„ç†. ä¾‹å¦‚, å®ƒä»¬éƒ½å¯ä»¥è¢«å¦å¤–ä¸€ä¸ªæ•´æ•°åŠ æˆ–è€…å‡. å…§å»ºçš„typeå‡½æ•°å…è®¸æˆ‘ä»¬æ£€æŸ¥ä»»ä½•æ•°å€¼çš„ç±»å‹.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">int</span><span class="s1">&#39;&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>æˆ‘ä»¬ç›®å‰ä½¿ç”¨çš„æ•°å€¼çŸ¥è¯†å°‘é‡Pythonè¯­è¨€çš„å…§å»º_æœ¬åœ°_æ•°æ®ç±»å‹. æœ¬åœ°æ•°æ®ç±»å‹å…·æœ‰ä»¥ä¸‹å±æ€§:</p>
<ol>
<li>æœ‰å¯¹åŸç”Ÿç±»å‹çš„å€¼è¿›è¡Œå®šä¹‰çš„è¡¨è¾¾å¼, å«åšå¸¸é‡</li>
<li>æœ‰å¯¹åŸç”Ÿç±»å‹çš„å€¼è¿›è¡Œæ“ä½œçš„å…§å»ºå‡½æ•°ä»¥åŠæ“ä½œç¬¦</li>
</ol>
<p>intç±»æ˜¯ç”¨æ¥è¡¨ç¤ºæ•´æ•°çš„åŸç”Ÿæ•°æ®ç±»å‹. æ•´å‹å¸¸é‡(ç›¸é‚»æ•°å­—åºåˆ—)è¡¨è¾¾ä¸ºintå€¼, ä»¥åŠæ•°å­¦è¿ç®—ç¬¦æ¥æ“ä½œè¿™äº›å€¼.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="mi">12</span> <span class="o">+</span> <span class="mi">3000000000000000000000000</span>
<span class="mi">3000000000000000000000012</span>
</code></pre></td></tr></table>
</div>
</div><p>PythonåŒ…å«æœ‰ä¸‰ç§æœ¬åœ°æ•°æ®ç±»å‹: æ•´å‹(int), å®æ•°(float), ä»¥åŠå¤æ•°(complex).</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">float</span><span class="s1">&#39;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">1j</span><span class="p">)</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">complex</span><span class="s1">&#39;&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>Floats</strong>: åå­—floatæ¥æºäºPythonä»¥åŠè®¸å¤šå…¶ä»–çš„ç¨‹åºè¯­è¨€å®æ•°çš„è¡¨ç¤ºæ–¹å¼æ˜¯ä»¥: &ldquo;æµ®ç‚¹(floating point)&ldquo;æ¥è¡¨ç¤ºçš„. è‡³äºæ•°å­—æ˜¯å¦‚ä½•è¡¨ç¤ºçš„è¿™äº›ç»†èŠ‚ä¸åœ¨æˆ‘ä»¬è¿™ä¸€èŠ‚çš„è®¨è®ºèŒƒå›´ä¹‹å†…, è€Œä¸€äº›intä»¥åŠfloatå¯¹è±¡çš„é«˜çº§å·®å¼‚éœ€è¦é‡ç‚¹äº†è§£. å°¤å…¶æ˜¯, intå¯¹è±¡èƒ½å¤Ÿå‡†ç¡®åœ°è¡¨ç¤ºæ•´æ•°, å¯¹å…¶å¤§å°æ²¡æœ‰ä»»ä½•è¿‘ä¼¼ä»¥åŠé™åˆ¶. å¦ä¸€æ–¹é¢, floatå¯¹è±¡èƒ½å¤Ÿè¡¨ç¤ºè¾ƒå®½èŒƒå›´å†…çš„åˆ†æ•°, ä½†ä¸æ˜¯æ‰€æœ‰çš„æ•°å­—éƒ½èƒ½å¤Ÿå‡†ç¡®è¡¨ç¤º, åŒæ—¶å®ƒä»¬è¿˜å…·æœ‰æœ€å°å€¼ä»¥åŠæœ€å¤§å€¼. å› æ­¤, floatæ•°å€¼åº”è¯¥è¢«è§†ä¸ºå®é™…å€¼çš„è¿‘ä¼¼å€¼æ¥å¯¹å¾…. è¿™äº›è¿‘ä¼¼å€¼åªå…·æœ‰æœ‰é™çš„ç²¾åº¦. åˆå¹¶æµ®ç‚¹æ•°ä¼šå¯¼è‡´ä¸€äº›ç²¾åº¦é”™è¯¯; å¦‚æœä¸ç”¨è¿‘ä¼¼å€¼çš„è¯ä¸‹é¢çš„è¡¨è¾¾å¼è®¡ç®—ååº”è¯¥ä¼šç­‰äº7:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="mi">7</span> <span class="o">/</span> <span class="mi">3</span> <span class="o">*</span> <span class="mi">3</span>
<span class="mf">7.0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span> <span class="o">*</span> <span class="mi">7</span> <span class="o">*</span> <span class="mi">3</span>
<span class="mf">6.999999999999999</span>
</code></pre></td></tr></table>
</div>
</div><p>è™½ç„¶ä¸Šé¢æ˜¯intçš„ç»„åˆ, ç”¨ä¸€ä¸ªinté™¤ä»¥å¦ä¸€ä¸ªä¼šå¾—åˆ°ä¸€ä¸ªfloatçš„å€¼: ä¸€ä¸ªè¢«æˆªæ–­äº†çš„è¿‘ä¼¼å€¼, ä¹Ÿå°±æ˜¯ä¸¤ä¸ªæ•´æ•°ç›¸é™¤çš„å®é™…æ¯”ç‡.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">float</span><span class="s1">&#39;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span>
<span class="mf">0.3333333333333333</span>
</code></pre></td></tr></table>
</div>
</div><p>å½“æˆ‘ä»¬è¿›è¡Œç›¸ç­‰æ€§æµ‹è¯•çš„æ—¶å€™å°±ä¼šå‡ºç°è¿‘ä¼¼å€¼çš„é—®é¢˜.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span> <span class="o">==</span> <span class="mf">0.333333333333333312345</span>  <span class="c1"># Beware of float approximation</span>
<span class="bp">True</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿™äº›intç±»å‹ä¸floatç±»å‹ä¹‹é—´çš„å¾®å¦™ä¸åŒ, å¯¹ç¨‹åºçš„ç¼–å†™å…·æœ‰å¹¿æ³›çš„å½±å“, å› æ­¤å®ƒä»¬çš„ç»†èŠ‚ç¨‹åºå‘˜å¿…é¡»è¦é“­è®°åœ¨å¿ƒ. å¹¸è¿çš„æ˜¯, åªæœ‰å°‘é‡çš„æœ¬åœ°æ•°æ®ç±»å‹, é™åˆ¶äº†ç²¾é€šç¼–ç¨‹è¯­è¨€æ‰€éœ€è¦çš„è®°å¿†é‡. æ­¤å¤–, è¿™äº›ç›¸åŒçš„ç»†èŠ‚åœ¨è®¸å¤šç¼–ç¨‹è¯­è¨€ä¸­ä¹Ÿæ˜¯ä¸€è‡´çš„. ç”±ç¤¾åŒºå‡†åˆ™å¼ºåˆ¶æ‰§è¡Œ, å¦‚: <a href="http://en.wikipedia.org/wiki/IEEE_floating_point">IEEE 754 floating point standard</a></p>
<p><strong>éæ•°å­—ç±»å‹</strong>. æ•°å€¼èƒ½å¤Ÿä»£è¡¨è®¸å¤šå…¶ä»–ç±»å‹çš„æ•°æ®, ä¾‹å¦‚å£°éŸ³, å›¾åƒ, åœ°ç‚¹, ç½‘å€, ç½‘ç»œè¿æ¥ç­‰ç­‰. å°‘é‡æ˜¯é€šè¿‡æœ¬åœ°æ•°æ®ç±»å‹æ¥è¡¨ç¤ºçš„, ä¾‹å¦‚ä»£è¡¨çœŸ(True)å’Œå‡(False)çš„å¸ƒå°”(bool)ç±»å‹. å¤§å¤šæ•°å€¼çš„ç±»å‹éƒ½éœ€è¦ç¨‹åºå‘˜æ¥ä½¿ç”¨æœ¬ç« ä¸­ç ”ç©¶çš„ç»„åˆå’ŒæŠ½è±¡æ‰‹æ®µæ¥è¿›è¡Œå®šä¹‰.</p>
<p>æ¥ä¸‹æ¥çš„éƒ¨åˆ†å°†ä»‹ç»æ›´å¤šPythonçš„æœ¬åœ°æ•°æ®ç±»å‹, ä¾§é‡äºå®ƒä»¬åœ¨åˆ›å»ºæœ‰ç”¨çš„æ•°æ®æŠ½è±¡ä¸­æ‰€èµ·åˆ°çš„ä½œç”¨. é‚£äº›å¯¹äºæ›´åŠ æ·±å…¥çš„ç»†èŠ‚æ„Ÿå…´è¶£çš„äººå¯ä»¥é˜…è¯»ä¸€ä¸‹æ·±å…¥Python3è¿™æœ¬ä¹¦çš„<a href="http://getpython3.com/diveintopython3/native-datatypes.html">æœ¬åœ°æ•°æ®ç±»å‹</a>è¿™ä¸€ç« ,å†™å‡ºäº†æ‰€æœ‰Pythonçš„æœ¬åœ°æ•°æ®ç±»å‹çš„å®ç”¨æ¦‚è¿°ä»¥åŠå¦‚ä½•å¯¹å®ƒä»¬è¿›è¡Œæ“ä½œ, åŒ…æ‹¬å¤§é‡çš„ç”¨æ³•ä¾‹å­ä»¥åŠç»ƒä¹ æç¤º.</p>
<h3 id="22-æ•°æ®æŠ½è±¡">2.2 æ•°æ®æŠ½è±¡</h3>
<p>å½“æˆ‘ä»¬è€ƒè™‘ä¸–ç•Œä¸Šçš„å¹¿æ³›çš„äº‹ç‰©çš„æ—¶å€™, æˆ‘ä»¬ä¼šæƒ³è¦å°†å®ƒåœ¨æˆ‘ä»¬çš„ç¨‹åºä¸­è¡¨ç°å‡ºæ¥, æˆ‘ä»¬ä¼šå‘ç°å®ƒä»¬å¤§å¤šæ•°éƒ½å…·æœ‰å¤åˆç»“æ„. ä¾‹å¦‚, ä¸€ä¸ªåœ°ç†ä½ç½®æœ‰ç»åº¦ä»¥åŠçº¬åº¦åæ ‡. ä¸ºäº†è¡¨ç¤ºä½ç½®, æˆ‘ä»¬ä¼šæƒ³è®©æˆ‘ä»¬çš„ç¨‹åºè¯­è¨€æœ‰èƒ½åŠ›å°†ç»åº¦å’Œçº¬åº¦åˆåœ¨ä¸€èµ·ä»¥å½¢æˆä¸€å¯¹, ä½œä¸ºä¸€ä¸ªæˆ‘ä»¬çš„ç¨‹åºèƒ½å¤Ÿæ“ä½œçš„ä¸€ä¸ªå•ä¸€çš„æ¦‚å¿µå•å…ƒ, ä½†æ˜¯å®ƒä¹Ÿå…·æœ‰ä¸¤ä¸ªéƒ¨åˆ†å¯ä»¥è¿›è¡Œå•ç‹¬è€ƒè™‘.</p>
<p>ä½¿ç”¨å¤åˆæ•°æ®èƒ½å¤Ÿè®©æˆ‘ä»¬æå‡ç¨‹åºçš„æ¨¡å—æ€§, å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿå°†åœ°ç†ä½ç½®ä½œä¸ºä¸€ä¸ªæ•´ä½“æ¥è¿›è¡Œæ“ä½œ, ç„¶åæˆ‘ä»¬å°±å¯ä»¥å¯¹ç¨‹åºä½¿ç”¨ä½ç½®è¿›è¡Œè®¡ç®—ä¸­æ˜¯å¦‚ä½•å¯¹è¿™äº›åœ°ç†ä½ç½®è¿›è¡Œè¡¨ç¤ºçš„ç»†èŠ‚è¿›è¡Œå±è”½. ä¸€èˆ¬çš„éš”ç¦»ç¨‹åºå„ä¸ªéƒ¨åˆ†çš„æŠ€æœ¯, éƒ½æ˜¯å¤„ç†æ•°æ®æ˜¯å¦‚ä½•è¢«è¡¨ç¤º, ä»¥åŠå¤„ç†æ•°æ®æ˜¯å¦‚ä½•è¢«æ“ä½œçš„å¼ºå¤§çš„è®¾è®¡æ–¹æ³•, è¿™æ–¹æ³•ç§°ä¸ºæ•°æ®æŠ½è±¡. æ•°æ®æŠ½è±¡è®©ç¨‹åºæ›´å®¹æ˜“è¢«è®¾è®¡, ç»´æŠ¤, ä»¥åŠä¿®æ”¹</p>
<p>æ•°æ®æŠ½è±¡åœ¨æ€§è´¨ä¸Šè·Ÿå‡½æ•°æŠ½è±¡é‚£ä¸€ç« ç›¸ä¼¼. å½“æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå‡½æ•°æŠ½è±¡, å‡½æ•°æ˜¯å¦‚ä½•å®ç°çš„ç»†èŠ‚èƒ½å¤Ÿè¢«å‹åˆ¶, ä»¥åŠç‰¹å®šçš„å‡½æ•°æœ¬èº«èƒ½å¤Ÿè¢«ä»»ä½•å…¶ä»–çš„å…·æœ‰ç›¸åŒæ•´ä½“è¡Œä¸ºçš„å‡½æ•°è¿›è¡Œæ›¿æ¢. æ¢å¥è¯è¯´, æˆ‘ä»¬å¯ä»¥å®ç°ä¸€ä¸ªæŠ½è±¡æ¥å°†å‡½æ•°ä½¿ç”¨çš„æ–¹å¼ä¸å‡½æ•°å¦‚ä½•å®ç°çš„ç»†èŠ‚ä¸Šè¿›è¡Œåˆ†ç¦». ç±»ä¼¼åœ°, æ•°æ®æŠ½è±¡å¯¹å¤åˆæ•°æ®çš„ä½¿ç”¨æ–¹å¼ä¸å¦‚ä½•æ„é€ çš„ç»†èŠ‚è¿›è¡Œäº†éš”ç¦».</p>
<p>æ•°æ®æŠ½è±¡çš„åŸºæœ¬æ€æƒ³æ˜¯ç»“æ„åŒ–ç¨‹åº, ä»¥ä¾¿äºå®ƒä»¬å¯¹æŠ½è±¡æ•°æ®è¿›è¡Œæ“ä½œ. ä¹Ÿå°±æ˜¯è¯´, æˆ‘ä»¬çš„ç¨‹åºåº”è¯¥ä»¥å°½å¯èƒ½å°‘çš„ä»¥å¯¹æ•°æ®è¿›è¡Œå‡è®¾çš„æ–¹å¼æ¥ä½¿ç”¨æ•°æ®. åŒæ—¶, æ•°æ®çš„å…·ä½“è¡¨ç°åº”è¯¥å®šä¹‰ä¸ºç¨‹åºçš„ä¸€ä¸ªç‹¬ç«‹çš„éƒ¨åˆ†.</p>
<p>ç¨‹åºçš„è¿™ä¸¤ä¸ªéƒ¨åˆ†, å¯¹æ•°æ®æŠ½è±¡è¿›è¡Œæ“ä½œçš„éƒ¨åˆ†ä»¥åŠå®šä¹‰å…·ä½“è¡¨ç¤ºçš„éƒ¨åˆ†, é€šè¿‡ä¸€ç»„å°çš„å‡½æ•°è¿›è¡Œè¿æ¥, è¿™äº›å‡½æ•°æ ¹æ®å…·ä½“è¡¨ç¤ºå®ç°æŠ½è±¡æ•°æ®. ä¸ºäº†è¯´æ˜è¿™ç§æŠ€æœ¯, æˆ‘ä»¬éœ€è¦è€ƒè™‘å¦‚ä½•è®¾è®¡ä¸€å¥—å‡½æ•°æ¥æ“ä½œæœ‰ç†æ•°.</p>
<h4 id="221-ä¾‹å­-æœ‰ç†æ•°">2.2.1 ä¾‹å­: æœ‰ç†æ•°</h4>
<p>ä¸€ä¸ªæœ‰ç†æ•°å°±æ˜¯æ•´æ•°çš„æ¯”ç‡, æœ‰ç†æ•°æ˜¯æ„æˆå®æ•°çš„é‡è¦å­ç±». ä¸€ä¸ªæœ‰ç†æ•°å¦‚1/3æˆ–è€…17/29é€šå¸¸å†™ä½œ:</p>
<p><code>&lt;numerator&gt;/&lt;denominator&gt;</code></p>
<p>è€Œ<code>&lt;numerator&gt;</code>ä»¥åŠ<code>&lt;denominator&gt;</code>éƒ½æ˜¯æ•´æ•°çš„å ä½ç¬¦. è¿™äº›éƒ¨åˆ†éƒ½éœ€è¦ç”¨æ¥å‡†ç¡®åœ°è¡¨å¾æœ‰ç†æ•°çš„å€¼. å®é™…ä¸Šæ•´æ•°ç›¸é™¤å¾—åˆ°ä¸€ä¸ªæµ®ç‚¹æ•°çš„è¿‘ä¼¼å€¼, å¤±å»äº†æ•´æ•°çš„ç²¾ç¡®åº¦.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span>
<span class="mf">0.3333333333333333</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span> <span class="o">==</span> <span class="mf">0.333333333333333300000</span>  <span class="c1"># Dividing integers yields an approximation</span>
<span class="bp">True</span>
</code></pre></td></tr></table>
</div>
</div><p>ç„¶è€Œ, æˆ‘ä»¬å¯ä»¥é€šè¿‡å°†åˆ†å­å’Œåˆ†æ¯ç»„åˆåœ¨ä¸€èµ·æ¥ä¸ºæœ‰ç†æ•°åˆ›å»ºä¸€ä¸ªç²¾ç¡®çš„è¡¨ç¤º.</p>
<p>æˆ‘ä»¬ä»ä½¿ç”¨å‡½æ•°çš„æŠ½è±¡ä¸­å¯ä»¥çŸ¥é“, æˆ‘ä»¬å¯ä»¥åœ¨ç¨‹åºçš„æŸäº›éƒ¨åˆ†å®ç°ä¹‹å‰å¼€å§‹è¿›è¡Œç¼–ç¨‹. è®©æˆ‘ä»¬å‡è®¾æˆ‘ä»¬å·²ç»æœ‰åŠæ³•ä»ä¸€ä¸ªåˆ†å­ä»¥åŠä¸€ä¸ªåˆ†æ¯ä¸­æ„é€ ä¸€ä¸ªæœ‰ç†æ•°å¼€å§‹. æˆ‘ä»¬è¿˜å‡è®¾, ç»™å®šä¸€ä¸ªæœ‰ç†æ•°, æˆ‘ä»¬æœ‰æ–¹æ³•é€‰å®šå®ƒçš„åˆ†å­å’Œåˆ†æ¯çš„éƒ¨åˆ†. è®©æˆ‘ä»¬è¿›ä¸€æ­¥å‡è®¾æ„é€ å™¨ä»¥åŠé€‰æ‹©å™¨å¯å…·æœ‰ä¸€ä¸‹çš„ä¸‰ä¸ªåŠŸèƒ½:</p>
<ul>
<li>**rational(n, d)**ä»¥åˆ†å­ä¸ºnåˆ†æ¯ä¸ºdçš„å½¢å¼è¿”å›ä¸€ä¸ªæœ‰ç†æ•°</li>
<li>**numer(x)**è¿”å›æœ‰ç†æ•°ä¸­çš„åˆ†å­x</li>
<li>**denom(x)**è¿”å›æœ‰ç†æ•°ä¸­çš„åˆ†æ¯x</li>
</ul>
<p>åœ¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ç¨‹åºè®¾è®¡ä¸­çš„å¼ºå¤§ç­–ç•¥: <em>ç¥ˆæ„¿æ€ç»´</em>. æˆ‘ä»¬è¿˜æ²¡æœ‰è®²è¿°ä¸€ä¸ªæœ‰ç†æ•°æ˜¯å¦‚ä½•è¡¨ç¤ºçš„, æˆ–è€…å‡½æ•°number, denom, ä»¥åŠrationalåº”è¯¥æ€ä¹ˆå®ç°. å³ä½¿è¿™æ ·, å¦‚æœæˆ‘ä»¬å®šä¹‰äº†è¿™ä¸‰ä¸ªå‡½æ•°, æˆ‘ä»¬å¯ä»¥å¯¹æœ‰ç†æ•°è¿›è¡ŒåŠ , ä¹˜, æ‰“å°, ä»¥åŠæµ‹è¯•ç›¸ç­‰æ€§ç­‰æ“ä½œ:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">add_rationals</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">nx</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="n">numer</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">denom</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">ny</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">numer</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">denom</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rational</span><span class="p">(</span><span class="n">nx</span> <span class="o">*</span> <span class="n">dy</span> <span class="o">+</span> <span class="n">ny</span> <span class="o">*</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">dy</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">mul_rational</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">rational</span><span class="p">(</span><span class="n">numer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">numer</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">denom</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">denom</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">print_rational</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="n">numer</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="n">denom</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">rationals_are_equal</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">numer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">denom</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="n">numer</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="n">denom</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>ç°åœ¨æˆ‘ä»¬å…·æœ‰å®šä¹‰åœ¨é€‰æ‹©å™¨å‡½æ•°numberä»¥åŠdenomå’Œæ„é€ å™¨å‡½æ•°rationalä¹‹ä¸Šçš„æ“ä½œå‡½æ•°, ä½†æ˜¯æˆ‘ä»¬è¿˜æ²¡æœ‰å®šä¹‰è¿™äº›é€‰æ‹©å™¨å‡½æ•°ä»¥åŠæ„é€ å™¨å‡½æ•°. æˆ‘ä»¬éœ€è¦ä¸€ç§æ–¹æ³•æ¥å°†åˆ†å­å’Œåˆ†æ¯è¿›è¡Œç²˜åˆ, å½¢æˆä¸€ä¸ªå¤åˆå€¼.</p>
<h4 id="222-ä¸€å¯¹">2.2.2 ä¸€å¯¹</h4>
<p>ä¸ºäº†è®©æˆ‘ä»¬å®ç°æ­£ç¡®ç­‰çº§çš„æ•°æ®æŠ½è±¡, Pythonæä¾›äº†ä¸€ç§å¤åˆæ•°æ®ç»“æ„å«åšlist, èƒ½å¤Ÿé€šè¿‡å°†è¡¨è¾¾å¼æ”¾åˆ°æ–¹æ‹¬å·å†…å¹¶ç”¨é€—å·åˆ†éš”å¼€æ¥æ„é€ , è¿™ç§è¡¨è¾¾å¼å°±å«åšåˆ—è¡¨å­—é¢é‡.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>
<span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><p>åˆ—è¡¨ä¸­çš„å…ƒç´ å¯ä»¥ç”¨ä¸¤ç§æ–¹å¼æ¥è¿›è¡Œè®¿é—®, ç¬¬ä¸€ç§æ–¹å¼æ˜¯é€šè¿‡æˆ‘ä»¬ç†Ÿæ‚‰çš„å¤šé‡åˆ†é…çš„æ–¹æ³•, é€šè¿‡å¯¹listå¯¹è±¡ä¸­çš„å…ƒç´ è¿›è¡Œè§£åŒ…ç„¶åç»‘å®šæ¯ä¸€ä¸ªå…ƒç´ åˆ°ä¸åŒçš„åå­—.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">pair</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">pair</span>
<span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">pair</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span>
<span class="mi">10</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y</span>
<span class="mi">20</span>
</code></pre></td></tr></table>
</div>
</div><p>ç¬¬äºŒä¸ªè®¿é—®æ–¹æ³•æ˜¯é€šè¿‡listçš„å…ƒç´ é€‰æ‹©è¿ç®—ç¬¦, ä¹Ÿé€šè¿‡æ–¹æ‹¬å·æ¥è¿›è¡Œè¡¨è¾¾. ä¸åƒåˆ—è¡¨å­—é¢é‡, ä¸€ä¸ªæ–¹æ‹¬å·è¡¨è¾¾å¼ç›´æ¥è·Ÿåœ¨å¦ä¸€ä¸ªè¡¨è¾¾å¼åé¢ä¸ä»¥ç”Ÿæˆåˆ—è¡¨å€¼æ¥è¿è¡Œ, è€Œæ˜¯åœ¨å‰é¢çš„è¡¨è¾¾å¼ä¸­é€‰æ‹©ä¸€ä¸ªå…ƒç´ .</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="mi">10</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="mi">20</span>
</code></pre></td></tr></table>
</div>
</div><p>åœ¨Pythonä¸­çš„åˆ—è¡¨(ä»¥åŠå¤§å¤šæ•°å…¶ä»–çš„ç¼–ç¨‹è¯­è¨€)æ˜¯ä»¥0ç´¢å¼•ä½œä¸ºå¼€å§‹çš„, è¿™æ„å‘³ç€ç´¢å¼•0é€‰å®šç¬¬ä¸€ä¸ªå…ƒç´ , ç´¢å¼•1é€‰å®šç¬¬äºŒä¸ª, ç­‰ç­‰. ä¸€ä¸ªæ”¯æŒè¿™ä¸ªç´¢å¼•æƒ¯ä¾‹çš„ç›´è§‰æ˜¯ç´¢å¼•ä»£è¡¨ä¸€ä¸ªå…ƒç´ åç¦»åˆ—è¡¨å¼€å§‹ä½ç½®æœ‰å¤šè¿œ.</p>
<p>è·Ÿå…ƒç´ é€‰æ‹©æ“ä½œç¬¦ç›¸ç­‰çš„å‡½æ•°å«åšgetitem, å®ƒä¹Ÿç”¨ç´¢å¼•0ä½œä¸ºå¼€å§‹ä½ç½®æ¥å¯¹åˆ—è¡¨å¯¹è±¡è¿›è¡Œé€‰å–.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">getitem</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">getitem</span><span class="p">(</span><span class="n">pair</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="mi">10</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">getitem</span><span class="p">(</span><span class="n">pair</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="mi">20</span>
</code></pre></td></tr></table>
</div>
</div><p>ä¸¤ä¸ªå…ƒç´ çš„åˆ—è¡¨ä¸æ˜¯è¡¨ç¤ºä¸€å¯¹çš„å”¯ä¸€æ–¹æ³•, ä»»ä½•å°†ä¸¤ä¸ªå€¼æ†ç»‘åˆ°ä¸€å—çš„æ–¹æ³•éƒ½å¯ä»¥è®¤ä¸ºæ˜¯ä¸€å¯¹. åªæ˜¯åˆ—è¡¨æ˜¯ä¸€ç§å¸¸ç”¨çš„æ–¹æ³•. åˆ—è¡¨ä¹Ÿå¯ä»¥å®¹çº³è¶…è¿‡ä¸¤ä¸ªå¯¹è±¡, æ­£å¦‚æˆ‘ä»¬æœ¬ç« æ¥ä¸‹æ¥è¦è¿›è¡Œè®¨è®ºçš„.</p>
<p><strong>è¡¨ç¤ºæœ‰ç†æ•°</strong>. ç°åœ¨æˆ‘ä»¬èƒ½å¤Ÿå°†æœ‰ç†æ•°è¡¨ç¤ºä¸ºä¸€å¯¹æ•´æ•°çš„ç»„åˆ: ä¸€ä¸ªåˆ†å­å’Œä¸€ä¸ªåˆ†æ¯.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">rational</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">d</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">numer</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">denom</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><p>ç»“åˆæ—©å…ˆæˆ‘ä»¬å®šä¹‰çš„ç®—æœ¯è¿ç®—, æˆ‘ä»¬å¯ä»¥ç”¨æˆ‘ä»¬å·²ç»å®šä¹‰å¥½çš„å‡½æ•°æ¥æ“ä½œæœ‰ç†æ•°.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">half</span> <span class="o">=</span> <span class="n">rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">print_rational</span><span class="p">(</span><span class="n">half</span><span class="p">)</span>
<span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">third</span> <span class="o">=</span> <span class="n">rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">print_rational</span><span class="p">(</span><span class="n">mul_rational</span><span class="p">(</span><span class="n">half</span><span class="p">,</span> <span class="n">third</span><span class="p">))</span>
<span class="mi">1</span> <span class="o">/</span> <span class="mi">6</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">print_rational</span><span class="p">(</span><span class="n">add_rationals</span><span class="p">(</span><span class="n">third</span><span class="p">,</span> <span class="n">third</span><span class="p">))</span>
<span class="mi">6</span> <span class="o">/</span> <span class="mi">9</span>
</code></pre></td></tr></table>
</div>
</div><p>åƒä¸Šé¢ä¾‹å­æ˜¾ç¤ºçš„é‚£æ ·, æˆ‘ä»¬çš„æœ‰ç†æ•°çš„å®ç°ä¸ä¼šå°†æœ‰ç†æ•°å‡å°‘åˆ°æœ€ä½é¡¹. æˆ‘ä»¬å¯ä»¥é€šè¿‡æ”¹å˜rationalå‡½æ•°çš„å®ç°æ¥ä¿®å¤è¿™ä¸ªç¼ºé™·. å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªå‡½æ•°æ¥è®¡ç®—ä¸¤ä¸ªæ•´æ•°çš„æœ€å¤§å…¬åˆ†æ¯, æˆ‘ä»¬å°±å¯ä»¥åœ¨æ„å»ºæœ‰ç†æ•°å¯¹æ—¶ç”¨å®ƒæ¥å°†åˆ†å­å’Œåˆ†æ¯å‡å°‘ä¸ºæœ€åº•é¡¹. è·Ÿè®¸å¤šæœ‰ç”¨çš„å·¥å…·ä¸€æ ·, åœ¨Pythonçš„åº“ä¸­å·²ç»æœ‰è¿™æ ·çš„ä¸€ä¸ªå‡½æ•°äº†.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">fractions</span> <span class="kn">import</span> <span class="n">gcd</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">rational</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">gcd</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">n</span><span class="o">//</span><span class="n">g</span><span class="p">,</span> <span class="n">d</span><span class="o">//</span><span class="n">g</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>æ•´é™¤è¿ç®—ç¬¦, <code>//</code>, è¡¨ç¤ºæ•´é™¤, ä¹Ÿå°±æ˜¯å¯¹ç›¸é™¤çš„ç»“æœå°†å‘ä¸‹èˆå…¥å°æ•°éƒ¨åˆ†. ç”±äºæˆ‘ä»¬å·²ç»çŸ¥é“gèƒ½å¤Ÿå®Œå…¨æ•´é™¤nä»¥åŠd, æ•´é™¤åœ¨è¿™ç§æƒ…å†µä¸‹æ˜¯ç²¾ç¡®çš„. è¿™ä¸ªrationalå‡½æ•°çš„åˆç†åœ°è¿›è¡Œäº†ä¿®æ­£ä¿è¯äº†æœ‰ç†æ•°ä»¥æœ€ä½é¡¹æ¥è¡¨ç¤º.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">print_rational</span><span class="p">(</span><span class="n">add_rationals</span><span class="p">(</span><span class="n">third</span><span class="p">,</span> <span class="n">third</span><span class="p">))</span>
<span class="mi">2</span> <span class="o">/</span> <span class="mi">3</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿™ç§æ”¹è¿›æ˜¯é€šè¿‡æ”¹è¿›æ„é€ å‡½æ•°è€Œä¸ç”¨æ”¹å˜å…¶ä»–å‡½æ•°(å³å®ç°å®é™…è¿ç®—çš„å‡½æ•°)æ¥å®Œæˆçš„.</p>
<h4 id="223-æŠ½è±¡å±éšœ">2.2.3 æŠ½è±¡å±éšœ</h4>
<p>åœ¨ç»§ç»­(ä»‹ç»)æ›´å¤šçš„ç»„åˆæ•°æ®å’Œæ•°æ®æŠ½è±¡çš„ä¾‹å­ä¹‹å‰, è®©æˆ‘ä»¬æ€è€ƒä¸€ä¸‹æœ‰ç†æ•°ä¾‹å­æå‡ºçš„ä¸€äº›é—®é¢˜. æˆ‘ä»¬æ ¹æ®æ„é€ å‡½æ•°rationalå’Œé€‰æ‹©å™¨numer, denomå®šä¹‰æ“ä½œ. ä¸€èˆ¬æ¥è¯´, æ•°æ®æŠ½è±¡çš„åŸºç¡€æ€æƒ³æ˜¯è¯†åˆ«ä¸€ç»„åŸºç¡€æ“ä½œ, æ ¹æ®è¿™äº›æ“ä½œæ¥è¡¨è¾¾æŸç§ç±»å‹çš„å€¼çš„æ‰€æœ‰æ“ä½œ, ç„¶ååªä½¿ç”¨è¿™äº›æ“ä½œæ¥å¤„ç†æ•°æ®. é€šè¿‡é™åˆ¶è¿™äº›æ“ä½œçš„ä½¿ç”¨æ–¹å¼, å°†ä¼šæ›´å®¹æ˜“æ”¹å˜æŠ½è±¡æ•°æ®çš„è¡¨ç¤ºè€Œä¸ç”¨ä¿®æ”¹ç¨‹åºçš„è¡Œä¸º.</p>
<p>å¯¹äºæœ‰ç†æ•°, ç¨‹åºçš„ä¸åŒéƒ¨åˆ†ä½¿ç”¨ä¸åŒçš„æ“ä½œæ¥æ“çºµæœ‰ç†æ•°, å¦‚ä¸‹è¡¨æ‰€è¿°:</p>
<table>
<thead>
<tr>
<th align="left"><strong>Parts of the program that&hellip;</strong></th>
<th align="left"><strong>Treat rational as&hellip;</strong></th>
<th align="left"><strong>Using only&hellip;</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Use rational numbers to perform computation</td>
<td align="left">whole data values</td>
<td align="left"><code>add_rational</code>, <code>mul_rational</code>, <code>rationals_are_equal</code>, <code>print_rational</code></td>
</tr>
<tr>
<td align="left">Create rationals or implement rational operations</td>
<td align="left">numerators and denominators</td>
<td align="left"><code>rational</code>, <code>numer</code>, <code>denom</code></td>
</tr>
<tr>
<td align="left">Implement selectors and constructor for rationals</td>
<td align="left">two-element lists</td>
<td align="left">list literals and element selection</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th align="left"><strong>ç¨‹åºçš„æ¯ä¸ªéƒ¨åˆ†&hellip;</strong></th>
<th align="left"><strong>å°†æœ‰ç†æ•°å½“åš&hellip;</strong></th>
<th align="left"><strong>åªç”¨ä½œ</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">ç”¨æœ‰ç†æ•°æ¥æ‰§è¡Œè®¡ç®—</td>
<td align="left">æ•´ä¸ªæ•°å€¼</td>
<td align="left"><code>add_rational</code>, <code>mul_rational</code>, <code>rationals_are_equal</code>, <code>print_rational</code></td>
</tr>
<tr>
<td align="left">åˆ›å»ºæœ‰ç†æ•°æˆ–æ“ä½œæœ‰ç†æ•°</td>
<td align="left">åˆ†å­ä»¥åŠåˆ†æ¯</td>
<td align="left"><code>rational</code>, <code>numer</code>, <code>denom</code></td>
</tr>
<tr>
<td align="left">å®ç°æœ‰ç†æ•°çš„æ„é€ å™¨ä»¥åŠé€‰æ‹©å™¨</td>
<td align="left">ä¸¤ä¸ªå…ƒç´ çš„åˆ—è¡¨</td>
<td align="left">åˆ—è¡¨å­—é¢é‡ä»¥åŠå…ƒç´ é€‰æ‹©</td>
</tr>
</tbody>
</table>
<p>åœ¨ä¸Šé¢çš„æ¯ä¸€å±‚, æœ€åä¸€åˆ—çš„å‡½æ•°å®ç°äº†ä¸€ä¸ªæŠ½è±¡å±éšœ. è¿™äº›å‡½æ•°é€šè¿‡æ›´ä½å±‚æ¬¡çš„æŠ½è±¡æ¥å®ç°æ¥è¢«æ›´é«˜å±‚çš„å‡½æ•°è°ƒç”¨.</p>
<p>è¿åä¸€ä¸ªæŠ½è±¡å±éšœçš„æƒ…å†µå‘ç”Ÿåœ¨æ¯å½“å¯ä»¥åœ¨è¾ƒé«˜çº§åˆ«å‡½æ•°ä¸­ä½¿ç”¨ç¨‹åºçš„ä¸€éƒ¨åˆ†æ—¶, å´ä½¿ç”¨è¾ƒä½çº§åˆ«çš„å‡½æ•°æ¥å®ç°. ä¸¾ä¸ªä¾‹å­, ä¸€ä¸ªè®¡ç®—æœ‰ç†æ•°å¹³æ–¹çš„å‡½æ•°æœ€å¥½æ˜¯æ ¹æ®<code>mul_rational</code>æ¥å®ç°, è€Œæ— éœ€å¯¹æœ‰ç†æ•°çš„å®ç°è¿›è¡Œä»»ä½•å‡è®¾.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">square_rational</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">mul_rational</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>ç›´æ¥æ¶‰åŠåˆ°åˆ†å­ä»¥åŠåˆ†æ¯ä¼šè¿åä¸€å±‚æŠ½è±¡å±éšœ.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">square_rational_violating_once</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">rational</span><span class="p">(</span><span class="n">numer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">numer</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">denom</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">denom</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</code></pre></td></tr></table>
</div>
</div><p>å‡è®¾æœ‰ç†æ•°ç”¨ä¸¤ä¸ªå…ƒç´ çš„åˆ—è¡¨è¡¨ç¤ºä¼šè¿åä¸¤å±‚æŠ½è±¡å±éšœ.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">square_rational_violating_twice</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</code></pre></td></tr></table>
</div>
</div><p>æŠ½è±¡å±éšœè®©ç¨‹åºæ›´å®¹æ˜“ç®¡ç†ä¸ä¿®æ”¹. è¶Šå°‘å‡½æ•°ä¾èµ–äºç‰¹å®šçš„è¡¨ç¤º, å½“æƒ³æ”¹å˜å…¶ä¸­ä¸€ä¸ªçš„è¡¨ç¤ºçš„æ—¶å€™å°±éœ€è¦è¶Šå°‘çš„æ”¹åŠ¨. æ‰€æœ‰çš„è¿™äº›<code>square_rational</code>çš„å®ç°éƒ½å…·æœ‰æ­£ç¡®çš„è¡Œä¸º, ä½†æ˜¯åªæœ‰ç¬¬ä¸€ä¸ªå¯¹äºæœªçŸ¥çš„å˜åŒ–æ˜¯å¥å£®çš„. <code>square_rational</code>å‡½æ•°å³ä½¿åœ¨æˆ‘ä»¬ä¿®æ”¹æœ‰ç†æ•°çš„è¡¨ç¤ºçš„æ—¶å€™ä¹Ÿä¸éœ€è¦æ›´æ–°. ç›¸æ¯”ä¹‹ä¸‹, <code>square_rational_violating_once</code>æ¯å½“é€‰æ‹©å™¨æˆ–è€…æ„é€ å™¨çš„ç‰¹å¾æ”¹å˜çš„æ—¶å€™éƒ½éœ€è¦è¿›è¡Œä¿®æ”¹, è€Œ<code>square_rational_violating_twice</code>åˆ™åœ¨æœ‰ç†æ•°çš„å®ç°æœ‰ä»»ä½•æ”¹å˜æ—¶éƒ½éœ€è¦è¿›è¡Œæ›´æ–°.</p>
<h4 id="224-æ•°æ®çš„å±æ€§">2.2.4 æ•°æ®çš„å±æ€§</h4>
<p>æŠ½è±¡å±éšœèƒ½å¤Ÿå¡‘é€ æˆ‘ä»¬æ€è€ƒæ•°æ®çš„æ–¹å¼. å¯¹æœ‰ç†æ•°è¿›è¡Œæœ‰æ•ˆçš„è¡¨ç¤ºæ˜¯ä¸é™äºä»»ä½•ç‰¹å®šçš„å®ç°çš„(å¦‚å…·æœ‰ä¸¤ä¸ªå…ƒç´ çš„åˆ—è¡¨); å®ƒæ˜¯rationalå‡½æ•°è¿”å›çš„ä¸€ä¸ªå€¼, è¿™ä¸ªå€¼èƒ½å¤Ÿè¾“å…¥åˆ°numerä»¥åŠdenomå½“ä¸­. é™¤æ­¤ä¹‹å¤–, å¿…éœ€ç»´æŒæ„é€ å™¨è·Ÿé€‰æ‹©å™¨ä¹‹é—´æ°å½“çš„å…³ç³». ä¹Ÿå°±æ˜¯è¯´, å¦‚æœæˆ‘ä»¬ä»æ•´æ•°nè·Ÿdä¸­æ„é€ ä¸€ä¸ªæœ‰ç†æ•°x, åº”è¯¥å¾—åˆ°ä¸€ç§æƒ…å†µæ˜¯numer(x)/denom(x)ç­‰äºn/d.</p>
<p>ä¸€èˆ¬æ¥è¯´, æˆ‘ä»¬å¯ä»¥ç”¨é€‰æ‹©å™¨å‡½æ•°ä»¥åŠæ„é€ å™¨å‡½æ•°é›†åˆä¸ä¸€äº›è¡Œä¸ºæ¡ä»¶ä¸€èµ·æ¥è¡¨ç¤ºæŠ½è±¡æ•°æ®. åªè¦è¿™äº›è¡Œä¸ºæ¡ä»¶æ»¡è¶³(ä¾‹å¦‚ä¸Šé¢çš„é™¤æ³•å±æ€§), é€‰æ‹©å™¨ä»¥åŠæ„é€ å™¨å‡½æ•°æ„æˆäº†ä¸€ç§æ•°æ®çš„æœ‰æ•ˆè¡¨ç¤º. åœ¨æŠ½è±¡å±éšœä¹‹ä¸‹çš„ç»†èŠ‚å¯èƒ½ä¼šæœ‰æ›´æ”¹, ä½†æ˜¯å¦‚æœè¡Œä¸ºæ²¡æœ‰æ”¹å˜, é‚£æ•°æ®æŠ½è±¡ä¾ç„¶æ˜¯æœ‰æ•ˆçš„, ç„¶åä»»ä½•ä½¿ç”¨è¿™äº›æ•°æ®æŠ½è±¡ç¼–å†™çš„ç¨‹åºä¾ç„¶æ˜¯æ­£ç¡®çš„.</p>
<p>è¿™ä¸€è§‚ç‚¹èƒ½å¤Ÿè¿›è¡Œå¹¿æ³›åœ°åº”ç”¨, åŒ…æ‹¬æˆ‘ä»¬ç”¨äºå®ç°æœ‰ç†æ•°çš„æ•°æ®å¯¹. æˆ‘ä»¬ä»æ²¡æœ‰è¯´è¿‡ä»€ä¹ˆæ˜¯æ•°æ®å¯¹, åªæœ‰è¯­è¨€æä¾›çš„åˆ›å»ºä»¥åŠæ“ä½œä¸¤ä¸ªå…ƒç´ çš„åˆ—è¡¨æ–¹æ³•. æˆ‘ä»¬éœ€è¦å®ç°çš„æ•°æ®å¯¹çš„è¡Œä¸ºæ˜¯å®ƒèƒ½å°†ä¸¤ä¸ªå€¼é»åˆåœ¨ä¸€èµ·. è€Œè¡Œä¸ºæ¡ä»¶,</p>
<ul>
<li>å¦‚æœä¸€ä¸ªæ•°æ®å¯¹pç”±å€¼xè·Ÿyæ„é€ , é‚£ä¹ˆselect(p, 0)è¿”å›x, select(p, 1)è¿”å›y.</li>
</ul>
<p>æˆ‘ä»¬å®é™…ä¸Šä¸éœ€è¦ç”¨åˆ—è¡¨ç±»å‹æ¥åˆ›å»ºæ•°æ®å¯¹, ä½œä¸ºæ›¿ä»£, æˆ‘ä»¬å¯ä»¥å®ç°ä¸¤ä¸ªå‡½æ•°pairä»¥åŠselectæ¥æ»¡è¶³è¿™ä¸ªæè¿°, å°±åƒä¸¤ä¸ªå…ƒç´ çš„åˆ—è¡¨ä¸€æ ·.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">pair</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;Return a function that represents a pair.&#34;&#34;&#34;</span>
        <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="n">index</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">x</span>
            <span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">y</span>
        <span class="k">return</span> <span class="n">get</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">select</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;Return the element at index i of pair p.&#34;&#34;&#34;</span>
        <span class="k">return</span> <span class="n">p</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>æœ‰äº†è¿™ä¸ªå®ç°, æˆ‘ä»¬å¯ä»¥åˆ›å»ºå¹¶æ“ä½œæ•°æ®å¯¹.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="n">pair</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">select</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="mi">20</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">select</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="mi">14</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿™ç§é«˜é˜¶å‡½æ•°çš„ä½¿ç”¨æ–¹å¼èƒ½å¤Ÿè·Ÿæˆ‘ä»¬å¯¹äºæ•°æ®æ˜¯ä»€ä¹ˆè¿™ç§ç›´è§‚çš„æ¦‚å¿µè¿›è¡Œå¯¹åº”. ç„¶è€Œ, è¿™äº›å‡½æ•°è¶³å¤Ÿè¡¨ç¤ºæˆ‘ä»¬ç¨‹åºä¸­ç”¨åˆ°çš„æ•°æ®å¯¹. å‡½æ•°è¶³ä»¥è¡¨ç¤ºå¤åˆæ•°æ®.</p>
<p>ç”¨å‡½æ•°å±•ç¤ºæ•°æ®å¯¹çš„æ„æ€ä¸ä»£è¡¨Pythonå°±æ˜¯ä»¥è¿™ç§æ–¹å¼æ¥è¿è¡Œçš„(å¤„äºæ•ˆç‡çš„åŸå› , åˆ—è¡¨çš„å®ç°æ›´åŠ çš„ç›´è§‚)ä½†æ˜¯å®ƒèƒ½ä»¥è¿™ç§æ–¹å¼è¿è¡Œ. å‡½æ•°å‹çš„è¡¨ç¤ºè™½ç„¶æ¨¡ç³Š, ä½†å®ƒå®Œå…¨å…·æœ‰è¡¨ç¤ºæ•°æ®å¯¹çš„èƒ½åŠ›, å› ä¸ºå®ƒæ»¡è¶³æ•°æ®å¯¹å”¯ä¸€éœ€è¦æ»¡è¶³çš„æ¡ä»¶. æ•°æ®æŠ½è±¡çš„å®è·µå…è®¸æˆ‘ä»¬è½»æ˜“åœ°åœ¨å„ç§è¡¨ç¤ºä¸­è¿›è¡Œåˆ‡æ¢.</p>
<h3 id="23-åºåˆ—">2.3 åºåˆ—</h3>
<p>åºåˆ—å°±æ˜¯ä¸€ä¸ªå€¼çš„æœ‰åºé›†åˆ. åºåˆ—åœ¨è®¡ç®—æœºç§‘å­¦ä¸­æ˜¯å¼ºå¤§çš„, åŸºæœ¬çš„æŠ½è±¡. åºåˆ—ä¸æ˜¯æŸä¸ªç‰¹å®šçš„å…§å»ºç±»å‹çš„å®ä¾‹æˆ–è€…æŠ½è±¡æ•°æ®è¡¨ç¤º, è€Œæ˜¯åœ¨ä¸€äº›ä¸åŒç±»å‹çš„æ•°æ®ä¹‹é—´å…±äº«è¡Œä¸ºçš„é›†åˆ. ä¹Ÿå°±æ˜¯è¯´, æœ‰è®¸å¤šç§ç±»å‹çš„åºåˆ—. ä½†æ˜¯å®ƒä»¬éƒ½å…±äº«å…±åŒçš„è¡Œä¸º. å°¤å…¶æ˜¯,</p>
<p><strong>é•¿åº¦</strong>. ä¸€ä¸ªåºåˆ—å…·æœ‰æœ‰é™çš„é•¿åº¦. ä¸€ä¸ªç©ºåºåˆ—çš„é•¿åº¦æ˜¯0.</p>
<p><strong>å…ƒç´ é€‰æ‹©</strong>. ä¸€ä¸ªåºåˆ—çš„å¯¹äºä»»ä½•å°äºå®ƒé•¿åº¦çš„éè´Ÿæ•´æ•°çš„ç´¢å¼•å€¼éƒ½å¯¹åº”å®ƒçš„ä¸€ä¸ªå…ƒç´ , ç¬¬ä¸€ä¸ªå…ƒç´ ä»0å¼€å§‹.</p>
<p>PythonåŒ…å«çš„ä¸€äº›æœ¬åœ°æ•°æ®ç±»å‹å°±æ˜¯åºåˆ—, æœ€é‡è¦çš„è«è¿‡äº<strong>åˆ—è¡¨</strong>äº†.</p>
<h4 id="231-åˆ—è¡¨">2.3.1 åˆ—è¡¨</h4>
<p>ä¸€ä¸ªåˆ—è¡¨å°±æ˜¯ä¸€ä¸ªå…·æœ‰ä»»æ„é•¿åº¦çš„åºåˆ—. åˆ—è¡¨å…·æœ‰ä¸€å¤§å¥—å…§å»ºè¡Œä¸º, ä»¥åŠè¡¨ç¤ºè¿™äº›è¡Œä¸ºçš„ç‰¹æ®Šè¯­æ³•. æˆ‘ä»¬å·²ç»è§è¯†è¿‡åˆ—è¡¨å­—é¢é‡äº†, ä¹Ÿå°±æ˜¯ç”¨æ¥è¿ç®—ç”Ÿæˆåˆ—è¡¨å®ä¾‹é‚£ä¸ª, ä»¥åŠå…ƒç´ é€‰æ‹©è¡¨è¾¾å¼, å³ç”¨æ¥è·å–åˆ—è¡¨ä¸­çš„å€¼çš„è¯­æ³•. å…§å»ºçš„lenå‡½æ•°ç”¨äºè¿”å›ä¸€ä¸ªåºåˆ—çš„é•¿åº¦. ä¸‹é¢, digitsæ˜¯ä¸€ä¸ªå…·æœ‰å››ä¸ªå…ƒç´ çš„åˆ—è¡¨. ç´¢å¼•ä¸º3çš„å…ƒç´ å€¼æ˜¯8.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">digits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">digits</span><span class="p">)</span>
<span class="mi">4</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">digits</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="mi">8</span>
</code></pre></td></tr></table>
</div>
</div><p>å¦å¤–, åˆ—è¡¨å¯ä»¥åŠ åœ¨ä¸€èµ·, ä»¥åŠä¸ä¸€ä¸ªæ•´æ•°ç›¸ä¹˜. å¯¹äºåºåˆ—æ¥è¯´, åŠ æ³•ä»¥åŠä¹˜æ³•ä¸ä¼šæ·»åŠ æˆ–è€…ä¹˜é‡Œé¢çš„å…ƒç´ , è€Œæ˜¯å¤åˆ¶åºåˆ—æœ¬èº«å¹¶å°†å®ƒä»¬åˆå¹¶åœ¨ä¸€èµ·. ä¹Ÿå°±æ˜¯è¯´, åœ¨operatoræ¨¡å—ä¸‹çš„addå‡½æ•°(ä»¥åŠç¬¦å·+)è¿”å›çš„æ˜¯æ·»åŠ çš„å‚æ•°çº§è”åç”Ÿæˆçš„ä¸€ä¸ªåˆ—è¡¨. è€Œåœ¨operatorä¸­çš„mulå‡½æ•°(ä»¥åŠ<code>*</code>å·)èƒ½å¤Ÿä¼ å…¥ä¸€ä¸ªåˆ—è¡¨ä»¥åŠä¸€ä¸ªæ•´æ•°ç„¶åè¿”å›å¦ä¸€ä¸ªåˆ—è¡¨, è¿™ä¸ªåˆ—è¡¨æ˜¯ç”±kæ¬¡é‡å¤çš„æºåˆ—è¡¨ç»„æˆçš„.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span> <span class="o">+</span> <span class="n">digits</span> <span class="o">*</span> <span class="mi">2</span>
<span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><p>ä»»æ„çš„å€¼éƒ½å¯ä»¥åŒ…å«åœ¨åˆ—è¡¨ä¸­, åŒ…æ‹¬å…¶ä»–çš„åˆ—è¡¨. ä¸ºäº†é€‰æ‹©åˆ°åŒ…æ‹¬åœ¨åˆ—è¡¨é‡Œé¢çš„åˆ—è¡¨è¿™æ ·æ·±å±‚æ¬¡åµŒå¥—çš„å…ƒç´ å¯ä»¥å¤šæ¬¡åº”ç”¨åˆ—è¡¨å…ƒç´ é€‰æ‹©è¯­æ³•.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">pairs</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">]]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">pairs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">pairs</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="mi">30</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="232-åºåˆ—è¿­ä»£">2.3.2 åºåˆ—è¿­ä»£</h4>
<p>åœ¨å¾ˆå¤šæƒ…å†µä¸‹, æˆ‘ä»¬ä¼šæƒ³è¦å¯¹åºåˆ—çš„å…ƒç´ è¿›è¡Œè¿­ä»£ç„¶ååè¿‡æ¥å¯¹æ¯ä¸ªå…ƒç´ æ‰§è¡Œä¸€äº›è®¡ç®—. è¿™ç§æ¨¡å¼æ˜¯å¦‚æ­¤çš„å¸¸è§ä»¥è‡³äºPythonæœ‰ä¸€ä¸ªé¢å¤–çš„æ§åˆ¶è¯­å¥æ¥å¤„ç†é¡ºåºçš„æ•°æ®: forè¯­å¥.</p>
<p>æƒ³ä¸€ä¸‹è®¡ç®—ä¸€ä¸ªå€¼åœ¨åºåˆ—ä¸­å‡ºç°çš„æ¬¡æ•°è¿™æ ·çš„ä¸€ä¸ªé—®é¢˜, æˆ‘ä»¬å¯ä»¥å®ç°ä¸€ä¸ªå‡½æ•°ç”¨whileå¾ªç¯æ¥è¿›è¡Œè®¡æ•°.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">count</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">total</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">==</span> <span class="n">value</span><span class="p">:</span>
                <span class="n">total</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">total</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">count</span><span class="p">(</span><span class="n">digits</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="mi">2</span>
</code></pre></td></tr></table>
</div>
</div><p>Pythonçš„forè¯­å¥èƒ½å¤Ÿç®€åŒ–è¿™ä¸ªå‡½æ•°ä½“é€šè¿‡ç›´æ¥å¯¹å…ƒç´ å€¼è¿›è¡Œè¿­ä»£è€Œæ ¹æœ¬ä¸éœ€è¦å¼•å…¥åç§°index.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">count</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">elem</span> <span class="o">==</span> <span class="n">value</span><span class="p">:</span>
                <span class="n">total</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">total</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">count</span><span class="p">(</span><span class="n">digits</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="mi">2</span>
</code></pre></td></tr></table>
</div>
</div><p>forè¯­å¥ç”±å•ä¸ªå­å¥ç»„æˆ, å½¢å¼å¦‚ä¸‹:</p>
<pre><code>for &lt;name&gt; in &lt;expression&gt;:
    &lt;suite&gt;
</code></pre><p>ä¸€ä¸ªforè¯­å¥ä¼šæŒ‰ç…§ä»¥ä¸‹çš„æ­¥éª¤æ‰§è¡Œ:</p>
<ol>
<li>è®¡ç®—å¤´éƒ¨è¡¨è¾¾å¼<code>&lt;expression&gt;</code>, å¿…é¡»è¿”å›ä¸€ä¸ªå¯è¿­ä»£çš„å€¼.</li>
<li>éå†è¯¥å¯è¿­ä»£å€¼ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ , æ˜¯ä¸ºäº†:
<ol>
<li>å°†è¿™ä¸ªå…ƒç´ å€¼å½“å‰åŸŸçš„ä¸­çš„<code>&lt;name&gt;</code>è¿›è¡Œç»‘å®š</li>
<li>æ‰§è¡Œ<code>&lt;suite&gt;</code></li>
</ol>
</li>
</ol>
<p>è¿™ä¸ªæ‰§è¡Œè¿‡ç¨‹å¼•ç”¨çš„æ˜¯å¯è¿­ä»£çš„å€¼, åˆ—è¡¨æ˜¯åºåˆ—çš„ä¸€ç§, è€Œåºåˆ—æ˜¯ä¸€ç§å¯è¿­ä»£çš„å€¼. å®ƒä»¬çš„å…ƒç´ æŒ‰ç…§å®ƒä»¬åŸæœ‰çš„é¡ºåºè¢«è€ƒè™‘. PythonåŒ…æ‹¬å…¶ä»–çš„å¯è¿­ä»£çš„å€¼, ä½†æ˜¯ç›®å‰æˆ‘ä»¬ä¼šä¸“æ³¨äºåºåˆ—; æœ¯è¯­&quot;å¯è¿­ä»£&quot;çš„ä¸€èˆ¬å®šä¹‰å‡ºç°åœ¨ç¬¬å››ç« çš„è¿­ä»£å™¨éƒ¨åˆ†.</p>
<p>è¿™ä¸ªè®¡ç®—è¿‡ç¨‹çš„ä¸€ä¸ªé‡è¦çš„æ„ä¹‰æ˜¯<code>&lt;name&gt;</code>ä¼šåœ¨forè¯­å¥è¿è¡Œåç»‘å®šåˆ°åºåˆ—ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ . forå¾ªç¯å¼•å…¥äº†å¦å¤–ä¸€ç§å¯ä»¥è®©è¿è¡Œç¯å¢ƒéšè¯­å¥æ‰§è¡Œè€Œæ›´æ–°çš„æ–¹å¼.</p>
<p><strong>åºåˆ—è§£åŒ…</strong>. åœ¨ç¨‹åºä¸­çš„å¸¸è§æ¨¡å¼æ˜¯æœ‰ä¸€ä¸ªä»¥åºåˆ—ä¸ºå…ƒç´ çš„åºåˆ—, ä½†å…ƒç´ éƒ½æ˜¯å›ºå®šé•¿åº¦çš„. ä¸€ä¸ªforè¯­å¥å¯èƒ½ä¼šåŒ…å«æœ‰å¤šä¸ªåç§°åœ¨å®ƒçš„å¤´éƒ¨ç”¨æ¥å¯¹åºåˆ—ä¸­çš„æ¯ä¸€ä¸ªåºåˆ—å…ƒç´ &quot;è§£åŒ…&quot;åˆ°å„è‡ªå¯¹åº”çš„åç§°ä¸Š. ä¾‹å¦‚, å¯èƒ½ä¼šæœ‰ä¸€ä¸ªä»¥åŒ…å«ä¸¤ä¸ªå…ƒç´ çš„åºåˆ—ä¸ºå…ƒç´ çš„åºåˆ—:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">pairs</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]</span>
</code></pre></td></tr></table>
</div>
</div><p>ç„¶åå¸Œæœ›ä»ä¸­æ‰¾åˆ°è¿™äº›åºåˆ—å¯¹ä¸­ä¸¤ä¸ªæ•°å­—æ˜¯ç›¸ç­‰çš„åºåˆ—å¯¹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">same_count</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></td></tr></table>
</div>
</div><p>ä¸‹é¢çš„forè¯­å¥åœ¨å®ƒçš„å¤´éƒ¨æœ‰ä¸¤ä¸ªå˜é‡åxå’Œy, è¿™ä¸¤ä¸ªå˜é‡åä¼šåˆ†åˆ«è·Ÿåºåˆ—å¯¹çš„ç¬¬ä¸€å’Œç¬¬äºŒä¸ªå…ƒç´ è¿›è¡Œç»‘å®š:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">y</span><span class="p">:</span>
            <span class="n">same_count</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">same_count</span>
<span class="mi">2</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿™ç§å°†å¤šä¸ªåç§°ä»¥å›ºå®šé•¿åº¦çš„é¡ºåºç»‘å®šåˆ°å¤šä¸ªå€¼çš„æ¨¡å¼ç§°ä¸ºåºåˆ—è§£åŒ…; è¿™è·Ÿæˆ‘ä»¬åœ¨èµ‹å€¼è¯­å¥ä¸­çœ‹åˆ°çš„ç»‘å®šå¤šä¸ªåç§°åˆ°å¤šä¸ªå€¼çš„æ¨¡å¼æ˜¯ä¸€æ ·çš„.</p>
<p><strong>èŒƒå›´</strong>. ä¸€ä¸ªrangeç±»å‹æ˜¯Pythonä¸­å¦ä¸€ä¸ªå…§å»ºçš„åºåˆ—ç±»å‹, å®ƒä»£è¡¨äº†ä¸€ä¸ªæ•´æ•°çš„åŒºé—´. åŒºé—´ç”±rangeæ¥åˆ›é€ , éœ€è¦ä¸¤ä¸ªæ•´æ•°ä½œä¸ºå‚æ•°: ç¬¬ä¸€ä¸ªæ•°å­—å’Œä¸€ä¸ªè¶…å‡ºæ‰€éœ€èŒƒå›´å†…çš„æœ€åä¸€ä¸ªæ•°å­—.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="c1"># åŒ…å«1, ä½†ä¸åŒ…å«10</span>
<span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>è°ƒç”¨listæ„é€ å™¨è®¡ç®—å‡ºåœ¨ä¸€ä¸ªåœ¨èŒƒå›´å†…çš„ä¸èŒƒå›´ç›¸ç¬¦çš„åˆ—è¡¨, å› æ­¤å¯ä»¥å¾ˆå®¹æ˜“åœ°æ£€æŸ¥é‡Œé¢çš„å…ƒç´ .</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><p>å¦‚æœåªç»™å®šä¸€ä¸ªå‚æ•°, è¿™è¢«è§£æä¸ºæ„å»ºä¸€ä¸ªä»é›¶å¼€å§‹åˆ°è¶…å‡ºæ‰€éœ€èŒƒå›´å†…çš„æœ€åä¸€ä¸ªæ•°å­—çš„åŒºé—´.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><p>åŒºé—´é€šå¸¸å‡ºç°åœ¨forè¡¨è¾¾å¼çš„å¤´éƒ¨æ¥æŒ‡å®š<code>&lt;suite&gt;</code>éƒ¨ä½åº”è¯¥æ‰§è¡Œçš„æ¬¡æ•°: æœ‰ä¸€ä¸ªå…±åŒçš„çº¦å®šæ˜¯å¦‚æœåœ¨forçš„å¤´éƒ¨å†™å…¥çš„åç§°åœ¨<code>&lt;suite&gt;</code>ä¸­æ²¡æœ‰ç”¨åˆ°çš„è¯å°±ç”¨å•ä¸ªä¸‹åˆ’çº¿ä½œä¸ºåç§°:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Go Bears!&#39;</span><span class="p">)</span>

<span class="n">Go</span> <span class="n">Bears</span><span class="err">!</span>
<span class="n">Go</span> <span class="n">Bears</span><span class="err">!</span>
<span class="n">Go</span> <span class="n">Bears</span><span class="err">!</span>
</code></pre></td></tr></table>
</div>
</div><p>ä¸‹åˆ’çº¿å¯¹äºè§£é‡Šå™¨ç¯å¢ƒè€Œè¨€åªæ˜¯å¦å¤–çš„ä¸€ä¸ªåç§°, ä½†æ˜¯å®ƒåœ¨ç¨‹åºå‘˜ä¹‹é—´å´æ˜¯å…·æœ‰å¸¸è§„çš„æ„ä¹‰, é‚£å°±æ˜¯è¡¨æ˜è¿™ä¸ªåç§°ä¸ä¼šç°åœ¨åœ¨ä¹‹åçš„ä»»ä½•è¡¨è¾¾å¼ä¸­.</p>
<h4 id="233-åºåˆ—å¤„ç†">2.3.3 åºåˆ—å¤„ç†</h4>
<p>åºåˆ—æ˜¯ä¸€ç§å¦‚æ­¤å¸¸è§çš„ç”¨äºç»„æˆå¤åˆæ•°æ®çš„å½¢å¼ä»¥è‡³äºæ•´ä¸ªç¨‹åºé€šå¸¸éƒ½å›´ç»•è¿™ä¸ªå•ä¸€æŠ½è±¡æ¥è¿›è¡Œç»„ç»‡. æ¨¡å—åŒ–ç»„ä»¶åŒæ—¶ä»¥åºåˆ—ä½œä¸ºè¾“å…¥å’Œè¾“å‡ºèƒ½å¤Ÿå¯¹æ•°æ®å¤„ç†è¿‡ç¨‹è¿›è¡Œæ··åˆä»¥åŠåŒ¹é…. å¤æ‚ç»„ä»¶èƒ½å¤Ÿé€šè¿‡å°†åºåˆ—å¤„ç†æ“ä½œè¿æ¥åœ¨ä¸€èµ·å½¢æˆç®¡é“æ¥è¿›è¡Œå®šä¹‰, è€Œæ¯ä¸ªå¤„ç†éƒ½æ˜¯ç®€å•å’Œé›†ä¸­çš„.</p>
<p><strong>åˆ—è¡¨æ¨å¯¼</strong>. å¾ˆå¤šçš„åºåˆ—å¤„ç†æ“ä½œèƒ½å¤Ÿé€šè¿‡ä¸ºåºåˆ—ä¸­çš„æ¯ä¸ªå…ƒç´ è®¡ç®—ä¸€ä¸ªå›ºå®šçš„è¡¨è¾¾å¼ç„¶åæ”¶é›†ç»“æœçš„å€¼åˆ°ä¸€ä¸ªç»“æœåºåˆ—ä¸­æ¥è¡¨ç¤º. åœ¨Pythonä¸­, ä¸€ä¸ªåˆ—è¡¨æ¨å¯¼å¼æ˜¯ä¸€ä¸ªæ‰§è¡Œè¿™æ ·çš„è®¡ç®—çš„è¡¨è¾¾å¼:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">odds</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">odds</span><span class="p">]</span>
<span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><p>ä¸Šé¢çš„forå…³é”®è¯ä¸æ˜¯forè¯­å¥çš„ä¸€éƒ¨åˆ†, è€Œæ˜¯åˆ—è¡¨è¡¨è¾¾å¼çš„ä¸€éƒ¨åˆ†å› ä¸ºå®ƒåŒ…å«åœ¨æ–¹æ‹¬å·é‡Œé¢. è€Œå­è¡¨è¾¾å¼ x+1 æ˜¯å°†xé¡ºåºç»‘å®šåˆ°æ¯ä¸€ä¸ªoddsä¸­çš„å…ƒç´ æ¥è¿›è¡Œè¿ç®—, ç„¶åæ”¶é›†æ¯æ¬¡è¿ç®—çš„ç»“æœåˆ°åˆ—è¡¨ä¸­.</p>
<p>å¦ä¸€ä¸ªå¸¸è§çš„åˆ—è¡¨æ¨å¯¼æ“ä½œæ˜¯å»é€‰æ‹©ä¸€ä¸ªæ»¡è¶³æŸäº›ç»“æœçš„å­é›†. åˆ—è¡¨æ¨å¯¼èƒ½å¤Ÿè¡¨è¾¾è¿™ç§æ¨¡å¼, ä¾‹å¦‚é€‰æ‹©æ‰€æœ‰oddsä¸­çš„èƒ½å¤Ÿæ•´é™¤25çš„å…ƒç´ :</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">odds</span> <span class="k">if</span> <span class="mi">25</span> <span class="o">%</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><p>åˆ—è¡¨æ¨å¯¼çš„ä¸€èˆ¬å½¢å¼æ˜¯:</p>
<p><code>[&lt;map expression&gt; for &lt;name&gt; in &lt;sequence expression&gt; if &lt;filter expression&gt;]</code></p>
<p>ä¸ºäº†è¿ç®—ä¸€ä¸ªåˆ—è¡¨æ¨å¯¼, Pythonä¼šè®¡ç®—<code>&lt;sequence expression&gt;</code>, è¿™ä¸ªè¡¨è¾¾å¼å¿…é¡»è¦è¿”å›ä¸€ä¸ªå¯è¿­ä»£å€¼. ç„¶å, å¯¹æ¯ä¸ªå…ƒç´ æŒ‰ç…§é¡ºåº, å°†å…ƒç´ çš„å€¼ä¸<code>&lt;name&gt;</code>è¿›è¡Œç»‘å®š, æ¥ç€è¿ç®—è¿‡æ»¤è¡¨è¾¾å¼, ç„¶åå¦‚æœè¿‡æ»¤ç»“æœè¿”å›çœŸå€¼, <code>map expression</code>(æ˜ å°„è¡¨è¾¾å¼)å°†ä¼šæ‰§è¡Œ, æœ€åç»“æœä¼šè¢«æ”¶é›†åˆ°ä¸€ä¸ªåˆ—è¡¨ä¸­.</p>
<p><strong>èšåˆ</strong>. ç¬¬ä¸‰ä¸ªåºåˆ—å¤„ç†çš„ä¸€èˆ¬æ¨¡å¼æ˜¯å°†ä¸€ä¸ªåºåˆ—ä¸­æ‰€æœ‰çš„å€¼èšåˆåˆ°å•ä¸€çš„ä¸€ä¸ªå€¼ä¸­. å…§å»ºå‡½æ•°sum, min, ä»¥åŠmaxæ‰€æœ‰éƒ½æ˜¯èšåˆå‡½æ•°çš„ä¾‹å­.</p>
<p>é€šè¿‡ç»“åˆè¿™äº›å¯¹æ¯ä¸ªå…ƒç´ è¿›è¡Œè¿ç®—, é€‰æ‹©å…ƒç´ çš„å­é›†, ä»¥åŠèšé›†å…ƒç´ çš„æ¨¡å¼, æˆ‘ä»¬å¯ä»¥ä½¿ç”¨åºåˆ—å¤„ç†æ–¹æ³•æ¥è§£å†³é—®é¢˜.</p>
<p>ä¸€ä¸ªå®Œå¤‡æ­£æ•´æ•°æŒ‡çš„å°±æ˜¯ä¸€ä¸ªç­‰äºå®ƒçš„é™¤æ•°çš„æ€»å’Œ. nçš„é™¤æ•°æ˜¯å°äºnä¸”èƒ½å‡åˆ†nçš„æ­£æ•´æ•°. å¯ä»¥é€šè¿‡åˆ—è¡¨æ¨å¯¼æ¥è¿ç®—ä»è€Œåˆ—å‡ºè¿™äº›nçš„é™¤æ•°</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">divisors</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">divisors</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">divisors</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><p>ä½¿ç”¨divisorså‡½æ•°, æˆ‘ä»¬å¯ä»¥ç”¨å…¶ä»–çš„åˆ—è¡¨æ¨å¯¼æ¥è®¡ç®—å‡ºä»1åˆ°1000çš„æ‰€æœ‰çš„å®Œå¤‡æ•°. (1é€šå¸¸ä¹Ÿè¢«è®¤ä¸ºæ˜¯å®Œå¤‡æ•°, ä½†æ˜¯å®ƒä¸ç¬¦åˆæˆ‘ä»¬å¯¹divisorsçš„å®šä¹‰)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span> <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="n">divisors</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="o">==</span> <span class="n">n</span><span class="p">]</span>
<span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">496</span><span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><p>æˆ‘ä»¬å¯ä»¥å¤ç”¨æˆ‘ä»¬å®šä¹‰çš„divisorsæ¥è§£å†³å¦å¤–çš„é—®é¢˜, æ‰¾å‡ºä¸€ä¸ªå…·æœ‰å›ºå®šé¢ç§¯ä»¥åŠæ•´æ•°é•¿åº¦è¾¹é•¿çš„é•¿æ–¹å½¢çš„æœ€å°å‘¨é•¿. é•¿æ–¹å½¢çš„é¢ç§¯ç­‰äºå®ƒçš„é«˜ä¹˜ä»¥å®½. è€Œä¸”, ç»™å®šé¢ç§¯ä»¥åŠé«˜, æˆ‘ä»¬å¯ä»¥è®¡ç®—å‡ºå®½. æˆ‘ä»¬å¯ä»¥è‚¯å®šåœ°è¯´, é•¿å’Œå®½éƒ½èƒ½å‡åˆ†é¢ç§¯çš„è¯, å°±å¯ä»¥ä¿è¯è¾¹é•¿éƒ½æ˜¯æ•´æ•°.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">width</span><span class="p">(</span><span class="n">area</span><span class="p">,</span> <span class="n">height</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">area</span> <span class="o">%</span> <span class="n">height</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">area</span> <span class="o">//</span> <span class="n">height</span>
</code></pre></td></tr></table>
</div>
</div><p>é•¿æ–¹å½¢çš„å‘¨é•¿ç­‰äºå®ƒè¾¹é•¿çš„æ€»å’Œ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">perimeter</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">width</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">height</span>
</code></pre></td></tr></table>
</div>
</div><p>å…·æœ‰æ•´æ•°è¾¹é•¿çš„é•¿æ–¹å½¢çš„é«˜å¿…é¡»æ˜¯å®ƒé¢ç§¯çš„é™¤æ•°. æˆ‘ä»¬å¯ä»¥é€šè¿‡è€ƒè™‘å®ƒæ‰€æœ‰çš„é«˜æ¥è®¡ç®—æœ€å°å‘¨é•¿.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">minimum_perimeter</span><span class="p">(</span><span class="n">area</span><span class="p">):</span>
        <span class="n">heights</span> <span class="o">=</span> <span class="n">divisors</span><span class="p">(</span><span class="n">area</span><span class="p">)</span>
        <span class="n">perimeters</span> <span class="o">=</span> <span class="p">[</span><span class="n">perimeter</span><span class="p">(</span><span class="n">width</span><span class="p">(</span><span class="n">area</span><span class="p">,</span> <span class="n">h</span><span class="p">),</span> <span class="n">h</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">heights</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">perimeters</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">area</span> <span class="o">=</span> <span class="mi">80</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">width</span><span class="p">(</span><span class="n">area</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="mi">16</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">perimeter</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="mi">42</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">perimeter</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="mi">36</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">minimum_perimeter</span><span class="p">(</span><span class="n">area</span><span class="p">)</span>
<span class="mi">36</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">minimum_perimeter</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)]</span>
<span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>é«˜é˜¶å‡½æ•°</strong></p>
<p>æˆ‘ä»¬åœ¨åºåˆ—å¤„ç†ä¸­è§‚å¯Ÿåˆ°çš„ä¸€èˆ¬æ¨¡å¼å¯ä»¥ç”¨é«˜é˜¶å‡½æ•°æ¥è¿›è¡Œè¡¨ç¤º. é¦–å…ˆ, ä¸ºåºåˆ—ä¸­çš„æ¯ä¸ªå…ƒç´ è¿è¡Œä¸€ä¸ªè¡¨è¾¾å¼å¯ä»¥é€šè¿‡å¯¹æ¯ä¸€ä¸ªå…ƒç´ åº”ç”¨å‡½æ•°æ¥æ¥è¡¨ç¤º.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">apply_to_all</span><span class="p">(</span><span class="n">map_fn</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">map_fn</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">s</span><span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><p>é€šè¿‡å¯¹æ¯ä¸€ä¸ªå…ƒç´ åº”ç”¨çš„å‡½æ•°è¡¨è¾¾å¼ç„¶åä»…é€‰æ‹©èƒ½ä½¿è¡¨è¾¾å¼ç»“æœä¸ºçœŸçš„å…ƒç´ .</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">keep_if</span><span class="p">(</span><span class="n">filter_fn</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">s</span> <span class="k">if</span> <span class="n">filter_fn</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
</code></pre></td></tr></table>
</div>
</div><p>æœ€å, è®¸å¤šå½¢å¼çš„èšåˆå¯ä»¥è¡¨ç¤ºä¸ºåå¤åº”ç”¨ä¸€ä¸ªå¸¦æœ‰ä¸¤ä¸ªå‚æ•°çš„å‡½æ•°, åˆ†åˆ«æ˜¯è¿›è¡Œ<strong>reduced</strong>åçš„å€¼, ä»¥åŠé¡ºåºåº”ç”¨çš„æ¯ä¸€ä¸ªå…ƒç´ .</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">reduce</span><span class="p">(</span><span class="n">reduce_fn</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">initial</span><span class="p">):</span>
        <span class="n">reduced</span> <span class="o">=</span> <span class="n">initial</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
            <span class="n">reduced</span> <span class="o">=</span> <span class="n">reduce_fn</span><span class="p">(</span><span class="n">reduced</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">reduced</span>
</code></pre></td></tr></table>
</div>
</div><p>ä¾‹å¦‚, reduceå¯ä»¥ç”¨æ¥å°†åºåˆ—ä¸­çš„æ‰€æœ‰å…ƒç´ ä¹˜åˆ°ä¸€èµ·. ä½¿ç”¨mulæ›¿ä»£<code>reduce_fn</code>, 1æ›¿ä»£<code>initial</code>, reduceå¯ä»¥ç”¨æ¥å°†åºåˆ—ä¸­çš„æ•°éƒ½ä¹˜åˆ°ä¸€èµ·.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="nb">reduce</span><span class="p">(</span><span class="n">mul</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
<span class="mi">64</span>
</code></pre></td></tr></table>
</div>
</div><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨è¿™äº›é«˜é˜¶å‡½æ•°æ¥æ‰¾å¯»å®Œå¤‡æ•°</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">divisors_of</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">divides_n</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">n</span> <span class="o">%</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">keep_if</span><span class="p">(</span><span class="n">divides_n</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">divisors_of</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">add</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">sum_of_divisors</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">reduce</span><span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="n">divisors_of</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">perfect</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sum_of_divisors</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">==</span> <span class="n">n</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">keep_if</span><span class="p">(</span><span class="n">perfect</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">496</span><span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>å¸¸è§„åç§°</strong></p>
<p>åœ¨è®¡ç®—æœºç§‘å­¦çš„ç¤¾ç¾¤ä¸­, <code>apply_to_all</code>ä¸€èˆ¬å«åš<code>map</code>, <code>keep_if</code>ä¸€èˆ¬å«åš<code>filter</code>. åœ¨Pythonä¸­, å…§å»ºçš„mapä»¥åŠfilteræ˜¯è¿™äº›æ–¹æ³•çš„æ³›åŒ–, ä¸”å¹¶ä¸è¿”å›åˆ—è¡¨å¯¹è±¡. è¿™äº›æ–¹æ³•ä¼šåœ¨ç¬¬å››ç« æ¥è¿›è¡Œè®¨è®º. ä¸Šé¢çš„å®šä¹‰ç›¸å½“äºç”¨åˆ—è¡¨æ„é€ å™¨åˆ°å¤„ç†å…§å»ºçš„mapä»¥åŠfilterè°ƒç”¨åæ‰€è¿”å›ç»“æœ.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">apply_to_all</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">map_fn</span><span class="p">,</span> <span class="n">s</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">map_fn</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
<span class="n">keep_if</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">filter_fn</span><span class="p">,</span> <span class="n">s</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="n">filter_fn</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
</code></pre></td></tr></table>
</div>
</div><p>reduceå‡½æ•°æ„å»ºåœ¨Pythonçš„æ ‡å‡†åº“çš„<code>functools</code>æ¨¡å—ä¸­. åœ¨è¿™ä¸ªç‰ˆæœ¬ä¸­, initialå‚æ•°æ˜¯å¯é€‰çš„.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="nb">reduce</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">mul</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">product</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">reduce</span><span class="p">(</span><span class="n">mul</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">product</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="mi">120</span>
</code></pre></td></tr></table>
</div>
</div><p>åœ¨Pythonç¨‹åºä¸­, ç›´æ¥ä½¿ç”¨åˆ—è¡¨æ¨å¯¼æ˜¯æ¯”ä½¿ç”¨é«˜é˜¶å‡½æ•°æ›´ä¸€èˆ¬çš„æ¨¡å¼, ä½†ä¸¤è€…åœ¨åˆ—è¡¨å¤„ç†ä¸­éƒ½æ˜¯å¹¿æ³›ä½¿ç”¨çš„æ–¹æ³•.</p>
<h4 id="234-åºåˆ—æŠ½è±¡">2.3.4 åºåˆ—æŠ½è±¡</h4>
<p>æˆ‘ä»¬å·²ç»ä»‹ç»äº†ä¸¤ç§æ»¡è¶³åºåˆ—æŠ½è±¡çš„æœ¬åœ°æ•°æ®ç±»å‹: åˆ—è¡¨å’ŒåŒºé—´(lists and ranges). ä¸¤è€…éƒ½æ»¡è¶³è¿™éƒ¨åˆ†å¼€å§‹æ‰€è®¾çš„æ¡ä»¶: é•¿åº¦ä»¥åŠå…ƒç´ é€‰æ‹©. PythonåŒ…å«äº†é¢å¤–çš„ä¸¤ä¸ªåºåˆ—ç±»å‹çš„è¡Œä¸ºç”¨æ¥è¿›è¡Œåºåˆ—æŠ½è±¡çš„æ‹“å±•.</p>
<p><strong>æˆå‘˜</strong>. ä¸€ä¸ªå€¼èƒ½å¤Ÿå°±æ˜¯å¦æ˜¯ä¸€ä¸ªåºåˆ—çš„æˆå‘˜æ¥è¿›è¡Œæµ‹è¯•. Pythonæœ‰ä¸¤ä¸ªæ“ä½œç¬¦<code>in</code>ä»¥åŠ<code>not in</code>å…¶è®¡ç®—çš„ç»“æœæ˜¯Trueæˆ–è€…Falseå–å†³äºå…ƒç´ æ˜¯å¦å‡ºç°åœ¨åºåˆ—ä¸­.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">digits</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">2</span> <span class="ow">in</span> <span class="n">digits</span>
<span class="bp">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">1828</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">digits</span>
<span class="bp">True</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>åˆ‡ç‰‡</strong>. åºåˆ—éƒ½åŒ…å«æ›´å°çš„åºåˆ—. ä¸€ä¸ªåºåˆ—çš„åˆ‡ç‰‡æ˜¯åŸæœ‰åºåˆ—çš„ä»»ä½•ä¸€ä¸ªè¿ç»­ç‰‡æ®µ, ç”±ä¸€å¯¹æ•´æ•°æ¥æŒ‡å®š. å°±åƒrangeæ„é€ å‡½æ•°ä¸€æ ·, ç¬¬ä¸€ä¸ªæ•´æ•°æŒ‡å®šäº†åˆ‡ç‰‡çš„èµ·å§‹ä¸‹æ ‡, ç„¶åç¬¬äºŒä¸ªæ•´æ•°æŒ‡å®šäº†è¶…è¿‡ç»“æŸä¸‹æ ‡çš„æ•°.</p>
<p>åœ¨Pythonä¸­, åºåˆ—åˆ‡ç‰‡çš„è¡¨è¾¾å¼è·Ÿå…ƒç´ é€‰æ‹©ç±»ä¼¼, ç”¨æ–¹æ‹¬å·åŒ…è£¹. ä¸€ä¸ªå†’å·åˆ†å‰²èµ·å§‹ä»¥åŠç»“æŸç´¢å¼•. ä»»ä½•çœç•¥çš„è¾¹ç•Œéƒ½è¢«è®¤å®šä¸ºä¸€ä¸ªæå€¼: 0æ˜¯å¼€å§‹ä¸‹æ ‡çš„æå€¼, è€Œåºåˆ—çš„é•¿åº¦åˆ™æ˜¯ç»“æŸä¸‹æ ‡çš„æå€¼.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">digits</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">digits</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><p>åˆ‡ç‰‡ä¹Ÿå¯ä»¥ç”¨äºæ ‘çš„åˆ†æ”¯ä¸Š. ä¾‹å¦‚, æˆ‘ä»¬å¯èƒ½æƒ³è¦å¯¹ä¸€äº›æ ‘çš„åˆ†æ”¯æ•°è¿›è¡Œé™åˆ¶. ä¸€ä¸ªå…±åŒçš„æ ‘è½¬å‹é€šè¿‡å°†åŸå§‹æ ‘è¿›è¡Œåˆ†ç»„ç»„åˆå¹¶è°ƒæ•´åˆ†æ”¯å¾—å‡ºçš„ä¸€ä¸ªäºŒå‰æ ‘å«åšäºŒå€¼åŒ–è®¡ç®—.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">right_binarize</span><span class="p">(</span><span class="n">tree</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;Construct a right-branching binary tree.&#34;&#34;&#34;</span>
        <span class="k">if</span> <span class="n">is_leaf</span><span class="p">(</span><span class="n">tree</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">tree</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">tree</span> <span class="o">=</span> <span class="p">[</span><span class="n">tree</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tree</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">right_binarize</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">tree</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">right_binarize</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]]]]]]</span>
</code></pre></td></tr></table>
</div>
</div><p>å¯¹Pythonåºåˆ—æŠ½è±¡ä¸­çš„è¿™äº›é¢å¤–è¡Œä¸ºè¿›è¡Œæšä¸¾ç»™æˆ‘ä»¬ä¸€ä¸ªæœºä¼šæ¥åæ˜ ä¸€ä¸ªä¸€èˆ¬æœ‰ç”¨çš„æ•°æ®æŠ½è±¡çš„ç»„æˆ. æŠ½è±¡çš„ä¸°å¯Œæ€§(ä¹Ÿå°±æ˜¯è¯´å®ƒåŒ…å«çš„è¡Œä¸ºæœ‰å¤šå°‘)æ˜¯æœ‰æ„ä¹‰çš„. å¯¹ç”¨æˆ·æ¥è¯´, ä¸€ä¸ªæŠ½è±¡çš„, é¢å¤–çš„è¡Œä¸ºå¯èƒ½å¾ˆæœ‰å¸®åŠ©. å¦ä¸€æ–¹é¢, ç”¨ä¸€ä¸ªæ–°ç±»å‹æ¥æ»¡è¶³å¯¹ä¸°å¯ŒæŠ½è±¡æ€§çš„è¦æ±‚å¯èƒ½å¾ˆå…·æŒ‘æˆ˜æ€§. å¦ä¸€ä¸ªä¸°å¯ŒæŠ½è±¡æ€§çš„è´Ÿé¢åæœæ˜¯å®ƒä»¬å¯èƒ½éœ€è¦ç”¨æˆ·ç”¨æ›´é•¿çš„æ—¶é—´æ¥å­¦ä¹ .</p>
<p>åºåˆ—å…·æœ‰ä¸°å¯Œçš„æŠ½è±¡æ€§å› ä¸ºå› ä¸ºå®ƒä»¬åœ¨è®¡ç®—æœºä¸­æ˜¯å¦‚æ­¤çš„æ— æ‰€ä¸åœ¨, ä»¥è‡³äºéœ€è¦å­¦ä¹ ä¸€äº›å¤æ‚çš„è¡Œä¸ºæ˜¯åˆç†çš„, ä¸€èˆ¬æ¥è¯´, å¤§å¤šæ•°ç”¨æˆ·å®šä¹‰çš„æŠ½è±¡åº”è¯¥å°½å¯èƒ½ä¿æŒç®€å•.</p>
<p><strong>æ·±å…¥é˜…è¯»</strong>. åˆ‡ç‰‡ç¬¦å·æ”¶å½•äº†å„ç§å„æ ·çš„ç‰¹æ®Šä¾‹å­, ä¾‹å¦‚è´Ÿçš„èµ·å§‹å€¼, ç»“æŸå€¼ä»¥åŠæ­¥è¿›å¤§å°. ä¸€ä¸ªå®Œæ•´çš„æè¿°å‡ºç°åœ¨Dive Into Python 3çš„å­èŠ‚ä¸­å«åš<a href="http://getpython3.com/diveintopython3/native-datatypes.html#slicinglists">åˆ‡ç‰‡åˆ—è¡¨</a>. åœ¨è¿™èŠ‚ç« ä¸­, æˆ‘ä»¬åªä¼šä½¿ç”¨åˆ°ä¸Šé¢æåŠçš„åŸºç¡€ç‰¹æ€§.</p>
<h4 id="235-å­—ç¬¦ä¸²">2.3.5 å­—ç¬¦ä¸²</h4>
<p>æ–‡æœ¬å€¼åœ¨è®¡ç®—æœºç§‘å­¦ä¸­å¯èƒ½æ˜¯æ¯”æ•°å­—è¦æ›´ä¸€èˆ¬çš„å­˜åœ¨. ä½œä¸ºä¾‹å­, Pythonç¨‹åºçš„éƒ½æ˜¯ä»¥æ–‡æœ¬è¿›è¡Œç¼–å†™ä»¥åŠå­˜å‚¨. Pythonä¸­ä½œä¸ºæ–‡æœ¬çš„æœ¬åœ°æ•°æ®ç±»å‹è¢«å«åšå­—ç¬¦ä¸², è€Œå¯¹åº”çš„æ„é€ å™¨å°±æ˜¯<code>str</code>.</p>
<p>åœ¨Pythonä¸­å…³äºå­—ç¬¦ä¸²çš„è¡¨ç°, è¡¨è¾¾ä»¥åŠæ“ä½œæœ‰å¾ˆå¤šçš„ç»†èŠ‚. å­—ç¬¦ä¸²æ˜¯å¦ä¸€ä¸ªä¸°å¯ŒæŠ½è±¡çš„ä¾‹å­, ä¸€ä¸ªéœ€è¦ç¨‹åºå‘˜æ‰¿è¯ºç‰¢å›ºåœ°æŒæ¡çš„éƒ¨åˆ†. æ­¤éƒ¨åˆ†ä¼šç”¨ä½œå¯¹åŸºæœ¬å­—ç¬¦ä¸²è¡Œä¸ºçš„ç®€æ˜ä»‹ç».</p>
<p>å­—ç¬¦ä¸²å­—é¢è¡¨è¾¾å¼é€šè¿‡ç”¨å•å¼•å·æˆ–è€…åŒå¼•å·ä½œä¸ºè®°å·æ¥åŒ…å›´å¯ä»¥è¡¨è¾¾ä»»æ„çš„æ–‡æœ¬.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="s1">&#39;I am string!&#39;</span>
<span class="s1">&#39;I am string!&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="s2">&#34;I&#39;ve got an apostrophe&#34;</span>
<span class="s2">&#34;I&#39;ve got an apostrophe&#34;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="s1">&#39;æ‚¨å¥½&#39;</span>
<span class="s1">&#39;æ‚¨å¥½&#39;</span>
</code></pre></td></tr></table>
</div>
</div><p>æˆ‘ä»¬å·²ç»åœ¨ä»£ç ä¸­è§è¯†è¿‡å­—ç¬¦ä¸²äº†, å¦‚<code>docstring</code>, <code>print</code>å‡½æ•°çš„è°ƒç”¨ä¸­, ä»¥åŠåœ¨<code>assert</code>è¯­å¥ä¸­çš„é”™è¯¯æ¶ˆæ¯.</p>
<p>å­—ç¬¦ä¸²æ»¡è¶³æˆ‘ä»¬åœ¨æœ¬èŠ‚æœ€å¼€å§‹ä»‹ç»çš„åºåˆ—çš„ä¸¤ä¸ªåŸºæœ¬æ¡ä»¶: å®ƒä»¬å…·æœ‰é•¿åº¦ä»¥åŠæ”¯æŒå…ƒç´ é€‰æ‹©.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">city</span> <span class="o">=</span> <span class="s1">&#39;Berkeley&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">city</span><span class="p">)</span>
<span class="mi">8</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">city</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="s1">&#39;k&#39;</span>
</code></pre></td></tr></table>
</div>
</div><p>å±äºå­—ç¬¦ä¸²æœ¬èº«ä¹Ÿæ˜¯å­—ç¬¦ä¸², åªä¸è¿‡å®ƒä»¬åªæœ‰ä¸€ä¸ªå­—ç¬¦. å­—ç¬¦æ˜¯å­—æ¯è¡¨çš„ä»»æ„å•ä¸ªå­—ç¬¦, æ ‡ç‚¹ç¬¦å·, æˆ–è€…å…¶ä»–ç¬¦å·. ä¸åƒè®¸å¤šå…¶ä»–çš„ç¼–ç¨‹è¯­è¨€, Pythonæ²¡æœ‰åˆ†å¼€å­—ç¬¦ç±»å‹; ä»»ä½•æ–‡æœ¬éƒ½æ˜¯å­—ç¬¦ä¸², å•ä¸€ä¸€ä¸ªå­—ç¬¦ä»£è¡¨ä¸€ä¸ªé•¿åº¦ä¸ºä¸€çš„å­—ç¬¦ä¸².</p>
<p>å°±åƒåˆ—è¡¨, å­—ç¬¦ä¸²ä¹Ÿå¯ä»¥ç”¨åŠ æ³•æˆ–è€…ä¹˜æ³•æ¥è¿›è¡Œç»“åˆ.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="s1">&#39;Berkeley&#39;</span> <span class="o">+</span> <span class="s1">&#39;, CA&#39;</span>
<span class="s1">&#39;Berkeley, CA&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="s1">&#39;Shabu &#39;</span> <span class="o">*</span> <span class="mi">2</span>
<span class="s1">&#39;Shabu Shabu &#39;</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>æˆå‘˜</strong>. å­—ç¬¦ä¸²çš„è¡Œä¸ºå‘æ•£è‡ªPythonä¸­çš„å…¶ä»–åºåˆ—ç±»å‹. å­—ç¬¦ä¸²æŠ½è±¡ä¸ç¬¦åˆæˆ‘ä»¬æè¿°çš„åˆ—è¡¨ä»¥åŠåŒºé—´é‚£æ ·çš„å…¨åºåˆ—æŠ½è±¡, å°¤å…¶æ˜¯, å½“æˆå‘˜è¿ç®—ç¬¦<code>in</code>åº”ç”¨åˆ°å­—ç¬¦ä¸²æ—¶, å´ä¼šæœ‰è·Ÿåº”ç”¨åˆ°åºåˆ—ä¸Šå®Œå…¨ä¸åŒçš„è¡Œä¸ºè¡¨ç°. å®ƒåŒ¹é…çš„æ˜¯å­å­—ç¬¦ä¸²è€Œä¸æ˜¯å…ƒç´ .</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="s1">&#39;here&#39;</span> <span class="ow">in</span> <span class="s2">&#34;Where&#39;s Waldo?&#34;</span>
<span class="bp">True</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>å¤šè¡Œæ–‡æœ¬</strong>. å­—ç¬¦ä¸²å¹¶ä¸é™åˆ¶åªæœ‰ä¸€è¡Œ. ä¸‰é‡å¼•å·åˆ’å®šäº†å­—ç¬¦ä¸²æ–‡æœ¬å¯ä»¥è·¨è¶Šå¤šè¡Œçš„èŒƒå›´. æˆ‘ä»¬å·²ç»å¯¹docstringå¹¿æ³›ä½¿ç”¨è¿™ä¸ªä¸‰é‡å¼•å·äº†.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="s2">&#34;&#34;&#34;The Zen of Python
</span><span class="s2">claims, Readability counts.
</span><span class="s2">Read more: import this.&#34;&#34;&#34;</span>
<span class="s1">&#39;The Zen of Python</span><span class="se">\n</span><span class="s1">claims, &#34;Readability counts.&#34;</span><span class="se">\n</span><span class="s1">Read more: import this.&#39;</span>
</code></pre></td></tr></table>
</div>
</div><p>åœ¨ä¸Šé¢æ‰“å°å‡ºæ¥çš„ç»“æœä¸­, é‚£ä¸ª<code>\n</code>(å‘éŸ³æ˜¯&quot;backlash en&rdquo;)æ˜¯ä¸€ä¸ªå•å…ƒç´ , ç”¨æ¥ä»£è¡¨ä¸€ä¸ªæ–°è¡Œ. å³ä½¿å®ƒæ˜¯ç”¨ä¸¤ä¸ªå­—ç¬¦æ¥è¡¨ç¤ºçš„(backslash ä»¥åŠ n), å®ƒåœ¨é•¿åº¦ä»¥åŠå…ƒç´ é€‰æ‹©ä¸Šä¾ç„¶è¢«è®¤ä¸ºæ˜¯å•ä¸ªå­—ç¬¦.</p>
<p><strong>å­—ç¬¦ä¸²å¼ºåˆ¶è½¬æ¢</strong>. ä¸€ä¸ªå­—ç¬¦ä¸²èƒ½å¤Ÿä»Pythonçš„ä»»ä½•å¯¹è±¡ä¸­é€šè¿‡è°ƒç”¨<code>str</code>æ„é€ å™¨å‡½æ•°ä»¥ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå®ƒçš„å‚æ•°æ¥æ„å»º. è¿™ä¸ªå­—ç¬¦ä¸²çš„ç‰¹æ€§å¯¹äºä»å„ç§ç±»å‹çš„å¯¹è±¡ä¸­æ„é€ æè¿°æ€§çš„å­—ç¬¦ä¸²æ˜¯ååˆ†æœ‰ç”¨çš„.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="nb">str</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; is an element of &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">digits</span><span class="p">)</span>
<span class="s1">&#39;2 is an element of [1, 8, 2, 8]&#39;</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>æ·±å…¥é˜…è¯»</strong>. ç¼–ç æ–‡æœ¬åœ¨è®¡ç®—æœºä¸­æ˜¯ä¸€ä¸ªå¤æ‚çš„ä¸»é¢˜. åœ¨è¿™ä¸€ç« ä¸­, æˆ‘ä»¬ä¼šæŠ½è±¡å‡ºå­—ç¬¦ä¸²æ˜¯å¦‚ä½•è¡¨ç¤ºçš„ç»†èŠ‚. ç„¶è€Œ, å¯¹è®¸å¤šåº”ç”¨æ¥è¯´, å­—ç¬¦ä¸²æ˜¯å¦‚ä½•è¢«è®¡ç®—æœºç¼–ç çš„ç‰¹å®šç»†èŠ‚æ˜¯æ˜¯å¿…è¦çš„çŸ¥è¯†. åœ¨<a href="http://getpython3.com/diveintopython3/strings.html">The strings chapter of Dive Into Python3</a>ä¸­æä¾›äº†å­—ç¬¦ç¼–ç ä»¥åŠUnicodeçš„æè¿°</p>
<h4 id="236-æ ‘">2.3.6 æ ‘</h4>
<p>æˆ‘ä»¬æœ‰å°†ä¸€ä¸ªåˆ—è¡¨ä½œä¸ºå¦ä¸€ä¸ªåˆ—è¡¨å†…çš„å…ƒç´ æ¥ä½¿ç”¨çš„èƒ½åŠ›, åœ¨æˆ‘ä»¬çš„ç¼–ç¨‹è¯­è¨€ä¸­æä¾›äº†ä¸€ç§æ–°çš„ç»„åˆæ‰‹æ®µ. è¿™ç§èƒ½åŠ›å«åšæ•°æ®ç±»å‹çš„é—­åŒ…å±æ€§. ä¸€èˆ¬æ¥è¯´, å¦‚æœç»„åˆæ•°æ®çš„æ–¹æ³•ç»„åˆå‡ºæ¥çš„ç»“æœæœ¬èº«å¯ä»¥ç”¨äºè¿™ä¸ªç»„åˆæ–¹æ³•å°±è¯´è¿™ä¸ªç»„åˆæ–¹æ³•å…·æœ‰é—­åŒ…å±æ€§. é—­åŒ…æ˜¯ä»»ä½•ç»„åˆæ‰‹æ®µçš„å…³é”®æºæ³‰, å› ä¸ºå®ƒå…è®¸æˆ‘ä»¬å»åˆ›å»ºåˆ†å±‚çš„ç»“æ„&ndash;ç”±éƒ¨ä»¶ç»„æˆçš„ç»“æ„, è€Œè¿™ä¸ªéƒ¨ä»¶æœ¬èº«åˆæ˜¯ç”±å…¶ä»–éƒ¨ä»¶æ„æˆçš„ç­‰ç­‰.</p>
<p>æˆ‘ä»¬å¯ä»¥åœ¨ç¯å¢ƒå›¾ä¸­é€šè¿‡å—ä»¥åŠæŒ‡é’ˆç¬¦å·å¯¹åˆ—è¡¨è¿›è¡Œå¯è§†åŒ–, ä¸€ä¸ªåˆ—è¡¨æè¿°ä¸ºä¸€ç³»åˆ—åŒ…å«åˆ—è¡¨ä¸­å…ƒç´ çš„ç›¸é‚»å—. åŸå§‹å€¼å¦‚æ•°å­—, å­—ç¬¦ä¸², å¸ƒå°”å€¼, ä»¥åŠNoneå€¼ä¼šå‡ºç°åœ¨å…ƒç´ å—ä¸­, åˆæˆçš„æ•°æ®, å¦‚å‡½æ•°å€¼, ä»¥åŠå…¶ä»–åˆ—è¡¨, ä¼šç”¨ä¸€ä¸ªç®­å¤´æ¥è¡¨ç¤º.</p>
<iframe width="800" height="500" frameborder="0" src="http://pythontutor.com/iframe-embed.html#code=one_two%20%3D%20%5B1,%202%5D%0Anested%20%3D%20%5B%5B1,%202%5D,%20%5B%5D,%0A%20%20%20%20%20%20%20%20%20%20%5B%5B3,%20False,%20None%5D,%0A%20%20%20%20%20%20%20%20%20%20%20%5B4,%20lambda%3A%205%5D%5D%5D&codeDivHeight=400&codeDivWidth=350&cumulative=true&curInstr=4&origin=composingprograms.js&py=3&rawInputLstJSON=%5B%5D"> </iframe>
<p>å°†ä¸€ä¸ªåˆ—è¡¨åµŒå¥—åˆ°å¦ä¸€ä¸ªåˆ—è¡¨ä¸­ä¼šå¼•å…¥å¤æ‚æ€§. æ ‘æ˜¯åŸºæœ¬çš„æ•°æ®æŠ½è±¡, ç”¨äºåŠ å¼ºå¦‚ä½•å¯¹åˆ†å±‚æ•°æ®è¿›è¡Œç»“æ„åŒ–ä»¥åŠæ“ä½œçš„è§„å¾‹æ€§.</p>
<p>ä¸€æ£µæ ‘æœ‰ä¸€ä¸ªæ ¹å€¼ä»¥åŠä¸€ç³»åˆ—çš„åˆ†æ”¯. æ ‘çš„æ¯ä¸€ä¸ªåˆ†æ”¯éƒ½æ˜¯ä¸€æ£µæ ‘. ä¸€æ£µæ²¡æœ‰åˆ†æ”¯çš„æ ‘å«åšå¶å­. ä»»ä½•è¢«åŒ…å«åœ¨å¦ä¸€ä¸ªæ ‘ä¸­çš„æ ‘éƒ½å«åšæ£µæ ‘æ ‘çš„å­æ ‘(å°±åƒä¸€ä¸ªåˆ†æ”¯çš„åˆ†æ”¯). è€Œä¸€æ£µæ ‘çš„ä¸€æ£µå­æ ‘çš„æ ¹å€¼åˆè¢«ç§°ä½œè¿™æ£µæ ‘çš„ä¸€ä¸ªèŠ‚ç‚¹(æˆ–è€…èŠ‚ç‚¹å€¼).</p>
<p>æ ‘çš„æ•°æ®æŠ½è±¡ç”±ä¸€ä¸ªæ„é€ å™¨<code>tree</code>ä»¥åŠé€‰æ‹©å™¨<code>root</code>å’Œ<code>branches</code>ç»„åˆè€Œæˆ. æˆ‘ä»¬ç”±æœ€ç®€å•çš„ç‰ˆæœ¬å¼€å§‹.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">tree</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">branches</span> <span class="o">=</span> <span class="p">[]):</span>
        <span class="k">for</span> <span class="n">branch</span> <span class="ow">in</span> <span class="n">branches</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">is_tree</span><span class="p">(</span><span class="n">branch</span><span class="p">),</span> <span class="s1">&#39;branches must be trees&#39;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">root</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">[</span><span class="n">branches</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">root</span><span class="p">(</span><span class="n">tree</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tree</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">branches</span><span class="p">(</span><span class="n">tree</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tree</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</code></pre></td></tr></table>
</div>
</div><p>åªæœ‰å½“æ ‘å…·æœ‰æ ¹å€¼å¹¶ä¸”æ‰€æœ‰åˆ†æ”¯ä¹Ÿæ˜¯æ ‘æ—¶ï¼Œæ‰ä¼šå½¢å¼ä¸€æ£µè‰¯å¥½çš„æ ‘. <code>is_tree</code>å‡½æ•°æ˜¯ç”¨åœ¨<code>tree</code>æ„é€ å™¨ä¸­ç”¨æ¥æ ¡éªŒæ˜¯å¦æ‰€æœ‰çš„åˆ†æ”¯éƒ½å½¢æˆè‰¯å¥½.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">is_tree</span><span class="p">(</span><span class="n">tree</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">for</span> <span class="n">branch</span> <span class="ow">in</span> <span class="n">branches</span><span class="p">(</span><span class="n">tree</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_tree</span><span class="p">(</span><span class="n">branch</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">False</span>
        <span class="k">return</span> <span class="bp">True</span>
</code></pre></td></tr></table>
</div>
</div><p><code>is_leaf</code>å‡½æ•°ç”¨æ¥æ£€æŸ¥ä¸€æ£µæ ‘æ˜¯å¦æœ‰åˆ†æ”¯.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">is_leaf</span><span class="p">(</span><span class="n">tree</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="n">branches</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>æ ‘èƒ½å¤Ÿç”¨åµŒå¥—è¡¨è¾¾å¼æ¥æ„å»º, ä¸‹é¢çš„æ ‘<code>t</code>æœ‰æ ¹å€¼3ä»¥åŠä¸¤ä¸ªåˆ†æ”¯.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">t</span> <span class="o">=</span> <span class="n">tree</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="n">tree</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">tree</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="n">tree</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">tree</span><span class="p">(</span><span class="mi">1</span><span class="p">)])])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">t</span>
<span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]]]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">root</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="mi">3</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">branches</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="p">[[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]]]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">root</span><span class="p">(</span><span class="n">branches</span><span class="p">(</span><span class="n">t</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
<span class="mi">2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">is_leaf</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="bp">False</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">is_leaf</span><span class="p">(</span><span class="n">branches</span><span class="p">(</span><span class="n">t</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="bp">True</span>
</code></pre></td></tr></table>
</div>
</div><p>æ ‘é€’å½’å‡½æ•°å¯ä»¥ç”¨æ¥æ„é€ ä¸€æ£µæ ‘. ä¾‹å¦‚, ä¸€æ£µné˜¶æ–æ³¢é‚£å¥‘æ ‘ä»¥né˜¶æ–æ³¢é‚£å¥‘æ•°ä½œä¸ºæ ¹å€¼, å¯¹äº<code>n &gt; 1</code>æ—¶, ä¸¤ä¸ªåˆ†æ”¯ä¹Ÿæ˜¯æ–æ³¢é‚£å¥‘æ ‘. ä¸€ä¸ªæ–æ³¢é‚£å¥‘æ ‘æ¼”ç¤ºäº†æ–æ³¢é‚£å¥‘æ•°çš„æ ‘é€’å½’è®¡ç®—.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">fib_tree</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">tree</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">fib_tree</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">),</span> <span class="n">fib_tree</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">fib_n</span> <span class="o">=</span> <span class="n">root</span><span class="p">(</span><span class="n">left</span><span class="p">)</span> <span class="o">+</span> <span class="n">root</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">tree</span><span class="p">(</span><span class="n">fib_n</span><span class="p">,</span> <span class="p">[</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">])</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">fib_tree</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]]],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]]]]]</span>
</code></pre></td></tr></table>
</div>
</div><p>æ ‘é€’å½’å‡½æ•°ä¹Ÿç”¨äºå¤„ç†æ ‘. ä¾‹å¦‚, <code>count_leaves</code>å‡½æ•°ç”¨äºç»Ÿè®¡æ ‘çš„æ ‘å¶çš„é‡.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">count_leaves</span><span class="p">(</span><span class="n">tree</span><span class="p">);</span>
        <span class="k">if</span> <span class="n">is_leaf</span><span class="p">(</span><span class="n">tree</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">branch_counts</span> <span class="o">=</span> <span class="p">[</span><span class="n">count_leaves</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">branches</span><span class="p">(</span><span class="n">tree</span><span class="p">)]</span>
            <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">branch_counts</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">count_leaves</span><span class="p">(</span><span class="n">fib_tree</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="mi">8</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>åˆ†åŒºæ ‘</strong>. æ ‘å¯ä»¥ç”¨æ¥è¡¨ç¤ºæ•´æ•°çš„åˆ’åˆ†å½¢å¼. ä¸€ä¸ªç”¨æœ€å¤§ä¸ºmçš„æ•°åˆ’åˆ†æ•°næ¥ç»„æˆçš„åˆ†åŒºæ ‘æ˜¯ä¸€æ£µäºŒå‰æ ‘(ä¸¤ä¸ªåˆ†æ”¯), ä»£è¡¨äº†è®¡ç®—æ—¶å€™çš„ä¸¤ä¸ªé€‰æ‹©. åœ¨éå¶å­åˆ†åŒºæ ‘ä¸­:</p>
<ul>
<li>å·¦è¾¹çš„(ä¸‹æ ‡ä¸º0)åˆ†æ”¯åŒ…å«äº†è‡³å°‘ä½¿ç”¨ä¸€ä¸ªmæ¥åˆ’åˆ†nçš„æ‰€æœ‰æ–¹å¼</li>
<li>å³è¾¹çš„(ä¸‹æ ‡ä¸º1)åˆ†æ”¯åŒ…å«äº†ç”¨<code>m-1</code>éƒ¨åˆ†æ¥åˆ’åˆ†çš„åˆ†åŒºæ ‘, ä»¥åŠ</li>
<li>æ ¹çš„å€¼æ˜¯m</li>
</ul>
<p>åˆ†åŒºæ ‘å¶å­çš„å€¼è¡¨ç¤ºäº†ä»æ ‘çš„æ ¹åˆ°å¶çš„è·¯å¾„æ˜¯å¦ä»£è¡¨ä¸€ä¸ªnçš„æˆåŠŸåˆ†åŒº.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">partition_tree</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">tree</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">tree</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">left</span> <span class="o">==</span> <span class="n">partition_tree</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">m</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
            <span class="n">right</span> <span class="o">==</span> <span class="n">partition_tree</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">tree</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="p">[</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">])</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">partition_tree</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="bp">True</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="bp">True</span><span class="p">],</span> <span class="p">[</span><span class="bp">False</span><span class="p">]],</span> <span class="p">[</span><span class="bp">False</span><span class="p">]]]</span>
</code></pre></td></tr></table>
</div>
</div><p>ä»ä¸€ä¸ªåˆ†åŒºæ ‘æ‰“å°å‡ºåˆ†åŒºæ˜¯å¦å¤–ä¸€ä¸ªéå†æ ‘çš„æ ‘é€’å½’è¿‡ç¨‹, å°†æ¯ä¸€ä¸ªåˆ†åŒºæ„é€ æˆä¸€ä¸ªåˆ—è¡¨. ä¸ç®¡æ˜¯å¦èƒ½å¤Ÿè§¦åŠTrueå¶å­, åˆ†åŒºæ ‘éƒ½ä¼šæ‰“å°å‡ºæ¥.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">print_parts</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">partition</span> <span class="o">=</span> <span class="p">[]):</span>
        <span class="k">if</span> <span class="n">is_leaf</span><span class="p">(</span><span class="n">tree</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">root</span><span class="p">(</span><span class="n">tree</span><span class="p">):</span>
                <span class="k">print</span><span class="p">(</span><span class="s1">&#39; +&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">partition</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">branches</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
            <span class="n">m</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">root</span><span class="p">(</span><span class="n">tree</span><span class="p">))</span>
            <span class="n">print_parts</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">partition</span> <span class="o">+</span> <span class="p">[</span><span class="n">m</span><span class="p">])</span>
            <span class="n">print_parts</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">partition</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">print_parts</span><span class="p">(</span><span class="n">partition_tree</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span>
<span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span>
<span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span>
<span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
<span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span>
<span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span>
<span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span>
<span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span>
<span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="237-é“¾æ¥åˆ—è¡¨">2.3.7 é“¾æ¥åˆ—è¡¨</h4>
<p>ç›®å‰ä¸ºæ­¢, æˆ‘ä»¬åªç”¨äº†åŸç”Ÿçš„æ•°æ®ç±»å‹æ¥è¡¨ç¤ºåºåˆ—. ç„¶è€Œ, æˆ‘ä»¬ä¹Ÿå¯ä»¥å¼€å‘ä¸€ä¸ªä¸æ˜¯PythonåŸç”Ÿçš„åºåˆ—è¡¨ç¤º. ä¸€ä¸ªåºåˆ—çš„å¸¸è§è¡¨ç¤ºæ³•æ˜¯ç”±åµŒå¥—çš„æˆå¯¹æ•°æ®æ¥æ„æˆ, å«åšåˆ—è¡¨. ä¸‹é¢çš„ç¯å¢ƒå›¾ä¾‹è¡¨ç¤ºå‡ºä¸€ä¸ªç”±å››ä¸ªæŒ‰é¡ºåºåŒ…å«1, 2, 3å’Œ4çš„å…ƒç´ ç»„æˆçš„é“¾è¡¨.</p>
<iframe width="800" height="500" frameborder="0" src="http://pythontutor.com/iframe-embed.html#code=four%20%3D%20%5B1,%20%5B2,%20%5B3,%20%5B4,%20'empty'%5D%5D%5D%5D&codeDivHeight=400&codeDivWidth=350&cumulative=true&curInstr=0&origin=composingprograms.js&py=3&rawInputLstJSON=%5B%5D"> </iframe>
<p>ä¸€ä¸ªé“¾è¡¨æ˜¯ä¸€ä¸ªæˆå¯¹çš„æ•°æ®, åŒ…å«äº†åºåˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´ (åœ¨ä¾‹å­ä¸­æ˜¯1)ä»¥åŠå‰©ä¸‹çš„å…ƒç´ çš„åºåˆ—(åœ¨ä¾‹å­ä¸­æ˜¯2, 3, 4). ç¬¬äºŒä¸ªå…ƒç´ ä¹Ÿæ˜¯ä¸€ä¸ªé“¾è¡¨. å‰©ä¸‹çš„æœ€é‡Œé¢çš„é“¾è¡¨åªåŒ…å«4, å…¶ä½™éƒ¨åˆ†æ˜¯<code>empty</code>, ä¸€ä¸ªç”¨äºä»£è¡¨ç©ºé“¾è¡¨çš„å€¼.</p>
<p>é“¾è¡¨å…·æœ‰é€’å½’ç»“æ„: é“¾è¡¨çš„å…¶ä½™éƒ¨åˆ†æ˜¯ä¸€ä¸ªé“¾è¡¨æˆ–è€…<code>empty</code>å€¼. æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªæŠ½è±¡æ•°æ®è¡¨ç¤ºæ¥è¿›è¡ŒéªŒè¯, æ„é€ ä»¥åŠé€‰æ‹©é“¾è¡¨çš„æŸéƒ¨åˆ†.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">empty</span> <span class="o">=</span> <span class="s1">&#39;empty&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">is_link</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;s is a linked list if it is empty or a (first, rest) pair.&#34;&#34;&#34;</span>
        <span class="k">return</span> <span class="n">s</span> <span class="o">==</span> <span class="n">empty</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">is_link</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">link</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">rest</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;Construct a linked list from its first element and the rest.&#34;&#34;&#34;</span>
        <span class="k">assert</span> <span class="n">is_link</span><span class="p">(</span><span class="n">rest</span><span class="p">),</span> <span class="s1">&#39;rest must be a linked list.&#39;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">first</span><span class="p">,</span> <span class="n">rest</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">first</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;Return the first element of a linked list s.&#34;&#34;&#34;</span>
        <span class="k">assert</span> <span class="n">is_link</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="s1">&#39;first only applies to linked lists.&#39;</span>
        <span class="k">assert</span> <span class="n">s</span> <span class="o">!=</span> <span class="n">empty</span><span class="p">,</span> <span class="s1">&#39;empty linked list has no first element.&#39;</span>
        <span class="k">return</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">rest</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;Return the rest of the elements of a linked list s.&#34;&#34;&#34;</span>
        <span class="k">assert</span> <span class="n">is_link</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="s1">&#39;rest only applies to linked lists.&#39;</span>
        <span class="k">assert</span> <span class="n">s</span> <span class="o">!=</span> <span class="n">empty</span><span class="o">.</span> <span class="s1">&#39;empty linked list has no rest.&#39;</span>
        <span class="k">return</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><p>ä¸Šé¢, <code>link</code>æ˜¯ä¸€ä¸ªæ„é€ å™¨, <code>first</code>ä»¥åŠ<code>rest</code>æ˜¯ç”¨äºä»£è¡¨å·²ç»é“¾æ¥çš„åˆ—è¡¨æŠ½è±¡æ•°æ®çš„é€‰æ‹©å™¨. é“¾è¡¨çš„è¡Œä¸ºæ¡ä»¶æ˜¯åƒæ•°æ®å¯¹, å®ƒçš„æ„é€ å™¨ä»¥åŠé€‰æ‹©å™¨æ˜¯å…¶åå‡½æ•°.</p>
<ul>
<li>å¦‚æœä¸€ä¸ªé“¾è¡¨sæ˜¯ç”±ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯fä»¥åŠä¸€ä¸ªå·²ç»æ˜¯é“¾è¡¨çš„rç»„æˆ, é‚£ä¹ˆ<code>first(s)</code>è¿”å›çš„æ˜¯f, <code>rest(s)</code>è¿”å›çš„æ˜¯r.</li>
</ul>
<p>æˆ‘ä»¬å¯ä»¥ç”¨æ„é€ å™¨ä»¥åŠé€‰æ‹©å™¨æ¥æ“çºµé“¾è¡¨.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">four</span> <span class="o">=</span> <span class="n">link</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">link</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">link</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">link</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">empty</span><span class="p">))))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">first</span><span class="p">(</span><span class="n">four</span><span class="p">)</span>
<span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">rest</span><span class="p">(</span><span class="n">four</span><span class="p">)</span>
<span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;empty&#39;</span><span class="p">]]]</span>
</code></pre></td></tr></table>
</div>
</div><p>æˆ‘ä»¬å®ç°çš„è¿™ç§ç±»å‹çš„æŠ½è±¡æ•°æ®æ˜¯æ•°æ®å¯¹, ä¸€ä¸ªå…·æœ‰ä¸¤ä¸ªå…ƒç´ çš„åˆ—è¡¨å€¼. å€¼å¾—æ³¨æ„çš„æ˜¯, æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡å‡½æ•°æ¥å®ç°å¯¹æ•°æ®, åŒæ—¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨ä»»ä½•å¯¹æ•°æ®æ¥å®ç°é“¾è¡¨, å› æ­¤æˆ‘ä»¬å¯ä»¥åªç”¨å‡½æ•°æ¥å®ç°é“¾è¡¨.</p>
<p>é“¾è¡¨å¯ä»¥æŒ‰é¡ºåºå­˜å‚¨ä¸€ç³»åˆ—çš„æ•°æ®å€¼, ä½†æ˜¯æˆ‘ä»¬è¿˜æ²¡æœ‰å±•ç¤ºå®ƒæ»¡è¶³åºåˆ—æŠ½è±¡çš„é‚£ä¸€éƒ¨åˆ†. ä½¿ç”¨æˆ‘ä»¬å®šä¹‰çš„æŠ½è±¡æ•°æ®è¡¨ç¤º, æˆ‘ä»¬å¯ä»¥å®ç°åºåˆ—çš„ä¸¤ä¸ªç‰¹å¾è¡Œä¸º: é•¿åº¦ä»¥åŠå…ƒç´ é€‰æ‹©.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">len_link</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;Return the length of linked list s&#34;&#34;&#34;</span>
        <span class="n">length</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">s</span> <span class="o">!=</span> <span class="n">empty</span>
            <span class="n">s</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="n">rest</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">length</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">length</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">getitem_link</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;Return the element at index i of linked list s.&#34;&#34;&#34;</span>
        <span class="k">while</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">s</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">rest</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">first</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>ç°åœ¨, æˆ‘ä»¬å¯ä»¥ç”¨è¿™äº›å‡½æ•°æ¥æŠŠé“¾è¡¨å½“åšåºåˆ—æ¥æ“ä½œ. (æˆ‘ä»¬ç°åœ¨è¿˜ä¸èƒ½ç”¨å…§å»ºçš„lenå‡½æ•°, å…ƒç´ é€‰æ‹©è¯­æ³•, æˆ–è€…forè¯­å¥, ä½†æ˜¯å¾ˆå¿«å°±å¯ä»¥äº†)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">len_link</span><span class="p">(</span><span class="n">four</span><span class="p">)</span>
<span class="mi">4</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">getitem_link</span><span class="p">(</span><span class="n">four</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="mi">2</span>
</code></pre></td></tr></table>
</div>
</div><p>ä¸‹é¢çš„ä¸€ç³»åˆ—ç¯å¢ƒå›¾ä¾‹æ¼”ç¤ºäº†<code>getitem_link</code>çš„æ‰¾å¯»é“¾è¡¨ä¸­ä¸‹æ ‡ä¸º1çš„ç¬¬äºŒä¸ªå…ƒç´ çš„è¿­ä»£è¿‡ç¨‹. ä¸‹é¢, æˆ‘ä»¬å·²ç»ç”¨PythonåŸè¯­æ¥ç®€åŒ–å›¾è¡¨æ¥å®šä¹‰é“¾è¡¨four. è¿™ç§å®ç°é€‰æ‹©è¿åäº†æŠ½è±¡è¾¹ç•Œ, ä½†æ˜¯å…è®¸æˆ‘ä»¬æ›´å®¹æ˜“æ£€è§†è¿™ä¸ªä¾‹å­çš„è®¡ç®—è¿‡ç¨‹</p>
<iframe width="800" height="500" frameborder="0" src="http://pythontutor.com/iframe-embed.html#code=def%20first(s%29%3A%0A%20%20%20%20return%20s%5B0%5D%0Adef%20rest(s%29%3A%0A%20%20%20%20return%20s%5B1%5D%0A%0Adef%20getitem_link(s,%20i%29%3A%0A%20%20%20%20while%20i%20%3E%200%3A%0A%20%20%20%20%20%20%20%20s,%20i%20%3D%20rest(s%29,%20i%20-%201%0A%20%20%20%20return%20first(s%29%0A%0Afour%20%3D%20%5B1,%20%5B2,%20%5B3,%20%5B4,%20'empty'%5D%5D%5D%5D%0Agetitem_link(four,%201%29&codeDivHeight=400&codeDivWidth=350&cumulative=true&curInstr=0&origin=composingprograms.js&py=3&rawInputLstJSON=%5B%5D"> </iframe>
<p>é¦–å…ˆ, å‡½æ•°<code>getitem_link</code>è¢«è°ƒç”¨, åˆ›å»ºäº†ä¸€ä¸ªæœ¬åœ°å¸§:</p>
<iframe width="800" height="500" frameborder="0" src="http://pythontutor.com/iframe-embed.html#code=def%20first(s%29%3A%0A%20%20%20%20return%20s%5B0%5D%0Adef%20rest(s%29%3A%0A%20%20%20%20return%20s%5B1%5D%0A%0Adef%20getitem_link(s,%20i%29%3A%0A%20%20%20%20while%20i%20%3E%200%3A%0A%20%20%20%20%20%20%20%20s,%20i%20%3D%20rest(s%29,%20i%20-%201%0A%20%20%20%20return%20first(s%29%0A%0Afour%20%3D%20%5B1,%20%5B2,%20%5B3,%20%5B4,%20'empty'%5D%5D%5D%5D%0Agetitem_link(four,%201%29&codeDivHeight=400&codeDivWidth=350&cumulative=true&curInstr=0&origin=composingprograms.js&py=3&rawInputLstJSON=%5B%5D"> </iframe>
<p>whileå¤´éƒ¨çš„è¡¨è¾¾å¼è®¡ç®—å¾—åˆ°true, ç„¶åwhileçš„å†…éƒ¨ç­‰å¼ä¼šè¢«æ‰§è¡Œ, å‡½æ•°<code>rest</code>è¿”å›ä»¥2å¼€å¤´çš„å­åˆ—è¡¨.</p>
<iframe width="800" height="500" frameborder="0" src="http://pythontutor.com/iframe-embed.html#code=def%20first(s%29%3A%0A%20%20%20%20return%20s%5B0%5D%0Adef%20rest(s%29%3A%0A%20%20%20%20return%20s%5B1%5D%0A%0Adef%20getitem_link(s,%20i%29%3A%0A%20%20%20%20while%20i%20%3E%200%3A%0A%20%20%20%20%20%20%20%20s,%20i%20%3D%20rest(s%29,%20i%20-%201%0A%20%20%20%20return%20first(s%29%0A%0Afour%20%3D%20%5B1,%20%5B2,%20%5B3,%20%5B4,%20'empty'%5D%5D%5D%5D%0Agetitem_link(four,%201%29&codeDivHeight=400&codeDivWidth=350&cumulative=true&curInstr=0&origin=composingprograms.js&py=3&rawInputLstJSON=%5B%5D"> </iframe>
<p>æ¥ä¸‹æ¥, å±€éƒ¨åç§°sä¼šæ›´æ–°æˆä»¥åŸåˆ—è¡¨ç¬¬äºŒä¸ªå…ƒç´ ä¸ºå¼€å¤´çš„å­åˆ—è¡¨çš„å¼•ç”¨. è¿ç®—whileå¤´éƒ¨è¡¨è¾¾å¼ç°åœ¨ä¼šè¿”å›falseå€¼, ç„¶åPythonè¿ç®—åœ¨è¿”å›è¯­å¥ä¹‹åçš„<code>getitem_link</code>çš„æœ€åä¸€è¡Œè¡¨è¾¾å¼.</p>
<iframe width="800" height="500" frameborder="0" src="http://pythontutor.com/iframe-embed.html#code=def%20first(s%29%3A%0A%20%20%20%20return%20s%5B0%5D%0Adef%20rest(s%29%3A%0A%20%20%20%20return%20s%5B1%5D%0A%0Adef%20getitem_link(s,%20i%29%3A%0A%20%20%20%20while%20i%20%3E%200%3A%0A%20%20%20%20%20%20%20%20s,%20i%20%3D%20rest(s%29,%20i%20-%201%0A%20%20%20%20return%20first(s%29%0A%0Afour%20%3D%20%5B1,%20%5B2,%20%5B3,%20%5B4,%20'empty'%5D%5D%5D%5D%0Agetitem_link(four,%201%29&codeDivHeight=400&codeDivWidth=350&cumulative=true&curInstr=0&origin=composingprograms.js&py=3&rawInputLstJSON=%5B%5D"> </iframe>
<p>æœ€åçš„ç¯å¢ƒå›¾ä¾‹æ˜¾ç¤ºè°ƒç”¨firstçš„æœ¬åœ°å¸§, ä¹Ÿå°±æ˜¯å«æœ‰ç»‘å®šåˆ°åŒä¸€ä¸ªå­åˆ—è¡¨çš„åç§°s. firstå‡½æ•°é€‰æ‹©å€¼2ç„¶åè¿”å›, ä¹Ÿä¼šä»<code>getitem_link</code>ä¸­è¿”å›.</p>
<p>è¿™ä¸ªä¾‹å­æ¼”ç¤ºäº†ä¸€ä¸ªåˆ—è¡¨è®¡è¿ç®—çš„ä¸€èˆ¬æ¨¡å¼, è¿­ä»£æ“ä½œä¸­çš„æ¯ä¸€æ­¥éƒ½ä¼šä¸æ–­å¾—åˆ°åŸåˆ—è¡¨ä¸­è¾ƒçŸ­çš„åç¼€. è¿™æŸ¥æ‰¾åˆ—è¡¨é•¿åº¦ä»¥åŠå…ƒç´ çš„å¢é‡å¤„ç†è¿‡ç¨‹éœ€è¦ä¸€äº›æ—¶é—´æ¥è¿ç®—. Pythonçš„å…§å»ºåºåˆ—ç±»å‹æ˜¯ç”¨ä¸åŒå½¢å¼å®ç°çš„, è¿™è®©è®¡ç®—åºåˆ—é•¿åº¦æˆ–è€…æ£€ç´¢å®ƒçš„å…ƒç´ éƒ½ä¸ä¼šå¯¼è‡´å¾ˆå¤§çš„è®¡ç®—æˆæœ¬. è¿™ç§è¡¨ç°çš„ç»†èŠ‚å·²ç»è¶…å‡ºæœ¬æ–‡çš„èŒƒå›´.</p>
<p><strong>é€’å½’æ“ä½œ</strong>. <code>len_link</code>ä»¥åŠ<code>getitem_link</code>å‡½æ•°éƒ½æ˜¯è¿­ä»£çš„. å®ƒä»¬ä¸æ–­å‰¥ç¦»æ¯ä¸€å±‚çš„åµŒå¥—æ•°æ®å¯¹ç›´åˆ°åˆ°è¾¾åˆ°è¾¾åˆ—è¡¨çš„æœ€å(åœ¨<code>len_link</code>å‡½æ•°ä¸­)æˆ–è€…åˆ°è¾¾æœŸæœ›çš„å…ƒç´ (åœ¨<code>getitem_link</code>ä¸­).æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨é€’å½’æ¥å®ç°é•¿åº¦ä»¥åŠå…ƒç´ é€‰æ‹©.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">len_link_recursive</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;Return the length of a linked list s.&#34;&#34;&#34;</span>
        <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="n">empty</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">len_link_recursive</span><span class="p">(</span><span class="n">rest</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">getitem_link_recursive</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;Return the element at index i of linked list s.&#34;&#34;&#34;</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">first</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">getitem_link_recursive</span><span class="p">(</span><span class="n">rest</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">len_link_recursive</span><span class="p">(</span><span class="n">four</span><span class="p">)</span>
<span class="mi">4</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">getitem_link_recursive</span><span class="p">(</span><span class="n">four</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="mi">2</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿™äº›é€’å½’å®ç°è·Ÿéšæ•°æ®å¯¹ç»„æˆçš„é“¾ç›´åˆ°åˆ°è¾¾åˆ—è¡¨çš„æœ€å(åœ¨<code>len_link_recursive</code>ä¸­)æˆ–è€…åˆ°è¾¾æœŸæœ›çš„å…ƒç´ (åœ¨<code>getitem_link_recursive</code>ä¸­).</p>
<p>é€’å½’å¯¹äºè½¬æ¢ä»¥åŠåˆå¹¶é“¾è¡¨ä¹Ÿæ˜¯æœ‰ç”¨çš„.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">extend_link</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;Return a list with the elements of s followed by those of t.&#34;&#34;&#34;</span>
        <span class="k">assert</span> <span class="n">is_link</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="ow">and</span> <span class="n">is_link</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="n">empty</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">t</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">link</span><span class="p">(</span><span class="n">first</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">extend_link</span><span class="p">(</span><span class="n">rest</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">t</span><span class="p">))</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">extend_link</span><span class="p">(</span><span class="n">four</span><span class="p">,</span> <span class="n">four</span><span class="p">)</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;empty&#39;</span><span class="p">]]]]]]]]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">apply_to_all_link</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;Apply f to each element of s.&#34;&#34;&#34;</span>
        <span class="k">assert</span> <span class="n">is_link</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="n">empty</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">s</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">link</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">first</span><span class="p">(</span><span class="n">s</span><span class="p">)),</span> <span class="n">apply_to_all_link</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">rest</span><span class="p">(</span><span class="n">s</span><span class="p">)))</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">apply_to_all_link</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="n">four</span><span class="p">)</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="s1">&#39;empty&#39;</span><span class="p">]]]]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">keep_if_link</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;Return a list with elements of s for which f(e) is true.&#34;&#34;&#34;</span>
        <span class="k">assert</span> <span class="n">is_link</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="n">empty</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">s</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">kept</span> <span class="o">=</span> <span class="n">keep_if_link</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">rest</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">f</span><span class="p">(</span><span class="n">first</span><span class="p">(</span><span class="n">s</span><span class="p">)):</span>
                <span class="k">return</span> <span class="n">link</span><span class="p">(</span><span class="n">first</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">kept</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">kept</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">keep_if_link</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">%</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">four</span><span class="p">)</span>
<span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;empty&#39;</span><span class="p">]]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">join_link</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">separator</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;Return a string of all elements in s separated by separator.&#34;&#34;&#34;</span>
        <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="n">empty</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&#34;&#34;</span>
        <span class="k">elif</span> <span class="n">rest</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="n">empty</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">first</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">first</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="o">+</span> <span class="n">separator</span> <span class="o">+</span> <span class="n">join_link</span><span class="p">(</span><span class="n">rest</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">separator</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">join_link</span><span class="p">(</span><span class="n">four</span><span class="p">,</span> <span class="s2">&#34;, &#34;</span><span class="p">)</span>
<span class="s1">&#39;1, 2, 3, 4&#39;</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>é€’å½’æ„å»º</strong>. é“¾è¡¨åœ¨æˆ‘ä»¬å¢é‡åœ°æ„é€ åºåˆ—çš„æ—¶å€™å°¤å…¶æœ‰ç”¨, è¿™ç§æƒ…å†µç»å¸¸åœ¨é€’å½’è®¡ç®—ä¸­å‡ºç°.</p>
<p>ç¬¬ä¸€ç« ä¸­çš„<code>count_partitions</code>å‡½æ•°é€šè¿‡æ ‘é€’å½’è¿‡ç¨‹æ¥è®¡ç®—æ•´æ•°nç”¨æœ€å¤§ä¸ºmçš„æ•°æ¥è¿›è¡Œåˆ†å‰²çš„æ€»æ•°. é€šè¿‡åºåˆ—æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡æ˜ç¡®åœ°ä½¿ç”¨ç›¸ä¼¼çš„è¿‡ç¨‹æ¥æšä¸¾è¿™äº›åˆ‡åˆ†.</p>
<p>è·Ÿæˆ‘ä»¬è®¡ç®—æ—¶ä¸€æ ·, æˆ‘ä»¬ç”¨è·Ÿéšé—®é¢˜çš„ç›¸åŒé€’å½’åˆ†æ: ç”¨æœ€å¤§ä¸ºmçš„æ•´æ•°æ¥åˆ’åˆ†næ¶‰åŠåˆ°</p>
<ol>
<li>ä½¿ç”¨æœ€å¤§ä¸ºmçš„æ•´æ•°æ¥åˆ’åˆ†n-m, æˆ–è€…</li>
<li>ä½¿ç”¨æœ€å¤§ä¸ºm-1çš„æ•´æ•°æ¥åˆ’åˆ†n</li>
</ol>
<p>å¯¹äºåŸºæœ¬æƒ…å†µ, æˆ‘ä»¬å‘ç°ç”¨ä¸€ä¸ªè´Ÿæ•´æ•°æˆ–è€…ç”¨å°äº1çš„éƒ¨åˆ†æ¥åˆ’åˆ†0æ˜¯ä¸å¯èƒ½çš„, å› æ­¤0çš„åˆ’åˆ†æ•°ä¸ºç©º.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">partitions</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;Return a linked list of partitions of n using parts of up to m.
</span><span class="s2">        Each partition is represented as a linked list.
</span><span class="s2">        &#34;&#34;&#34;</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">link</span><span class="p">(</span><span class="n">empty</span><span class="p">,</span> <span class="n">empty</span><span class="p">)</span> <span class="c1"># A list containing the empty partition</span>
        <span class="k">elif</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">empty</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">using_m</span> <span class="o">=</span> <span class="n">partitions</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">m</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
            <span class="n">with_m</span> <span class="o">=</span> <span class="n">apply_to_all_link</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">link</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">s</span><span class="p">),</span> <span class="n">using_m</span><span class="p">)</span>
            <span class="n">without_m</span> <span class="o">=</span> <span class="n">partitions</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">extend_link</span><span class="p">(</span><span class="n">with_m</span><span class="p">,</span> <span class="n">without_m</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>åœ¨é€’å½’æƒ…å†µä¸‹, æˆ‘ä»¬æ„å»ºä¸¤ä¸ªåˆ†åŒºçš„å­åˆ—è¡¨. ç¬¬ä¸€ä¸ªç”¨m, å› æ­¤æˆ‘ä»¬åœ¨ç»“æœ<code>using_m</code>ä¸­çš„æ¯ä¸ªå…ƒç´ å‰é¢åŠ ä¸Šmæ¥æ„å»º<code>with_m</code>.</p>
<p>partitionsçš„ç»“æœæ˜¯é«˜åº¦åµŒå¥—çš„: ä¸€ä¸ªé“¾æ¥åˆ—è¡¨çš„é“¾æ¥åˆ—è¡¨, å¹¶ä¸”æ¯ä¸ªé“¾æ¥åˆ—è¡¨è¢«è¡¨ç¤ºä¸ºä½œä¸ºåˆ—è¡¨å€¼çš„åµŒå¥—å¯¹. åœ¨<code>join_link</code>å‡½æ•°ä¸­ç”¨æ°å½“çš„åˆ†éš”ç¬¦, æˆ‘ä»¬å¯ä»¥ç”¨äººç±»å¯é˜…è¯»çš„æ–¹å¼æ¥å±•ç¤ºå‡ºåˆ†åŒº.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">print_partitions</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
        <span class="n">lists</span> <span class="o">=</span> <span class="n">partitions</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">apply_to_all_link</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">join_link</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s2">&#34; + &#34;</span><span class="p">),</span> <span class="n">lists</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">join_link</span><span class="p">(</span><span class="n">strings</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">))</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">print_partitions</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span>
<span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span>
<span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span>
<span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
<span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span>
<span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span>
<span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span>
<span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span>
<span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="24-å¯å˜æ•°æ®">2.4 å¯å˜æ•°æ®</h3>
<p>æˆ‘ä»¬å·²ç»è§è¯†è¿‡æŠ½è±¡å¯¹äºå¸®åŠ©æˆ‘ä»¬åº”å¯¹å¤§å‹ç³»ç»Ÿçš„å¤æ‚æ€§ä¸Šçš„é‡è¦æ€§äº†. æœ‰æ•ˆçš„ç¼–ç¨‹ä¾èµ–äºæœ‰ç»„ç»‡çš„èƒ½å¤ŸæŒ‡å¯¼æˆ‘ä»¬åœ¨åˆ¶å®šç¨‹åºçš„æ•´ä½“è®¾è®¡çš„è§„åˆ™. å°¤å…¶æ˜¯, æˆ‘ä»¬éœ€è¦å¾ˆå¤šç­–ç•¥æ¥å¸®åŠ©æˆ‘ä»¬æ„é€ æ¨¡å—åŒ–çš„å¤§å‹ç³»ç»Ÿ, è¿™æ„å‘³ç€å®ƒä»¬ä¼šè‡ªç„¶åˆ†è£‚æˆå„ä¸ªç›¸å…³çš„éƒ¨åˆ†ä¸”èƒ½å¤Ÿåˆ†å¤´å¼€å‘ä»¥åŠç»´æŠ¤.</p>
<p>æœ‰ä¸€ä¸ªå¼ºå¤§çš„åˆ›å»ºæ¨¡å—åŒ–ç¨‹åºçš„æŠ€æœ¯, é‚£å°±æ˜¯åˆå¹¶å¯èƒ½éšæ—¶é—´æ”¹å˜çŠ¶æ€çš„æ•°æ®, é€šè¿‡è¿™ç§æ–¹å¼, å•ä¸ªæ•°æ®å¯¹è±¡å¯ä»¥è¡¨ç¤ºç‹¬ç«‹äºç¨‹åºçš„å…¶ä½™éƒ¨åˆ†æ¼”è¿›çš„ä¸œè¥¿. æ”¹å˜å¯¹è±¡çš„è¡Œä¸ºå¯èƒ½ä¼šå—åˆ°å…¶å†å²çš„å½±å“, å°±åƒä¸€ä¸ªçœŸå®ä¸–ç•Œçš„å®ä½“ä¸€æ ·. ä¸ºæ•°æ®æ·»åŠ çŠ¶æ€æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹èŒƒå¼çš„æ ¸å¿ƒè¦ç´ </p>
<h4 id="241-å¯¹è±¡éšå–»">2.4.1 å¯¹è±¡éšå–»</h4>
<p>åœ¨æœ¬æ–‡å¼€å¤´, æˆ‘ä»¬è¦åŒºåˆ†å‡½æ•°è·Ÿæ•°æ®: å‡½æ•°ç”¨äºæ‰§è¡Œæ“ä½œ, è€Œæ•°æ®åˆ™æ˜¯åœ¨å…¶ä¸Šè¢«æ“ä½œ. å½“æˆ‘ä»¬åœ¨æˆ‘ä»¬çš„æ•°æ®ä¸­åŒ…å«å‡½æ•°çš„å€¼çš„æ—¶å€™, æˆ‘ä»¬è®¤è¯†åˆ°æ•°æ®ä¹Ÿå¯ä»¥å…·æœ‰è¡Œä¸º. å‡½æ•°å¯ä»¥ä½œä¸ºæ•°æ®æ¥æ“ä½œ, ä¹Ÿå¯ä»¥è¢«è°ƒç”¨æ¥æ‰§è¡Œè®¡ç®—.</p>
<p><em>å¯¹è±¡</em>å°†æ•°æ®å€¼ä¸è¡Œä¸ºè¿›è¡Œç»„åˆ. å¯¹è±¡ä»£è¡¨ä¿¡æ¯, åŒæ—¶ä¹Ÿè¡¨ç°å¾—åƒå®ƒä»¬æ‰€ä»£è¡¨çš„äº‹ç‰©. ä¸€ä¸ªå¯¹è±¡è·Ÿå¦ä¸€ä¸ªå¯¹è±¡äº’åŠ¨çš„é€»è¾‘æ˜¯è·Ÿç¼–ç è¿™ä¸ªå¯¹è±¡çš„å€¼æ†ç»‘åœ¨ä¸€èµ·çš„. å½“ä¸€ä¸ªå¯¹è±¡éœ€è¦è¢«æ‰“å°å‡ºæ¥æ—¶, å®ƒçŸ¥é“å¦‚ä½•ç”¨æ–‡æœ¬æ¥è¡¨ç¤ºè‡ªèº«, å¦‚æœä¸€ä¸ªå¯¹è±¡æ˜¯ç”±éƒ¨åˆ†ç»„åˆè€Œæˆçš„, é‚£ä¹ˆå®ƒçŸ¥é“å¦‚ä½•æŒ‰éœ€æ˜¾ç¤ºè¿™äº›éƒ¨åˆ†. å¯¹è±¡(åŒ…å«çš„)å…¨éƒ½æ˜¯ä¿¡æ¯ä»¥åŠ(å¤„ç†)è¿‡ç¨‹, (å®ƒä»¬)æ†ç»‘åœ¨ä¸€èµ·æ¥è¡¨ç¤ºå¤æ‚äº‹ç‰©çš„æ€§è´¨, ç›¸äº’ä½œç”¨å’Œè¡Œä¸º.</p>
<p>å¯¹è±¡çš„è¡Œä¸ºåœ¨Pythonä¸­æ˜¯é€šè¿‡ä¸“é—¨çš„å¯¹è±¡è¯­æ³•ä»¥åŠç›¸å…³æœ¯è¯­æ¥å®ç°çš„, æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¾‹å­æ¥è¿›è¡Œä»‹ç», ä¸€ä¸ªæ—¥æœŸæ˜¯ä¸€ä¸ªå¯¹è±¡.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span>
</code></pre></td></tr></table>
</div>
</div><p>åç§°<code>date</code>ç»‘å®šåˆ°ä¸€ä¸ªç±»ä¸Šçš„. æ­£å¦‚æˆ‘ä»¬çœ‹åˆ°çš„, ä¸€ä¸ªç±»ä»£è¡¨ä¸€ç§å€¼. ä¸ªåˆ«çš„æ—¥æœŸå°±å«åšè¿™ä¸ªç±»çš„å®ä¾‹. å®ä¾‹èƒ½å¤Ÿé€šè¿‡ä½¿ç”¨è¡¨æ˜è¿™ä¸ªå®ä¾‹çš„ç‰¹å¾å‚æ•°æ¥è°ƒç”¨ç±»æ¥æ„å»º.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">tues</span> <span class="o">=</span> <span class="n">date</span><span class="p">(</span><span class="mi">2014</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>å½“ç”¨åŸå§‹æ•°å­—æ„é€ <code>tues</code>ä¹‹å, å®ƒçš„è¡Œä¸ºè¡¨ç°å¾—åƒæ—¥æœŸä¸€æ ·, ä¾‹å¦‚, å°†å®ƒè·Ÿå…¶ä»–çš„æ—¥æœŸç›¸å‡ä¼šè¿”å›ä¸€ä¸ªæ—¶å·®, æˆ‘ä»¬å¯ä»¥æ‰“å°å‡ºæ¥.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="mi">2014</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span> <span class="o">-</span> <span class="n">tues</span><span class="p">)</span>
<span class="mi">6</span> <span class="n">days</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">00</span>
</code></pre></td></tr></table>
</div>
</div><p>å¯¹è±¡å…·æœ‰<em>å±æ€§</em>, æ˜¯ä¸€ä¸ªå‘½ååçš„å¯¹è±¡çš„ä¸€éƒ¨åˆ†çš„å€¼. åœ¨Pythonä¸­, åƒå¾ˆå¤šå…¶ä»–çš„ç¼–ç¨‹è¯­è¨€ä¸€æ ·, æˆ‘ä»¬ç”¨ç‚¹ç¬¦å·æ¥æŒ‡å®šä¸€ä¸ªå¯¹è±¡çš„å±æ€§.</p>
<p><code>&lt;expression&gt; . &lt;name&gt;</code></p>
<p>ä¸Šé¢, <code>&lt;expression&gt;</code>æ˜¯ä¸€ä¸ªå¯¹è±¡, ç„¶å<code>&lt;name&gt;</code>æ˜¯ä¸€ä¸ªå¯¹è±¡å±æ€§çš„åç§°. ä¸æˆ‘ä»¬è‡³ä»Šä¸ºæ­¢è€ƒè™‘è¿‡çš„åç§°, å±æ€§åå¯¹äºç‚¹ç¬¦å·å‰é¢çš„å¯¹è±¡å®ä¾‹æ¥è¯´æ˜¯ç‹¬ç‰¹çš„.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">tues</span><span class="o">.</span><span class="n">year</span>
<span class="mi">2014</span>
</code></pre></td></tr></table>
</div>
</div><p>å¯¹è±¡é€šå¸¸ä¹Ÿæœ‰æ–¹æ³•, ä¹Ÿå°±æ˜¯å±æ€§å€¼ä¸ºå‡½æ•°çš„å±æ€§. éšå«çš„æ„æ€æ˜¯, æˆ‘ä»¬è®¤ä¸ºè¿™ä¸ªå¯¹è±¡&quot;çŸ¥é“&quot;å¦‚ä½•å»æ‰§è¡Œè¿™äº›æ–¹æ³•. é€šè¿‡å®ç°, (å¯¹è±¡)æ–¹æ³•æ˜¯ä¸€ä¸ªç”¨æ¥ä»å®ƒä»¬çš„å‚æ•°ä»¥åŠå®ƒä»¬çš„å¯¹è±¡ä¸­è®¡ç®—ç»“æœçš„å‡½æ•°. ä¾‹å¦‚, <code>tues</code>æœ‰ä¸€ä¸ª<code>strftime</code>æ–¹æ³•(ä¸€ä¸ªç»å…¸å‡½æ•°çš„åç§°, æ„æ€æ˜¯&quot;å­—ç¬¦ä¸²æ ¼å¼çš„æ—¶é—´&rdquo;)æ¥å—ä¸€ä¸ªå‚æ•°ç”¨äºæŒ‡å®šå¦‚ä½•æ˜¾ç¤ºæ—¥æœŸ(ä¾‹å¦‚: %Aè¡¨ç¤ºè¿™å‘¨çš„æŸä¸€å¤©åº”è¯¥å®Œæ•´åœ°æ‹¼å†™å‡ºæ¥).</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">tues</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&#34;%A, %B </span><span class="si">%d</span><span class="s2">&#34;</span><span class="p">)</span>
<span class="s1">&#39;Tuesday, May 13&#39;</span>
</code></pre></td></tr></table>
</div>
</div><p>è®¡ç®—<code>strftime</code>çš„è¿”å›å€¼éœ€è¦ä¸¤ä¸ªè¾“å…¥: ä¸€ä¸ªç”¨äºæè¿°è¾“å‡ºæ ¼å¼çš„å­—ç¬¦ä¸²ä»¥åŠç»‘å®šåœ¨tuesä¸­çš„æ—¥æœŸä¿¡æ¯. ç‰¹å®šæ—¥æœŸé€»è¾‘éœ€è¦åº”ç”¨è¿™ä¸ªæ–¹æ³•æ¥è¿”å›ç»“æœ. æˆ‘ä»¬ä»æ¥æ²¡æœ‰è¯´è¿‡2014å¹´5æœˆ13å·æ˜¯æ˜ŸæœŸäºŒ, ä½†æ˜¯çŸ¥é“å®ƒå¯¹åº”çš„æ˜¯å·¥ä½œæ—¥çš„ä¸€éƒ¨åˆ†, è¿™å°±æ„å‘³ç€å®ƒæ˜¯ä¸€ä¸ªæ—¥æœŸ. é€šè¿‡å°†è¡Œä¸ºä»¥åŠä¿¡æ¯ç»‘å®šåˆ°ä¸€èµ·, è¿™ä¸ªPythonå¯¹è±¡æä¾›ç»™æˆ‘ä»¬ä¸€ä¸ªå¯ä¿¡çš„, è‡ªè¶³çš„æ—¥æœŸæŠ½è±¡.</p>
<p>æ—¥æœŸæ˜¯ä¸€ä¸ªå¯¹è±¡, è€Œä¸”æ•°å­—, ç¬¦ä¸²å—, åˆ—è¡¨ä»¥åŠåŒºé—´ç­‰ä¹Ÿå…¨éƒ½æ˜¯å¯¹è±¡. å®ƒä»¬ä»£è¡¨ä¸€ä¸ªå€¼, è€Œä¸”è¿˜ä»¥ç¬¦åˆå®ƒä»¬è¡¨ç¤ºçš„å€¼çš„æ–¹å¼è¡¨ç°. å®ƒä»¬ä¹Ÿæœ‰å±æ€§ä»¥åŠæ–¹æ³•. æ¯”å¦‚, å­—ç¬¦ä¸²å…·æœ‰ä¸€ä¸ªæ•°ç»„æ–¹æ³•ç”¨äºæ–¹ä¾¿æ–‡æœ¬å¤„ç†.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="s1">&#39;1234&#39;</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">()</span>
<span class="bp">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="s1">&#39;rOBERT dE nIRO&#39;</span><span class="o">.</span><span class="n">swapcase</span><span class="p">()</span>
<span class="s1">&#39;Robert De Niro&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="s1">&#39;eyes&#39;</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;YES&#39;</span><span class="p">)</span>
<span class="bp">True</span>
</code></pre></td></tr></table>
</div>
</div><p>å®é™…ä¸Š, åœ¨Pythonä¸­æ‰€æœ‰çš„å€¼éƒ½æ˜¯å¯¹è±¡, ä¹Ÿå°±æ˜¯è¯´, æ‰€æœ‰å€¼éƒ½å…·æœ‰è¡Œä¸ºä»¥åŠå±æ€§. å®ƒä»¬çš„è¡Œä¸ºå°±åƒå®ƒä»¬æ‰€ä»£è¡¨çš„å€¼.</p>
<h4 id="242-åºåˆ—å¯¹è±¡">2.4.2 åºåˆ—å¯¹è±¡</h4>
<p>åŸå§‹å…§å»ºçš„å€¼çš„å®ä¾‹å¦‚æ•°å­—æ˜¯ä¸å¯å˜çš„. è¿™ä¸ªå€¼åœ¨ç¨‹åºçš„æ‰§è¡Œè¿‡ç¨‹ä¸­æ˜¯ä¸å¯å˜çš„. è€Œå¦ä¸€æ–¹é¢åˆ—è¡¨åˆ™æ˜¯å¯å˜çš„.</p>
<p>å¯å˜å¯¹è±¡ç”¨æ¥ä»£è¡¨éšæ—¶é—´å˜åŒ–çš„å€¼. ä¸€ä¸ªäººæ˜¯åœ¨ä»Šå¤©åˆ°æ˜å¤©ä¾ç„¶æ˜¯åŒä¸€ä¸ªäºº, å°½ç®¡å˜å¾—è€äº†, å‰ªäº†å¤´å‘, æˆ–è€…ä»¥æŸç§æ–¹å¼æ”¹å˜äº†. åŒæ ·åœ°, ä¸€ä¸ªå¯¹è±¡çš„å±æ€§å¯èƒ½ä¼šç”±äºå¯å˜æ“ä½œè€Œæ”¹å˜äº†å±æ€§. ä¾‹å¦‚, å¯ä»¥æ”¹å˜åˆ—è¡¨ä¸­çš„å†…å®¹. å¤§å¤šæ•°æ”¹å˜é€šè¿‡è°ƒç”¨æ‰§è¡Œåˆ—è¡¨å¯¹è±¡å†…éƒ¨çš„æ–¹æ³•.</p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªè¯´æ˜æ‰‘å…‹ç‰Œå†å²çš„ä¾‹å­(å¤§å¤§ç®€åŒ–)æ¥ä»‹ç»å¾ˆå¤šåˆ—è¡¨çš„ä¿®æ”¹æ“ä½œ. åœ¨ä¾‹å­çš„æ³¨é‡Šä¸­, æè¿°äº†æ¯ä¸ªæ–¹æ³•è°ƒç”¨çš„ç»“æœ.</p>
<p>æ‰‘å…‹ç‰Œæ˜¯åœ¨ä¸­å›½å‘æ˜çš„, å¤§çº¦åœ¨9ä¸–çºª. è¾ƒæ—©çš„æ‰‘å…‹ç‰Œåªæœ‰ä¸‰ç§èŠ±å¼, åˆ†åˆ«è·Ÿé’±çš„é¢é¢å¯¹åº”èµ·æ¥.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">chinese</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;coin&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;myriad&#39;</span><span class="p">]</span> <span class="c1"># ä¸€ä¸ªæ–‡å­—åˆ—è¡¨</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">suits</span> <span class="o">=</span> <span class="n">chinese</span> <span class="c1"># ä¸¤ä¸ªåå­—å¯¹åº”åŒä¸€ä¸ªåˆ—è¡¨</span>
</code></pre></td></tr></table>
</div>
</div><p>éšç€æ‰‘å…‹ç‰Œä¼ å…¥æ¬§æ´²(å¯èƒ½æ˜¯é€šè¿‡åŸƒåŠ), åªæœ‰coiné‚£é‚£ä¸ªèŠ±å¼è¿˜å­˜åœ¨è¥¿ç­ç‰™çš„ç‰Œæ¡Œä¸Š(oro).</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">suits</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span> <span class="c1"># åˆ é™¤æœ€åä¸€ä¸ªå…ƒç´ å¹¶è¿”å›</span>
<span class="s1">&#39;myriad&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">suits</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="c1"># åˆ é™¤è·Ÿå‚æ•°ç›¸ç­‰çš„ç¬¬ä¸€ä¸ªå…ƒç´ </span>
</code></pre></td></tr></table>
</div>
</div><p>æ–°å¢äº†ä¸‰ä¸ªèŠ±å¼(å®ƒä»¬çš„åå­—è¿˜æœ‰è®¾è®¡è¿›è¡Œäº†å‡ æ¬¡æ›´æ”¹).</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">suits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;cup&#39;</span><span class="p">)</span> <span class="c1"># æ·»åŠ ä¸€ä¸ªå…ƒç´ åˆ°æœ€å</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">suits</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;sword&#39;</span><span class="p">,</span> <span class="s1">&#39;club&#39;</span><span class="p">])</span> <span class="c1"># å°†æ‰€æœ‰çš„å…ƒç´ æ·»åŠ åˆ°åºåˆ—çš„æœ€å</span>
</code></pre></td></tr></table>
</div>
</div><p>ç„¶åæ„å¤§åˆ©äººå°†å‰‘å«åšé”¹.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">suits</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;spade&#39;</span> <span class="c1"># æ›¿ä»£ä¸€ä¸ªå…ƒç´ </span>
</code></pre></td></tr></table>
</div>
</div><p>å¾—åˆ°ä¸€å‰¯ä¼ ç»Ÿçš„æ„å¤§åˆ©æ‰‘å…‹ç‰Œ.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">suits</span>
<span class="p">[</span><span class="s1">&#39;coin&#39;</span><span class="p">,</span> <span class="s1">&#39;cup&#39;</span><span class="p">,</span> <span class="s1">&#39;spade&#39;</span><span class="p">,</span> <span class="s1">&#39;club&#39;</span><span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><p>ä»Šå¤©ç¾å›½ç”¨çš„æ‰‘å…‹ç‰Œæ˜¯æ³•å›½çš„å˜ç§, ä¿®æ”¹äº†å‰ä¸¤ä¸ªèŠ±å¼:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">suits</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;heart&#39;</span><span class="p">,</span> <span class="s1">&#39;diamond&#39;</span><span class="p">]</span> <span class="c1"># ä¿®æ”¹ä¸€ä¸ªåˆ‡ç‰‡</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">suits</span>
<span class="p">[</span><span class="s1">&#39;heart&#39;</span><span class="p">,</span> <span class="s1">&#39;diamond&#39;</span><span class="p">,</span> <span class="s1">&#39;spade&#39;</span><span class="p">,</span> <span class="s1">&#39;club&#39;</span><span class="p">]]</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿˜å­˜åœ¨ç”¨äºæ’å…¥, æ’åº, ä»¥åŠç¿»è½¬åˆ—è¡¨çš„æ–¹æ³•. æ‰€æœ‰è¿™äº›å˜åŠ¨çš„æ“ä½œéƒ½ä¼šä¿®æ”¹åˆ—è¡¨çš„å€¼; å®ƒä»¬ä¸ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„åˆ—è¡¨å¯¹è±¡.</p>
<p><strong>å…±äº«å’Œæ ‡è¯†</strong>. ç”±äºæˆ‘ä»¬å·²ç»ä¿®æ”¹å•ä¸ªåˆ—è¡¨, è€Œä¸æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„åˆ—è¡¨, å› æ­¤å¯¹è±¡ç»‘å®šçš„åç§°<code>chinese</code>çš„å€¼åŒæ ·ä¹Ÿä¼šæ”¹å˜, å› ä¸ºå®ƒè·Ÿsuitsç»‘å®šçš„æ˜¯åŒä¸€ä¸ªåˆ—è¡¨å¯¹è±¡.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">chinese</span>  <span class="c1"># åç§°è·Ÿ&#34;suits&#34;å…±åŒæŒ‡ä»£åŒä¸€ä¸ªè¢«ä¿®æ”¹çš„åˆ—è¡¨</span>
<span class="p">[</span><span class="s1">&#39;heart&#39;</span><span class="p">,</span> <span class="s1">&#39;diamond&#39;</span><span class="p">,</span> <span class="s1">&#39;spade&#39;</span><span class="p">,</span> <span class="s1">&#39;club&#39;</span><span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿™ç§è¡Œä¸ºæ˜¯æ–°çš„. æ—©å…ˆ, å¦‚æœä¸€ä¸ªåç§°æ²¡æœ‰å‡ºç°åœ¨ä¸€ä¸ªè¯­å¥ä¸­, é‚£ä¹ˆå®ƒçš„å€¼å°±ä¸ä¼šè¢«è¿™ä¸ªè¯­å¥å½±å“åˆ°. å¯¹äºå¯å˜æ•°æ®, åœ¨ä¸€ä¸ªåç§°ä¸Šè°ƒç”¨æ–¹æ³•èƒ½å¤ŸåŒæ—¶å½±å“åˆ°å…¶ä»–çš„åç§°.</p>
<p>å¯¹äºè¿™é‡Œä¾‹å­, ä¸‹é¢çš„è¿è¡Œç¯å¢ƒå›¾å±•ç¤ºäº†è·Ÿchineseåç§°ç»‘å®šçš„å€¼æ˜¯å¦‚ä½•åœ¨åªæ¶‰åŠåˆ°suitsçš„è¯­å¥ä¸­è¢«ä¿®æ”¹çš„. è§‚å¯Ÿä¾‹å­ä¸­çš„æ¯ä¸€ä¸ªæ­¥éª¤æ¥æŸ¥çœ‹è¿™äº›æ”¹å˜.</p>
<iframe width="800" height="500" frameborder="0" src="http://pythontutor.com/iframe-embed.html#code=chinese%20%3D%20%5B'coin',%20'string',%20'myriad'%5D%0Asuits%20%3D%20chinese%0Asuits.pop(%29%0Asuits.remove('string'%29%0Asuits.append('cup'%29%0Asuits.extend(%5B'sword',%20'club'%5D%29%0Asuits%5B2%5D%20%3D%20'spade'%0Asuits%5B0%3A2%5D%20%3D%20%5B'heart',%20'diamond'%5D&codeDivHeight=400&codeDivWidth=350&cumulative=true&curInstr=0&origin=composingprograms.js&py=3&rawInputLstJSON=%5B%5D"> </iframe>
<p>åˆ—è¡¨å¯¹è±¡å¯ä»¥ç”¨åˆ—è¡¨æ„é€ å™¨å‡½æ•°æ¥å¤åˆ¶. ä¿®æ”¹ä¸€ä¸ªåˆ—è¡¨ä¸ä¼šå½±å“åˆ°å¦å¤–ä¸€ä¸ª, é™¤éå®ƒä»¬å…±äº«ç›¸åŒçš„æ•°æ®ç»“æ„.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">nest</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">suits</span><span class="p">)</span> <span class="c1"># ç»‘å®š&#34;nest&#34;åˆ°ç¬¬äºŒä¸ªå…·æœ‰ç›¸åŒå…ƒç´ çš„åˆ—è¡¨ä¸­</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">nest</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">suits</span> <span class="c1"># åˆ›å»ºä¸€ä¸ªåµŒå¥—çš„åˆ—è¡¨</span>
</code></pre></td></tr></table>
</div>
</div><p>æ ¹æ®è¿™ç§ç¯å¢ƒ, é€šè¿‡suitså¼•ç”¨æ¥ä¿®æ”¹åˆ—è¡¨ä¼šå½±å“åˆ°nestçš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„é‚£ä¸ªå†…åµŒçš„åˆ—è¡¨, ä½†æ˜¯ä¸ä¼šå¯¹å…¶ä»–çš„å…ƒç´ æœ‰å½±å“.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">suits</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Joker&#39;</span><span class="p">)</span>  <span class="c1"># åœ¨ä¸‹æ ‡ä¸º2çš„åœ°æ–¹æ’å…¥ä¸€ä¸ªå…ƒç´ , å…¶ä»–çš„å…ƒç´ è¿›è¡Œå“åº”çš„ç§»ä½</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">nest</span>
<span class="p">[[</span><span class="s1">&#39;heart&#39;</span><span class="p">,</span> <span class="s1">&#39;diamond&#39;</span><span class="p">,</span> <span class="s1">&#39;Joker&#39;</span><span class="p">,</span> <span class="s1">&#39;spade&#39;</span><span class="p">,</span> <span class="s1">&#39;club&#39;</span><span class="p">],</span> <span class="s1">&#39;diamond&#39;</span><span class="p">,</span> <span class="s1">&#39;spade&#39;</span><span class="p">,</span> <span class="s1">&#39;club&#39;</span><span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><p>åŒæ ·åœ°, åœ¨nestçš„ç¬¬ä¸€ä¸ªå…ƒç´ ä¸­æ’¤é”€è¿™ä¸ªæ”¹åŠ¨åŒæ ·ä¹Ÿä¼šå½±å“åˆ°suit</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">nest</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="s1">&#39;Joker&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">suits</span>
<span class="p">[</span><span class="s1">&#39;heart&#39;</span><span class="p">,</span> <span class="s1">&#39;diamond&#39;</span><span class="p">,</span> <span class="s1">&#39;spade&#39;</span><span class="p">,</span> <span class="s1">&#39;club&#39;</span><span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><iframe width="800" height="500" frameborder="0" src="http://pythontutor.com/iframe-embed.html#code=suits%20%3D%20%5B'heart',%20'diamond',%20'spade',%20'club'%5D%0Anest%20%3D%20list(suits%29%0Anest%5B0%5D%20%3D%20suits%0Asuits.insert(2,%20'Joker'%29%0Ajoke%20%3D%20nest%5B0%5D.pop(2%29&codeDivHeight=400&codeDivWidth=350&cumulative=true&curInstr=0&origin=composingprograms.js&py=3&rawInputLstJSON=%5B%5D"> </iframe>
<p>å› ä¸ºä¸¤ä¸ªåˆ—è¡¨æœ‰å¯èƒ½ä¼šæœ‰ç›¸åŒçš„å†…å®¹, ä½†æ˜¯å®é™…ä¸Šæ˜¯ä¸¤ä¸ªä¸åŒçš„åˆ—è¡¨, æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ‰‹æ®µæ¥æµ‹è¯•ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯ç›¸åŒçš„. Pythonå«æœ‰ä¸¤ä¸ªæ¯”è¾ƒæ“ä½œç¬¦, å«åš <code>is</code> ä»¥åŠ <code>is not</code>, ç”¨æ¥æµ‹è¯•ä¸¤ä¸ªè¡¨è¾¾å¼å®é™…ä¸Šæ˜¯å¦å¾—åˆ°çš„æ˜¯ç›¸åŒçš„å¯¹è±¡. å¦‚æœä¸¤ä¸ªå¯¹è±¡å®ƒä»¬çš„å½“å‰å€¼æ˜¯ä¸€æ ·çš„, ç„¶åä»»ä½•ä¸€ä¸ªçš„æ”¹åŠ¨éƒ½ä¼šåæ˜ åˆ°å¦ä¸€ä¸ªå¯¹è±¡ä¸­, é‚£ä¹ˆä¸¤ä¸ªå¯¹è±¡æ˜¯ç›¸ç­‰çš„. èº«ä»½æ ‡è¯†æ˜¯æ¯”ç›¸ç­‰æ€§æ›´å¼ºçš„æ¡ä»¶.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">suits</span> <span class="ow">is</span> <span class="n">nest</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="bp">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">suits</span> <span class="ow">is</span> <span class="p">[</span><span class="s1">&#39;heart&#39;</span><span class="p">,</span> <span class="s1">&#39;diamond&#39;</span><span class="p">,</span> <span class="s1">&#39;spade&#39;</span><span class="p">,</span> <span class="s1">&#39;club&#39;</span><span class="p">]</span>
<span class="bp">False</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">suits</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;heart&#39;</span><span class="p">,</span> <span class="s1">&#39;diamond&#39;</span><span class="p">,</span> <span class="s1">&#39;spade&#39;</span><span class="p">,</span> <span class="s1">&#39;club&#39;</span><span class="p">]</span>
<span class="bp">True</span>
</code></pre></td></tr></table>
</div>
</div><p>æœ€åä¸¤ä¸ªæ¯”ç…§è¯´æ˜äº† <code>==</code> è·Ÿ <code>is</code> ä¸¤è€…çš„ä¸åŒ, å‰è€…æ£€æŸ¥èº«ä»½, è€Œåè€…åˆ™æ˜¯æ£€æŸ¥å†…å®¹çš„çš„ç›¸ç­‰æ€§</p>
<p><strong>åˆ—è¡¨æ¨å¯¼</strong>. ä¸€ä¸ªåˆ—è¡¨æ¨å¯¼æ€»æ˜¯ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„åˆ—è¡¨. ä¾‹å¦‚, <code>unicodedata</code>æ¨¡å—è·Ÿè¸ªUnicodeå­—æ¯è¡¨ä¸­æ¯ä¸€ä¸ªå­—ç¬¦çš„å®˜æ–¹åç§°. æˆ‘ä»¬å¯ä»¥æŸ¥æ‰¾ä¸åç§°ç›¸å¯¹åº”çš„å­—ç¬¦, åŒ…æ‹¬é‚£äº›æ‰‘å…‹ç‰Œçš„èŠ±å¼.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">unicodedata</span> <span class="kn">import</span> <span class="n">lookup</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">lookup</span><span class="p">(</span><span class="s1">&#39;WHITE &#39;</span> <span class="o">+</span> <span class="n">s</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39; SUIT&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">suits</span><span class="p">]</span>
<span class="p">[</span><span class="s1">&#39;â™¡&#39;</span><span class="p">,</span> <span class="s1">&#39;â™¢&#39;</span><span class="p">,</span> <span class="s1">&#39;â™¤&#39;</span><span class="p">,</span> <span class="s1">&#39;â™§&#39;</span><span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿™äº›ç»“æœåˆ—è¡¨å¹¶æ²¡æœ‰å°†å®ƒçš„å†…å®¹è·Ÿsuitsè¿›è¡Œå…±äº«, æ‰§è¡Œåˆ—è¡¨è¡¨è¾¾å¼ä¹Ÿä¸ä¼šæ”¹åŠ¨åˆ°suitsåˆ—è¡¨.</p>
<p>ä½ å¯ä»¥åœ¨Dive into Python 3ä¸­çš„<a href="http://getpython3.com/diveintopython3/strings.html#one-ring-to-rule-them-all">Unicodeç« èŠ‚</a>ä¸­, æŸ¥çœ‹æ›´å¤šç›¸å…³çš„ç”¨äºè¡¨ç¤ºæ–‡æœ¬çš„Unicodeæ ‡å‡†.</p>
<p><strong>å…ƒç»„</strong></p>
<p>ä¸€ä¸ªå…ƒç»„, æ˜¯ä¸€ä¸ªå…§å»ºçš„<code>tuple</code>ç±»å‹çš„å®ä¾‹, æ˜¯ä¸€ä¸ªä¸å¯å˜åºåˆ—. æ˜¯ç”¨å…ƒç»„å­—é¢é‡, ä¹Ÿå°±æ˜¯ç”¨é€—å·åˆ†å‰²å…ƒç´ æ¥åˆ›å»ºçš„. æ‹¬å·æ˜¯å¯é€‰çš„, ä½†æ˜¯åœ¨å®è·µä¸­ç»å¸¸ä½¿ç”¨. ä»»ä½•å¯¹è±¡éƒ½å¯ä»¥æ”¾åœ¨å…ƒç»„ä¸­.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span>
<span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="s2">&#34;the&#34;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="s2">&#34;and&#34;</span><span class="p">,</span> <span class="s2">&#34;only&#34;</span><span class="p">))</span>
<span class="p">(</span><span class="s1">&#39;the&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;and&#39;</span><span class="p">,</span> <span class="s1">&#39;only&#39;</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span> <span class="p">)</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">tuple</span><span class="s1">&#39;&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>ç©ºçš„æˆ–è€…æ‹¥æœ‰ä¸€ä¸ªå…ƒç´ çš„å…ƒç»„å…·æœ‰ç‰¹æ®Šçš„å­—é¢è¯­æ³•.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="p">()</span>    <span class="c1"># 0 elements</span>
<span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="mi">10</span><span class="p">,)</span> <span class="c1"># 1 element</span>
<span class="p">(</span><span class="mi">10</span><span class="p">,)</span>
</code></pre></td></tr></table>
</div>
</div><p>åƒåˆ—è¡¨, å…ƒç»„å…·æœ‰æœ‰é™çš„é•¿åº¦, åŒæ—¶ä¹Ÿæ”¯æŒå…ƒç´ é€‰æ‹©. å®ƒä»¬åŒæ ·ä¹Ÿå…·æœ‰ä¸€äº›å¯ç”¨äºåˆ—è¡¨çš„æ–¹æ³•, ä¾‹å¦‚<code>count</code>ä»¥åŠ<code>index</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">code</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&#34;up&#34;</span><span class="p">,</span> <span class="s2">&#34;up&#34;</span><span class="p">,</span> <span class="s2">&#34;down&#34;</span><span class="p">,</span> <span class="s2">&#34;down&#34;</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&#34;left&#34;</span><span class="p">,</span> <span class="s2">&#34;right&#34;</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
<span class="mi">8</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">code</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="s1">&#39;down&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">code</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&#34;down&#34;</span><span class="p">)</span>
<span class="mi">2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">code</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&#34;left&#34;</span><span class="p">)</span>
<span class="mi">4</span>
</code></pre></td></tr></table>
</div>
</div><p>ç„¶è€Œ, å¯¹äºé‚£äº›æ“ä½œåˆ—è¡¨å†…å®¹çš„æ–¹æ³•åœ¨å…ƒç»„ä¸­æ˜¯ä¸å¯ç”¨çš„, å› ä¸ºå…ƒç»„æ˜¯ä¸å¯å˜çš„.</p>
<p>å› æ­¤æ— æ³•æ”¹å˜å…ƒç»„ä¸­çš„å…ƒç´ , ä½†æ˜¯å¯ä»¥ä¿®æ”¹ä¸€ä¸ªåŒ…å«åœ¨å…ƒç»„ä¸­çš„å¯å˜å…ƒç´ çš„å€¼.</p>
<iframe width="800" height="500" frameborder="0" src="http://pythontutor.com/iframe-embed.html#code=nest%20%3D%20(10,%2020,%20%5B30,%2040%5D%29%0Anest%5B2%5D.pop(%29&codeDivHeight=400&codeDivWidth=350&cumulative=true&curInstr=0&origin=composingprograms.js&py=3&rawInputLstJSON=%5B%5D"> </iframe>
<p>å¤šé‡èµ‹å€¼ä¸­éšå¼åœ°ä½¿ç”¨å…ƒç»„, ä¸€ä¸ªå°†ä¸¤ä¸ªå€¼ç»‘å®šåˆ°ä¸¤ä¸ªåç§°ä¸­çš„èµ‹å€¼è¯­å¥ä¼šåˆ›å»ºä¸¤ä¸ªå…ƒç´ çš„å…ƒç»„ç„¶åå¯¹å®ƒè¿›è¡Œè§£åŒ….</p>
<h4 id="243-å­—å…¸">2.4.3 å­—å…¸</h4>
<p>å­—å…¸åœ¨Pythonä¸­æ˜¯ä¸€ä¸ªå…§å»ºçš„æ•°æ®ç±»å‹, ç”¨æ¥å­˜å‚¨ä»¥åŠæ“ä½œå¯¹åº”å…³ç³». ä¸€ä¸ªå­—å…¸åŒ…å«æœ‰å¤šä¸ªé”®å€¼å¯¹, é”®è·Ÿå€¼éƒ½æ˜¯å¯¹è±¡. å­—å…¸çš„ç›®çš„æ˜¯æä¾›ä¸€ä¸ªæŠ½è±¡åŒ–çš„ç”¨äºå­˜å‚¨ä»¥åŠæ£€ç´¢æ•°æ®å¹¶ä¸ä»¥è¿ç»­çš„æ•´æ•°è€Œæ˜¯æè¿°æ€§çš„é”®å€¼ä¸ºä¸‹æ ‡çš„åœ°æ–¹.</p>
<p>é€šå¸¸ç”¨å­—ç¬¦ä¸²æ¥ä½œä¸ºé”®å€¼, å› ä¸ºæˆ‘ä»¬å¸¸ç”¨ä¸€ä¸ªå­—ç¬¦ä¸²åç§°æ¥è¡¨ç¤ºä¸€æ ·ä¸œè¥¿. è¿™ä¸ªå­—å…¸å­—é¢é‡ç»™å®šå„ç§ç½—é©¬æ•°å­—çš„å€¼.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">numerals</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;I&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>ä½¿ç”¨å…ƒç´ é€‰æ‹©æ“ä½œç¬¦é€šè¿‡å®ƒä»¬çš„é”®æ¥æŸ¥çœ‹æˆ‘ä»¬å…ˆå‰åº”ç”¨äºåºåˆ—çš„å¯¹åº”çš„å€¼.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">numerals</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span>
<span class="mi">10</span>
</code></pre></td></tr></table>
</div>
</div><p>ä¸€ä¸ªå­—å…¸ä¸­æ¯ä¸€ä¸ªé”®æœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„å€¼. æ·»åŠ æ–°çš„é”®å€¼å¯¹æˆ–è€…é€šè¿‡é”®æ¥ä¿®æ”¹å·²ç»å­˜åœ¨çš„å€¼éƒ½å¯ä»¥é€šè¿‡èµ‹å€¼è¯­å¥å®ç°.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">numerals</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">numerals</span><span class="p">[</span><span class="s1">&#39;L&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">50</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">numerals</span>
<span class="p">{</span><span class="s1">&#39;I&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>æ³¨æ„åˆ°, <code>L</code>çš„å€¼åœ¨å‰é¢çš„è¾“å‡ºç»“æœä¸­æ˜¯æ²¡æœ‰æ·»åŠ çš„. å­—å…¸æ˜¯æ— åºçš„é”®å€¼å¯¹é›†åˆ. å½“æˆ‘ä»¬è¾“å‡ºä¸€ä¸ªå­—å…¸, é”®è·Ÿå€¼ä¼šä»¥æŸç§é¡ºåºæ¸²æŸ“, è€Œä½œä¸ºè¯­è¨€çš„ç”¨æˆ·, æˆ‘ä»¬æ— æ³•é¢„çŸ¥å°†ä¼šæŒ‰ç…§ä½•ç§é¡ºåºæ¸²æŸ“. å½“å¤šæ¬¡è¿è¡Œç¨‹åºæ—¶è¿™ç§é¡ºåºå¯èƒ½ä¼šæ”¹å˜.</p>
<p>å­—å…¸ä¹Ÿå¯ä»¥åœ¨ç¯å¢ƒå›¾ä¾‹ä¸­å‡ºç°.</p>
<iframe width="800" height="500" frameborder="0" src="http://pythontutor.com/iframe-embed.html#code=numerals%20%3D%20%7B'I'%3A%201,%20'V'%3A%205,%20'X'%3A%2010%7D%0Anumerals%5B'L'%5D%20%3D%2050&codeDivHeight=400&codeDivWidth=350&cumulative=true&curInstr=0&origin=composingprograms.js&py=3&rawInputLstJSON=%5B%5D"> </iframe>
<p>å­—å…¸ç±»å‹ä¹Ÿæ”¯æŒå¤šç§ç”¨äºè¿­ä»£å®ƒåŒ…å«çš„ä½œä¸ºä¸€ä¸ªæ•´ä½“çš„å­—å…¸å†…å®¹çš„æ–¹æ³•, <code>keys</code>, <code>values</code>ä»¥åŠ<code>items</code>éƒ½è¿”å›ä¸€ä¸ªå¯è¿­ä»£çš„å€¼</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="nb">sum</span><span class="p">(</span><span class="n">numerals</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="mi">66</span>
</code></pre></td></tr></table>
</div>
</div><p>ç”±é”®å€¼å¯¹å½¢å¼ç»„æˆçš„åˆ—è¡¨å¯ä»¥é€šè¿‡è°ƒç”¨<code>dict</code>æ„é€ å‡½æ•°æ¥è½¬åŒ–æˆä¸€ä¸ªå­—å…¸.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="nb">dict</span><span class="p">([(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">25</span><span class="p">)])</span>
<span class="p">{</span><span class="mi">3</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">25</span><span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>å­—å…¸ä¹Ÿå…·æœ‰ä¸€äº›é™åˆ¶:</p>
<ul>
<li>å­—å…¸ä¸­çš„ä¸€ä¸ªé”®ä¸èƒ½å¯¹åº”å¤šä¸ªå€¼</li>
<li>å¯¹äºä¸€ä¸ªç»™å®šçš„é”®æœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªå€¼.</li>
</ul>
<p>ç¬¬ä¸€ä¸ªé™åˆ¶æ˜¯è·ŸPythonå­—å…¸åº•å±‚å®ç°ç›¸ç»‘å®šçš„. è¿™ä¸ªé™åˆ¶çš„ç»†èŠ‚ä¸æ˜¯æœ¬æ–‡çš„ä¸»é¢˜. å¯ä»¥ç›´è§‚åœ°è®¤ä¸ºé”®å‘Šè¯‰Pythonåœ¨å†…å­˜ä¸­å“ªé‡Œå»æ‰¾è¿™ä¸ªé”®å€¼å¯¹; å¦‚æœè¿™ä¸ªkeyå€¼æ”¹å˜äº†è¿™ä¸ªå¯¹çš„ä½ç½®å¯èƒ½å°±ä¼šä¸è§äº†. å…ƒç»„é€šå¸¸ä¹Ÿæ˜¯å¯ä»¥åœ¨å­—å…¸ä¸­ä½œä¸ºé”®, å› ä¸ºåˆ—è¡¨ä¸å¯ä»¥ç”¨ä½œé”®å€¼.</p>
<p>ç¬¬äºŒä¸ªé™åˆ¶æ˜¯å­—å…¸æŠ½è±¡çš„ä¸€ä¸ªå¿…ç„¶ç»“æœ, é‚£å°±æ˜¯è®¾è®¡ç”¨ä¸€ä¸ªé”®æ¥å­˜å‚¨ä»¥åŠæ£€ç´¢ä¸€ä¸ªå€¼. å¦‚æœæœ€å¤šåªæœ‰ä¸€ä¸ªè¿™æ ·çš„å€¼å­˜åœ¨äºå­—å…¸å½“ä¸­, æˆ‘ä»¬åªèƒ½ç”¨ä¸€ä¸ªé”®æ¥æ£€ç´¢è¿™ä¸ªå€¼.</p>
<p>ä¸€ä¸ªç”±å­—å…¸æ¥æ‰§è¡Œçš„æœ‰ç”¨çš„æ–¹æ³•æ˜¯<code>get</code>, è¿™ä¸ªæ–¹æ³•è¦ä¹ˆä¼šè¿”å›ä¸€ä¸ªå­˜åœ¨çš„é”®æ‰€å¯¹åº”çš„å€¼, è¦ä¹ˆè¿”å›ä¸€ä¸ªé»˜è®¤å€¼. è€Œ<code>get</code>æ–¹æ³•çš„å‚æ•°å°±æ˜¯é”®ä»¥åŠé»˜è®¤å€¼.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">numerals</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="mi">0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">numerals</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="mi">5</span>
</code></pre></td></tr></table>
</div>
</div><p>å­—å…¸ä¹Ÿæœ‰ä¸€ä¸ªç±»ä¼¼äºåˆ—è¡¨çš„è§£æå¼è¯­æ³•. ä¸€ä¸ªé”®è¡¨è¾¾å¼ä»¥åŠä¸€ä¸ªå€¼è¡¨è¾¾å¼é€šè¿‡ä¸€ä¸ªå†’å·éš”å¼€, æ‰§è¡Œä¸€ä¸ªå­—å…¸è§£æä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å­—å…¸å¯¹è±¡.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">)}</span>
<span class="p">{</span><span class="mi">3</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">25</span><span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="244-æœ¬åœ°çŠ¶æ€">2.4.4 æœ¬åœ°çŠ¶æ€</h4>
<p>åˆ—è¡¨è·Ÿå­—å…¸éƒ½æœ‰æœ¬åœ°çŠ¶æ€: å®ƒä»¬åœ¨ç¨‹åºè¿è¡Œçš„ä»»æ„ä¸€ä¸ªç‚¹ä¸Šä¿®æ”¹å…·æœ‰ç‰¹å®šå†…å®¹çš„å€¼. &ldquo;çŠ¶æ€&quot;è¿™ä¸ªè¯æš—ç¤ºäº†ä¸€ä¸ªæ¼”å˜çš„è¿‡ç¨‹, è¡¨ç¤ºè¿™ä¸ªçŠ¶æ€å¯èƒ½ä¼šæ”¹å˜.</p>
<p>å‡½æ•°ä¹Ÿå¯ä»¥å…·æœ‰æœ¬åœ°çŠ¶æ€. ä¾‹å¦‚, è®©æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå‡½æ•°ç”¨äºæ¨¡æ‹Ÿä»ä¸€ä¸ªé“¶è¡Œè´¦æˆ·ä¸­ææ¬¾çš„è¿‡ç¨‹. æˆ‘ä»¬ä¼šåˆ›å»ºä¸€ä¸ªå«åšwithdrawçš„å‡½æ•°, å®ƒæŠŠä¸€ä¸ªæ•°é¢ä½œä¸ºå®ƒçš„å‚æ•°. å¦‚æœè¿™ä¸ªè´¦æˆ·å…·æœ‰è¶³å¤Ÿçš„é‡‘é¢ç”¨äºææ¬¾, é‚£ä¹ˆ<code>withdraw</code>ä¼šè¿”å›ææ¬¾åçš„å‰©ä½™ä½™é¢. å¦åˆ™, <code>withdraw</code>ä¼šè¿”å›ä¿¡æ¯&rsquo;èµ„é‡‘ä¸è¶³&rsquo;, ä¾‹å¦‚, å¦‚æœæˆ‘ä»¬å¼€å§‹æœ‰$100åœ¨è´¦æˆ·å†…, æˆ‘ä»¬ä¼šå¸Œæœ›è°ƒç”¨<code>withdraw</code>åèƒ½å¤Ÿå¾—åˆ°ä¸‹é¢çš„ä¸€ç³»åˆ—çš„è¿”å›å€¼</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">withdraw</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
<span class="mi">75</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">withdraw</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
<span class="mi">50</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">withdraw</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>
<span class="s1">&#39;Insufficient funds&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">withdraw</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="mi">35</span>
</code></pre></td></tr></table>
</div>
</div><p>ä¸Šé¢è¡¨è¾¾å¼<code>withdraw(25)</code>, è¿ç®—äº†ä¸¤æ¬¡, è¿”å›äº†ä¸åŒçš„å€¼. å› æ­¤, è¿™ä¸ªç”¨æˆ·å®šä¹‰å‡½æ•°æ˜¯ä¸çº¯çš„. è°ƒç”¨è¿™ä¸ªå‡½æ•°ä¸ä»…è¿”å›ä¸€ä¸ªå€¼, åŒæ—¶è¿˜ä¼šå¸¦æœ‰å‰¯ä½œç”¨ä»¥æŸç§æ–¹å¼æ¥æ”¹å˜è¿™ä¸ªå‡½æ•°, å› æ­¤ä¸‹ä¸€æ¬¡ç”¨ç›¸åŒçš„å‚æ•°æ¥è°ƒç”¨å‡½æ•°ä¼šè¿”å›ä¸åŒçš„å€¼. è¿™ä¸ªå‰¯ä½œç”¨æ˜¯ç”±<code>withdraw</code>å‡½æ•°æ›´æ”¹å½“å‰ç¯å¢ƒçš„ä¸€ä¸ªå¤–éƒ¨åç§°å€¼çš„ç»‘å®šè€Œé€ æˆçš„.</p>
<p>ä¸ºäº†è®©<code>withdraw</code>å‡½æ•°æœ‰æ„ä¹‰, å®ƒå¿…é¡»ç”¨ä¸€ä¸ªå…·æœ‰ä½™é¢çš„åˆå§‹çš„è´¦æˆ·æ¥åˆ›å»º. è€Œå‡½æ•°<code>make_withdraw</code>æ˜¯ä¸€ä¸ªæ›´é«˜å±‚æ¬¡çš„å‡½æ•°, éœ€è¦ä¸€ä¸ªåˆå§‹ä½™é¢ä½œä¸ºå‚æ•°. è€Œå‡½æ•°withdrawåˆ™æ˜¯å®ƒçš„è¿”å›å€¼.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">withdraw</span> <span class="o">=</span> <span class="n">make_withdraw</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p><code>make_withdraw</code>çš„ä¸€ä¸ªå®ç°éœ€è¦ä¸€ç§æ–°ç±»å‹çš„è¯­å¥: ä¸€ä¸ªéæœ¬åœ°çš„å£°æ˜. å½“æˆ‘ä»¬è°ƒç”¨<code>make_withdraw</code>æ—¶, æˆ‘ä»¬ç»‘å®šåç§°<code>balance</code>åˆ°ä¸€ä¸ªåˆå§‹è´¦æˆ·ä¸­. ç„¶åæˆ‘ä»¬å®šä¹‰å¹¶è¿”å›ä¸€ä¸ªæœ¬åœ°å‡½æ•°<code>withdraw</code>, å½“è°ƒç”¨è¿™ä¸ªå‡½æ•°æ—¶ä¼šæ›´æ–°ä»¥åŠè¿”å›<code>balance</code>çš„å€¼.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">make_withdraw</span><span class="p">(</span><span class="n">balance</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;Return a withdraw function that draws down balance with each call.&#34;&#34;&#34;</span>
        <span class="k">def</span> <span class="nf">withdraw</span><span class="p">(</span><span class="n">amount</span><span class="p">):</span>
            <span class="n">nonlocal</span> <span class="n">balance</span>
            <span class="k">if</span> <span class="n">amount</span> <span class="o">&gt;</span> <span class="n">balance</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;Insufficient funds&#39;</span>
            <span class="n">balance</span> <span class="o">=</span> <span class="n">balance</span> <span class="o">-</span> <span class="n">amount</span>
            <span class="k">return</span> <span class="n">balance</span>
        <span class="k">return</span> <span class="n">withdraw</span>
</code></pre></td></tr></table>
</div>
</div><p><code>nonlocal</code>è¯­å¥å£°æ˜äº†æ— è®ºä»»ä½•æ—¶å€™æˆ‘ä»¬æ”¹å˜åç§°<code>balance</code>çš„ç»‘å®šå€¼, éƒ½ä¼šåæ˜ åˆ°è¿™ä¸ª<code>balance</code>ç¬¬ä¸€ä¸ªæ‰¾åˆ°çš„ç»‘å®šå€¼çš„ç¯å¢ƒå¸§é‡Œé¢. å›æƒ³ä¸€ä¸‹æ²¡æœ‰<code>nonlocal</code>å£°æ˜, ä¸€ä¸ªèµ‹å€¼è¯­å¥æ€»æ˜¯ä¼šç»‘å®šç»‘å®šä¸€ä¸ªåç§°åˆ°å®ƒçš„å½“å‰ç¯å¢ƒçš„ç¬¬ä¸€ä¸ªå¸§é‡Œé¢. è¿™ä¸ª<code>nonlocal</code>è¯­å¥è¡¨ç¤ºåç§°å‡ºç°åœ¨ç¯å¢ƒä¸­é™¤ç¬¬ä¸€(æœ¬åœ°)å¸§æˆ–æœ€å(å…¨å±€)å¸§ä¹‹å¤–çš„æŸå¤„.</p>
<p>æ¥ä¸‹æ¥çš„ç¯å¢ƒå›¾ä¾‹æ¼”ç¤ºäº†å¤šæ¬¡è°ƒç”¨<code>make_withdraw</code>åˆ›å»ºçš„å‡½æ•°çš„å½±å“.</p>
<iframe width="800" height="500" frameborder="0" src="http://pythontutor.com/iframe-embed.html#code=def%20make_withdraw(balance%29%3A%0A%20%20%20%20def%20withdraw(amount%29%3A%0A%20%20%20%20%20%20%20%20nonlocal%20balance%0A%20%20%20%20%20%20%20%20if%20amount%20%3E%20balance%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20'Insufficient%20funds'%0A%20%20%20%20%20%20%20%20balance%20%3D%20balance%20-%20amount%0A%20%20%20%20%20%20%20%20return%20balance%0A%20%20%20%20return%20withdraw%0A%0Awd%20%3D%20make_withdraw(20%29%0Awd(5%29%0Awd(3%29&codeDivHeight=400&codeDivWidth=350&cumulative=true&curInstr=0&origin=composingprograms.js&py=3&rawInputLstJSON=%5B%5D"> </iframe>
<p>ç¬¬ä¸€ä¸ªdefè¯­å¥å…·æœ‰é€šå¸¸çš„æ•ˆæœ: å®ƒåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ç”¨æˆ·å®šä¹‰å‡½æ•°å¹¶åœ¨å…¨å±€ç¯å¢ƒç»‘å®šåç§°<code>make_withdraw</code>åˆ°è¿™ä¸ªå‡½æ•°. è€Œéšåè°ƒç”¨<code>make_withdraw</code>åˆ›å»ºå¹¶è¿”å›äº†ä¸€ä¸ªæœ¬åœ°å®šä¹‰çš„å‡½æ•°<code>withdraw</code>. åç§°<code>balance</code>ç»‘å®šåœ¨è¿™ä¸ªå‡½æ•°çš„çˆ¶çº§å¸§ä¸­. è‡³å…³é‡è¦çš„æ˜¯, åœ¨è¯¥ç¤ºä¾‹çš„å…¶ä½™éƒ¨åˆ†ä¸­å°†ä»…å­˜åœ¨ç”¨äºåç§°<code>balance</code>çš„å•ä¸ªç»‘å®š.</p>
<p>æ¥ä¸‹æ¥, æˆ‘ä»¬æ‰§è¡Œä¸€ä¸ªè¡¨è¾¾å¼æ¥ç”¨é‡‘é¢ä¸º5çš„å‚æ•°æ¥è°ƒç”¨è¿™ä¸ªç»‘å®šåˆ°åç§°wdä¸Šçš„å‡½æ•°. <code>withdraw</code>çš„å‡½æ•°ä½“æ‰§è¡Œåœ¨æ–°çš„æ‹“å±•è‡ª<code>withdraw</code>è¢«å®šä¹‰çš„çš„ç¯å¢ƒä¸­. è·Ÿè¸ªå‡½æ•°<code>withdraw</code>çš„è¿è¡Œ, æ¼”ç¤ºäº†<code>nonlocal</code>è¯­å¥åœ¨Pythonä¸­çš„æ•ˆæœ: ä¸€ä¸ªåœ¨ç¬¬ä¸€ä¸ªå±€éƒ¨å¸§å¤–é¢çš„çš„åç§°èƒ½å¤Ÿé€šè¿‡èµ‹å€¼è¯­å¥æ¥ä¿®æ”¹.</p>
<iframe width="800" height="500" frameborder="0" src="http://pythontutor.com/iframe-embed.html#code=def%20make_withdraw(balance%29%3A%0A%20%20%20%20def%20withdraw(amount%29%3A%0A%20%20%20%20%20%20%20%20nonlocal%20balance%0A%20%20%20%20%20%20%20%20if%20amount%20%3E%20balance%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20'Insufficient%20funds'%0A%20%20%20%20%20%20%20%20balance%20%3D%20balance%20-%20amount%0A%20%20%20%20%20%20%20%20return%20balance%0A%20%20%20%20return%20withdraw%0A%0Awd%20%3D%20make_withdraw(20%29%0Awd(5%29%0Awd(3%29&codeDivHeight=400&codeDivWidth=350&cumulative=true&curInstr=0&origin=composingprograms.js&py=3&rawInputLstJSON=%5B%5D"> </iframe>
<p><code>nonlocal</code>å£°æ˜åœ¨<code>withdraw</code>çš„å®šä¹‰å†…ä¿®æ”¹æ‰€æœ‰å‰©ä½™çš„èµ‹å€¼è¯­å¥. åœ¨æ‰§è¡Œ<code>nonlocal balance</code>ä¹‹å, ä»»ä½•è·Ÿ<code>balance</code>ç›¸å…³çš„æŠŠå®ƒæ”¾åœ¨ç­‰å·å·¦è¾¹çš„èµ‹å€¼è¯­å¥éƒ½ä¸ä¼šç»‘å®š<code>balance</code>åˆ°å½“å‰ç¯å¢ƒçš„ç¬¬ä¸€å¸§é‡Œå». ç›¸å, å®ƒä¼šæ‰¾åˆ°<code>balance</code>å·²ç»è¢«å®šä¹‰çš„ç¬¬ä¸€ä¸ªå¸§ç„¶ååœ¨è¿™ä¸€å¸§å†…å°†æŠŠåç§°è¿›è¡Œé‡æ–°çš„ç»‘å®š. å¦‚æœ<code>balance</code>ä¹‹å‰å¹¶æ²¡æœ‰è·Ÿä¸€ä¸ªå€¼è¿›è¡Œç»‘å®š, é‚£ä¹ˆ<code>nonlocal</code>è¯­å¥ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯.</p>
<p>é€šè¿‡ä¿®æ”¹<code>balance</code>çš„ç»‘å®š, æˆ‘ä»¬ä¹Ÿä¿®æ”¹äº†<code>withdraw</code>å‡½æ•°. ä¸‹ä¸€æ¬¡å®ƒè¢«è°ƒç”¨æ—¶, åç§°<code>balance</code>ä¼šæ‰§è¡Œ15è€Œä¸æ˜¯20. å› æ­¤, å½“æˆ‘ä»¬ç¬¬äºŒæ¬¡è°ƒç”¨<code>withdraw</code>æ—¶, æˆ‘ä»¬ä¼šçœ‹åˆ°å®ƒè¿”å›å€¼12è€Œä¸æ˜¯17. ç¬¬ä¸€æ¬¡è°ƒç”¨å¯¹<code>balance</code>çš„ä¿®æ”¹ä¼šåæ˜ åˆ°ç¬¬äºŒæ¬¡è°ƒç”¨çš„ç»“æœä¸­å».</p>
<iframe width="800" height="500" frameborder="0" src="http://pythontutor.com/iframe-embed.html#code=def%20make_withdraw(balance%29%3A%0A%20%20%20%20def%20withdraw(amount%29%3A%0A%20%20%20%20%20%20%20%20nonlocal%20balance%0A%20%20%20%20%20%20%20%20if%20amount%20%3E%20balance%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20'Insufficient%20funds'%0A%20%20%20%20%20%20%20%20balance%20%3D%20balance%20-%20amount%0A%20%20%20%20%20%20%20%20return%20balance%0A%20%20%20%20return%20withdraw%0A%0Awd%20%3D%20make_withdraw(20%29%0Awd(5%29%0Awd(3%29&codeDivHeight=400&codeDivWidth=350&cumulative=true&curInstr=0&origin=composingprograms.js&py=3&rawInputLstJSON=%5B%5D"> </iframe>
<p>é€šå¸¸æ¥è¯´, ç¬¬äºŒæ¬¡è°ƒç”¨<code>withdraw</code>ä¼šåˆ›å»ºç¬¬äºŒä¸ªæœ¬åœ°å¸§. ç„¶è€Œ, ä¸¤ä¸ª<code>withdraw</code>å¸§å…·æœ‰ç›¸åŒçš„çˆ¶çº§. ä¹Ÿå°±æ˜¯è¯´, å®ƒä»¬éƒ½æ‹“å±•è‡ªé‚£ä¸ªåŒ…å«æœ‰<code>balance</code>çš„ç»‘å®šçš„<code>make_withdraw</code>çš„ç¯å¢ƒä¸­. å› æ­¤, å®ƒä»¬å…±äº«é‚£ä¸ªç‰¹å®šçš„åç§°ç»‘å®š. è°ƒç”¨<code>withdraw</code>å‡½æ•°å…·æœ‰æ”¹å˜ç¯å¢ƒçš„å±€éƒ¨å½±å“, ä¸”ä¼šæŠŠè¿™ä¸ªå½±å“å»¶å±•åˆ°<code>withdraw</code>æœªæ¥çš„è°ƒç”¨ä¸­å». <code>nonlocal</code>å£°æ˜å…è®¸<code>withdraw</code>å‡½æ•°æ¥æ”¹å˜<code>make_withdraw</code>å¸§ä¸­çš„åç§°çš„ç»‘å®š.</p>
<p>è‡ªä»æˆ‘ä»¬ç¬¬ä¸€æ¬¡é‡åˆ°åµŒå¥—çš„defè¯­å¥ä»¥æ¥, æˆ‘ä»¬å·²ç»æ„è¯†åˆ°æœ¬åœ°å®šä¹‰å‡½æ•°å¯ä»¥è®¿é—®å®ƒæœ¬åœ°å¸§ä»¥å¤–çš„åç§°. è®¿é—®éæœ¬åœ°åç§°ä¸éœ€è¦<code>nonlocal</code>è¯­å¥. ç›¸æ¯”ä¹‹ä¸‹, åªæœ‰åœ¨<code>nonlocal</code>å£°æ˜ä¹‹å, ä¸€ä¸ªå‡½æ•°æ‰èƒ½åœ¨è¿™äº›å¸§é‡Œé¢ä¿®æ”¹åç§°çš„ç»‘å®š.</p>
<p>é€šè¿‡ä»‹ç»<code>nonlocal</code>å£°æ˜, æˆ‘ä»¬å·²ç»ä¸ºèµ‹å€¼è¯­å¥åˆ›å»ºäº†ä¸€ä¸ªåŒé‡è§’è‰². ä¸ç®¡å®ƒä»¬æ˜¯ä¿®æ”¹æœ¬åœ°ç»‘å®š, è¿˜æ˜¯ä¿®æ”¹<code>nonlocal</code>ç»‘å®š. å®é™…ä¸Š, èµ‹å€¼è¯­å¥å·²ç»å…·æœ‰äº†åŒé‡æ€§, å®ƒä»¬ä¸ä»…å¯ä»¥åˆ›å»ºæ–°çš„ç»‘å®šä¹Ÿå¯ä»¥é‡æ–°ç»‘å®šå·²ç»å­˜åœ¨çš„åç§°. èµ‹å€¼ä¹Ÿå¯ä»¥ä¿®æ”¹åˆ—è¡¨ä»¥åŠå­—å…¸çš„å†…å®¹. Pythonä¸­èµ‹å€¼ä¸­çš„è®¸å¤šè§’è‰²ä¼šæ©ç›–æ‰§è¡Œèµ‹å€¼è¯­å¥çš„å½±å“. è¿™å–å†³äºä½ ä½œä¸ºä¸€ä¸ªç¨‹åºå‘˜æ˜¯å¦‚ä½•æ–‡æ¡£åŒ–ä½ çš„ä»£ç ä»¥æ¸…æ™°åœ°è¡¨æ˜èµ‹å€¼çš„å½±å“æ¥è®©å…¶ä»–äººå¯ä»¥æ˜ç™½.</p>
<p><strong>Pythonç»†èŠ‚</strong>. è¿™ç§<code>non-local</code>æ¨¡å¼çš„èµ‹å€¼æ˜¯ä¸€ä¸ªå…·æœ‰é«˜é˜¶å‡½æ•°ä»¥åŠè¯æ³•ä½œç”¨åŸŸçš„ç¼–ç¨‹è¯­è¨€çš„ä¸€èˆ¬ç‰¹æ€§. å¤§éƒ¨åˆ†å…¶ä»–çš„ç¼–ç¨‹è¯­è¨€ä¸€ç‚¹éƒ½ä¸éœ€è¦<code>nonlocal</code>å£°æ˜. åè€Œ, <code>non-local</code>èµ‹å€¼é€šå¸¸æ˜¯èµ‹å€¼è¯­å¥çš„é»˜è®¤è¡Œä¸º.</p>
<p>Pythonå¯¹äºåç§°çš„æŸ¥æ‰¾ä¹Ÿå…·æœ‰ä¸€ä¸ªä¸åŒå¯»å¸¸çš„é™åˆ¶: åœ¨å‡½æ•°ä½“å†…, æ‰€æœ‰çš„åç§°çš„å®ä¾‹å¿…é¡»è¦æŒ‡å‘åŒä¸€å¸§. å› æ­¤, Pythonåœ¨ä¸€ä¸ª<code>non-local</code>å¸§å†…ä¸èƒ½æŸ¥æ‰¾åˆ°åç§°çš„å€¼, å¹¶ç»‘å®šç›¸åŒçš„åç§°åˆ°æœ¬åœ°å¸§å†…, å› ä¸ºç›¸åŒçš„åç§°ä¼šåœ¨ä¸¤ä¸ªä¸åŒçš„å¸§å†…è¢«åŒä¸€ä¸ªç¨‹åºè®¿é—®åˆ°. è¿™ä¸ªé™åˆ¶å…è®¸Pythonåœ¨å‡½æ•°ä½“æ‰§è¡Œå‰é¢„å…ˆè®¡ç®—åŒ…å«æ¯ä¸ªåç§°çš„å¸§. å½“è¿™ä¸ªé™åˆ¶è¢«è¿åæ—¶, ä¼šäº§ç”Ÿæ··ä¹±çš„é”™è¯¯ç»“æœä¿¡æ¯. ä½œä¸ºæ¼”ç¤º, ä¸‹é¢é‡å¤<code>make_withdraw</code>ç¤ºä¾‹, å¹¶å»é™¤nonlocalè¯­å¥.</p>
<iframe width="800" height="500" frameborder="0" src="http://pythontutor.com/iframe-embed.html#code=def%20make_withdraw(balance%29%3A%0A%20%20%20%20def%20withdraw(amount%29%3A%0A%20%20%20%20%20%20%20%20if%20amount%20%3E%20balance%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20'Insufficient%20funds'%0A%20%20%20%20%20%20%20%20balance%20%3D%20balance%20-%20amount%0A%20%20%20%20%20%20%20%20return%20balance%0A%20%20%20%20return%20withdraw%0A%0Awd%20%3D%20make_withdraw(20%29%0Awd(5%29&codeDivHeight=400&codeDivWidth=350&cumulative=true&curInstr=0&origin=composingprograms.js&py=3&rawInputLstJSON=%5B%5D"> </iframe>
<p>å‡ºç°äº†è¿™ä¸ª<code>UnboundLocalError</code>é”™è¯¯æ˜¯å› ä¸º<code>balance</code>åœ¨ç¬¬äº”è¡Œè¢«æœ¬åœ°åˆ†é…äº†ä¸€ä¸ªæœ¬åœ°å€¼, å› æ­¤Pythonå‡è®¾æ‰€æœ‰å¯¹<code>balance</code>çš„å¼•ç”¨ä¹Ÿå¿…é¡»å‡ºç°åœ¨æœ¬åœ°å¸§å†…. è¿™ä¸ªé”™è¯¯å‡ºç°åœ¨ç¬¬äº”è¡Œè¢«æ‰§è¡Œå‰, æ„å‘³ç€Pythonåœ¨æ‰§è¡Œç¬¬ä¸‰è¡Œä¹‹å‰å·²ç»ä»¥æŸç§æ–¹å¼è€ƒè™‘äº†ç¬¬äº”è¡Œ. å½“æˆ‘ä»¬å­¦ä¹ è§£æå™¨è®¾è®¡æ—¶, æˆ‘ä»¬ä¼šäº†è§£åˆ°åœ¨å‡½æ•°ä½“æ‰§è¡Œä¹‹å‰è¿›è¡Œé¢„ç¼–è¯‘æ˜¯ç›¸å½“æ™®éçš„äº‹æƒ…. åœ¨è¿™ä¸ªä¾‹å­ä¸­, Pythonçš„é¢„ç¼–è¯‘é™åˆ¶å¸§å†…å¯èƒ½å‡ºç°<code>balance</code>, å› æ­¤é¢„å…ˆé˜»æ­¢æ‰¾åˆ°è¯¥åç§°. æ·»åŠ ä¸€ä¸ª<code>nonlocal</code>å£°æ˜å¯ä»¥ä¿®å¤è¿™ä¸ªé”™è¯¯. <code>nonlocal</code>å£°æ˜åœ¨Python 2ä¸­æ˜¯ä¸å­˜åœ¨çš„.</p>
<h4 id="éæœ¬åœ°èµ‹å€¼çš„å¥½å¤„">éæœ¬åœ°èµ‹å€¼çš„å¥½å¤„</h4>
<p>éæœ¬åœ°èµ‹å€¼åœ¨æˆ‘ä»¬å°†ç¨‹åºçœ‹ä½œæ˜¯ä¸€ä¸ªç‹¬ç«‹ä¸è‡ªæ²»çš„å¯¹è±¡(ä¹Ÿå°±æ˜¯å¯¹è±¡ä¹‹é—´ç›¸äº’äº¤äº’ä½†å„è‡ªç®¡ç†ä»–ä»¬è‡ªå·±å†…éƒ¨çš„çŠ¶æ€)çš„è·¯ä¸Šæ˜¯é‡è¦çš„ä¸€æ­¥.</p>
<p>å°¤å…¶æ˜¯éæœ¬åœ°èµ‹å€¼èµ‹äºˆäº†æˆ‘ä»¬èƒ½åŠ›æ¥ç®¡ç†ä¸€äº›å‡½æ•°çš„å†…éƒ¨çŠ¶æ€, ä½†æ˜¯åœ¨è°ƒç”¨è¿™ä¸ªå‡½æ•°æ—¶ä¼šå‘å±•å‡ºè¿‡åº¦çš„è¿ç»­æ€§. <code>balance</code>ä¸ç‰¹å®šçš„<code>withdraw</code>å‡½æ•°ç›¸è”ç³»å¹¶å…±äº«äºè¿™å‡½æ•°çš„æ‰€æœ‰è°ƒç”¨ä¸­. ç„¶è€Œä¸º<code>balance</code>ç»‘å®šåˆ°ç›¸è”ç³»çš„withdrawå®ä¾‹åœ¨ç¨‹åºçš„å…¶ä½™åœ°æ–¹æ˜¯ä¸å¯è®¿é—®çš„. åªæœ‰<code>wd</code>åœ¨å®ƒå®šä¹‰çš„<code>make_withdraw</code>å¸§å†…æ˜¯å¯è®¿é—®çš„. å¦‚æœ<code>make_withdraw</code>å†æ¬¡è¢«è°ƒç”¨é‚£ä¹ˆå®ƒä¼šåˆ›å»ºåŒ…å«ä¸€ä¸ªå•ç‹¬çš„<code>balance</code>ç»‘å®šçš„ä¸€ä¸ªå•ç‹¬çš„å¸§.</p>
<p>æˆ‘ä»¬å¯ä»¥æ‰©å±•æˆ‘ä»¬çš„ä¾‹å­æ¥æ¼”ç¤ºè¿™ä¸€ç‚¹. ç¬¬äºŒæ¬¡è°ƒç”¨<code>make_withdraw</code>è¿”å›ç¬¬äºŒä¸ªå…·æœ‰ä¸€ä¸ªä¸åŒçˆ¶çº§çš„<code>withdraw</code>å‡½æ•°.æˆ‘ä»¬ç»‘å®šè¿™ç¬¬äºŒä¸ªå‡½æ•°åˆ°å…¨å±€å¸§çš„åç§°wd2ä¸Š.</p>
<iframe width="800" height="500" frameborder="0" src="http://pythontutor.com/iframe-embed.html#code=def%20make_withdraw(balance%29%3A%0A%20%20%20%20def%20withdraw(amount%29%3A%0A%20%20%20%20%20%20%20%20nonlocal%20balance%0A%20%20%20%20%20%20%20%20if%20amount%20%3E%20balance%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20'Insufficient%20funds'%0A%20%20%20%20%20%20%20%20balance%20%3D%20balance%20-%20amount%0A%20%20%20%20%20%20%20%20return%20balance%0A%20%20%20%20return%20withdraw%0A%0Awd%20%3D%20make_withdraw(20%29%0Awd2%20%3D%20make_withdraw(7%29%0Awd2(6%29%0Awd(8%29&codeDivHeight=400&codeDivWidth=350&cumulative=true&curInstr=0&origin=composingprograms.js&py=3&rawInputLstJSON=%5B%5D"> </iframe>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥çœ‹åˆ°é‚£é‡Œå…¶å®æœ‰ä¸¤ä¸ªå¯¹<code>balance</code>çš„ç»‘å®šåœ¨ä¸¤ä¸ªä¸åŒçš„å¸§é‡Œé¢ï¼ŒåŒæ—¶æ¯ä¸€ä¸ª<code>withdraw</code>å‡½æ•°éƒ½æœ‰ä¸€ä¸ªä¸åŒçš„çˆ¶çº§. åç§°wdç»‘å®šåˆ°ä¸€ä¸ªå…·æœ‰<code>balance</code>ä¸º20çš„å‡½æ•°ä¸Š, åŒæ—¶wd2ç»‘å®šåˆ°ä¸€ä¸ªå…·æœ‰<code>balance</code>ä¸º7çš„ä¸åŒå‡½æ•°ä¸Š.</p>
<p>è°ƒç”¨wd2ä¼šä¿®æ”¹å®ƒçš„éæœ¬åœ°ç»‘å®šåç§°<code>balance</code>, ä½†ä¸ä¼šå½±å“ç»‘å®šåˆ°<code>withdraw</code>åç§°çš„å‡½æ•°. wdä¹‹åçš„è°ƒç”¨ä¸ä¼šå—åˆ°wd2ä¸­æ”¹å˜çš„<code>balance</code>çš„å½±å“, å®ƒçš„<code>balance</code>ä¾ç„¶æ˜¯20</p>
<iframe width="800" height="500" frameborder="0" src="http://pythontutor.com/iframe-embed.html#code=def%20make_withdraw(balance%29%3A%0A%20%20%20%20def%20withdraw(amount%29%3A%0A%20%20%20%20%20%20%20%20nonlocal%20balance%0A%20%20%20%20%20%20%20%20if%20amount%20%3E%20balance%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20'Insufficient%20funds'%0A%20%20%20%20%20%20%20%20balance%20%3D%20balance%20-%20amount%0A%20%20%20%20%20%20%20%20return%20balance%0A%20%20%20%20return%20withdraw%0A%0Awd%20%3D%20make_withdraw(20%29%0Awd2%20%3D%20make_withdraw(7%29%0Awd2(6%29%0Awd(8%29&codeDivHeight=400&codeDivWidth=350&cumulative=true&curInstr=0&origin=composingprograms.js&py=3&rawInputLstJSON=%5B%5D"> </iframe>
<p>é€šè¿‡è¿™ç§æ–¹å¼, æ¯ä¸€ä¸ª<code>withdraw</code>çš„å®ä¾‹ç»´æŠ¤ç€å®ƒè‡ªå·±çš„<code>balance</code>çŠ¶æ€, ä½†æ˜¯è¿™ä¸ªçŠ¶æ€å¯¹äºç¨‹åºä¸­å…¶ä»–ä»»ä½•ä¸€ä¸ªå‡½æ•°æ¥è¯´éƒ½æ˜¯ä¸å¯è®¿é—®çš„. åœ¨é«˜å±‚çº§æ¥çœ‹è¿™ç§æƒ…å†µ, æˆ‘ä»¬å·²ç»åˆ›å»ºäº†ä¸€ä¸ªä¼šç®¡ç†å®ƒè‡ªå·±çš„å†…éƒ¨ä½†æ˜¯ä»¥æŸç§æ–¹å¼æ´»åŠ¨çš„ç”Ÿæ´»ä¸­çš„è´¦æˆ·æ¨¡å‹çš„é“¶è¡Œè´¦æˆ·çš„æŠ½è±¡.</p>
<h4 id="246-éæœ¬åœ°èµ‹å€¼çš„æˆæœ¬">2.4.6 éæœ¬åœ°èµ‹å€¼çš„æˆæœ¬</h4>
<p>æˆ‘ä»¬çš„è®¡ç®—ç¯å¢ƒæ¨¡å‹æ¸…æ™°åœ°æ‹“å±•åˆ°è§£é‡Šéæœ¬åœ°èµ‹å€¼çš„å½±å“. ç„¶è€Œ, éæœ¬åœ°èµ‹å€¼ä»‹ç»äº†ä¸€äº›åœ¨æˆ‘ä»¬æ€è€ƒåç§°ä»¥åŠå€¼çš„æ–¹å¼ä¸Šçš„é‡è¦çš„ç»†å¾®å·®åˆ«.</p>
<p>ä¹‹å‰, æˆ‘ä»¬çš„å€¼æ˜¯ä¸ä¼šä¿®æ”¹çš„; åªæœ‰æˆ‘ä»¬çš„åç§°ä»¥åŠç»‘å®šä¼šä¿®æ”¹, å½“ä¸¤ä¸ªåç§°aä»¥åŠbéƒ½ç»‘å®šåˆ°ä¸€ä¸ªå€¼ 4 ä¸Šæ—¶, å®ƒä»¬æ˜¯å¦ç»‘å®šåˆ°ç›¸åŒçš„æˆ–è€…æ˜¯ä¸åŒçš„ 4 æ˜¯æ— æ‰€è°“çš„, æ®æˆ‘ä»¬æ‰€çŸ¥, åªæœ‰ä¸€ä¸ª 4 å¯¹è±¡ä¸”ä»ä¸æ”¹å˜.</p>
<p>ç„¶è€Œ, å…·æœ‰çŠ¶æ€çš„å‡½æ•°ä¸æ˜¯ä»¥è¿™ç§è¡Œä¸ºæ–¹å¼. å½“ä¸¤ä¸ªåç§° wd ä»¥åŠ wd2 éƒ½ç»‘å®šåˆ°ä¸€ä¸ª<code>withdraw</code>å‡½æ•°ä¸Šæ—¶, å¯¹äºå®ƒä»¬æ˜¯å¦ç»‘å®šåˆ°åŒä¸€ä¸ªå‡½æ•°æˆ–è€…è¿™ä¸ªå‡½æ•°çš„ä¸åŒå®ä¾‹ä¸Šæ˜¯æœ‰å…³ç³»çš„. è€ƒè™‘ä¸€ä¸‹ä¸‹é¢çš„ä¾‹å­, å®ƒä¸æˆ‘ä»¬åˆšåˆšåˆ†æçš„ä¾‹å­ç›¸å¯¹æ¯”. åœ¨è¿™ç§æƒ…å†µä¸‹, è°ƒç”¨å‘½åä¸º wd2 çš„å‡½æ•°ä¼šä¿®æ”¹å‘½åä¸º wd çš„å‡½æ•°çš„å€¼, å› ä¸ºè¿™äº›åå­—éƒ½æ˜¯å¼•ç”¨åŒä¸€ä¸ªå‡½æ•°.</p>
<iframe width="800" height="500" frameborder="0" src="http://pythontutor.com/iframe-embed.html#code=def%20make_withdraw(balance%29%3A%0A%20%20%20%20def%20withdraw(amount%29%3A%0A%20%20%20%20%20%20%20%20nonlocal%20balance%0A%20%20%20%20%20%20%20%20if%20amount%20%3E%20balance%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20'Insufficient%20funds'%0A%20%20%20%20%20%20%20%20balance%20%3D%20balance%20-%20amount%0A%20%20%20%20%20%20%20%20return%20balance%0A%20%20%20%20return%20withdraw%0A%0Awd%20%3D%20make_withdraw(12%29%0Awd2%20%3D%20wd%0Awd2(1%29%0Awd(1%29&codeDivHeight=400&codeDivWidth=350&cumulative=true&curInstr=0&origin=composingprograms.js&py=3&rawInputLstJSON=%5B%5D"> </iframe>
<p>ä¸–ç•Œä¸Šç”¨ä¸¤ä¸ªåç§°å…±åŒå¼•ç”¨åŒä¸€ä¸ªå€¼æ˜¯å¾ˆå¸¸è§çš„, æ‰€ä»¥å®ƒå­˜åœ¨æˆ‘ä»¬çš„ç¨‹åºå½“ä¸­. ä½†æ˜¯, å€¼ä¼šéšç€æ—¶é—´è€Œå˜åŒ–, æˆ‘ä»¬å¿…é¡»è¦å°å¿ƒç†è§£å¯¹äºä¿®æ”¹å…¶ä»–åç§°è€Œå½±å“åˆ°è¿™äº›åç§°ä¼šå¸¦æ¥çš„ç»“æœ.</p>
<p>æ­£ç¡®åœ°åˆ†æå¸¦æœ‰åˆ†æœ¬åœ°èµ‹å€¼çš„ä»£ç çš„å…³é”®æ˜¯è¦è®°ä½, åªæœ‰å‡½æ•°è°ƒç”¨å¯ä»¥å¼•å…¥æ–°çš„å¸§. èµ‹å€¼è¯­å¥æ€»æ˜¯åœ¨å·²å­˜åœ¨çš„å¸§å†…ä¿®æ”¹ç»‘å®š. åœ¨è¿™ç§æƒ…å†µä¸‹, é™¤éè°ƒç”¨<code>make_withdraw</code>ä¸¤æ¬¡, å¦åˆ™åªèƒ½ç»‘å®šä¸€æ¬¡<code>balance</code>.</p>
<p><strong>ç›¸åŒå’Œæ”¹å˜</strong>. æå‡ºè¿™äº›ç»†å¾®ä¹‹å¤„æ˜¯å› ä¸ºéšç€ä¼šä¿®æ”¹åˆ†æœ¬åœ°ç¯å¢ƒçš„éçº¯å‡½æ•°çš„å¼•å…¥, æˆ‘ä»¬å·²ç»æ”¹å˜äº†è¡¨è¾¾å¼çš„æ€§è´¨. ä¸€ä¸ªè¡¨è¾¾å¼åªåŒ…å«çº¯å‡½æ•°è°ƒç”¨çš„è¯æ˜¯å¯é é€æ˜çš„; å¦‚æœæˆ‘ä»¬ç”¨å…¶å­è¡¨è¾¾å¼çš„å€¼æ›¿æ¢å…¶å­è¡¨è¾¾å¼ä¹‹ä¸€, å®ƒçš„å€¼ä¸ä¼šä¿®æ”¹.</p>
<p>é‡æ–°ç»‘å®šæ“ä½œç¬¦è¿åäº†é€æ˜å¼•ç”¨è¿™ä¸ªæ¡ä»¶å› ä¸ºå®ƒä»¬é™¤äº†è¿”å›ä¸€ä¸ªå€¼è¿˜åšäº†æ›´å¤šçš„äº‹æƒ…; å®ƒä»¬ä¿®æ”¹äº†ç¯å¢ƒ. å½“æˆ‘ä»¬å¼•å…¥ä»»æ„é‡ç»‘å®š, æˆ‘ä»¬å°±é‡åˆ°äº†ä¸€ä¸ªæ£˜æ‰‹çš„è®¤è¯†è®ºé—®é¢˜: å®ƒæ„å‘³ç€ä¸¤ä¸ªå€¼æ˜¯ç›¸ç­‰çš„. åœ¨æˆ‘ä»¬çš„è®¡ç®—ç¯å¢ƒæ¨¡å‹ä¸­, åˆ†åˆ«å®šä¹‰çš„ä¸¤ä¸ªå‡½æ•°ä¸æ˜¯ç›¸åŒçš„, å› ä¸ºä¿®æ”¹ä¸€ä¸ªåº”è¯¥ä¸ä¼šå…³è”åˆ°å¦å¤–ä¸€ä¸ª.</p>
<p>ä¸€èˆ¬æ¥è¯´, åªè¦æˆ‘ä»¬ä»æ¥æ²¡æœ‰ä¿®æ”¹æ•°æ®å¯¹è±¡, æˆ‘ä»¬å¯ä»¥è®¤ä¸ºå¤åˆæ•°æ®å¯¹è±¡æ°å¥½å°±æ˜¯å®ƒæ‰€æœ‰éƒ¨åˆ†çš„æ€»å’Œ. ä¾‹å¦‚, ä¸€ä¸ªæœ‰ç†æ•°å–å†³äºç»™å®šå®ƒä¸€ä¸ªåˆ†å­å’Œåˆ†æ¯. ä½†æ˜¯è¿™ç§è§‚ç‚¹åœ¨å­˜åœ¨å˜åŒ–çš„æƒ…å†µä¸‹å·²ç»ä¸åœ¨æœ‰æ•ˆ, ä¹Ÿå°±æ˜¯ä¸€ä¸ªå¤åˆæ•°æ®å¯¹è±¡å…·æœ‰ä¸€ä¸ª&quot;èº«ä»½æ ‡è¯†&rdquo;, ç”¨æ¥è·Ÿå®ƒç»„æˆçš„ç‰‡æ®µæ¥è¿›è¡ŒåŒºåˆ†çš„. ä¸€ä¸ªé“¶è¡Œè´¦æˆ·ä¾ç„¶æ˜¯&quot;åŒä¸€ä¸ª&quot;é“¶è¡Œè´¦æˆ·, å³ä½¿æˆ‘ä»¬é€šè¿‡æ”¯å–æ¥ä¿®æ”¹äº†ä½™é¢; åè¿‡æ¥, æˆ‘ä»¬å¯ä»¥æœ‰ä¸¤ä¸ªæ°å·§æœ‰ç›¸åŒä½™é¢çš„è´¦æˆ·, ä½†æ˜¯æ˜¯ä¸¤ä¸ªä¸åŒçš„å¯¹è±¡.</p>
<p>å°½ç®¡å®ƒå¼•å…¥äº†å¤æ‚æ€§, éæœ¬åœ°èµ‹å€¼ä¾ç„¶æ˜¯ä¸€ä¸ªåˆ›å»ºæ¨¡å—åŒ–ç¨‹åºçš„å¼ºåŠ›å·¥å…·. ç¨‹åºçš„ä¸åŒéƒ¨åˆ†å¯¹åº”ç€ä¸åŒçš„ç¯å¢ƒå¸§, èƒ½å¤Ÿéšç€è½¯ä»¶çš„æ‰§è¡Œæ¥åˆ†åˆ«æ¼”è¿›. æ­¤å¤–, ä½¿ç”¨å¸¦æœ‰æœ¬åœ°çŠ¶æ€çš„å‡½æ•°, æˆ‘ä»¬èƒ½å¤Ÿå®ç°å¯å˜æ•°æ®ç±»å‹. å®é™…ä¸Š, æˆ‘ä»¬å¯ä»¥å®ç°ç›¸å½“äºä¸Šé¢æåˆ°çš„å…§å»ºçš„listä»¥åŠdictç±»å‹çš„æŠ½è±¡æ•°æ®ç±»å‹.</p>
<h4 id="247-åˆ—è¡¨ä»¥åŠå­—å…¸çš„å®ç°">2.4.7 åˆ—è¡¨ä»¥åŠå­—å…¸çš„å®ç°</h4>
<p>Pythonè¯­è¨€å¹¶ä¸å…è®¸æˆ‘ä»¬è®¿é—®åˆ—è¡¨çš„å®ç°, åªæ˜¯å…§å»ºäº†åºåˆ—æŠ½è±¡ä»¥åŠå˜åŠ¨æ–¹æ³•åˆ°è¯­è¨€é‡Œé¢å». å¯ä»¥é€šè¿‡å…·æœ‰æœ¬åœ°çŠ¶æ€çš„å‡½æ•°æ¥ç†è§£å¯å˜åˆ—è¡¨æ˜¯å¦‚ä½•è¿›è¡Œè¡¨ç¤ºçš„, ç°åœ¨æˆ‘ä»¬å°†ä¼šå¼€å‘ä¸€ä¸ªå¯å˜çš„é“¾è¡¨å®ç°.</p>
<p>æˆ‘ä»¬ä¼šé€šè¿‡ä¸€ä¸ªå…·æœ‰é“¾è¡¨ä½œä¸ºå®ƒçš„æœ¬åœ°çŠ¶æ€çš„å‡½æ•°æ¥è¡¨ç°ä¸€ä¸ªå¯å˜é“¾è¡¨, åˆ—è¡¨éœ€è¦æœ‰ä¸€ä¸ªèº«ä»½, å°±åƒå…¶ä»–ä»»ä½•å¯å˜å€¼. å°¤å…¶æ˜¯, æˆ‘ä»¬ä¸èƒ½ç”¨ None æ¥ä»£è¡¨ä¸€ä¸ªç©ºçš„å¯å˜åˆ—è¡¨, å› ä¸ºä¸¤ä¸ªç©ºçš„åˆ—è¡¨ä¸æ˜¯ç›¸åŒçš„å€¼(ä¾‹å¦‚: ä¸ºå…¶ä¸­ä¸€ä¸ªåˆ—è¡¨æ’å…¥å…ƒç´ å¹¶ä¸ä¼šæ’å…¥åˆ°å¦ä¸€ä¸ªå½“ä¸­), ä½†æ˜¯ None å°±æ˜¯ None. å¦ä¸€æ–¹é¢, ä¸¤ä¸ªéƒ½å…·æœ‰<code>empty</code>ä½œä¸ºå®ƒçš„æœ¬åœ°çŠ¶æ€çš„ä¸åŒçš„å‡½æ•°å°†è¶³ä»¥ç”¨æ¥åŒºåˆ†ä¸¤ä¸ªç©ºåˆ—è¡¨.</p>
<p>å¦‚æœä¸€ä¸ªå¯å˜é“¾è¡¨æ˜¯ä¸€ä¸ªå‡½æ•°, å®ƒä¼šéœ€è¦ä»€ä¹ˆä¼ å…¥ä»€ä¹ˆå‚æ•°å‘¢? ç­”æ¡ˆå±•ç¤ºäº†ç¼–ç¨‹ä¸­çš„ä¸€èˆ¬æ¨¡å¼: è¿™ä¸ªå‡½æ•°æ˜¯ä¸€ä¸ªè°ƒåº¦å‡½æ•°åŒæ—¶å®ƒçš„å‚æ•°é¦–å…ˆæ˜¯ä¸€ä¸ªæ¶ˆæ¯, åé¢è·Ÿç€å‚æ•°åŒ–è¯¥æ–¹æ³•çš„å…¶ä»–å‚æ•°. è¿™ä¸ªæ¶ˆæ¯æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²åç§°è¡¨ç¤ºè¿™ä¸ªå‡½æ•°åº”è¯¥åšä»€ä¹ˆ. è°ƒåº¦å‡½æ•°å®é™…ä¸Šé›†åˆäº†è®¸å¤šçš„å‡½æ•°: ç”¨æ¶ˆæ¯ç¡®å®šå‡½æ•°çš„è¡Œä¸º, ä»¥åŠå°†é¢å¤–çš„å‚æ•°ç”¨åœ¨è¿™ä¸ªè¡Œä¸ºä¸Š.</p>
<p>æˆ‘ä»¬çš„å¯å˜åˆ—è¡¨ä¼šå›åº”5ç§ä¸åŒçš„æ¶ˆæ¯: <code>len</code>, <code>getitem</code>, <code>push_first</code>, <code>pop_first</code>, ä»¥åŠ<code>str</code>. å‰ä¸¤ä¸ªå®ç°åºåˆ—æŠ½è±¡çš„è¡Œä¸º. æ¥ä¸‹æ¥çš„ä¸¤ä¸ªç”¨äºå¢åŠ æˆ–è€…ç§»é™¤åˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ . æœ€åä¸€ä¸ªæ¶ˆæ¯è¿”å›ä»£è¡¨æ•´ä¸ªé“¾è¡¨çš„å­—ç¬¦ä¸².</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">mutable_link</span><span class="p">():</span>
        <span class="s2">&#34;&#34;&#34;Return a functional implementation of a mutable linked list.&#34;&#34;&#34;</span>
        <span class="n">contents</span> <span class="o">=</span> <span class="n">empty</span>
        <span class="k">def</span> <span class="nf">dispatch</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">message</span> <span class="o">==</span> <span class="s1">&#39;len&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">len_link</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">message</span> <span class="o">==</span> <span class="s1">&#39;getitem&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">getitem_link</span><span class="p">(</span><span class="n">contents</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">message</span> <span class="o">==</span> <span class="s1">&#39;push_first&#39;</span><span class="p">:</span>
                <span class="n">contents</span> <span class="o">=</span> <span class="n">link</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">contents</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">message</span> <span class="o">==</span> <span class="s1">&#39;pop_first&#39;</span><span class="p">:</span>
                <span class="n">f</span> <span class="o">=</span> <span class="n">first</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span>
                <span class="n">contents</span> <span class="o">=</span> <span class="n">rest</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">f</span>
            <span class="k">elif</span> <span class="n">message</span> <span class="o">==</span> <span class="s1">&#39;str&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">join_link</span><span class="p">(</span><span class="n">contents</span><span class="p">,</span> <span class="s1">&#39;, &#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dispatch</span>
</code></pre></td></tr></table>
</div>
</div><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥å¢åŠ ä¸€ä¸ªç®€ä¾¿å‡½æ•°æ¥ä»ä»»ä½•çš„å…§å»ºåºåˆ—ä¸­æ„é€ ä¸€ä¸ªå®ç°äº†åŠŸèƒ½çš„é“¾è¡¨, ç®€å•åœ°ç›¸åçš„é¡ºåºæ¥æ·»åŠ æ¯ä¸€ä¸ªå…ƒç´ .</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">to_mutable_link</span><span class="p">(</span><span class="n">source</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;Return a functional list with the same contents as source.&#34;&#34;&#34;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">mutable_link</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
            <span class="n">s</span><span class="p">(</span><span class="s1">&#39;push_first&#39;</span><span class="p">,</span> <span class="n">element</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">s</span>
</code></pre></td></tr></table>
</div>
</div><p>åœ¨ä¸Šé¢çš„å®šä¹‰ä¸­, å‡½æ•°<code>reversed</code>æ¥å—å¹¶è¿”å›ä¸€ä¸ªå¯è¿­ä»£çš„å€¼; è¿™æ˜¯å¦ä¸€ä¸ªå‡½æ•°å¤„ç†åºåˆ—çš„ä¾‹å­.</p>
<p>åˆ°ç°åœ¨, æˆ‘ä»¬å¯ä»¥æ„é€ ä¸€ä¸ªå®ç°äº†åŠŸèƒ½çš„å¯å˜é“¾è¡¨. è¦æ³¨æ„è¿™ä¸ªé“¾è¡¨æœ¬èº«æ˜¯ä¸€ä¸ªå‡½æ•°.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">s</span> <span class="o">=</span> <span class="n">to_mutable_link</span><span class="p">(</span><span class="n">suits</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">function</span><span class="s1">&#39;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="p">(</span><span class="s1">&#39;str&#39;</span><span class="p">))</span>
<span class="n">heart</span><span class="p">,</span> <span class="n">diamond</span><span class="p">,</span> <span class="n">spade</span><span class="p">,</span> <span class="n">club</span>
</code></pre></td></tr></table>
</div>
</div><p>æ­¤å¤–, æˆ‘ä»¬å¯ä»¥è¾“å…¥ä¿¡æ¯åˆ°åˆ—è¡¨ <code>s</code> æ¥æ”¹å˜å®ƒçš„å†…å®¹, ä¸ºå®ä¾‹ç§»é™¤å®ƒçš„ç¬¬ä¸€ä¸ªå…ƒç´ .</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">s</span><span class="p">(</span><span class="s1">&#39;pop_first&#39;</span><span class="p">)</span>
<span class="s1">&#39;heart&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="p">(</span><span class="s1">&#39;str&#39;</span><span class="p">))</span>
<span class="n">diamond</span><span class="p">,</span> <span class="n">spade</span><span class="p">,</span> <span class="n">club</span>
</code></pre></td></tr></table>
</div>
</div><p>åŸåˆ™ä¸Š, <code>push_first</code>ä»¥åŠ<code>pop_first</code>è¶³ä»¥å¯¹åˆ—è¡¨è¿›è¡Œä»»æ„æ›´æ”¹. æˆ‘ä»¬å¯ä»¥æ€»æ˜¯æ¸…ç©ºæ•´ä¸ªåˆ—è¡¨ç„¶åç”¨æœŸæœ›çš„ç»“æœæ¥æ›¿æ¢å®ƒçš„æ—§å†…å®¹.</p>
<p><strong>æ¶ˆæ¯ä¼ é€’</strong>. ç»™å®šä¸€äº›æ—¶é—´, æˆ‘ä»¬å¯ä»¥å®ç°å¾ˆå¤šPythonåˆ—è¡¨çš„æœ‰ç”¨çš„å˜åŠ¨æ“ä½œ. ä¾‹å¦‚<code>extend</code>ä»¥åŠ<code>insert</code>. å¯¹æ­¤æˆ‘ä»¬å¯ä»¥è¿›è¡Œé€‰æ‹©: æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å·²å­˜åœ¨çš„æ¶ˆæ¯<code>pop_first</code>ä»¥åŠ<code>push_first</code>æ¥è¿›è¡Œæ‰€æœ‰çš„æ›´æ”¹å°†å®ƒä»¬éƒ½å®ç°åœ¨ä¸€ä¸ªå‡½æ•°é‡Œé¢. æˆ–è€…, æˆ‘ä»¬å¯ä»¥æ·»åŠ é¢å¤–çš„<code>elif</code>æ¡ä»¶åˆ°<code>dispatch</code>å‡½æ•°ä½“ä¸­, æ¯ä¸€ä¸ªå¯¹ä¸€ç§æ¶ˆæ¯è¿›è¡Œæ£€æŸ¥(ä¾‹å¦‚: <code>extend</code>)ä»¥åŠç›´æ¥åº”ç”¨é€‚å½“çš„ä¿®æ”¹åˆ°å†…å®¹å½“ä¸­.</p>
<p>ç¬¬äºŒç§æ–¹æ³•, å°±æ˜¯å°†æ‰€æœ‰æ“ä½œçš„é€»è¾‘å°è£…åˆ°å“åº”ä¸åŒæ¶ˆæ¯çš„ä¸€ä¸ªå‡½æ•°å†…çš„æ•°æ®å€¼ä¸Š, è¿™æ˜¯ä¸€ç§ç§°ä¸ºæ¶ˆæ¯ä¼ é€’çš„è§„åˆ™. ä¸€ä¸ªä½¿ç”¨æ¶ˆæ¯ä¼ é€’æ¥å®šä¹‰è°ƒåº¦å‡½æ•°çš„ç¨‹åº, æ¯ä¸€ä¸ªè¿™ç§å‡½æ•°éƒ½å¯ä»¥å…·æœ‰å±€éƒ¨çŠ¶æ€, ä»¥åŠé€šè¿‡ä¼ é€’&quot;æ¶ˆæ¯&quot;ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°æ¥ç»„ç»‡è®¡ç®—. æ¶ˆæ¯æ˜¯å¯¹åº”ç‰¹æ®Šè¡Œä¸ºçš„å­—ç¬¦ä¸².</p>
<p><strong>å®ç°å­—å…¸</strong>. æˆ‘ä»¬è¿˜å¯ä»¥å®ç°ä¸€ä¸ªå…·æœ‰è·Ÿå­—å…¸ç±»ä¼¼è¡Œä¸ºçš„å€¼. åœ¨è¿™ç§æƒ…å†µä¸‹, æˆ‘ä»¬ç”¨ä¸€ä¸ªé”®å€¼å¯¹çš„åˆ—è¡¨æ¥ä¿å­˜å­—å…¸çš„å†…å®¹. æ¯ä¸ªå¯¹æ˜¯ä¸€ä¸ªä¸¤ä¸ªå…ƒç´ çš„åˆ—è¡¨.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">dictionary</span><span class="p">():</span>
        <span class="s2">&#34;&#34;&#34;Return a functional implementation of a dictionary.&#34;&#34;&#34;</span>
        <span class="n">records</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">def</span> <span class="nf">getitem</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
            <span class="n">matches</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">records</span> <span class="k">if</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">key</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">matches</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">matches</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">return</span> <span class="n">value</span>
        <span class="k">def</span> <span class="nf">setitem</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
            <span class="n">nonlocal</span> <span class="n">records</span>
            <span class="n">non_matches</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">records</span> <span class="k">if</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">key</span><span class="p">]</span>
            <span class="n">records</span> <span class="o">=</span> <span class="n">non_matches</span> <span class="o">+</span> <span class="p">[[</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">]]</span>
        <span class="k">def</span> <span class="nf">dispatch</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">message</span> <span class="o">==</span> <span class="s1">&#39;getitem&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">getitem</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">message</span> <span class="o">==</span> <span class="s1">&#39;setitem&#39;</span><span class="p">:</span>
                <span class="n">setitem</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">dispatch</span>
</code></pre></td></tr></table>
</div>
</div><p>å†ä¸€æ¬¡, æˆ‘ä»¬ç”¨æ¶ˆæ¯ä¼ è¾“æ–¹æ³•æ¥ç»„ç»‡æˆ‘ä»¬çš„å®ç°. æˆ‘ä»¬å·²ç»æ”¯æŒä¸¤ä¸ªæ¶ˆæ¯: <code>getitem</code>å’Œ<code>setitem</code>. ä¸ºä¸€ä¸ªé”®æ’å…¥ä¸€ä¸ªå€¼, æˆ‘ä»¬è¿‡æ»¤å‡ºä»»ä½•ç»™å®šé”®çš„å­˜åœ¨è®°å½•, ç„¶åæ·»åŠ ä¸€ä¸ª. é€šè¿‡è¿™ç§æ–¹å¼, æˆ‘ä»¬ä¿è¯æ¯ä¸€ä¸ªé”®å€¼åœ¨è®°å½•ä¸­åªå‡ºç°ä¸€æ¬¡. è¦ä¸ºä¸€ä¸ªé”®æ‰¾å‡ºå®ƒçš„å€¼, æˆ‘ä»¬è¿‡æ»¤å‡ºç¬¦åˆç»™å®šçš„é”®çš„å€¼. æˆ‘ä»¬ç°åœ¨å¯ä»¥ç”¨æˆ‘ä»¬çš„å®ç°æ¥ä¿å­˜ä»¥åŠæ£€ç´¢å€¼.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">d</span> <span class="o">=</span> <span class="n">dictionary</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d</span><span class="p">(</span><span class="s1">&#39;setitem&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d</span><span class="p">(</span><span class="s1">&#39;setitem&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d</span><span class="p">(</span><span class="s1">&#39;getitem&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="mi">9</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d</span><span class="p">(</span><span class="s1">&#39;getitem&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="mi">16</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿™ç§å®ç°çš„å­—å…¸æ²¡æœ‰ä¸ºå¿«é€ŸæŸ¥æ‰¾ä½œä¼˜åŒ–, å› ä¸ºæ¯ä¸€æ¬¡è°ƒç”¨å¿…é¡»è¦è¿‡æ»¤å…¨éƒ¨çš„è®°å½•. å…§å»ºçš„å­—å…¸ç±»å‹æ˜¯ååˆ†é«˜æ•ˆçš„. å®ƒçš„å®ç°æ–¹å¼è¶…å‡ºäº†æœ¬æ–‡çš„èŒƒå›´.</p>
<h4 id="248-è°ƒåº¦å­—å…¸">2.4.8 è°ƒåº¦å­—å…¸</h4>
<p>è°ƒåº¦å‡½æ•°æ˜¯ä¸ºæŠ½è±¡æ•°æ®å®ç°æ¶ˆæ¯ä¼ é€’æ¥å£çš„ä¸€èˆ¬æ–¹æ³•. ä¸ºäº†å®ç°æ¶ˆæ¯è°ƒåº¦, è¿„ä»Šä¸ºæ­¢æˆ‘ä»¬ä½¿ç”¨æ¡ä»¶è¯­å¥æ¥å¯¹æ¯”æ¶ˆæ¯å­—ç¬¦ä¸²è·Ÿå·²çŸ¥æ¶ˆæ¯çš„å›ºå®šé›†.</p>
<p>å…§å»ºçš„å­—å…¸æ•°æ®ç±»å‹æä¾›ä¸€ä¸ªä¸€èˆ¬çš„æ–¹æ³•æ¥æŸ¥æ‰¾ä¸€ä¸ªé”®çš„å€¼. è€Œä¸æ˜¯ä½¿ç”¨æ¡ä»¶æ¥å®ç°æ´¾å‘, æˆ‘ä»¬å¯ä»¥ç”¨å­—ç¬¦ä¸²ä½œä¸ºå­—å…¸çš„é”®.</p>
<p>ä¸‹é¢çš„å¯å˜<code>account</code>æ•°æ®ç±»å‹å®ç°ä¸ºä¸€ä¸ªå­—å…¸. å®ƒæœ‰ä¸€ä¸ªæ„é€ å™¨<code>account</code>ä»¥åŠä¸€ä¸ªé€‰æ‹©å™¨<code>check_balance</code>, ä»¥åŠç”¨äºå­˜å‚¨(deposit)æˆ–è€…å–å‡º(withdraw)èµ„é‡‘çš„å‡½æ•°. æ­¤å¤–, è´¦æˆ·çš„æœ¬åœ°çŠ¶æ€ä¹Ÿè¢«ä¿å­˜åœ¨å­—å…¸å‘¨å›´å®ç°å®ƒçš„åŠŸèƒ½çš„å‡½æ•°ä¸­.</p>
<iframe width="800" height="500" frameborder="0" src="http://pythontutor.com/iframe-embed.html#code=def%20account(initial_balance%29%3A%0A%20%20%20%20def%20deposit(amount%29%3A%0A%20%20%20%20%20%20%20%20dispatch%5B'balance'%5D%20%2B%3D%20amount%0A%20%20%20%20%20%20%20%20return%20dispatch%5B'balance'%5D%0A%20%20%20%20def%20withdraw(amount%29%3A%0A%20%20%20%20%20%20%20%20if%20amount%20%3E%20dispatch%5B'balance'%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20'Insufficient%20funds'%0A%20%20%20%20%20%20%20%20dispatch%5B'balance'%5D%20-%3D%20amount%0A%20%20%20%20%20%20%20%20return%20dispatch%5B'balance'%5D%0A%20%20%20%20dispatch%20%3D%20%7B'deposit'%3A%20%20%20deposit,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'withdraw'%3A%20%20withdraw,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'balance'%3A%20%20%20initial_balance%7D%0A%20%20%20%20return%20dispatch%0A%0Adef%20withdraw(account,%20amount%29%3A%0A%20%20%20%20return%20account%5B'withdraw'%5D(amount%29%0Adef%20deposit(account,%20amount%29%3A%0A%20%20%20%20return%20account%5B'deposit'%5D(amount%29%0Adef%20check_balance(account%29%3A%0A%20%20%20%20return%20account%5B'balance'%5D%0A%0Aa%20%3D%20account(20%29%0Adeposit(a,%205%29%0Awithdraw(a,%2017%29%0Acheck_balance(a%29&codeDivHeight=400&codeDivWidth=350&cumulative=true&curInstr=0&origin=composingprograms.js&py=3&rawInputLstJSON=%5B%5D"> </iframe>
<p><code>account</code>æ„é€ å™¨å‡½æ•°ä½“å†…çš„<code>dispatch</code>åˆ°ä¸€ä¸ªåŒ…å«ç”±å¸æˆ·æ¥å—çš„æ¶ˆæ¯ä½œä¸ºé”®çš„å­—å…¸è¿›è¡Œç»‘å®š. å½“å­˜æ¬¾ä»¥åŠå–æ¬¾æ¶ˆæ¯ç»‘å®šè·Ÿå‡½æ•°ç»‘å®š, ä½™é¢å°±æ˜¯ä¸€ä¸ªæ•°å­—. è¿™äº›å‡½æ•°èƒ½å¤Ÿè®¿é—®<code>dispatch</code>å­—å…¸, åŒæ—¶, å®ƒä»¬ä¹Ÿå¯ä»¥æŸ¥çœ‹ä»¥åŠä¿®æ”¹ä½™é¢. é€šè¿‡ä¿å­˜ä½™é¢åœ¨dispatchå­—å…¸ä¸­è€Œä¸æ˜¯ç›´æ¥ä¿å­˜åœ¨åœ¨accountå‡½æ•°å¸§ä¸­, æˆ‘ä»¬é¿å…äº†åœ¨<code>deposit</code>ä»¥åŠ<code>withdraw</code>ä¸­éœ€è¦ç”¨åˆ°<code>nonlocal</code>å£°æ˜.</p>
<p><code>+=</code>ä»¥åŠ<code>-=</code>æ“ä½œæ˜¯Python(ä»¥åŠå…¶ä»–è®¸å¤šè¯­è¨€)ä¸­ç”¨äºç»„åˆæŸ¥æ‰¾å’Œé‡æ–°åˆ†é…çš„ç®€ä¾¿æ–¹æ³•. ç›¸å½“äºä¸‹é¢çš„æœ€åä¸¤è¡Œ.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">+=</span> <span class="mi">1</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="249-ä¼ æ’­çº¦æŸ">2.4.9 ä¼ æ’­çº¦æŸ</h4>
<p>å¯å˜æ•°æ®å…è®¸æˆ‘ä»¬å»æ¨¡æ‹Ÿå…·æœ‰æ”¹å˜çš„ç³»ç»Ÿ, ä¹Ÿå…è®¸æˆ‘ä»¬å»æ„å»ºæ–°ç±»å‹çš„æŠ½è±¡. åœ¨è¿™ä¸ªæ‰©å±•ä¾‹å­ä¸­, æˆ‘ä»¬ç»„åˆéæœ¬åœ°å£°æ˜, åˆ—è¡¨, ä»¥åŠå­—å…¸æ¥æ„å»ºä¸€ä¸ªåŸºç¡€çº¦æŸçš„ç³»ç»Ÿ, å®ƒæ”¯æŒå¤šç§è¯´æ˜çš„è®¡ç®—. ä½œä¸ºçº¦æŸçš„è¡¨è¾¾å¼ç¨‹åºæ˜¯å£°æ˜æ€§ç¼–ç¨‹çš„ä¸€ç§ç±»å‹, ä¹Ÿå°±æ˜¯ä¸€ä¸ªç¨‹åºå‘˜å£°æ˜è¦å»è§£å†³çš„é—®é¢˜çš„ç»“æ„, ä½†æ˜¯æŠ½è±¡å‡ºäº†ç©¶ç«Ÿå¦‚ä½•è®¡ç®—é—®é¢˜çš„è§£å†³æ–¹æ¡ˆçš„ç»†èŠ‚ã€‚.</p>
<p>è®¡ç®—æœºç¨‹åºä¼ ç»Ÿä¸Šæ˜¯ç»„ç»‡ä¸ºå•æ–¹å‘è®¡ç®—çš„, ä¹Ÿå°±æ˜¯åœ¨é¢„å…ˆæŒ‡å®šçš„å‚æ•°ä¸Šæ‰§è¡Œæ“ä½œæ¥ç”Ÿäº§æœŸæœ›çš„è¾“å‡º. å¦ä¸€æ–¹é¢, æˆ‘ä»¬é€šå¸¸æƒ³è¦ä»¥æ•°é‡çš„å…³ç³»æ¥å¯¹ç³»ç»Ÿå»ºæ¨¡. ä¾‹å¦‚, æˆ‘ä»¬ä»¥å‰æ€è€ƒè¿‡çš„ç†æƒ³æ°”ä½“å®šå¾‹, å®ƒæ˜¯é€šè¿‡ç»å°”å…¹æ›¼å¸¸æ•°(k)æ¥è·Ÿå‹åŠ›(p), ä½“ç§¯(v), æ•°é‡(n), ä»¥åŠæ¸©åº¦(t)ç›¸å…³çš„.</p>
<p><code>p * v = n * k * t</code></p>
<p>è¿™æ ·çš„ä¸€ä¸ªæ–¹ç¨‹ä¸æ˜¯å•é¡¹çš„. æœ‰ä»»æ„å››ä¸ªç»™å®šçš„æ•°é‡, æˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªç­‰å¼æ¥è®¡ç®—ç¬¬äº”ä¸ª. ç„¶è€Œå°†è¿™ä¸ªç­‰å¼è½¬æ¢åˆ°ä¼ ç»Ÿçš„è®¡ç®—æœºè¯­è¨€ä¸­æˆ–è¿«ä½¿æˆ‘ä»¬å»é€‰æ‹©ä¸€ä¸ªæ•°é‡å¹¶ç”¨å…¶ä»–å››ä¸ªæ•°é‡æ¥è®¡ç®—å‡ºå®ƒ. å› æ­¤, ä¸€ä¸ªè®¡ç®—å‹åŠ›çš„å‡½æ•°æ— æ³•è¢«ç”¨æ¥è®¡ç®—æ¸©åº¦, å³ä½¿æ‰€æœ‰éœ€è¦è®¡ç®—çš„æ•°é‡éƒ½æºè‡ªåŒä¸€ä¸ªç­‰å¼.</p>
<p>åœ¨æœ¬èŠ‚ä¸­, æˆ‘ä»¬ç”¨çº¿æ€§å…³ç³»æ¥å‹¾å‹’å‡ºä¸€èˆ¬æ¨¡å‹çš„è®¾è®¡. æˆ‘ä»¬å®šä¹‰ä¿ç•™åœ¨æ•°é‡ä¹‹é—´çš„åŸå§‹çº¦æŸ, ä¾‹å¦‚ä¸€ä¸ª<code>adder(a, b, c)</code>çº¦æŸä¼šå¼ºåˆ¶å¾—åˆ°æ•°å­¦å…³ç³»<code>a + b = c</code>.</p>
<p>æˆ‘ä»¬è¿˜å®šä¹‰äº†ä¸€ç§ç»„åˆæ–¹æ³•, å› æ­¤åŸå§‹çº¦æŸå¯ä»¥è¢«ç»„åˆæ¥è¡¨è¾¾å‡ºæ›´å¤šå¤æ‚çš„å…³ç³». é€šè¿‡è¿™ç§æ–¹å¼, æˆ‘ä»¬çš„ç¨‹åºå°±ç±»ä¼¼äºä¸€ä¸ªç¨‹åºè¯­è¨€. æˆ‘ä»¬é€šè¿‡æ„å»ºä¸€ä¸ªç”±è¿æ¥å™¨è¿æ¥æ¥è¿æ¥çº¦æŸçš„ç½‘ç»œæ¥ç»„åˆçº¦æŸ. ä¸€ä¸ªè¿æ¥å™¨æ˜¯ä¸€ä¸ªæŒæœ‰ä¸€ä¸ªå€¼ä»¥åŠå¹¶ä¸”å¯ä»¥å‚ä¸ä¸€ä¸ªæˆ–å¤šä¸ªçº¦æŸçš„å¯¹è±¡.</p>
<p>ä¾‹å¦‚, æˆ‘ä»¬çŸ¥é“åæ°åº¦ä»¥åŠæ‘„æ°åº¦ä¹‹é—´çš„å…³ç³»æ˜¯: <code>9 * c = 5 * (f - 32)</code></p>
<p>è¿™ä¸ªæ–¹ç¨‹æ˜¯cå’Œfä¹‹é—´çš„å¤æ‚çº¦æŸ. è¿™æ ·çš„ä¸€ä¸ªçº¦æŸèƒ½å¤Ÿæƒ³è±¡ä¸ºä¸€ä¸ªç”±åŸå§‹<code>adder</code>, <code>multiple</code>ä»¥åŠ<code>constant</code>çº¦æŸç»„æˆçš„ç½‘ç»œ.</p>
<p><img src="http://composingprograms.com/img/constraints.png" alt="constraints" /></p>
<p>åœ¨è¿™ä¸ªå›¾ç‰‡ä¸­, æˆ‘ä»¬çœ‹åˆ°å·¦è¾¹çš„ä¹˜æ³•å™¨æœ‰ä¸‰ä¸ªç»ˆç«¯, æ ‡è®°ä¸ºa, bå’Œc. è¿™äº›å°†ä¹˜æ³•å™¨è¿æ¥åˆ°ç½‘ç»œçš„å…¶ä½™éƒ¨åˆ†, å¦‚ä¸‹æ‰€ç¤º: aç»ˆç«¯æ˜¯è¿æ¥åˆ°ä¸€ä¸ªè¿æ¥å™¨<code>celsius</code>, å®ƒå°†ä¼šä¿å­˜æ‘„æ°æ¸©åº¦. bç»ˆç«¯è¿æ¥åˆ°ä¸€ä¸ªè¿æ¥å™¨wä¸­, ä¹Ÿå°±æ˜¯ä¸€ä¸ªè¿æ¥åˆ°å…·æœ‰9çš„å¸¸é‡ç›’å­çš„è¿æ¥å™¨. cç»ˆç«¯æ˜¯ä¸€ä¸ªä¹˜æ³•å™¨ç›’å­çº¦æŸä¸ºaå’Œbçš„ä¹˜ç§¯, è¿æ¥åˆ°cç»ˆç«¯çš„æ˜¯å¦å¤–ä¸€ä¸ªä¹˜æ³•å™¨, è¿™ä¸ªä¹˜æ³•å™¨çš„bç»ˆç«¯è¿æ¥åˆ°ä¸€ä¸ªå¸¸é‡5è€Œaç»ˆç«¯è¿æ¥åˆ°ä¸€ä¸ªå’Œçº¦æŸçš„å…¶ä¸­ä¸€é¡¹ä¸Š.</p>
<p>è¿™æ ·çš„ç½‘ç»œè®¡ç®—è¿‡ç¨‹å¦‚ä¸‹: å½“ä¸€ä¸ªè¿æ¥å™¨ç»™å®šäº†ä¸€ä¸ªå€¼(é€šè¿‡ç”¨æˆ·æˆ–è€…å®ƒè¿æ¥åˆ°çš„çº¦æŸç›’å­), å®ƒå°†ä¼šå”¤é†’å®ƒæ‰€æœ‰å…³è”çš„çº¦æŸ(é™¤äº†é‚£ä¸ªå”¤é†’å®ƒçš„çº¦æŸ)æ¥é€šçŸ¥å®ƒä»¬å®ƒæ‰€å…·æœ‰çš„å€¼. æ¯ä¸€æ¬¡å”¤é†’çº¦æŸç›’å­ç„¶åè½®è¯¢å®ƒçš„è¿æ¥å™¨æ¥æŸ¥çœ‹è¿™é‡Œæ˜¯å¦æœ‰è¶³å¤Ÿçš„ä¿¡æ¯æ¥ç¡®å®šä¸€ä¸ªè¿æ¥å™¨çš„å€¼. å¦‚æœæœ‰, è¿™ä¸ªç›’å­å°±è®¾ç½®è¿™ä¸ªè¿æ¥å™¨, è¿™ä¸ªè¿æ¥å™¨éšåä¼šå”¤é†’æ‰€æœ‰è‡ªå·±çš„å…³è”çº¦æŸç­‰. ä¾‹å¦‚, åœ¨æ‘„æ°åº¦å’Œåæ°åº¦ä¹‹é—´çš„è½¬æ¢, w, xä»¥åŠyéƒ½ä¼šç«‹å³è¢«åˆ†åˆ«è®¾ç½®ä¸ºå¸¸é‡ç›’å­9, 5ä»¥åŠ32. è¿æ¥å™¨å”¤é†’ä¹˜æ³•å™¨ä»¥åŠåŠ æ³•å™¨, å®ƒåˆ¤æ–­å¾—å‡ºç°åœ¨è¿˜æ²¡æœ‰è¶³å¤Ÿçš„ä¿¡æ¯æ¥ç»§ç»­æ‰§è¡Œ. å¦‚æœç”¨æˆ·(æˆ–è€…ç½‘ç»œçš„å…¶ä»–éƒ¨åˆ†)ç»™<code>celsius</code>è¿æ¥å™¨è®¾å®šä¸€ä¸ªå€¼(æ¯”å¦‚è¯´25), é‚£ä¹ˆæœ€å·¦è¾¹çš„ä¹˜æ³•å™¨ä¼šè¢«å”¤é†’, ç„¶åå®ƒä¼šè®¾å®šuä¸º<code>25 * 9 = 225</code>. ç„¶åuä¼šå”¤é†’ç¬¬äºŒä¸ªä¹˜æ³•å™¨, å®ƒä¼šè®¾å®švä¸º45, ç„¶åvå”¤é†’åŠ æ³•å™¨, å®ƒä¼šè®¾ç½®<code>fahrenheit</code>è¿æ¥å™¨ä¸º77.</p>
<p><strong>ä½¿ç”¨çº¦æŸç³»ç»Ÿ</strong>. è¦ä½¿ç”¨çº¦æŸç³»ç»Ÿæ¥æ‰§è¡Œä¸Šé¢æç»˜çš„æ¸©åº¦è®¡ç®—, æˆ‘ä»¬é¦–å…ˆé€šè¿‡è°ƒç”¨<code>connector</code>æ„é€ å™¨æ¥åˆ›å»ºä¸¤ä¸ªå·²å‘½åçš„è¿æ¥å™¨, <code>celsius</code>ä»¥åŠ<code>fahrenheit</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">celsius</span> <span class="o">=</span> <span class="n">connector</span><span class="p">(</span><span class="s1">&#39;Celsius&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fahrenheit</span> <span class="o">=</span> <span class="n">connector</span><span class="p">(</span><span class="s1">&#39;Fahrenheit&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>ç„¶å, æˆ‘ä»¬è¿æ¥è¿™äº›è¿æ¥å™¨åˆ°ç½‘ç»œä¸­æ¥åšä¸€ä¸ªä¸Šå›¾çš„é•œåƒå®ç°. å‡½æ•°<code>convert</code>ç”¨æ¥è£…é…ç½‘ç»œä¸­çš„å„ç§è¿æ¥å™¨ä»¥åŠçº¦æŸ.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">converter</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;Connect c to f with constraints to convert from Celsius to Fahrenheit.&#34;&#34;&#34;</span>
        <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">connector</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>
        <span class="n">multiple</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>
        <span class="n">multiple</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>
        <span class="n">adder</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
        <span class="n">constant</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
        <span class="n">constant</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">constant</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">converter</span><span class="p">(</span><span class="n">celsius</span><span class="p">,</span> <span class="n">fahrenheit</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>æˆ‘ä»¬ä¼šç”¨ä¸€ä¸ªæ¶ˆæ¯è¾“å…¥åˆ°ç³»ç»Ÿä¸­æ¥åè°ƒçº¦æŸä»¥åŠè¿æ¥å™¨. çº¦æŸæ˜¯ä¸å…·æœ‰æœ¬åœ°çŠ¶æ€çš„ä¸€ä¸ªå­—å…¸. çº¦æŸä¸ä¼šç›´æ¥ä¿®æ”¹è¿æ¥å™¨çš„å€¼, è€Œæ˜¯ä¼šé€šè¿‡å‘é€ä¿¡æ¯æ¥ä¿®æ”¹, å› æ­¤è¿æ¥å™¨å¯ä»¥é€šçŸ¥å…¶ä»–çš„çº¦æŸæ¥å“åº”ä¿®æ”¹. é€šè¿‡è¿™ç§æ–¹å¼, ä¸€ä¸ªè¿æ¥å™¨ä»£è¡¨ä¸€ä¸ªæ•°å­—, åŒæ—¶ä¹Ÿå°è£…è¿æ¥å™¨çš„è¡Œä¸º.</p>
<p>ä¸€ä¸ªæˆ‘ä»¬å¯ä»¥å‘é€åˆ°è¿æ¥å™¨çš„ä¿¡æ¯æ˜¯è®¾ç½®å®ƒçš„å€¼. è¿™é‡Œ, æˆ‘ä»¬(ä¹Ÿå°±æ˜¯&quot;ç”¨æˆ·&rdquo;)è®¾ç½®<code>celsius</code>çš„å€¼ä¸º25.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">celsius</span><span class="p">[</span><span class="s1">&#39;set_val&#39;</span><span class="p">](</span><span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">Celsius</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">Fahrenheit</span> <span class="o">=</span> <span class="mf">77.0</span>
</code></pre></td></tr></table>
</div>
</div><p>ä¸ä»…ä»…<code>celsius</code>çš„å€¼ä¿®æ”¹ä¸º25, è€Œä¸”å®ƒçš„å€¼é€šè¿‡ç½‘ç»œä¼ æ’­, å› æ­¤<code>fahrenheit</code>çš„å€¼ä¹Ÿä¼šä¿®æ”¹. è¿™äº›å€¼ä¼šè¢«æ‰“å°å‡ºæ¥å› ä¸ºåœ¨æ„å»ºå®ƒä»¬çš„æ—¶å€™æˆ‘ä»¬å‘½åäº†è¿™ä¸¤ä¸ªè¿æ¥å™¨.</p>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥å°è¯•è®¾å®š<code>fahrenheit</code>åˆ°ä¸€ä¸ªæ–°å€¼, æ¯”å¦‚è¯´212.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">fahrenheit</span><span class="p">[</span><span class="s1">&#39;set_val&#39;</span><span class="p">](</span><span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="mi">212</span><span class="p">)</span>
<span class="n">Contradiction</span> <span class="n">detected</span><span class="p">:</span> <span class="mf">77.0</span> <span class="n">vs</span> <span class="mi">212</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿™ä¸ªè¿æ¥å™¨ä¼šæŠ±æ€¨è¯´å®ƒæ¢æµ‹åˆ°ä¸€ä¸ªçŸ›ç›¾: å®ƒçš„å€¼æ˜¯77.0, ç„¶åæŸä¸ªäººå°è¯•å°†å®ƒè®¾ä¸º212. å¦‚æœæˆ‘ä»¬çœŸçš„æƒ³è¦ç”¨æ–°çš„å€¼é‡ç”¨è¿™ä¸ªç½‘ç»œ, æˆ‘ä»¬å¯ä»¥å‘Šè¯‰<code>celsius</code>å»å¿˜è®°å®ƒçš„æ—§å€¼:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">celsius</span><span class="p">[</span><span class="s1">&#39;forget&#39;</span><span class="p">](</span><span class="s1">&#39;user&#39;</span><span class="p">)</span>
<span class="n">Celsius</span> <span class="ow">is</span> <span class="n">forgotten</span>
<span class="n">Fahrenheit</span> <span class="ow">is</span> <span class="n">forgotten</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿æ¥å™¨<code>celsius</code>å‘ç°é‚£ä¸ªæœ¬æ¥è¦è®¾å®šå®ƒå€¼çš„ç”¨æˆ·ç°åœ¨æ­£åœ¨æ’¤å›è¿™ä¸ªå€¼, å› æ­¤<code>celsius</code>åŒæ„å»ä¸¢æ‰è‡ªå·±çš„å€¼, ç„¶åå®ƒé€šçŸ¥ç½‘ç»œçš„å‰©ä½™éƒ¨åˆ†ç›®å‰çš„æƒ…å†µ. è¿™ä¸ªä¿¡æ¯æœ€ç»ˆä¼ æ’­åˆ°<code>fahrenheit</code>ä¸­, å®ƒç°åœ¨å‘ç°å®ƒæ²¡æœ‰ç†ç”±å»ç»§ç»­ç›¸ä¿¡å®ƒæ‹¥æœ‰çš„å€¼æ˜¯77. å› æ­¤, å®ƒä¹Ÿæ”¾å¼ƒäº†å®ƒè‡ªå·±çš„å€¼.</p>
<p>ç°åœ¨, <code>fahrenheit</code>å·²ç»æ²¡æœ‰äº†å€¼, æˆ‘ä»¬å¯ä»¥è‡ªç”±åœ°è®¾å®šå®ƒä¸º212:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">fahrenheit</span><span class="p">[</span><span class="s1">&#39;set_val&#39;</span><span class="p">](</span><span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="mi">212</span><span class="p">)</span>
<span class="n">Fahrenheit</span> <span class="o">=</span> <span class="mi">212</span>
<span class="n">Celsius</span> <span class="o">=</span> <span class="mf">100.0</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿™ä¸ªæ–°å€¼, å½“å…¶é€šè¿‡ç½‘ç»œä¼ æ’­æ—¶, è¿«ä½¿<code>celsius</code>å¾—åˆ°ä¸€ä¸ªå€¼100. æˆ‘ä»¬å·²ç»ä½¿ç”¨è¿™ä¸ªéå¸¸ç›¸åƒçš„ç½‘ç»œæ¥é€šè¿‡ç»™å®š<code>fahrenheit</code>è®¡ç®—<code>celsius</code>, é€šè¿‡ç»™å®š<code>fahrenheit</code>è®¡ç®—<code>celsius</code>. è¿™ç§è®¡ç®—çš„éæ–¹å‘æ€§æ˜¯åŸºäºçº¦æŸçš„ç³»ç»Ÿçš„åŒºåˆ«ç‰¹å¾ã€‚</p>
<p><strong>å®ç°çº¦æŸç³»ç»Ÿ</strong>. å°±åƒæˆ‘ä»¬çœ‹åˆ°çš„, è¿æ¥å™¨æ˜¯ä¸€ä¸ªæ˜ å°„æ¶ˆæ¯åç§°åˆ°å‡½æ•°ä»¥åŠæ•°æ®å€¼çš„å­—å…¸. æˆ‘ä»¬ä¼šå®ç°è¿æ¥å™¨æ¥å“åº”ä¸‹é¢çš„æ¶ˆæ¯:</p>
<ul>
<li><code>connector['set_val'](source, value)</code>è¡¨æ˜<code>source</code>éœ€è¦è¿æ¥å™¨æ¥è®¾ç½®å®ƒçš„å½“å‰å€¼ä¸º<code>value</code>.</li>
<li><code>connector['has_val']()</code>è¿”å›æ˜¯å¦è¿™ä¸ªè¿æ¥å™¨å·²ç»å…·æœ‰ä¸€ä¸ªå€¼.</li>
<li><code>connector['val']</code>æ˜¯connectorçš„å½“å‰å€¼.</li>
<li><code>connector['forget'](source)</code>å‘Šè¯‰è¿æ¥å™¨éœ€è¦å®ƒå»å¿˜è®°è®¾å®šçš„<code>source</code>çš„å€¼</li>
<li><code>connector['connect'](source)</code>å‘Šè¯‰è¿æ¥å™¨å»åŠ å…¥åˆ°ä¸€ä¸ªæ–°çš„çº¦æŸä¸­, ä¹Ÿå°±æ˜¯<code>source</code>;</li>
</ul>
<p>çº¦æŸä¹Ÿæ˜¯å­—å…¸, å®ƒä¼šä»è¿æ¥å™¨é€šè¿‡ä¸¤ä¸ªæ¶ˆæ¯æ¥æ¥æ”¶ä¿¡æ¯:</p>
<ul>
<li><code>constraints['new_val']()</code>è¡¨æ˜å·²ç»è¿æ¥åˆ°çº¦æŸå¹¶å…·æœ‰ä¸€ä¸ªæ–°çš„å€¼çš„ä¸€äº›è¿æ¥å™¨.</li>
<li><code>constraints['forget']()</code>è¡¨æ˜å·²ç»è¿æ¥åˆ°çº¦æŸå¹¶å…·æœ‰å¹¶å¿˜è®°å®ƒçš„å€¼çš„ä¸€äº›è¿æ¥å™¨.</li>
</ul>
<p>å½“çº¦æŸæ¥æ”¶åˆ°è¿™äº›ä¿¡æ¯, å®ƒä»¬æ°å½“åœ°å°†è¿™äº›ä¿¡æ¯ä¼ æ’­åˆ°å…¶ä»–çš„è¿æ¥å™¨.</p>
<p><code>adder</code>å‡½æ•°é€šè¿‡ä¸‰ä¸ªè¿æ¥å™¨æ¥æ„é€ äº†ä¸€ä¸ªåŠ æ³•çº¦æŸ, å°±æ˜¯å‰ä¸¤ä¸ªå¿…é¡»è¦ç›¸åŠ å¾—åˆ°ç¬¬ä¸‰ä¸ª: <code>a + b = c</code>. è¦æ”¯æŒå¤šå‘çº¦æŸä¼ æ’­, åŠ æ³•å™¨ä¹Ÿå¿…é¡»è¦èƒ½å¤ŸæŒ‡å®šä»cå‡å»aå¾—åˆ°bä»¥åŠåŒæ ·çš„ä»cå‡å»bå¾—åˆ°a.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">add</span><span class="p">,</span> <span class="n">sub</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">adder</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;The constraints that a + b = c.&#34;&#34;&#34;</span>
        <span class="k">return</span> <span class="n">make_ternary_constraint</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">add</span><span class="p">,</span> <span class="n">sub</span><span class="p">,</span> <span class="n">sub</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>æˆ‘ä»¬ä¹Ÿæ„¿æ„å»å®ç°ä¸€ä¸ªé€šç”¨çš„ä¸‰å…ƒ(ä¸‰ä¸ªæ–¹å‘)çº¦æŸ, ä¹Ÿå°±æ˜¯ç”¨ä¸‰ä¸ªè¿æ¥å™¨ä»¥åŠä¸‰ä¸ªå‡½æ•°ä»<code>adder</code>æ¥åˆ›å»ºä¸€ä¸ªçº¦æŸæ¥æ¥å—<code>new_val</code>ä»¥åŠ<code>forget</code>ä¿¡æ¯. å“åº”æ¶ˆæ¯çš„æ˜¯è¢«æ”¾ç½®åœ¨ä¸€ä¸ªå­—å…¸ä¸­ç§°ä¸º<code>constraint</code>çš„æœ¬åœ°å‡½æ•°.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">make_ternary_constraint</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">ab</span><span class="p">,</span> <span class="n">ca</span><span class="p">,</span> <span class="n">cb</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;The constraint that ab(a, b)=c and ca(c, a)=b and cb(c, b)=a.&#34;&#34;&#34;</span>
        <span class="k">def</span> <span class="nf">new_value</span><span class="p">():</span>
            <span class="n">av</span><span class="p">,</span> <span class="n">bv</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="p">[</span><span class="n">connector</span><span class="p">[</span><span class="s1">&#39;has_val&#39;</span><span class="p">]()</span> <span class="k">for</span> <span class="n">connector</span> <span class="ow">in</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)]</span>
            <span class="k">if</span> <span class="n">av</span> <span class="ow">and</span> <span class="n">bv</span><span class="p">:</span>
                <span class="n">c</span><span class="p">[</span><span class="s1">&#39;set_val&#39;</span><span class="p">](</span><span class="n">constraint</span><span class="p">,</span> <span class="n">ab</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="s1">&#39;val&#39;</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="s1">&#39;val&#39;</span><span class="p">]))</span>
            <span class="k">elif</span> <span class="n">av</span> <span class="ow">and</span> <span class="n">cv</span><span class="p">:</span>
                <span class="n">b</span><span class="p">[</span><span class="s1">&#39;set_val&#39;</span><span class="p">](</span><span class="n">constraint</span><span class="p">,</span> <span class="n">ca</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;val&#39;</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="s1">&#39;val&#39;</span><span class="p">]))</span>
            <span class="k">elif</span> <span class="n">bv</span> <span class="ow">and</span> <span class="n">cv</span><span class="p">:</span>
                <span class="n">a</span><span class="p">[</span><span class="s1">&#39;set_val&#39;</span><span class="p">](</span><span class="n">constraint</span><span class="p">,</span> <span class="n">cb</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;val&#39;</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="s1">&#39;val&#39;</span><span class="p">]))</span>
        <span class="k">def</span> <span class="nf">forget_value</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">connector</span> <span class="ow">in</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
                <span class="n">connector</span><span class="p">[</span><span class="s1">&#39;forget&#39;</span><span class="p">](</span><span class="n">constraint</span><span class="p">)</span>
        <span class="n">constraint</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;new_val&#39;</span><span class="p">:</span> <span class="n">new_value</span><span class="p">,</span> <span class="s1">&#39;forget&#39;</span><span class="p">:</span> <span class="n">forget_value</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">connector</span> <span class="ow">in</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
            <span class="n">connector</span><span class="p">[</span><span class="s1">&#39;connect&#39;</span><span class="p">](</span><span class="n">constraint</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">constraint</span>
</code></pre></td></tr></table>
</div>
</div><p>ç§°ä¸º<code>constraint</code>çš„å­—å…¸æ˜¯ä¸€ä¸ªè°ƒåº¦å­—å…¸, ä½†å®ƒæœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªçº¦æŸå¯¹è±¡. å®ƒå“åº”çº¦æŸæ¥æ”¶çš„ä¸¤ä¸ªä¿¡æ¯, ä½†å®ƒåœ¨è°ƒç”¨å®ƒçš„è¿æ¥å™¨æ—¶ä¹Ÿä½œä¸º<code>source</code>å‚æ•°æ¥ä¼ è¾“.</p>
<p>æ— è®ºä»»ä½•æ—¶å€™çº¦æŸè¢«é€šçŸ¥æœ‰ä¸€ä¸ªå®ƒçš„è¿æ¥å™¨å¾—åˆ°äº†ä¸€ä¸ªå€¼æ—¶, çº¦æŸçš„æœ¬åœ°å‡½æ•°<code>new_value</code>å°±ä¼šè¢«è°ƒç”¨. è¿™ä¸ªå‡½æ•°é¦–å…ˆæ£€æŸ¥çœ‹æ˜¯å¦aå’Œbéƒ½æœ‰å€¼. å¦‚æœæœ‰, å®ƒä¼šå‘Šè¯‰cå»è®¾å®šå€¼è‡ªå·±ä¸ºå‡½æ•°abçš„è¿”å›å€¼, åœ¨<code>adder</code>çš„æƒ…å†µä¸‹å°±æ˜¯ç›¸åŠ çš„ç»“æœ. çº¦æŸå°†å®ƒè‡ªå·±(constraint)ä½œä¸ºsourceå‚æ•°æ¥ä¼ è¾“åˆ°connectorä¸­, ä¹Ÿå°±æ˜¯adderå¯¹è±¡. å¦‚æœaå’Œbä¸æ˜¯å…¨éƒ½æœ‰å€¼, é‚£ä¹ˆconstraintä¼šæ£€æŸ¥aä»¥åŠc, ç­‰ç­‰.</p>
<p>å¦‚æœçº¦æŸè¢«é€šçŸ¥åˆ°å®ƒçš„å…¶ä¸­ä¸€ä¸ªè¿æ¥å™¨å·²ç»å¿˜è®°å®ƒçš„å€¼, å®ƒä¼šè¦æ±‚å®ƒæ‰€æœ‰çš„è¿æ¥å™¨é©¬ä¸Šé—å¿˜è‡ªå·±çš„å€¼. (åªæœ‰è¿™äº›å€¼æ˜¯ç”±çº¦æŸè®¾ç½®çš„ä¼šçœŸçš„ä¸¢å¤±æ‰.)</p>
<p>ä¸€ä¸ªä¹˜æ³•å™¨è·Ÿä¸€ä¸ªåŠ æ³•å™¨ååˆ†çš„ç›¸ä¼¼.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">mul</span><span class="p">,</span> <span class="n">truediv</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">multiple</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;The constraint that a * b = c.&#34;&#34;&#34;</span>
        <span class="k">return</span> <span class="n">make_ternary_constraint</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">mul</span><span class="p">,</span> <span class="n">truediv</span><span class="p">,</span> <span class="n">truediv</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>ä¸€ä¸ªå¸¸é‡ä¹Ÿæ˜¯ä¸€ä¸ªçº¦æŸ, ä½†æ˜¯ä¸€ä¸ªæ°¸è¿œä¸ä¼šå‘é€ä»»ä½•ä¿¡æ¯çš„çº¦æŸ, å› ä¸ºåœ¨å®ƒè®¾ç½®æ„å»ºçš„æ—¶å€™åªæ¶‰åŠåˆ°å•ä¸€çš„ä¸€ä¸ªè¿æ¥å™¨.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">constant</span><span class="p">(</span><span class="n">connector</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;The constraint that connector = value.&#34;&#34;&#34;</span>
        <span class="n">constraint</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">connector</span><span class="p">[</span><span class="s1">&#39;set_val&#39;</span><span class="p">](</span><span class="n">constraint</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">constraint</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿™ä¸‰ä¸ªçº¦æŸè¶³ä»¥å®ç°æˆ‘ä»¬çš„æ¸©åº¦è½¬æ¢ç½‘ç»œ.</p>
<p><strong>è¡¨ç¤ºè¿æ¥å™¨</strong>. ä¸€ä¸ªè¿æ¥å™¨æ˜¯ä½œä¸ºä¸€ä¸ªåŒ…å«ä¸€ä¸ªå€¼çš„å­—å…¸æ¥è¡¨ç¤ºçš„, ä½†ä¹Ÿæœ‰æœ¬åœ°çŠ¶æ€çš„å“åº”å‡½æ•°. è¿™è¿æ¥å™¨å¿…é¡»è·Ÿè¸ªç»™äºˆå…¶å½“å‰å€¼çš„ä¿¡æ¯æä¾›è€…ä»¥åŠå®ƒå‚ä¸çš„çº¦æŸçš„åˆ—è¡¨.</p>
<p>è¿™ä¸ª<code>connector</code>æ„é€ å™¨æœ‰æœ¬åœ°çš„å‡½æ•°æ¥è®¾ç½®ä»¥åŠé—å¿˜å€¼, å®ƒä»¬æ˜¯æ¥è‡ªçº¦æŸçš„æ¶ˆæ¯çš„å“åº”.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">connector</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;A connector between constraints.&#34;&#34;&#34;</span>
        <span class="n">informant</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">constraints</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
            <span class="n">nonlocal</span> <span class="n">informant</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">connector</span><span class="p">[</span><span class="s1">&#39;val&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">informant</span><span class="p">,</span> <span class="n">connector</span><span class="p">[</span><span class="s1">&#39;val&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">source</span><span class="p">,</span> <span class="n">value</span>
                <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="n">inform_all_except</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="s1">&#39;new_val&#39;</span><span class="p">,</span> <span class="n">constraints</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">val</span> <span class="o">!=</span> <span class="n">value</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Contradiction detected:&#39;</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="s1">&#39;vs&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">forget_value</span><span class="p">(</span><span class="n">source</span><span class="p">):</span>
            <span class="n">nonlocal</span> <span class="n">informant</span>
            <span class="k">if</span> <span class="n">informant</span> <span class="o">==</span> <span class="n">source</span><span class="p">:</span>
                <span class="n">informant</span><span class="p">,</span> <span class="n">connector</span><span class="p">[</span><span class="s1">&#39;val&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span>
                <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;is forgotten&#39;</span><span class="p">)</span>
                <span class="n">inform_all_except</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="s1">&#39;forget&#39;</span><span class="p">,</span> <span class="n">constraints</span><span class="p">)</span>
        <span class="n">connector</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;val&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
            <span class="s1">&#39;set_val&#39;</span><span class="p">:</span> <span class="n">set_value</span><span class="p">,</span>
            <span class="s1">&#39;forget&#39;</span><span class="p">:</span> <span class="n">forget_value</span><span class="p">,</span>
            <span class="s1">&#39;has_val&#39;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">connector</span><span class="p">[</span><span class="s1">&#39;val&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">,</span>
            <span class="s1">&#39;connect&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">source</span><span class="p">:</span> <span class="n">constraints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">connector</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿æ¥å™¨å†ä¸€æ¬¡ä½œä¸ºäº”ä¸ªæ¶ˆæ¯çš„è°ƒåº¦å­—å…¸ç”¨æ¥é€šè¿‡çº¦æŸå»ä¸è¿æ¥å™¨é€šä¿¡. æœ‰å››ä¸ªæ˜¯å“åº”å‡½æ•°, æœ€åçš„ä¸€ä¸ªæ˜¯å“åº”çš„å€¼æœ¬èº«.</p>
<p>å½“æœ‰è¯·æ±‚æ¥è®¾ç½®è¿æ¥å™¨çš„å€¼æ—¶æœ¬åœ°å‡½æ•°<code>set_value</code>ä¼šè¢«è°ƒç”¨. å¦‚æœè¿æ¥å™¨å½“å‰ä¸å…·æœ‰å€¼, å®ƒå°†è®¾ç½®å…¶å€¼å¹¶è®°ä½è¯·æ±‚è¦è®¾ç½®çš„å€¼çš„æºçº¦æŸä¸º<code>informant</code>. æ¥ç€è¿æ¥å™¨ä¼šé€šçŸ¥æ‰€æœ‰å®ƒå‚ä¸çš„çº¦æŸé™¤äº†è¯·æ±‚è¦è®¾ç½®å€¼çš„çº¦æŸ. è¿™æ˜¯ä½¿ç”¨ä»¥ä¸‹çš„è¿­ä»£å‡½æ•°å®Œæˆçš„.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">inform_all_except</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">constraints</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;Inform all constraints of the message, except source.&#34;&#34;&#34;</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">constraints</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">c</span> <span class="o">!=</span> <span class="n">source</span><span class="p">:</span>
                <span class="n">c</span><span class="p">[</span><span class="n">message</span><span class="p">]()</span>
</code></pre></td></tr></table>
</div>
</div><p>å¦‚æœä¸€ä¸ªè¿æ¥å™¨è¢«è¦æ±‚é—å¿˜å®ƒçš„å€¼, å®ƒä¼šè°ƒç”¨æœ¬åœ°çš„<code>forget_value</code>å‡½æ•°, è¿™å‡½æ•°é¦–å…ˆæ£€æŸ¥ç¡®è®¤è¯·æ±‚æœ€åˆè®¾ç½®çš„å€¼æ˜¯ä»ç›¸åŒçš„çº¦æŸä¸­æ¥çš„. å¦‚æœæ˜¯è¿æ¥å™¨é€šçŸ¥å®ƒçš„å…³è”çº¦æŸå…³äºå€¼çš„ä¸¢å¤±.</p>
<p>å“åº”<code>has_val</code>æ¶ˆæ¯æŒ‡ç¤ºå‡ºè¿æ¥å™¨æ˜¯å¦æœ‰ä¸€ä¸ªå€¼. å“åº”<code>connect</code>æ¶ˆæ¯ä¼šæ·»åŠ çº¦æŸæºåˆ°çº¦æŸåˆ—è¡¨ä¸­.</p>
<p>æˆ‘ä»¬å·²ç»è®¾è®¡å¥½çš„çº¦æŸç¨‹åºä»‹ç»äº†è®¸å¤šæ€æƒ³å°†ä¼šåœ¨é¢å‘å¯¹è±¡ç¼–ç¨‹é‡Œé¢å†æ¬¡å‡ºç°. çº¦æŸä»¥åŠè¿æ¥å™¨éƒ½æ˜¯é€šè¿‡æ¶ˆæ¯æ“çºµçš„æŠ½è±¡. å½“è¿æ¥å™¨çš„å€¼è¢«ä¿®æ”¹, å®ƒæ˜¯é€šè¿‡æ¶ˆæ¯æ”¹å˜çš„è€Œä¸”ä¸ä»…ä»…æ”¹å˜å€¼, è¿˜éªŒè¯å®ƒ(æ£€æŸ¥æº)ä»¥åŠä¼ æ’­å®ƒçš„å½±å“(é€šçŸ¥å…¶ä»–çš„çº¦æŸ). å®é™…ä¸Š, åœ¨è¿™ç« ä¹‹å, æˆ‘ä»¬ä¼šç”¨ä¸€ä¸ªç›¸ä¼¼çš„å­—å…¸æ¶æ„, å®ƒåŒ…å«å­—ç¬¦ä¸²å€¼ä½œä¸ºé”®ä»¥åŠå‡½æ•°å€¼æ¥å®ç°ä¸€ä¸ªé¢å‘å¯¹è±¡ç³»ç»Ÿ.</p>
<h3 id="25-é¢å‘å¯¹è±¡ç¼–ç¨‹">2.5 é¢å‘å¯¹è±¡ç¼–ç¨‹</h3>
<p>é¢å‘å¯¹è±¡ç¼–ç¨‹(OOP)æ˜¯ä¸€ç§ç»„ç»‡ç¨‹åºçš„æ–¹æ³•, åœ¨è¿™ä¸€ç« ä¸­å®ƒæ±‡é›†å¹¶å¸¦æ¥äº†è®¸å¤šæ€æƒ³. æ¯”å¦‚åœ¨æ•°æ®æŠ½è±¡ä¸­çš„å‡½æ•°, ç±»åœ¨æ•°æ®ä½¿ç”¨å’Œå®ç°ä¹‹é—´åˆ›å»ºçš„æŠ½è±¡å±éšœ. æ¯”å¦‚è°ƒåº¦å­—å…¸, å¯¹è±¡å›åº”è¡Œä¸ºè¯·æ±‚, æ¯”å¦‚å¯å˜æ•°æ®ç»“æ„, å…·æœ‰æœ¬åœ°çŠ¶æ€çš„å¯¹è±¡å¹¶ä¸å¯ä»¥ç›´æ¥åœ¨å…¨å±€ç¯å¢ƒè®¿é—®. Pythonçš„å¯¹è±¡ç³»ç»Ÿæä¾›äº†ä¾¿åˆ©çš„è¯­æ³•æ¥ä¿ƒè¿›ä½¿ç”¨è¿™äº›æŠ€æœ¯æ¥ç»„ç»‡ç¨‹åº. è®¸å¤šè¿™äº›è¯­æ³•éƒ½åœ¨å…¶ä»–çš„é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€ä¸­å…±äº«.</p>
<p>å¯¹è±¡ç³»ç»Ÿæä¾›çš„ä¸ä»…ä»…æ˜¯ä¾¿åˆ©. å®ƒä¸ºè®¾è®¡ç¨‹åºå¯ç”¨äº†æ–°çš„éšå–», ä¹Ÿå°±æ˜¯å…¶ä¸­å‡ ä¸ªç‹¬ç«‹çš„ä»£ç†åœ¨è®¡ç®—æœºä¸­çš„äº¤äº’. æ¯ä¸€ä¸ªå¯¹è±¡ä»¥æå–ä¸¤è€…å¤æ‚æ€§çš„æ–¹å¼å°†å±€éƒ¨çŠ¶æ€ä»¥åŠè¡Œä¸ºæ†ç»‘åœ¨ä¸€èµ·. å¯¹è±¡ä¹‹é—´ç›¸äº’é€šä¿¡, å¹¶ä¸”æœ‰ç”¨çš„ç»“æœä»å®ƒä»¬ä¹‹é—´äº¤äº’çš„æˆæœä¸­å¾—å‡º. å¯¹è±¡ä¸ä»…ä»…ä¼ é€’æ¶ˆæ¯, å®ƒä»¬ä¹Ÿåœ¨ç›¸åŒç±»å‹çš„å…¶ä»–å¯¹è±¡é—´å…±äº«è¡Œä¸ºä»¥åŠåœ¨ç›¸å…³ç±»å‹ä¸­ç»§æ‰¿ç‰¹æ€§</p>
<p>é¢å‘å¯¹è±¡ç¼–ç¨‹èŒƒä¾‹æœ‰å®ƒè‡ªå·±çš„è¯æ±‡ç”¨æ¥æ”¯æŒå¯¹è±¡éšå–». æˆ‘ä»¬å·²ç»è§è¯†è¿‡ä¸€ä¸ªå¯¹è±¡å°±æ˜¯ä¸€ä¸ªå…·æœ‰æ–¹æ³•ä»¥åŠå±æ€§é€šè¿‡ç‚¹è¯­æ³•è®¿é—®çš„æ•°æ®å€¼. æ¯ä¸€ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªç±»å‹, å«åšå®ƒçš„ç±». è¦åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°æ®ç±»å‹, æˆ‘ä»¬éœ€è¦å®ç°ä¸€ä¸ªæ–°çš„ç±».</p>
<h4 id="251-å¯¹è±¡ä»¥åŠç±»">2.5.1 å¯¹è±¡ä»¥åŠç±»</h4>
<p>ä¸€ä¸ªç±»å°±æ˜¯æ‰€æœ‰ç±»å‹æ˜¯è¿™ä¸ªç±»çš„å¯¹è±¡çš„ä¸€ä¸ªæ¨¡æ¿. æ¯ä¸ªå¯¹è±¡éƒ½æ˜¯æŸç§ç‰¹å®šç±»å‹çš„ç±»çš„ä¸€ä¸ªå®ä¾‹. åˆ°ç›®å‰ä¸ºæ­¢æˆ‘ä»¬ç”¨è¿‡çš„æ‰€æœ‰å¯¹è±¡éƒ½å…·æœ‰å…§å»ºçš„ç±», ä½†æ˜¯æ–°çš„ç”¨æˆ·å®šä¹‰çš„ç±»å‹ä¹Ÿå¯ä»¥è¢«åˆ›å»º. ä¸€ä¸ªç±»çš„å®šä¹‰æŒ‡å®šäº†å±æ€§ä»¥åŠæ–¹æ³•åœ¨è¿™ç§ç±»çš„å¯¹è±¡ä¹‹é—´å…±äº«. æˆ‘ä»¬ä¼šé€šè¿‡é‡çœ‹é“¶è¡Œè´¦æˆ·çš„ä¾‹å­æ¥ä»‹ç»ç±»å£°æ˜.</p>
<p>å½“ä»‹ç»å±€éƒ¨çŠ¶æ€, æˆ‘ä»¬çœ‹åˆ°é“¶è¡Œè´¦æˆ·è¢«è‡ªç„¶åœ°ä»¥å…·æœ‰<code>balance</code>çš„å¯å˜æ•°æ®å€¼æ¥å»ºæ¨¡. ä¸€ä¸ªé“¶è¡Œè´¦æˆ·å¯¹è±¡åº”è¯¥æœ‰ä¸€ä¸ª<code>withdraw</code>æ–¹æ³•æ¥æ›´æ–°è´¦æˆ·çš„ä½™é¢ä»¥åŠåœ¨æ›´æ–°åçš„ä½™é¢æœ‰æ•ˆçš„æƒ…å†µä¸‹è¿”å›è¯·æ±‚çš„é‡‘é¢. è¦å®ŒæˆæŠ½è±¡, ä¸€ä¸ªé“¶è¡Œè´¦æˆ·åº”è¯¥å¯ä»¥è¿”å›å®ƒå½“å‰çš„ä½™é¢(balance), è¿”å›è´¦æˆ·æŒæœ‰è€…(holder)çš„åç§°, ä»¥åŠå­˜æ¬¾é‡‘é¢(deposit).</p>
<p>ä¸€ä¸ªè´¦æˆ·ç±»å…è®¸æˆ‘ä»¬å»åˆ›å»ºå¤šä¸ªé“¶è¡Œè´¦æˆ·çš„å®ä¾‹. åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡å®ä¾‹çš„åŠ¨ä½œè¢«ç§°ä¸ºç±»çš„å®ä¾‹åŒ–. åœ¨Pythonä¸­å®ä¾‹åŒ–ä¸€ä¸ªç±»çš„è¯­æ³•è·Ÿè°ƒç”¨ä¸€ä¸ªå‡½æ•°çš„è¯­æ³•æ˜¯ä¸€æ ·çš„. åœ¨è¿™ç§æƒ…å†µä¸‹, æˆ‘ä»¬ç”¨å‚æ•°&rsquo;Kirk&rsquo;å³è´¦æˆ·æŒæœ‰è€…çš„åç§°æ¥è°ƒç”¨<code>Account</code>ç±».</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">Account</span><span class="p">(</span><span class="s1">&#39;Kirk&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>ä¸€ä¸ªå¯¹è±¡çš„ä¸€ä¸ªå±æ€§å°±æ˜¯ä¸€ä¸ªè·Ÿå¯¹è±¡å…³è”çš„åå€¼å¯¹, å¹¶ä¸”å®ƒèƒ½å¤Ÿé€šè¿‡ç‚¹è¯­æ³•æ¥è®¿é—®. ç‰¹å®šå¯¹è±¡çš„ç‰¹å®šå±æ€§(ä¸ç±»çš„æ‰€æœ‰å¯¹è±¡ç›¸å¯¹è€Œè¨€)ç§°ä¸ºå®ä¾‹å±æ€§. æ¯ä¸€ä¸ª<code>Account</code>éƒ½æœ‰å®ƒçš„è‡ªå·±çš„ä½™é¢ä»¥åŠè´¦æˆ·æŒæœ‰è€…åç§°, ä¹Ÿå°±æ˜¯ä¾‹å­çš„å®ä¾‹å±æ€§. åœ¨æ›´åŠ å¹¿æ³›çš„ç¼–ç¨‹ç¤¾åŒº, å®ä¾‹å±æ€§ä¹Ÿä¼šå«åš<em>å­—æ®µ</em>, <em>ç‰¹æ€§</em>, æˆ–è€…å®ä¾‹å˜é‡</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">holder</span>
<span class="s1">&#39;Kirk&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">balance</span>
<span class="mi">0</span>
</code></pre></td></tr></table>
</div>
</div><p>åœ¨å¯¹è±¡æˆ–è€…æ‰§è¡Œç‰¹å®šå¯¹è±¡è®¡ç®—çš„å‡½æ•°è¢«ç§°ä¸ºæ–¹æ³•. æ–¹æ³•çš„è¿”å›å€¼ä»¥åŠå‰¯ä½œç”¨å¯ä»¥å–å†³äºå¯¹è±¡çš„å…¶ä»–å±æ€§ä¸”æ”¹å˜å®ƒ. ä¾‹å¦‚, <code>deposit</code>(å­˜æ¬¾)æ˜¯Accountç±»å¯¹è±¡açš„ä¸€ä¸ªæ–¹æ³•. å®ƒæ¥æ”¶ä¸€ä¸ªå‚æ•°, å°±æ˜¯å­˜æ¬¾çš„é‡‘é¢, ä¿®æ”¹å¯¹è±¡çš„<code>balance</code>(ä½™é¢)å±æ€§, ç„¶åè¿”å›ä½™é¢çš„ç»“æœ.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">deposit</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="mi">15</span>
</code></pre></td></tr></table>
</div>
</div><p>æˆ‘ä»¬ç§°æ–¹æ³•åœ¨ç‰¹å®šçš„å¯¹è±¡ä¸Šè¢«è°ƒç”¨. ä½œä¸ºè°ƒç”¨<code>withdraw</code>(å–å‡º)æ–¹æ³•è°ƒç”¨çš„ç»“æœ, è¦ä¹ˆå–æ¬¾ä¼šè¢«æ‰¹å‡†å¹¶æ‰£é™¤æ€»é¢, è¦ä¹ˆè¯·æ±‚è¢«æ‹’ç»ç„¶åæ–¹æ³•è¿”å›ä¸€ä¸ªé”™è¯¯ä¿¡æ¯.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">withdraw</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="mi">5</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">balance</span>
<span class="mi">5</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">withdraw</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="s1">&#39;Insufficient funds&#39;</span>
</code></pre></td></tr></table>
</div>
</div><p>å¦‚ä¸Šæ‰€è¿°, æ–¹æ³•çš„è¡Œä¸ºå¯ä»¥å–å†³äºå¯¹è±¡å±æ€§çš„ä¿®æ”¹. å¯¹<code>withdraw</code>(å–æ¬¾)çš„ä¸¤æ¬¡ç›¸åŒçš„è°ƒç”¨è¿”å›äº†ä¸åŒçš„ç»“æœ.</p>
<h4 id="252-å®šä¹‰ç±»">2.5.2 å®šä¹‰ç±»</h4>
<p>ç”¨æˆ·å®šä¹‰ç±»å‹æ˜¯é€šè¿‡åŒ…å«ä¸€ä¸ªå•ä¸€æ¡æ¬¾çš„<code>class</code>å£°æ˜æ¥åˆ›å»ºçš„, ä¸€ä¸ª<code>class</code>å£°æ˜å®šä¹‰ä¸€ä¸ªç±»çš„åç§°, ç„¶ååŒ…å«ä¸€ç³»åˆ—è¯­å¥æ¥å®šä¹‰ç±»çš„å±æ€§:</p>
<pre><code>class &lt;name&gt;:
    &lt;suite&gt;
</code></pre><p>å½“ä¸€ä¸ªç±»å£°æ˜è¢«æ‰§è¡Œ, ä¸€ä¸ªæ–°çš„ç±»å°±ä¼šåˆ›å»ºå¹¶åœ¨å½“å‰ç¯å¢ƒçš„ç¬¬ä¸€å¸§å†…ç»‘å®šåˆ°<code>&lt;name&gt;</code>. å†…éƒ¨çš„ä¸€ç³»åˆ—è¯­å¥ä¼šæ‰§è¡Œ. ä»»ä½•åœ¨classå£°æ˜çš„<code>&lt;suite&gt;</code>èŒƒå›´å†…çš„é€šè¿‡defæˆ–è€…èµ‹å€¼è¯­å¥å®šä¹‰çš„åç§°ä¼šåˆ›å»ºæˆ–ä¿®æ”¹ç±»çš„å±æ€§.</p>
<p>ç±»é€šå¸¸å›´ç»•æ“çºµç±»çš„å±æ€§, ä¹Ÿå°±æ˜¯è·Ÿè¿™ä¸ªç±»çš„æ¯ä¸ªå®ä¾‹ç›¸å…³è”çš„åå€¼å¯¹. è¿™ä¸ªç±»é€šè¿‡å®šä¹‰ç”¨äºåˆå§‹åŒ–æ–°å¯¹è±¡çš„æ–¹æ³•æ¥æŒ‡å®šå…¶å¯¹è±¡çš„å®ä¾‹å±æ€§. ä¾‹å¦‚, åˆå§‹åŒ–<code>Account</code>ç±»çš„å¯¹è±¡çš„å…¶ä¸­ä¸€ä¸ªéƒ¨åˆ†æ˜¯åˆ†é…ç»™å®ƒä¸€ä¸ªåˆå§‹çš„ä½™é¢å€¼0.</p>
<p>ç±»å£°æ˜ä¸­çš„<code>&lt;suite&gt;</code>åŒ…å«æœ‰defå£°æ˜, å®ƒä¼šå®šä¹‰ä¸ºè¿™ç§ç±»çš„å¯¹è±¡å®šä¹‰æ–°çš„æ–¹æ³•. åœ¨Pythonä¸­åˆå§‹åŒ–å¯¹è±¡çš„æ–¹æ³•å…·æœ‰ä¸€ä¸ªç‰¹åˆ«çš„åå­—, <code>__init__</code>(åœ¨å•è¯initçš„ä¸¤è¾¹éƒ½æœ‰ä¸¤ä¸ªä¸‹åˆ’çº¿), è¿™æ–¹æ³•ç§°ä¸ºè¿™ä¸ªç±»çš„æ„é€ å™¨.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">Account</span><span class="p">:</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">account_holder</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">holder</span> <span class="o">=</span> <span class="n">account_holder</span>
</code></pre></td></tr></table>
</div>
</div><p>Accountç±»çš„<code>__init__</code>æ–¹æ³•æœ‰ä¸¤ä¸ªå½¢å¼å‚æ•°. ç¬¬ä¸€ä¸ªæ˜¯<code>self</code>, å®ƒç»‘å®šåˆ°çš„æ˜¯æœ€æ–°åˆ›å»ºçš„<code>Account</code>å¯¹è±¡. ç¬¬äºŒä¸ªå‚æ•°æ˜¯<code>account_holder</code>, å®ƒåœ¨è°ƒç”¨ç±»æ¥å®ä¾‹åŒ–å¯¹è±¡çš„æ—¶å€™ç»‘å®šä¸ºçš„ä¼ è¾“ç»™ç±»çš„å‚æ•°.</p>
<p>æ„é€ å™¨å°†å®ä¾‹åä¸º<code>balance</code>çš„å±æ€§ç»‘å®šä¸ºå€¼0. å®ƒåŒæ—¶ä¹Ÿå°†åä¸º<code>holder</code>çš„å±æ€§ç»‘å®šåˆ°åä¸º<code>account_holder</code>å…·æœ‰çš„å€¼. å½¢å¼å‚æ•°<code>account_holder</code>åœ¨<code>__init__</code>æ–¹æ³•ä¸­æ˜¯æœ¬åœ°åç§°. å¦ä¸€æ–¹é¢, æœ€ç»ˆé€šè¿‡èµ‹å€¼è¯­å¥è¿›è¡Œç»‘å®šçš„åç§°<code>holder</code>ä¾ç„¶å­˜åœ¨, å› ä¸ºå®ƒé€šè¿‡ç‚¹è¯­æ³•å­˜å‚¨ä¸º<code>self</code>çš„å±æ€§.</p>
<p>åœ¨å®šä¹‰äº†<code>Account</code>ç±»ä¹‹å, æˆ‘ä»¬å¯ä»¥å®ä¾‹åŒ–å®ƒ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">Account</span><span class="p">(</span><span class="s1">&#39;Kirk&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿™ç§&quot;è°ƒç”¨&quot;<code>Account</code>ç±»åˆ›å»ºå‡ºæ¥çš„æ–°å¯¹è±¡æ˜¯<code>Account</code>çš„ä¸€ä¸ªå®ä¾‹, ç„¶åç”¨ä¸¤ä¸ªå‚æ•°: æœ€æ–°åˆ›å»ºçš„å¯¹è±¡ä»¥åŠå­—ç¬¦ä¸²<code>Kirk</code>æ¥è°ƒç”¨æ„é€ å™¨å‡½æ•°<code>__init__</code>. æŒ‰ç…§æƒ¯ä¾‹, æˆ‘ä»¬ç”¨å‚æ•°åselfä»£è¡¨æ„é€ å™¨çš„ç¬¬ä¸€ä¸ªå‚æ•°, å› ä¸ºå®ƒæ˜¯ç»‘å®šåˆ°å·²è¢«å®ä¾‹åŒ–çš„å¯¹è±¡ä¸Šçš„. è¿™ä¸ªæƒ¯ä¾‹å®é™…ä¸Šåœ¨æ‰€æœ‰Pythonä»£ç ä¸­è¢«é‡‡ç”¨.</p>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥ç”¨ç‚¹è¯­æ³•è®¿é—®å¯¹è±¡çš„<code>balance</code>ä»¥åŠ<code>holder</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">balance</span>
<span class="mi">0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">holder</span>
<span class="s1">&#39;Kirk&#39;</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>èº«ä»½</strong>. æ¯ä¸€ä¸ªæ–°çš„è´¦æˆ·å®ä¾‹éƒ½æœ‰å®ƒè‡ªå·±çš„<code>balance</code>å±æ€§, è¿™ä¸ªå€¼ç‹¬ç«‹äºå…¶ä»–ç›¸åŒç±»å‹çš„å¯¹è±¡.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Account</span><span class="p">(</span><span class="s1">&#39;Spock&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span><span class="o">.</span><span class="n">balance</span> <span class="o">=</span> <span class="mi">200</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">acc</span><span class="o">.</span><span class="n">balance</span> <span class="k">for</span> <span class="n">acc</span> <span class="ow">in</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)]</span>
<span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><p>ä¸ºäº†å¼ºåˆ¶è¿™ç§åˆ†ç¦», æ¯ä¸€ä¸ªç”¨æˆ·å®šä¹‰ç±»çš„å®ä¾‹å¯¹è±¡éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†, å¯¹è±¡æ ‡è¯†å¯ä»¥ç”¨<code>is</code>æˆ–è€…<code>is not</code>æ“ä½œç¬¦æ¥è¿›è¡Œæ¯”è¾ƒ.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="ow">is</span> <span class="n">a</span>
<span class="bp">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">b</span>
<span class="bp">True</span>
</code></pre></td></tr></table>
</div>
</div><p>å°½ç®¡éƒ½æ˜¯ä»ç›¸åŒçš„è°ƒç”¨ä¸­æ„é€ , ç»‘å®šåˆ°açš„å¯¹è±¡è·Ÿç»‘å®šåˆ°bçš„å¯¹è±¡æ˜¯ä¸ç›¸åŒçš„. è€ŒåŒæ ·åœ°, ç”¨èµ‹å€¼è¯­å¥ç»‘å®šä¸€ä¸ªå¯¹è±¡åˆ°æ–°çš„åå­—ä¸ä¼šåˆ›å»ºæ–°çš„å¯¹è±¡.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">a</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="ow">is</span> <span class="n">a</span>
<span class="bp">True</span>
</code></pre></td></tr></table>
</div>
</div><p>æ–°çš„ç”¨æˆ·å®šä¹‰ç±»çš„å¯¹è±¡åªå½“ä¸€ä¸ªç±»(ä¾‹å¦‚<code>Account</code>)é€šè¿‡è¡¨è¾¾å¼è¯­æ³•è°ƒç”¨è¿›è¡Œå®ä¾‹åŒ–çš„æ—¶å€™æ‰ä¼šè¢«åˆ›å»º.</p>
<p><strong>æ–¹æ³•</strong>. å¯¹è±¡æ–¹æ³•é€šå¸¸ä¹Ÿé€šè¿‡ç±»è¯­å¥çš„å¥—ä»¶å†…çš„<code>def</code>è¯­å¥æ¥å®šä¹‰. ä¸‹é¢, <code>deposit</code>ä»¥åŠ<code>withdraw</code>éƒ½æ˜¯ä½œä¸º<code>Account</code>ç±»çš„æ–¹æ³•æ¥å®šä¹‰çš„.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">Account</span><span class="p">:</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">account_holder</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">holder</span> <span class="o">=</span> <span class="n">account_holder</span>
        <span class="k">def</span> <span class="nf">deposit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">+</span> <span class="n">amount</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">balance</span>
        <span class="k">def</span> <span class="nf">withdraw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">amount</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">balance</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;Insufficient funds&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">-</span> <span class="n">amount</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">balance</span>
</code></pre></td></tr></table>
</div>
</div><p>è™½ç„¶ä¸€ä¸ªæ–¹æ³•çš„å®šä¹‰è·Ÿä¸€ä¸ªå‡½æ•°çš„å®šä¹‰åœ¨å¦‚ä½•å£°æ˜ä¸Šå¹¶æ²¡æœ‰ä»€ä¹ˆä¸åŒ, ä½†æ–¹æ³•å®šä¹‰åœ¨å®ƒä»¬æ‰§è¡Œçš„æ—¶å€™ä¼šå¸¦æ¥ä¸åŒçš„æ•ˆæœ. é€šè¿‡åœ¨<code>class</code>è¯­å¥å†…éƒ¨<code>def</code>è¯­å¥åˆ›å»ºçš„å‡½æ•°å€¼ä¼šç»‘å®šåˆ°å£°æ˜çš„åç§°ä¸Š, åŒæ—¶ä¹Ÿä¼šå±€éƒ¨ç»‘å®šä½œä¸ºç±»çš„å±æ€§. è¿™ä¸ªå€¼ä¼šä»ä¸€ä¸ªç±»çš„å®ä¾‹ä¸­é€šè¿‡ç‚¹è¯­æ³•ä½œä¸ºæ–¹æ³•è¢«è°ƒç”¨.</p>
<p>æ¯ä¸€ä¸ªæ–¹æ³•çš„å®šä¹‰å†ä¸€æ¬¡åŒ…å«æœ‰ç‰¹æ®Šçš„ç¬¬ä¸€å‚æ•°<code>self</code>, å®ƒæ˜¯ç»‘å®šåˆ°è°ƒç”¨æ–¹æ³•çš„å¯¹è±¡ä¸Šçš„. ä¾‹å¦‚, æˆ‘ä»¬ä¼šè¯´<code>deposit</code>æ˜¯åœ¨ç‰¹å®šçš„<code>Account</code>å¯¹è±¡ä¸Šè¢«è°ƒç”¨çš„, åŒæ—¶éœ€è¦ä¼ å•ä¸ªå‚æ•°å€¼: å­˜æ¬¾çš„é‡‘é¢. å¯¹è±¡æœ¬èº«è¢«ç»‘å®šåˆ°<code>self</code>ä¸Š, è€Œå‚æ•°ç»‘å®šåˆ°<code>amount</code>ä¸Š. æ‰€æœ‰è°ƒç”¨çš„æ–¹æ³•éƒ½å¯ä»¥é€šè¿‡<code>self</code>å‚æ•°è®¿é—®å¯¹è±¡, åŒæ—¶, å®ƒä»¬å…¨éƒ¨éƒ½å¯ä»¥è®¿é—®ä»¥åŠæ“çºµå¯¹è±¡çš„çŠ¶æ€.</p>
<p>è¦è°ƒç”¨è¿™äº›æ–¹æ³•, æˆ‘ä»¬å†ä¸€æ¬¡è¦ç”¨åˆ°ç‚¹è¯­æ³•, å¦‚ä¸‹æ‰€ç¤º:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">spock_account</span> <span class="o">=</span> <span class="n">Account</span><span class="p">(</span><span class="s1">&#39;Spock&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">spock_account</span><span class="o">.</span><span class="n">deposit</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="mi">100</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">spock_account</span><span class="o">.</span><span class="n">withdraw</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span>
<span class="mi">10</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">spock_account</span><span class="o">.</span><span class="n">withdraw</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span>
<span class="s1">&#39;Insufficient funds&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">spock_account</span><span class="o">.</span><span class="n">holder</span>
<span class="s1">&#39;Spock&#39;</span>
</code></pre></td></tr></table>
</div>
</div><p>å½“ä¸€ä¸ªæ–¹æ³•é€šè¿‡ç‚¹è¯­æ³•è¢«è°ƒç”¨, å¯¹è±¡æœ¬èº«(åœ¨è¿™ä¸ªä¾‹å­ä¸­æ˜¯ç»‘å®šåˆ°<code>spock_account</code>ä¸Šçš„å¯¹è±¡)æ‰®æ¼”ä¸€ä¸ªåŒé‡è§’è‰². ç¬¬ä¸€, å®ƒç¡®å®šåç§°<code>withdraw</code>çš„å«ä¹‰; <code>withdraw</code>ä¸æ˜¯å½“å‰ç¯å¢ƒä¸‹çš„åç§°, è€Œæ˜¯Accountç±»çš„æœ¬åœ°åç§°. ç¬¬äºŒ, å½“<code>withdraw</code>æ–¹æ³•è¢«è°ƒç”¨æ—¶å®ƒä¼šç»‘å®šåˆ°ç¬¬ä¸€ä¸ªå‚æ•°<code>self</code>.</p>
<h4 id="253-æ¶ˆæ¯ä¼ é€’ä¸ç‚¹è¡¨è¾¾å¼">2.5.3 æ¶ˆæ¯ä¼ é€’ä¸ç‚¹è¡¨è¾¾å¼</h4>
<p>é‚£äº›å®šä¹‰åœ¨ç±»é‡Œé¢çš„æ–¹æ³•ä»¥åŠé€šå¸¸åœ¨æ„é€ å™¨é‡Œé¢åˆ†é…çš„å®ä¾‹å±æ€§, éƒ½æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹çš„åŸºæœ¬è¦ç´ . è¿™ä¸¤ä¸ªæ¦‚å¿µåœ¨æ¶ˆæ¯ä¼ é€’æ•°æ®å€¼çš„å®ç°ä¸­å¤åˆ¶äº†è°ƒåº¦å­—å…¸çš„å¤§å¤šæ•°è¡Œä¸º. å¯¹è±¡ç”¨ç‚¹è¯­æ³•æºå¸¦æ¶ˆæ¯, ä½†é‚£äº›æ¶ˆæ¯ä¸æ˜¯ä»»æ„å­—ç¬¦ä¸²å€¼ä½œä¸ºé”®, å®ƒä»¬æ˜¯ä½œä¸ºç±»çš„å±€éƒ¨åç§°è€Œå­˜åœ¨çš„. å¯¹è±¡ä¹Ÿæœ‰å‘½åçš„æœ¬åœ°çŠ¶æ€(å®ä¾‹å±æ€§), ä½†æ˜¯è¿™ä¸ªçŠ¶æ€å¯ä»¥ä½¿ç”¨ç‚¹è¯­æ³•è¿›è¡Œè®¿é—®ä»¥åŠæ“çºµ, è€Œä¸ç”¨åœ¨å®ç°ä¸­ä½¿ç”¨<code>nonlocal</code>è¯­å¥.</p>
<p>æ¶ˆæ¯ä¼ é€’çš„ä¸­å¿ƒæ€æƒ³æ˜¯æ•°æ®å€¼åº”è¯¥é€šè¿‡å“åº”å®ƒä»¬æ‰€ä»£è¡¨çš„æŠ½è±¡ç±»å‹çš„ç›¸å…³æ¶ˆæ¯å…·æœ‰è¡Œä¸º. ç‚¹ç¬¦å·æ˜¯Pythonçš„ä¸€ä¸ªå¥æ³•ç‰¹å¾, ç”¨æ¥å½¢å¼åŒ–æ¶ˆæ¯ä¼ é€’çš„éšå–». ä½¿ç”¨å…·æœ‰å…§å»ºå¯¹è±¡ç³»ç»Ÿçš„è¯­è¨€çš„å¥½å¤„æ˜¯æ¶ˆæ¯ä¼ é€’å¯ä»¥ä¸è¯­è¨€çš„å…¶ä»–ç‰¹æ€§æ— ç¼äº’åŠ¨, ä¾‹å¦‚èµ‹å€¼è¯­å¥, æˆ‘ä»¬æ— éœ€è¯·æ±‚ä¸åŒçš„æ¶ˆæ¯æ¥&quot;è·å–(get)&ldquo;æˆ–è€…&quot;è®¾ç½®(set)&ldquo;è·Ÿæœ¬åœ°å±æ€§åç§°ç›¸å…³è”çš„å€¼; è¯­è¨€çš„è¯­æ³•å…è®¸æˆ‘ä»¬ç›´æ¥ä½¿ç”¨æ¶ˆæ¯åç§°.</p>
<p><strong>ç‚¹è¡¨è¾¾å¼</strong>. ä»£ç ç‰‡æ®µ<code>spock_account.deposit</code>è¢«ç§°ä¸ºç‚¹è¡¨è¾¾å¼. ä¸€ä¸ªç‚¹è¡¨è¾¾å¼ç”±ä¸€ä¸ªè¡¨è¾¾å¼, ä¸€ä¸ªç‚¹, ä»¥åŠä¸€ä¸ªåç§°ç»„æˆ.</p>
<p><code>&lt;expression&gt;.&lt;name&gt;</code></p>
<p><code>&lt;expression&gt;</code>å¯ä»¥æ˜¯ä»»æ„æœ‰æ•ˆçš„Pythonè¡¨è¾¾å¼, ä½†æ˜¯<code>&lt;name&gt;</code>å¿…é¡»æ˜¯ä¸€ä¸ªç®€å•åç§°(ä¸æ˜¯ä¸€ä¸ªè¿è¡Œåå¾—åˆ°ä¸€ä¸ªåç§°çš„è¡¨è¾¾å¼). ç‚¹è¡¨è¾¾å¼å¯¹<code>&lt;expression&gt;</code>çš„å€¼ä»£è¡¨çš„å¯¹è±¡è¿ç®—å‡ºç»™å®šçš„<code>&lt;name&gt;</code>å±æ€§çš„å€¼.</p>
<p>å…§å»ºå‡½æ•°<code>getattr</code>ä¹Ÿé€šè¿‡ä¸€ä¸ªåç§°è¿”å›ä¸€ä¸ªå¯¹è±¡çš„å±æ€§. è¿™æ˜¯ä¸€ä¸ªç›¸å½“äºç‚¹ç¬¦å·çš„å‡½æ•°. ä½¿ç”¨<code>getattr</code>å‡½æ•°, æˆ‘ä»¬å¯ä»¥ç”¨å­—ç¬¦ä¸²æŸ¥çœ‹ä¸€ä¸ªå±æ€§, å°±åƒåœ¨è°ƒåº¦å­—å…¸ä¸­é‚£æ ·åš.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">spock_account</span><span class="p">,</span> <span class="s1">&#39;balance&#39;</span><span class="p">)</span>
<span class="mi">10</span>
</code></pre></td></tr></table>
</div>
</div><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨<code>hasattr</code>æµ‹è¯•ä¸€ä¸ªå¯¹è±¡æ˜¯å¦å…·æœ‰æŸä¸ªå±æ€§.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">spock_account</span><span class="p">,</span> <span class="s1">&#39;deposit&#39;</span><span class="p">)</span>
<span class="bp">True</span>
</code></pre></td></tr></table>
</div>
</div><p>å¯¹è±¡çš„æ˜¯å±æ€§åŒ…æ‹¬æ‰€æœ‰çš„å®ä¾‹å±æ€§, ä»¥åŠåœ¨å…¶ç±»ä¸­å®šä¹‰çš„æ‰€æœ‰å±æ€§(åŒ…æ‹¬æ–¹æ³•). æ–¹æ³•æ˜¯ç±»ä¸­éœ€è¦ç‰¹æ®Šå¤„ç†çš„å±æ€§</p>
<p><strong>æ–¹æ³•å’Œå‡½æ•°</strong>. å½“ä¸€ä¸ªæ–¹æ³•åœ¨ä¸€ä¸ªå¯¹è±¡ä¸Šè¢«è°ƒç”¨, å¯¹è±¡ä¼šéšå«åœ°ä½œä¸ºæ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°è¿›è¡Œä¼ è¾“. ä¹Ÿå°±æ˜¯è¯´, å¯¹è±¡æ˜¯ç‚¹å·å·¦è¾¹çš„<code>&lt;expression&gt;</code>çš„å€¼è‡ªåŠ¨åœ°ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ è¾“ç»™ç‚¹å·è¡¨è¾¾å¼å³è¾¹çš„æ–¹æ³•åä»£è¡¨çš„å‡½æ•°. ç»“æœå°±æ˜¯å¯¹è±¡ç»‘å®šåˆ°å‚æ•°<code>self</code>ä¸Š.</p>
<p>è¦å®ç°è‡ªåŠ¨ç»‘å®š<code>self</code>, Pythonå°†æˆ‘ä»¬è‡ªæœ¬æ–‡å¼€å§‹ä»¥æ¥ä¸€ç›´åˆ›å»ºçš„å‡½æ•°å’Œç»‘å®šæ–¹æ³•åŒºåˆ†å¼€æ¥äº†, è¿™äº›æ–¹æ³•å°†å‡½æ•°å’Œè¦è°ƒç”¨è¯¥æ–¹æ³•çš„å¯¹è±¡è€¦åˆåœ¨äº†ä¸€èµ·. ç»‘å®šæ–¹æ³•çš„å€¼å·²ç»å’Œå®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°(ä¹Ÿå°±æ˜¯è°ƒç”¨å®ƒçš„å®ä¾‹, é‚£ä¸ªå°†åœ¨æ–¹æ³•è¢«è°ƒç”¨æ—¶ä¼šå‘½åä¸º<code>self</code>çš„å¯¹è±¡)å…³è”åœ¨ä¸€èµ·.</p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨äº¤äº’å¼è§£æå™¨ä¸Šè°ƒç”¨<code>type</code>æ¥å¤„ç†ç‚¹è¯­æ³•çš„è¿”å›å€¼æ¥çœ‹å‡ºå·®å¼‚. ä½œä¸ºä¸€ä¸ªç±»çš„å±æ€§, ä¸€ä¸ªæ–¹æ³•åªæ˜¯ä¸€ä¸ªå‡½æ•°, ä½†æ˜¯ä½œä¸ºä¸€ä¸ªå®ä¾‹çš„å±æ€§, å®ƒå°±æ˜¯ä¸€ä¸ªç»‘å®šäº†çš„æ–¹æ³•:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="n">Account</span><span class="o">.</span><span class="n">deposit</span><span class="p">)</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">function</span><span class="s1">&#39;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="n">spock_account</span><span class="o">.</span><span class="n">deposit</span><span class="p">)</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">method</span><span class="s1">&#39;&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿™ä¸¤ä¸ªç»“æœçš„ä¸åŒäº‹å®ä¸Šåœ¨äºç¬¬ä¸€ä¸ªæ˜¯æ ‡å‡†çš„å¸¦æœ‰ä¸¤ä¸ªå½¢å‚<code>self</code>ä»¥åŠ<code>account</code>çš„å‡½æ•°. è€Œç¬¬äºŒä¸ªæ˜¯å…·æœ‰å•ä¸ªå½¢å‚çš„æ–¹æ³•, åœ¨æ–¹æ³•è¢«è°ƒç”¨æ—¶åç§°<code>self</code>ä¼šè¢«è‡ªåŠ¨åœ°ç»‘å®šåˆ°åä¸º<code>spock_account</code>çš„å¯¹è±¡ä¸Š, è€Œå½¢å‚<code>amount</code>ä¼šè¢«ç»‘å®šåˆ°ä¼ å…¥æ–¹æ³•çš„å‚æ•°ä¸Š. æ‰€æœ‰è¿™äº›å€¼, æ— è®ºæ˜¯å‡½æ•°å€¼æˆ–è€…ç»‘å®šæ–¹æ³•å€¼, éƒ½è·Ÿç›¸åŒçš„<code>deposit</code>å‡½æ•°ä½“ç›¸å…³è”.</p>
<p>æˆ‘ä»¬å¯ä»¥ç”¨ä¸¤ç§æ–¹å¼è°ƒç”¨<code>deposit</code>: ä½œä¸ºå‡½æ•°ä»¥åŠä½œä¸ºç»‘å®šæ–¹æ³•. åœ¨å‰ä¸€ç§æƒ…å†µä¸‹, æˆ‘ä»¬å¿…é¡»æ˜ç¡®åœ°æä¾›ä¸€ä¸ªå‚æ•°ç»™<code>self</code>å½¢å‚, åœ¨åä¸€ç§æƒ…å†µä¸‹, <code>self</code>å½¢å‚ä¼šè‡ªåŠ¨ç»‘å®š.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">Account</span><span class="o">.</span><span class="n">deposit</span><span class="p">(</span><span class="n">spock_account</span><span class="p">,</span> <span class="mi">1001</span><span class="p">)</span>  <span class="c1"># The deposit function takes 2 arguments</span>
<span class="mi">1011</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">spock_account</span><span class="o">.</span><span class="n">deposit</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>           <span class="c1"># The deposit method takes 1 argument</span>
<span class="mi">2011</span>
</code></pre></td></tr></table>
</div>
</div><p>å‡½æ•°<code>getattr</code>çš„è¡Œä¸ºè·Ÿç‚¹ç¬¦å·å®Œå…¨ç±»ä¼¼: å¦‚æœå®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡, ä½†æ˜¯åç§°æ˜¯ä¸€ä¸ªå·²ç»åœ¨ç±»ä¸­å®šä¹‰çš„æ–¹æ³•. é‚£ä¹ˆ<code>getattr</code>è¿”å›ä¸€ä¸ªç»‘å®šçš„æ–¹æ³•å€¼. å¦ä¸€æ–¹é¢, å¦‚æœç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªç±», é‚£ä¹ˆ<code>getattr</code>ç›´æ¥è¿”å›å±æ€§å€¼, ä¹Ÿå°±æ˜¯ä¸€ä¸ªçº¯å‡½æ•°.</p>
<p><strong>å‘½åçº¦å®š</strong>. ä¼ ç»Ÿä¸Šå‘½åç±»æ˜¯ä½¿ç”¨<code>CapWords</code>æƒ¯ä¾‹(ä¹Ÿå°±æ˜¯ç§°ä¸ºé©¼å³°å¼, å› ä¸ºåœ¨åç§°ä¸­é—´çš„å•è¯é¦–éƒ¨çœ‹èµ·æ¥åƒæ˜¯ä¸€ä¸ªé©¼å³°). æ–¹æ³•åè·Ÿéšå‘½åå‡½æ•°æ‰€ä½¿ç”¨çš„æ ‡å‡†æƒ¯ä¾‹ä¹Ÿå°±æ˜¯ä½¿ç”¨å°å†™å•è¯å¹¶ç”¨ä¸‹åˆ’çº¿ä½œåˆ†å‰².</p>
<p>åœ¨æŸäº›æƒ…å†µä¸‹, å¯¹è±¡ä¸Šè·Ÿç»´æŠ¤æ€§ä¸ä¸€è‡´æ€§ç›¸å…³çš„ä¸€äº›å®ä¾‹å˜é‡ä»¥åŠæ–¹æ³•æˆ‘ä»¬æ˜¯ä¸å¸Œæœ›å¯¹è±¡çš„ç”¨æˆ·çœ‹åˆ°æˆ–è€…ä½¿ç”¨çš„. å®ƒä»¬ä¸æ˜¯ç±»çš„æŠ½è±¡å®šä¹‰çš„ä¸€éƒ¨åˆ†, è€Œæ˜¯å®ç°çš„ä¸€éƒ¨åˆ†. Pythonçš„æƒ¯ä¾‹è§„å®šå¦‚æœä¸€ä¸ªå±æ€§åä»¥ä¸‹åˆ’çº¿å¼€å§‹, å®ƒå°±åº”è¯¥åªèƒ½è¢«ç±»è‡ªèº«å†…éƒ¨çš„æ–¹æ³•è®¿é—®åˆ°, è€Œä¸æ˜¯ä½¿ç”¨è¿™ä¸ªç±»çš„ç”¨æˆ·.</p>
<h4 id="254-ç±»å±æ€§">2.5.4 ç±»å±æ€§</h4>
<p>ä¸€äº›å±æ€§å€¼æ˜¯å…±äº«ç»™æŒ‡å®šç±»çš„æ‰€æœ‰å¯¹è±¡è®¿é—®çš„. è¿™æ ·çš„å±æ€§æ˜¯è·Ÿç±»æœ¬èº«è€Œä¸æ˜¯ä»»ä½•ä¸ªåˆ«ç±»çš„å®ä¾‹ç›¸å…³è”çš„. ä¾‹å¦‚, è®©æˆ‘ä»¬å‡è®¾ä¸€ä¸ªé“¶è¡Œä»¥å›ºå®šåˆ©ç‡æ”¯ä»˜è´¦æˆ·ä½™é¢çš„åˆ©æ¯. åˆ©ç‡å¯èƒ½ä¼šå˜åŠ¨, ä½†æ˜¯è¿™æ˜¯ä¸€ä¸ªåœ¨æ‰€æœ‰è´¦æˆ·ä¸­å…±äº«çš„å•ä¸€å€¼.</p>
<p>ç±»å±æ€§é€šè¿‡èµ‹å€¼è¯­å¥åœ¨ç±»çš„å¥—ä»¶è¯­å¥ä¸­ä¸”åœ¨æ‰€æœ‰æ–¹æ³•å®šä¹‰çš„å¤–é¢åˆ›å»º. åœ¨æ›´å¹¿æ³›çš„å¼€å‘è€…ç¤¾åŒºä¸­, ç±»å±æ€§å¯èƒ½ä¹Ÿä¼šå«åšç±»å˜é‡æˆ–é™æ€å˜é‡. æ¥ä¸‹æ¥çš„ç±»è¯­å¥ä¸­ä¸º<code>Account</code>ç±»åˆ›å»ºä¸€ä¸ªåä¸º<code>interest</code>çš„å±æ€§.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">Account</span><span class="p">:</span>
        <span class="n">interest</span> <span class="o">=</span> <span class="mf">0.02</span>  <span class="c1"># ä¸€ä¸ªç±»å±æ€§</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">account_holder</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">holder</span> <span class="o">=</span> <span class="n">account_holder</span>
        <span class="c1"># é¢å¤–çš„æ–¹æ³•ä¼šåœ¨è¿™é‡Œå®šä¹‰</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿™ä¸ªå±æ€§ä¾ç„¶å¯ä»¥ä»ç±»çš„ä»»ä½•å®ä¾‹ä¸­è®¿é—®åˆ°.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">spock_account</span> <span class="o">=</span> <span class="n">Account</span><span class="p">(</span><span class="s1">&#39;Spock&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">kirk_account</span> <span class="o">=</span> <span class="n">Account</span><span class="p">(</span><span class="s1">&#39;Kirk&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">spock_account</span><span class="o">.</span><span class="n">interest</span>
<span class="mf">0.02</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">kirk_account</span><span class="o">.</span><span class="n">interest</span>
<span class="mf">0.02</span>
</code></pre></td></tr></table>
</div>
</div><p>ä½†æ˜¯, å¯¹ç±»å±æ€§çš„å•ä¸ªèµ‹å€¼è¯­å¥ä¼šæ›´æ”¹è¯¥ç±»çš„æ‰€æœ‰å®ä¾‹çš„å±æ€§å€¼.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">Account</span><span class="o">.</span><span class="n">interest</span> <span class="o">=</span> <span class="mf">0.04</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">spock_account</span><span class="o">.</span><span class="n">interest</span>
<span class="mf">0.04</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">kirk_account</span><span class="o">.</span><span class="n">interest</span>
<span class="mf">0.04</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>å±æ€§å</strong>. æˆ‘ä»¬å·²ç»åœ¨å¯¹è±¡ç³»ç»Ÿä¸­å¼•å…¥äº†è¶³å¤Ÿçš„å¤æ‚åº¦, ä»¥è‡³äºæˆ‘ä»¬å¿…é¡»è¦æŒ‡å®šå¦‚ä½•å°†åç§°è§£æä¸ºç‰¹æ®Šçš„å±æ€§. æ¯•ç«Ÿ, æˆ‘ä»¬å¯ä»¥è½»æ˜“åœ°æ‹¥æœ‰ä¸€ä¸ªç›¸åŒåç§°çš„ç±»å±æ€§ä»¥åŠå®ä¾‹å±æ€§.</p>
<p>å°±åƒæˆ‘ä»¬å·²ç»è§è¯†è¿‡çš„, ä¸€ä¸ªç‚¹è¡¨è¾¾å¼åŒ…å«ä¸€ä¸ªè¡¨è¾¾å¼, ä¸€ä¸ªç‚¹, ä»¥åŠä¸€ä¸ªåç§°:</p>
<p><code>&lt;expression&gt;.&lt;name&gt;</code></p>
<p>å»æ‰§è¡Œä¸€ä¸ªç‚¹è¡¨è¾¾å¼:</p>
<ol>
<li>æ‰§è¡Œåœ¨ç‚¹ç¬¦å·å·¦è¾¹çš„<code>&lt;expression&gt;</code>è¯­å¥, å®ƒè¿”å›çš„ä¸€ä¸ªå¯¹è±¡ç»™ç‚¹è¡¨è¾¾å¼.</li>
<li><code>&lt;name&gt;</code>è·Ÿå¯¹è±¡çš„å®ä¾‹å±æ€§ç›¸åŒ¹é…; å¦‚æœæœ‰ä¸€ä¸ªè¿™æ ·åç§°çš„å±æ€§, å°±ä¼šè¿”å›å®ƒçš„å€¼.</li>
<li>å¦‚æœ<code>&lt;name&gt;</code>æ²¡æœ‰å‡ºç°åœ¨å®ä¾‹å±æ€§ä¹‹ä¸­, é‚£ä¹ˆä¼šå»ç±»ä¸­æŸ¥æ‰¾<code>&lt;name&gt;</code>, (å¦‚æœæ‰¾åˆ°)å¹¶è¿”å›ç±»å±æ€§çš„å€¼.</li>
<li>é™¤éè¿™ä¸ªå€¼æ˜¯ä¸€ä¸ªå‡½æ•°, é‚£ä¹ˆå°†ä¼šè¿”å›ä¸€ä¸ªç»‘å®šäº†çš„æ–¹æ³•. å¦åˆ™å±æ€§å€¼å°†è¢«è¿”å›.</li>
</ol>
<p>åœ¨æ‰§è¡Œè¿‡ç¨‹å½“ä¸­, å®ä¾‹å±æ€§çš„æŸ¥æ‰¾ä¼šåœ¨ç±»å±æ€§ä¹‹å‰, å°±åƒæœ¬åœ°åç§°å¯¹äºå…¨å±€ç¯å¢ƒåç§°æ‰€å…·æœ‰çš„ä¼˜å…ˆæƒ. åœ¨ç±»ä¸­å®šä¹‰çš„æ–¹æ³•ä¼šè·Ÿç‚¹è¡¨è¾¾å¼ä¸­çš„å¯¹è±¡ç»“åˆé€šè¿‡æ‰§è¡Œç¬¬å››æ­¥çš„è¿‡ç¨‹å½¢æˆä¸€ä¸ªç»‘å®šæ–¹æ³•. è¿™ä¸ªæŸ¥æ‰¾ç±»ä¸­çš„åç§°çš„è¿‡ç¨‹ä¼šæœ‰é™„åŠ çš„ç»†å¾®å·®åˆ«, ä¸€æ—¦æˆ‘ä»¬ä»‹ç»ç±»ç»§æ‰¿ä¹‹åå°†ä¼šå¾ˆå¿«å‡ºç°.</p>
<p><strong>å±æ€§èµ‹å€¼</strong>. åœ¨å…¶å·¦ä¾§åŒ…å«ç‚¹è¡¨è¾¾å¼çš„æ‰€æœ‰èµ‹å€¼è¯­å¥éƒ½ä¼šå½±å“è¯¥ç‚¹è¡¨è¾¾å¼å¯¹è±¡çš„å±æ€§. å¦‚æœå¯¹è±¡æ˜¯ä¸€ä¸ªå®ä¾‹, é‚£ä¹ˆèµ‹å€¼ä¼šè®¾å®šä¸€ä¸ªå®ä¾‹å±æ€§. å¦‚æœå¯¹è±¡æ˜¯ä¸€ä¸ªç±», é‚£ä¹ˆèµ‹å€¼ä¼šè®¾å®šä¸€ä¸ªç±»å±æ€§. è¿™ä¸ªè§„åˆ™å¸¦æ¥çš„åæœæ˜¯, ä¸ºä¸€ä¸ªå¯¹è±¡èµ‹å€¼ä¸€ä¸ªå±æ€§ä¸èƒ½å½±å“åˆ°å®ƒçš„ç±»çš„å±æ€§. ä¸‹é¢çš„ä¾‹å­æ¼”ç¤ºäº†è¿™ä¸ªåŒºåˆ«.</p>
<p>å¦‚æœæˆ‘ä»¬ä¸ºä¸€ä¸ªè´¦æˆ·å®ä¾‹èµ‹å€¼ä¸€ä¸ªåä¸º<code>interest</code>çš„å±æ€§, æˆ‘ä»¬å°±åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„è·Ÿå·²ç»å­˜åœ¨çš„ç±»å±æ€§åç§°ä¸€æ ·çš„å®ä¾‹å±æ€§.</p>
<p><code>&gt;&gt;&gt; kirk_account.interest = 0.08</code></p>
<p>ç„¶åè¿™ä¸ªå±æ€§å€¼ä¼šåœ¨ç‚¹è¡¨è¾¾å¼ä¸­è¢«è¿”å›</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">kirk_account</span><span class="o">.</span><span class="n">interest</span>
<span class="mf">0.08</span>
</code></pre></td></tr></table>
</div>
</div><p>ç„¶è€Œ, ç±»å±æ€§<code>interest</code>ä»ç„¶ä¿ç•™å®ƒçš„åŸå§‹å€¼, æä¾›ç»™æ‰€æœ‰å…¶ä»–çš„è´¦æˆ·è¿”å›.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">spock_account</span><span class="o">.</span><span class="n">interest</span>
<span class="mf">0.04</span>
</code></pre></td></tr></table>
</div>
</div><p>æ›´æ”¹ç±»å±æ€§<code>interest</code>ä¼šå½±å“åˆ°<code>spock_account</code>, ä½†æ˜¯å¯¹<code>kirk_account</code>çš„å®ä¾‹å±æ€§ä¸ä¼šæœ‰å½±å“.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">Account</span><span class="o">.</span><span class="n">interest</span> <span class="o">=</span> <span class="mf">0.05</span>  <span class="c1"># changing the class attribute</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">spock_account</span><span class="o">.</span><span class="n">interest</span>     <span class="c1"># changes instances without like-named instance attributes</span>
<span class="mf">0.05</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">kirk_account</span><span class="o">.</span><span class="n">interest</span>     <span class="c1"># but the existing instance attribute is unaffected</span>
<span class="mf">0.08</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="255-ç»§æ‰¿">2.5.5 ç»§æ‰¿</h4>
<p>å½“åœ¨é¢å‘å¯¹è±¡æ¨¡å¼ä¸‹å·¥ä½œæ—¶ï¼Œæˆ‘ä»¬å¸¸å¸¸å‘ç°ä¸åŒçš„ç±»å‹æ˜¯æœ‰å…³ç³»çš„ã€‚å°¤å…¶æ˜¯ï¼Œæˆ‘ä»¬ä¼šå‘ç°ç›¸ä¼¼ç±»çš„åœ¨ä¸“æœ‰åŒ–ç¨‹åº¦ä¸Šæœ‰æ‰€ä¸åŒã€‚ä¸¤ä¸ªç±»å¯èƒ½ä¼šæœ‰ç›¸åŒçš„å±æ€§ï¼Œä½†æ˜¯å…¶ä¸­ä¸€ä¸ªä»£è¡¨çš„æ˜¯å¦ä¸€ä¸ªçš„ç‰¹æ®Šä¾‹å­ã€‚</p>
<p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šæƒ³è¦å®ç°ä¸€ä¸ªæ”¯ç¥¨è´¦æˆ·ï¼Œå®ƒè·Ÿæ ‡å‡†è´¦æˆ·æœ‰æ‰€ä¸åŒã€‚ä¸€ä¸ªæ”¯ç¥¨è´¦æˆ·æ¯æ¬¡å–é’±éƒ½éœ€è¦é¢å¤–çš„$1æ‰‹ç»­è´¹ä¸”å…·æœ‰æ›´ä½çš„åˆ©ç‡ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬æ¼”ç¤ºæœŸæœ›çš„è¡Œä¸ºã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">ch</span> <span class="o">=</span> <span class="n">CheckingAccount</span><span class="p">(</span><span class="s1">&#39;Spock&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ch</span><span class="o">.</span><span class="n">interest</span> <span class="c1"># æ”¯ç¥¨è´¦æˆ·å…·æœ‰æ›´ä½çš„åˆ©ç‡</span>
<span class="mf">0.01</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ch</span><span class="o">.</span><span class="n">deposit</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="c1"># å­˜æ¬¾æ˜¯ä¸€æ ·çš„</span>
<span class="mi">20</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ch</span><span class="o">.</span><span class="n">withdraw</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># å–æ¬¾éœ€è¦å‡å»é¢å¤–çš„è´¹ç”¨</span>
<span class="mi">14</span>
</code></pre></td></tr></table>
</div>
</div><p>ä¸€ä¸ª<code>CheckingAccount</code>æ˜¯ä¸€ä¸ªä¸“æœ‰åŒ–çš„<code>Account</code>ã€‚åœ¨OOPæœ¯è¯­ä¸­ï¼Œä¸€èˆ¬çš„è´¦æˆ·ä¼šä½œä¸º<code>CheckingAccount</code>çš„åŸºç±»ï¼Œè€Œ<code>CheckingAccount</code>ä¼šæˆä¸º<code>Account</code>çš„å­ç±»ï¼ˆæœ¯è¯­çˆ¶ç±»ä»¥åŠè¶…ç±»é€šå¸¸ä¹Ÿç”¨æ¥è¡¨ç¤ºåŸºç±»ï¼Œè€Œå­ç±»é€šå¸¸ä¹Ÿç”¨æ¥è¡¨ç¤ºå­é›†ã€‚ï¼‰</p>
<p>ä¸€ä¸ªå­ç±»ç»§æ‰¿å®ƒçš„åŸºç±»çš„å±æ€§ï¼Œä½†å¯èƒ½ä¼šé‡è½½æŸäº›å±æ€§ï¼ŒåŒ…æ‹¬æŸäº›æ–¹æ³•ã€‚æœ‰äº†ç»§æ‰¿ï¼Œæˆ‘ä»¬åªéœ€è¦æŒ‡å‡ºå­ç±»ä¸åŸºç±»ä¹‹é—´çš„ä¸åŒã€‚ä»»ä½•æˆ‘ä»¬åœ¨å­ç±»ä¸­æ²¡æœ‰ç‰¹åˆ«æŒ‡æ˜çš„éƒ½ä¼šè‡ªåŠ¨å‡å®šå®ƒçš„è¡Œä¸ºè·ŸåŸºç±»ä¸€æ ·ã€‚</p>
<p>ç»§æ‰¿é™¤äº†æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„ç»„ç»‡æ€§ç‰¹æ€§ï¼Œåœ¨å¯¹è±¡éšå–»ä¸­ä¹Ÿå…·æœ‰ä½œç”¨ã€‚ç»§æ‰¿ä»£è¡¨çš„æ„æ€æ˜¯ç±»ä¸­&quot;æ˜¯ä¸€ä¸ª&quot;çš„å…³ç³»ï¼Œå¯ä¸&quot;æœ‰ä¸€ä¸ª&quot;çš„å…³ç³»ç›¸ç±»æ¯”ã€‚ä¸€ä¸ªæ”¯ç¥¨è´¦æˆ·&quot;æ˜¯ä¸€ä¸ª&quot;ç‰¹æ®Šç±»å‹çš„è´¦æˆ·ï¼Œå› æ­¤ç»§æ‰¿è‡ª<code>Account</code>çš„<code>CheckingAccount</code>è´¦æˆ·å°±æ˜¯ç»§æ‰¿çš„æ°å½“ä½¿ç”¨ã€‚å¦ä¸€æ–¹é¢ï¼Œä¸€ä¸ªé“¶è¡Œ&quot;æœ‰ä¸€ä¸ª&quot;åˆ—çš„é“¶è¡Œè´¦æˆ·ç»™å®ƒç®¡ç†ç€ï¼Œå› æ­¤ï¼Œéƒ½ä¸åº”è¯¥ç»§æ‰¿å…¶ä»–ï¼Œè€Œæ˜¯ï¼Œè´¦æˆ·å¯¹è±¡åˆ—è¡¨ä¼šè‡ªç„¶åœ°è¡¨ç¤ºä¸ºä¸€ä¸ªé“¶è¡Œè´¦æˆ·å¯¹è±¡çš„å®ä¾‹å±æ€§ã€‚</p>
<h4 id="256-ä½¿ç”¨ç»§æ‰¿">2.5.6 ä½¿ç”¨ç»§æ‰¿</h4>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬ç»™å‡º<code>Account</code>çš„å®Œæ•´å®ç°ï¼ŒåŒ…æ‹¬ç±»çš„æ–‡æ¡£å­—ç¬¦ä¸²ä»¥åŠå®ƒçš„æ–¹æ³•ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">Account</span><span class="p">:</span>
        <span class="s2">&#34;&#34;&#34;A bank account that has a non-negative balance.&#34;&#34;&#34;</span>
        <span class="n">interest</span> <span class="o">=</span> <span class="mf">0.02</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">account_holder</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">holder</span> <span class="o">=</span> <span class="n">account_holder</span>
        <span class="k">def</span> <span class="nf">deposit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
            <span class="s2">&#34;&#34;&#34;Increase the account balance by amount and return the new balance.&#34;&#34;&#34;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">+</span> <span class="n">amount</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">balance</span>
        <span class="k">def</span> <span class="nf">withdraw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
            <span class="s2">&#34;&#34;&#34;Decrease the account balance by amount and return the new balance&#34;&#34;&#34;</span>
            <span class="k">if</span> <span class="n">amount</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">balance</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;Insufficient funds&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">-</span> <span class="n">amount</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">balance</span>
</code></pre></td></tr></table>
</div>
</div><p>ä¸‹é¢æ˜¾ç¤ºçš„æ˜¯<code>CheckingAccount</code>çš„å®Œæ•´å®ç°ã€‚æˆ‘ä»¬é€šè¿‡åœ¨ç±»ååçš„æ‹¬å·ä¸­æ”¾ç½®ä¸€ä¸ªè¿ç®—åä¸ºåŸºç±»çš„è¡¨è¾¾å¼æ¥æŒ‡å®šç»§æ‰¿ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">CheckingAccount</span><span class="p">(</span><span class="n">Account</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;A bank account that charges for withdrawals.&#34;&#34;&#34;</span>
        <span class="n">withdraw_charge</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">interest</span> <span class="o">=</span> <span class="mf">0.01</span>
        <span class="k">def</span> <span class="nf">withdraw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Account</span><span class="o">.</span><span class="n">withdraw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">withdraw_charge</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿™é‡Œï¼Œæˆ‘ä»¬å¼•å…¥ä¸€ä¸ªåœ¨ç±»<code>CheckingAccount</code>ä¸­æŒ‡å®šçš„å±æ€§<code>withdraw_charge</code>ã€‚æˆ‘ä»¬åˆ†é…ä¸€ä¸ªè¾ƒä½çš„å€¼ç»™<code>interest</code>å±æ€§ã€‚æˆ‘ä»¬åŒæ ·ä¹Ÿå®šä¹‰ä¸€ä¸ªæ–°çš„<code>withdraw</code>æ–¹æ³•æ¥é‡æ–°å®šä¹‰åœ¨<code>Account</code>ç±»ä¸­çš„è¡Œä¸ºã€‚åœ¨ç±»ä¸­æ²¡æœ‰è¿›ä¸€æ­¥çš„å£°æ˜ï¼Œæ‰€æœ‰å…¶ä»–çš„è¡Œä¸ºéƒ½æ˜¯ç»§æ‰¿è‡ªåŸºç±»<code>Account</code>ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">checking</span> <span class="o">=</span> <span class="n">CheckingAccount</span><span class="p">(</span><span class="s1">&#39;Sam&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">checking</span><span class="o">.</span><span class="n">deposit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="mi">10</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">checking</span><span class="o">.</span><span class="n">withdraw</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="mi">4</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">checking</span><span class="o">.</span><span class="n">interest</span>
<span class="mf">0.01</span>
</code></pre></td></tr></table>
</div>
</div><p>è¡¨è¾¾å¼<code>checking.deposit</code>è¿ç®—ç»‘å®šçš„å–æ¬¾æ–¹æ³•, ä¹Ÿå°±æ˜¯å®šä¹‰åœ¨<code>Account</code>ç±»å†…çš„æ–¹æ³•. å½“Pythonè§£æç‚¹è¡¨è¾¾å¼å†…ä¸æ˜¯å®ä¾‹å±æ€§çš„åç§°çš„æ—¶å€™, å®ƒä¼šåœ¨ç±»å†…éƒ¨æŸ¥æ‰¾åç§°. å®é™…ä¸Š, åœ¨ç±»å†…&quot;æŸ¥æ‰¾&quot;çš„è¡Œä¸ºå°è¯•å»æŸ¥æ‰¾åŸå§‹ç±»ç»§æ‰¿é“¾ä¸­çš„æ¯ä¸ªåŸºç±»ä¸­çš„åç§°. æˆ‘ä»¬å¯ä»¥é€’å½’åœ°å®šä¹‰è¿™ä¸ªè¿‡ç¨‹. æ¥æŸ¥æ‰¾ç±»ä¸­çš„åç§°.</p>
<ol>
<li>å¦‚æœå®ƒåœ¨ä¸€ä¸ªç±»ä¸­å‘½åäº†ä¸€ä¸ªå±æ€§, è¿”å›å±æ€§çš„å€¼.</li>
<li>å¦åˆ™, åœ¨åŸºç±»ä¸­æŸ¥æ‰¾åç§°, å¦‚æœé‡Œé¢æœ‰ä¸€ä¸ªçš„è¯.</li>
</ol>
<p>åœ¨<code>deposit</code>çš„ä¾‹å­ä¸­, Pythoné¦–å…ˆå¿…å®šä¼šåœ¨å®ä¾‹ä¸­æŸ¥æ‰¾åç§°, ç„¶ååœ¨<code>CheckingAccount</code>ç±»ä¸­æŸ¥æ‰¾. æœ€åä¼šåœ¨<code>Account</code>ç±»ä¸­æŸ¥æ‰¾, ä¹Ÿå°±æ˜¯<code>deposit</code>å®šä¹‰çš„åœ°æ–¹. æ ¹æ®æˆ‘ä»¬çš„ç‚¹è¡¨è¾¾å¼è¿ç®—è§„åˆ™, ç”±äº<code>deposit</code>æ˜¯åœ¨<code>checking</code>å®ä¾‹ä¸­æŸ¥æ‰¾ç±»å¾—åˆ°çš„å‡½æ•°, å³è¿ç®—ç‚¹è¡¨è¾¾å¼ç»‘å®šæ–¹æ³•çš„å€¼. æ­¤æ–¹æ³•ç”¨å‚æ•°10æ¥è°ƒç”¨, ä¼šç”¨ç»‘å®šäº†<code>checking</code>å¯¹è±¡çš„<code>self</code>ä»¥åŠç»‘å®šäº†10çš„<code>amount</code>è°ƒç”¨<code>deposit</code>æ–¹æ³•.</p>
<p>å¯¹è±¡çš„ç±»ä¼šä¸€ç›´ä¿æŒä¸å˜. å³ä½¿<code>deposit</code>æ–¹æ³•æ˜¯åœ¨<code>Account</code>ç±»ä¸­æ‰¾åˆ°çš„, <code>deposit</code>è°ƒç”¨æ—¶<code>self</code>ç»‘å®šçš„å®ä¾‹è¿˜æ˜¯å±äº<code>CheckingAccount</code>è€Œä¸æ˜¯<code>Account</code>.</p>
<p><strong>è°ƒç”¨ç¥–å…ˆ</strong>. å·²ç»è¢«é‡è½½çš„å±æ€§ä¾ç„¶èƒ½å¤Ÿé€šè¿‡ç±»å¯¹è±¡æ¥è®¿é—®. ä¾‹å¦‚, æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå«æœ‰<code>withdraw_charge</code>çš„å‚æ•°æ¥è°ƒç”¨<code>Account</code>çš„<code>withdraw</code>æ–¹æ³•ä»è€Œå®ç°<code>CheckingAccount</code>ç±»çš„<code>withdraw</code>æ–¹æ³•.</p>
<p>æ³¨æ„åˆ°æˆ‘ä»¬è°ƒç”¨<code>self.withdraw_charge</code>è€Œä¸æ˜¯ç­‰ä»·çš„<code>CheckingAccount.withdraw_charge</code>. å‰è€…ç›¸å¯¹äºåè€…çš„å¥½å¤„æ˜¯ä¸€ä¸ªç»§æ‰¿è‡ª<code>CheckingAccount</code>çš„ç±»å¯èƒ½ä¼šé‡å†™ä½“ç°çš„æ‰‹ç»­è´¹. å¦‚æœæ˜¯è¿™æ ·çš„æƒ…å†µ, æˆ‘ä»¬ä¼šæƒ³è¦è®©æˆ‘ä»¬å®ç°çš„<code>withdraw</code>æ‰¾åˆ°çš„æ˜¯æ–°çš„å€¼, è€Œä¸æ˜¯æ—§çš„å€¼.</p>
<p><strong>æ¥å£</strong>. åœ¨é¢å‘å¯¹è±¡ç¼–ç¨‹å½“ä¸­, ä¸åŒçš„ç±»å‹çš„å¯¹è±¡ç›¸äº’ä¹‹é—´å…±äº«ç›¸åŒçš„å±æ€§åç§°æ˜¯ååˆ†å¸¸è§çš„. ä¸€ä¸ªå¯¹è±¡æ¥å£æ˜¯ä¸€ä¸ªç”±å±æ€§ä»¥åŠå»ºç«‹åœ¨è¿™äº›å±æ€§ä¹‹ä¸Šçš„æ¡ä»¶çš„é›†åˆ. ä¾‹å¦‚, æ‰€æœ‰è´¦æˆ·å¿…é¡»è¦æœ‰æ¥å—æ•°å€¼çš„<code>deposit</code>ä»¥åŠ<code>withdraw</code>æ–¹æ³•, ä¹Ÿæœ‰ä¸€ä¸ª<code>balance</code>å±æ€§. è€Œç±»<code>Account</code>ä»¥åŠ<code>CheckingAccount</code>éƒ½å®ç°äº†è¿™äº›æ¥å£. åœ¨è¿™ç§æ–¹å¼ä¸‹ç»§æ‰¿å°¤å…¶ä¼šä¿ƒè¿›å‘½åå…±äº«. åœ¨ä¸€äº›ç¼–ç¨‹è¯­è¨€æ¯”å¦‚Java, æ¥å£å®ç°å¿…é¡»æ˜ç¡®åœ°è¢«å£°æ˜. åœ¨å…¶ä»–å¦‚Python, Rubyä»¥åŠGoä¸­, ä»»ä½•å…·æœ‰æ°å½“åç§°çš„å¯¹è±¡å°±æ˜¯ä¸€ä¸ªæ¥å£.</p>
<p>åœ¨ä½ çš„ç¨‹åºä¸­ä½¿ç”¨å¯¹è±¡(è€Œä¸æ˜¯å®ç°å®ƒä»¬)çš„éƒ¨åˆ†å¦‚æœå¯¹äºå¯¹è±¡çš„ç±»å‹æ²¡æœ‰ä½œå‡ºä»»ä½•å‡è®¾, è€Œæ˜¯åªå®šä¹‰äº†å®ƒä»¬çš„å±æ€§åç§°é‚£ä¹ˆå¯¹äºæœªæ¥çš„ä¿®æ”¹è¿™æ˜¯æœ€å¥å£®çš„. æ¢å¥è¯è¯´, å®ƒä»¬ä½¿ç”¨å¯¹è±¡æŠ½è±¡è€Œä¸æ˜¯å‡è®¾ä»»ä½•å…³äºå®ƒçš„å®ç°.</p>
<p>ä¾‹å¦‚, å‡å¦‚è¯´æˆ‘ä»¬è¿è¡Œä¸€ä¸ªå½©ç¥¨, åŒæ—¶æˆ‘ä»¬å¸Œæœ›å­˜å…¥$5åˆ°è´¦æˆ·åˆ—è¡¨çš„æ¯ä¸€ä¸ªè´¦æˆ·ä¸­. æ¥ä¸‹æ¥çš„å®ç°æ²¡æœ‰å‡è®¾ä»»ä½•å…³äºè¿™äº›è´¦æˆ·çš„ç±»å‹, å› æ­¤, èƒ½å¤Ÿåœ¨ä»»ä½•ç±»å‹çš„å…·æœ‰<code>deposit</code>æ–¹æ³•çš„å¯¹è±¡ä¸‹åŒç­‰è¿è¡Œ.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">deposit_all</span><span class="p">(</span><span class="n">winners</span><span class="p">,</span> <span class="n">amount</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">account</span> <span class="ow">in</span> <span class="n">winners</span><span class="p">:</span>
            <span class="n">account</span><span class="o">.</span><span class="n">deposit</span><span class="p">(</span><span class="n">amount</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>å‡½æ•°<code>deposit_all</code>åªå‡è®¾æ¯ä¸€ä¸ª<code>account</code>æ»¡è¶³è´¦æˆ·å¯¹è±¡çš„æŠ½è±¡, å› æ­¤å®ƒä¼šä¸ä»»ä½•å…¶ä»–ä¹Ÿå®ç°äº†è¿™ä¸ªæ¥å£çš„è´¦æˆ·ç±»å·¥ä½œ. å‡è®¾ä¸€ä¸ªç‰¹å®šçš„è´¦æˆ·ç±»ä¼šè¿åè¿™ä¸ªè´¦æˆ·å¯¹è±¡æŠ½è±¡çš„æŠ½è±¡å±éšœ. ä¾‹å¦‚, æ¥ä¸‹æ¥çš„å®ç°ä¸ä¸€å®šèƒ½è·Ÿæ–°ç±»å‹çš„è´¦æˆ·ä¸€èµ·å·¥ä½œ.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">deposit_all</span><span class="p">(</span><span class="n">winners</span><span class="p">,</span> <span class="n">amount</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">account</span> <span class="ow">in</span> <span class="n">winners</span><span class="p">:</span>
            <span class="n">Account</span><span class="o">.</span><span class="n">deposit</span><span class="p">(</span><span class="n">account</span><span class="p">,</span> <span class="n">amount</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>ç¨å, æˆ‘ä»¬å°†ä¼šåœ¨è¿™ä¸€ç« è¯¦ç»†è®²è¿°å…³äºè¿™ä¸ªä¸»é¢˜çš„æ›´å¤šç»†èŠ‚.</p>
<h4 id="257-å¤šé‡ç»§æ‰¿">2.5.7 å¤šé‡ç»§æ‰¿</h4>
<p>Pythonæ”¯æŒå­ç±»ä»å¤šä¸ªåŸºç±»ä¸­ç»§æ‰¿å±æ€§çš„æ¦‚å¿µ, è¿™ä¸€è¯­è¨€ç‰¹æ€§è¢«ç§°ä¸º_å¤šé‡ç»§æ‰¿_.</p>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç»§æ‰¿è‡ª<code>Account</code>çš„<code>SavingsAccount</code>, è¿™ä¸ªè´¦æˆ·æ¯æ¬¡å­˜æ¬¾éƒ½ä¼šæ”¶å–å®¢æˆ·ä¸€ç‚¹å°è´¹ç”¨.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">SavingsAccount</span><span class="p">(</span><span class="n">Account</span><span class="p">):</span>
        <span class="n">deposit_charge</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">def</span> <span class="nf">deposit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Account</span><span class="o">.</span><span class="n">deposit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">deposit_charge</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>ç„¶å, ä¸€ä¸ªèªæ˜çš„æ‰§è¡Œå®˜æ„æ€äº†ä¸€ä¸ª<code>AsSeenOnTVAccount</code>è´¦æˆ·, å®ƒå…·æœ‰<code>CheckingAccount</code>ä»¥åŠ<code>SavingsAccount</code>è´¦æˆ·çš„æœ€å¥½çš„ç‰¹æ€§: å–æ¬¾è´¹ç”¨, å­˜æ¬¾è´¹ç”¨, ä»¥åŠä½åˆ©ç‡. è¿™æ˜¯é›†å­˜æ¬¾ä»¥åŠå–æ¬¾è´¦æˆ·äºä¸€èº«çš„è´¦æˆ·! æ‰§è¡Œå®˜çš„ç†ç”±æ˜¯: &ldquo;å¦‚æœæˆ‘ä»¬æ„å»ºå®ƒçš„è¯, æœ‰äººæ„¿æ„å»ºç«‹è´¦æˆ·å¹¶æ”¯ä»˜è¿™äº›è´¹ç”¨, æˆ‘ä»¬ç”šè‡³ä¼šç»™ä»–ä»¬ä¸€ç¾å…ƒ&rdquo;.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">AsSeenOnTVAccount</span><span class="p">(</span><span class="n">CheckingAccount</span><span class="p">,</span> <span class="n">SavingsAccount</span><span class="p">):</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">account_holder</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">holder</span> <span class="o">=</span> <span class="n">account_holder</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># å…è´¹çš„1ç¾å…ƒ</span>
</code></pre></td></tr></table>
</div>
</div><p>å®é™…ä¸Š, è¿™ä¸ªå®ç°æ˜¯å¤æ‚çš„. åˆ†åˆ«ä½¿ç”¨å®šä¹‰åœ¨<code>CheckingAccount</code>ä»¥åŠ<code>SavingsAccount</code>ä¸­çš„å‡½æ•°æ¥å–æ¬¾ä»¥åŠå­˜æ¬¾éƒ½ä¼šäº§ç”Ÿè´¹ç”¨.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">such_a_deal</span> <span class="o">=</span> <span class="n">AsSeenOnTVAccount</span><span class="p">(</span><span class="s2">&#34;John&#34;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">such_a_deal</span><span class="o">.</span><span class="n">balance</span>
<span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">such_a_deal</span><span class="o">.</span><span class="n">deposit</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>         <span class="c1"># æ¥è‡ªSavingsAccount.depositçš„è´¹ç”¨ $2</span>
<span class="mi">19</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">such_a_deal</span><span class="o">.</span><span class="n">withdraw</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>         <span class="c1"># æ¥è‡ªCheckingAccount.withdrawçš„è´¹ç”¨ $1</span>
<span class="mi">13</span>
</code></pre></td></tr></table>
</div>
</div><p>æ— äºŒä¹‰æ€§å¼•ç”¨èƒ½å¤ŸæŒ‰æœŸæœ›è¢«å¤„ç†:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">such_a_deal</span><span class="o">.</span><span class="n">deposit_charge</span>
<span class="mi">2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">such_a_deal</span><span class="o">.</span><span class="n">withdraw_charge</span>
<span class="mi">1</span>
</code></pre></td></tr></table>
</div>
</div><p>ä½†æ˜¯å½“å¼•ç”¨æœ‰æ­§ä¹‰æ—¶ä¼šæ€æ ·å‘¢, ä¾‹å¦‚åœ¨<code>Account</code>ä»¥åŠ<code>CheckingAccount</code>éƒ½å®šä¹‰äº†çš„<code>withdraw</code>æ–¹æ³•çš„å¼•ç”¨? ä¸‹é¢çš„å›¾ä¾‹æç»˜äº†<code>AsSeenOnTVAccount</code>ç±»çš„ç»§æ‰¿å›¾. æ¯ä¸€ä¸ªç®­å¤´éƒ½æ˜¯ä»å­ç±»æŒ‡å‘çˆ¶ç±».</p>
<p><img src="http://www.composingprograms.com/img/multiple_inheritance.png" alt="å¤šé‡ç»§æ‰¿å›¾ä¾‹" /></p>
<p>åƒè¿™æ ·ä¸€ä¸ªçš„ç®€å•çš„è±å½¢å½¢çŠ¶, Pythonæ˜¯ä»å·¦åˆ°å³, ç„¶åå‘ä¸Šå¤„ç†åç§°. åœ¨è¿™ä¸ªä¾‹å­ä¸­, PythonæŒ‰ç…§ä»¥ä¸‹ç±»çš„æ’åºæ¥æ£€æŸ¥ä¸€ä¸ªå±æ€§åç§°, ç›´åˆ°æ‰¾åˆ°å…·æœ‰è¿™æ ·åç§°çš„å±æ€§:</p>
<p>AsSeenOnTVAccount, CheckingAccount, SavingsAccount, Account, object</p>
<p>è¿™ä¸æ˜¯ä¸€ä¸ªæ­£ç¡®å¤„ç†ç»§æ‰¿é¡ºåºé—®é¢˜çš„åŠæ³•, æœ‰ä¸€äº›ä¾‹å­ä¸­æˆ‘ä»¬å¯èƒ½æ›´å€¾å‘äºç»™æ›´é«˜çš„ä¼˜å…ˆçº§ç»™æŸäº›ç»§æ‰¿çš„ç±»è€Œä¸æ˜¯å…¶ä»–çš„. ç„¶è€Œ, ä»»ä½•æ”¯æŒå¤šé‡ç»§æ‰¿çš„ç¼–ç¨‹è¯­è¨€éƒ½å¿…é¡»è¦é€‰æ‹©æŸäº›ä¸€è‡´çš„é¡ºåºæ–¹å¼, æ¥è®©ä½¿ç”¨è¿™ä¸ªè¯­è¨€çš„ç”¨æˆ·å¯ä»¥é¢„çŸ¥ä»–ä»¬çš„ç¨‹åºçš„è¡Œä¸º.</p>
<p><strong>è¿›ä¸€æ­¥é˜…è¯»</strong>. Pythonä½¿ç”¨ç§°ä½œC3æ’åºè§£å†³æ–¹æ³•çš„é€’å½’ç®—æ³•æ¥å¤„ç†è¿™ä¸ªåç§°. ä»»ä½•ç±»æ–¹æ³•çš„è§£å†³é¡ºåºå¯ä»¥åœ¨æ‰€æœ‰ç±»ä¸­ä½¿ç”¨<code>mro</code>æ–¹æ³•æŸ¥è¯¢.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="vm">__name__</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">AsSeenOnTVAccount</span><span class="o">.</span><span class="n">mro</span><span class="p">()]</span>
<span class="p">[</span><span class="s1">&#39;AsSeenOnTVAccount&#39;</span><span class="p">,</span> <span class="s1">&#39;CheckingAccount&#39;</span><span class="p">,</span> <span class="s1">&#39;SavingsAccount&#39;</span><span class="p">,</span> <span class="s1">&#39;Account&#39;</span><span class="p">,</span> <span class="s1">&#39;object&#39;</span><span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><p>è§£å†³é¡ºåºçš„æŸ¥æ‰¾æ–¹æ³•çš„ç²¾ç¡®ç®—æ³•ä¸æ˜¯æœ¬æ–‡çš„ä¸»é¢˜, ä½†æ˜¯å®ƒè¢«<a href="http://python-history.blogspot.com/2010/06/method-resolution-order.html">æè¿°åœ¨Pythonçš„ç¬¬ä¸€ä½œè€…</a>çš„åŸè‘—è®ºæ–‡çš„å¼•ç”¨ä¸­.</p>
<h4 id="258-å¯¹è±¡çš„ä½œç”¨">2.5.8 å¯¹è±¡çš„ä½œç”¨</h4>
<p>Pythonå¯¹è±¡ç³»ç»Ÿæ˜¯ä¸ºäº†ä½¿æ•°æ®æŠ½è±¡ä»¥åŠæ¶ˆæ¯ä¼ é€’æ–¹ä¾¿å’Œçµæ´»è€Œè®¾è®¡çš„. ç±», æ–¹æ³•, ç»§æ‰¿, ä»¥åŠç‚¹è¡¨è¾¾å¼çš„ä¸“æœ‰è¯­æ³•éƒ½æ˜¯å…è®¸æˆ‘ä»¬åœ¨ç¨‹åºä¸­å½¢è±¡åŒ–å¯¹è±¡çš„æ¯”å–», ä¹Ÿå°±æ˜¯æå‡æˆ‘ä»¬ç»„ç»‡å¤§å‹ç¨‹åºçš„èƒ½åŠ›.</p>
<p>ç‰¹åˆ«åœ°, æˆ‘ä»¬ä¼šå¸Œæœ›æˆ‘ä»¬çš„å¯¹è±¡ç³»ç»Ÿä¿ƒè¿›ç¨‹åºä¸åŒå…³æ³¨ç‚¹çš„åˆ†ç¦». ç¨‹åºä¸­çš„æ¯ä¸ªå¯¹è±¡éƒ½å°è£…å¹¶ç®¡ç†æŸéƒ¨åˆ†çš„ç¨‹åºçš„çŠ¶æ€, åŒæ—¶æ¯ä¸ªç±»å£°æ˜å†…å®šä¹‰çš„å‡½æ•°éƒ½å®ç°äº†ç¨‹åºæ€»ä½“é€»è¾‘çš„ä¸€éƒ¨åˆ†. æŠ½è±¡å±éšœåœ¨å¤§å‹ç¨‹åºçš„ä¸åŒæ–¹é¢å½¢æˆç•Œé™.</p>
<p>é¢å‘å¯¹è±¡ç¼–ç¨‹å°¤å…¶é€‚åˆå»ç¼–å†™åˆ†ç¦»ä½†æ˜¯ä¹Ÿæœ‰äº¤äº’éƒ¨åˆ†çš„æ¨¡å‹ç³»ç»Ÿ. ä¾‹å¦‚, ä¸åŒç”¨æˆ·åœ¨ç¤¾äº¤ç½‘ç»œä¸­äº¤äº’, ä¸åŒçš„è§’è‰²åœ¨æ¸¸æˆä¸­äº¤äº’, ä»¥åŠä¸åŒçš„å½¢çŠ¶åœ¨ç‰©ç†ä»¿çœŸç³»ç»Ÿä¸­äº¤äº’. å½“è¦è¡¨ç°è¿™æ ·çš„ä¸€ä¸ªç³»ç»Ÿæ—¶, åœ¨ç¨‹åºä¸­çš„å¯¹è±¡å¸¸å¸¸è‡ªç„¶åœ°æ˜ å°„åˆ°ç³»ç»Ÿä¸­å·²ç»å»ºæ¨¡çš„å¯¹è±¡ä¸Š, åŒæ—¶ç±»æç»˜å®ƒä»¬çš„ç±»å‹ä»¥åŠå…³ç³».</p>
<p>å¦ä¸€æ–¹é¢, ç±»å¯èƒ½ä¸ä¼šæä¾›æœ€å¥½çš„æœºåˆ¶æ¥å®ç°æŸäº›æŠ½è±¡. åŠŸèƒ½æŠ½è±¡ä¸ºè¾“å…¥è¾“å‡ºä¹‹é—´çš„å…³ç³»è¡¨ç°æä¾›æ›´è‡ªç„¶çš„éšå–». ä¸åº”è¯¥è¿«ä½¿åœ¨ç±»ä¸­ç¨‹åºçš„æ¯ä¸€ç‚¹éƒ½ç¬¦åˆé€»è¾‘, å°¤å…¶æ˜¯å½“ä¸ºäº†æ›´è‡ªç„¶åœ°æ“ä½œæ•°æ®æ—¶å®šä¹‰çš„ç‹¬ç«‹å‡½æ•°. å‡½æ•°ä¹Ÿå¯ä»¥å®ä¹ åˆ†ç¦»å…³æ³¨ç‚¹.</p>
<p>å¤šèŒƒä¾‹è¯­è¨€å¦‚Pythonå…è®¸ç¨‹åºå‘˜å¯¹é€‚å½“çš„é—®é¢˜æ¥ä½¿ç”¨æ°å½“çš„æ¨¡å¼. å­¦ä¹ è¯†åˆ«ä»€ä¹ˆæ—¶å€™åº”è¯¥å¼•å…¥ä¸€ä¸ªæ–°çš„ç±», æˆ–è€…ä¸ä¹‹å¯¹ç…§çš„æ–°å‡½æ•°ä¸ºäº†ç®€åŒ–æˆ–è€…æ¨¡å—åŒ–ä¸€ä¸ªç¨‹åº, åœ¨è½¯ä»¶å·¥ç¨‹ä¸­æ˜¯ä¸€ä¸ªé‡è¦çš„è®¾è®¡æŠ€èƒ½å€¼å¾—è®¤çœŸå…³æ³¨.</p>
<h3 id="26-å®ç°ç±»ä»¥åŠå¯¹è±¡">2.6 å®ç°ç±»ä»¥åŠå¯¹è±¡</h3>
<p>å½“åœ¨é¢å‘å¯¹è±¡ç¼–ç¨‹èŒƒå¼ä¸‹å·¥ä½œæ—¶, æˆ‘ä»¬ä½¿ç”¨å¯¹è±¡éšå–»å»æŒ‡å¯¼æˆ‘ä»¬ç¨‹åºçš„ç»„ç»‡. åœ¨ç±»å£°æ˜å½“ä¸­è¡¨è¾¾çš„å¤§å¤šæ•°é€»è¾‘æ˜¯å…³äºå¦‚ä½•è¡¨ç¤ºä»¥åŠæ“ä½œæ•°æ®çš„. åœ¨è¿™ä¸€èŠ‚å½“ä¸­, æˆ‘ä»¬ä¼šçœ‹åˆ°ç±»ä»¥åŠå¯¹è±¡æœ¬èº«å¯ä»¥ä»…ä»…ä½¿ç”¨å‡½æ•°ä»¥åŠå­—å…¸æ¥è¡¨ç¤º. ç”¨è¿™ç§æ–¹æ³•å®ç°ä¸€ä¸ªå¯¹è±¡ç³»ç»Ÿçš„ç›®çš„æ˜¯é˜æ˜ç”¨å¯¹è±¡éšå–»ä¸éœ€è¦ç‰¹åˆ«çš„ç¼–ç¨‹è¯­è¨€. Pythonå¯ä»¥æ˜¯é¢å‘å¯¹è±¡çš„, ç”šè‡³ä¸€ä¸ªæ²¡æœ‰å†…å»ºå¯¹è±¡ç³»ç»Ÿçš„ç¼–ç¨‹è¯­è¨€ä¹Ÿå¯ä»¥.</p>
<p>ä¸ºäº†å®ç°å¯¹è±¡, æˆ‘ä»¬ä¼šæŠ›å¼ƒç‚¹ç¬¦å·(éœ€è¦å†…å»ºçš„è¯­è¨€æ”¯æŒ), ä½†æ˜¯ä¼šåˆ›å»ºä¸€ä¸ªè°ƒåº¦å­—å…¸, å®ƒçš„è¡Œä¸ºè·Ÿå†…å»ºçš„å¯¹è±¡ç³»ç»Ÿå…ƒç´ çš„å¤§è‡´ä¸€æ ·. æˆ‘ä»¬å·²ç»è§è¯†è¿‡å¦‚ä½•é€šè¿‡è°ƒåº¦å­—å…¸å®ç°æ¶ˆæ¯ä¼ é€’è¡Œä¸º. ä¸ºäº†å®Œå…¨å®ç°ä¸€ä¸ªå¯¹è±¡ç³»ç»Ÿ, æˆ‘ä»¬åœ¨å®ä¾‹, ç±»ä»¥åŠåŸºç±»ä»¥åŠæ‰€æœ‰å«æœ‰å±æ€§çš„å­—å…¸å½“ä¸­å‘é€æ¶ˆæ¯.</p>
<p>æˆ‘ä»¬ä¸ä¼šå®ç°æ•´ä¸ªPythonå¯¹è±¡ç³»ç»Ÿ, å…¶ä¸­åŒ…æ‹¬åœ¨æœ¬æ–‡ä¸­æ²¡æœ‰è¦†ç›–åˆ°çš„ç‰¹æ€§(ä¾‹å¦‚, å…ƒç±»ä»¥åŠé™æ€æ–¹æ³•). ç›¸å, æˆ‘ä»¬ä¼šä¸“æ³¨äºæ²¡æœ‰å¤šç»§æ‰¿ä¹Ÿæ²¡æœ‰è‡ªçœè¡Œä¸º(ä¾‹å¦‚è¿”å›ä¸€ä¸ªç±»çš„å®ä¾‹)çš„ç”¨æˆ·å®šä¹‰ç±». æˆ‘ä»¬çš„å®ç°å¹¶ä¸æ„å‘³ç€æŒ‰ç…§Pythonç±»å‹ç³»ç»Ÿçš„ç²¾ç¡®è§„èŒƒ. ç›¸å, è¿™ä¹ˆåšçš„ç›®çš„æ˜¯å®ç°å¯¹è±¡éšå–»çš„æ ¸å¿ƒåŠŸèƒ½.</p>
<h4 id="261-å®ä¾‹">2.6.1 å®ä¾‹</h4>
<p>æˆ‘ä»¬ä»å®ä¾‹å¼€å§‹. ä¸€ä¸ªå®ä¾‹å…·æœ‰å‘½åçš„å±æ€§, ä¾‹å¦‚ä¸€ä¸ªè´¦æˆ·å†…çš„ä½™é¢, å¯ä»¥è¢«è®¾ç½®ä»¥åŠæ¢å¤. æˆ‘ä»¬ç”¨ä¸€ä¸ªè°ƒåº¦å­—å…¸å®ç°ä¸€ä¸ªå¯ä»¥å“åº”&quot;get&quot;ä»¥åŠ&quot;set&quot;å±æ€§å€¼çš„å®ä¾‹. å±æ€§æœ¬èº«è¢«ä¿å­˜åœ¨ä¸€ä¸ªå«åš<code>attributes</code>çš„æœ¬åœ°å­—å…¸å½“ä¸­.</p>
<p>å°±åƒæˆ‘ä»¬åœ¨ä¹‹å‰çš„ç« èŠ‚ä¸­çœ‹åˆ°çš„, å­—å…¸æœ¬èº«æ˜¯æŠ½è±¡æ•°æ®ç±»å‹. æˆ‘ä»¬ç”¨åˆ—è¡¨å®ç°ä¸€ä¸ªå­—å…¸, æˆ‘ä»¬ç”¨æ•°æ®å¯¹æ¥å®ç°åˆ—è¡¨, åŒæ—¶æˆ‘ä»¬ç”¨å‡½æ•°æ¥å®ç°æ•°æ®å¯¹. å½“æˆ‘ä»¬ä¾æ®å­—å…¸æ¥å®ç°ä¸€ä¸ªå¯¹è±¡ç³»ç»Ÿæ—¶, è¦è®°ä½çš„æ˜¯æˆ‘ä»¬ä¹Ÿå¯ä»¥åªç”¨å‡½æ•°æ¥å®ç°å¯¹è±¡.</p>
<p>è¦å¼€å§‹æˆ‘ä»¬çš„å®ç°, æˆ‘ä»¬å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç±»çš„å®ç°å¯ä»¥æŸ¥æ‰¾ä»»ä½•ä¸æ˜¯å®ä¾‹çš„ä¸€éƒ¨åˆ†çš„åç§°. æˆ‘ä»¬è¿›å…¥ä¸€ä¸ªä¼ å…¥å‚æ•°<code>cls</code>çš„ç±»<code>make_instance</code>å½“ä¸­.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">make_instance</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;Return a new object instance, which is a dispatch dictionary.&#34;&#34;&#34;</span>
        <span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">attributes</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">attributes</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">[</span><span class="s1">&#39;get&#39;</span><span class="p">](</span><span class="n">name</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">bind_method</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">instance</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
            <span class="n">attributes</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
            <span class="n">attributes</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">instance</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;get&#39;</span><span class="p">:</span> <span class="n">get_value</span><span class="p">,</span> <span class="s1">&#39;set&#39;</span><span class="p">:</span> <span class="n">set_value</span><span class="p">}</span>
            <span class="k">return</span> <span class="n">instance</span>
</code></pre></td></tr></table>
</div>
</div><p><code>instance</code>æ˜¯ä¸€ä¸ªè°ƒåº¦å­—å…¸ç”¨æ¥å“åº”<code>get</code>ä»¥åŠ<code>set</code>æ¶ˆæ¯. <code>set</code>æ¶ˆæ¯ç›¸å½“äºPythonçš„å¯¹è±¡ç³»ç»Ÿçš„å±æ€§èµ‹å€¼: æ‰€æœ‰åˆ†é…äº†çš„å±æ€§éƒ½ç›´æ¥ä¿å­˜åœ¨å¯¹è±¡çš„æœ¬åœ°å±æ€§å­—å…¸å½“ä¸­. åœ¨<code>get</code>æ–¹æ³•ä¸­, å¦‚æœ<code>name</code>ä¸å‡ºç°åœ¨æœ¬åœ°çš„<code>attributes</code>å­—å…¸ä¸­, é‚£ä¹ˆå®ƒä¼šåœ¨ç±»å½“ä¸­æŸ¥æ‰¾. å¦‚æœé€šè¿‡<code>cls</code>è¿”å›çš„<code>value</code>æ˜¯ä¸€ä¸ªå‡½æ•°, å®ƒå¿…é¡»è·Ÿä¸€ä¸ªå®ä¾‹ç»‘å®š.</p>
<p><strong>ç»‘å®šå€¼æ–¹æ³•</strong>. åœ¨<code>make_instance</code>ä¸­çš„<code>get_value</code>å‡½æ•°é€šè¿‡ç±»çš„<code>get</code>(æ–¹æ³•)æ¥æ‰¾åˆ°ä¸€ä¸ªå‘½åå±æ€§, ç„¶åè°ƒç”¨<code>bind_method</code>æ–¹æ³•. ç»‘å®šæ–¹æ³•åªç”¨äºå‡½æ•°å€¼, åŒæ—¶å®ƒé€šè¿‡æ’å…¥å®ä¾‹ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä»ä¸€ä¸ªå‡½æ•°å€¼ä¸­åˆ›å»ºä¸€ä¸ªç»‘å®šæ–¹æ³•å€¼.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">bind_method</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">instance</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;Return a bound method if value is callable, or value otherwise.&#34;&#34;&#34;</span>
        <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">method</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">value</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">method</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">value</span>
</code></pre></td></tr></table>
</div>
</div><p>å½“ä¸€ä¸ªæ–¹æ³•æ˜¯å¯è°ƒç”¨æ—¶, é€šè¿‡è¿™ä¸ªå®šä¹‰ç¬¬ä¸€ä¸ªå‚æ•°selfä¼šè¢«ç»‘å®šä¸ºå€¼<code>instance</code>.</p>
<h4 id="262-ç±»">2.6.2 ç±»</h4>
<p>ä¸€ä¸ªç±»ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡, éƒ½å­˜åœ¨äºPythonçš„å¯¹è±¡ç³»ç»Ÿä»¥åŠç°åœ¨æˆ‘ä»¬è¿™é‡Œå®ç°çš„ç³»ç»Ÿ. ä¸ºäº†ç®€å•èµ·è§, æˆ‘ä»¬çš„ç±»å¹¶æ²¡æœ‰å®ƒä»¬è‡ªå·±çš„ç±»å‹. (åœ¨Pythonä¸­, ç±»éƒ½æ˜¯æœ‰å®ƒä»¬è‡ªå·±çš„ç±»å‹çš„; å‡ ä¹æ‰€æœ‰çš„ç±»éƒ½å…±äº«ç›¸åŒçš„ç±»å‹, å«åš<code>type</code>.) ä¸€ä¸ªç±»å¯ä»¥å“åº”<code>get</code>ä»¥åŠ<code>set</code>æ¶ˆæ¯, ä¹Ÿå¯ä»¥å“åº”<code>new</code>æ¶ˆæ¯:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">make_class</span><span class="p">(</span><span class="n">attributes</span><span class="p">,</span> <span class="n">base_class</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;Return a new class, which is a dispatch dictionary.&#34;&#34;&#34;</span>
        <span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">attributes</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">attributes</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">base_class</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">base_class</span><span class="p">[</span><span class="s1">&#39;get&#39;</span><span class="p">](</span><span class="n">name</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
            <span class="n">attributes</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">def</span> <span class="nf">new</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">init_instance</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="bp">cls</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;get&#39;</span><span class="p">:</span> <span class="n">get_value</span><span class="p">,</span> <span class="s1">&#39;set&#39;</span><span class="p">:</span> <span class="n">set_value</span><span class="p">,</span> <span class="s1">&#39;new&#39;</span><span class="p">:</span> <span class="n">new</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">cls</span>
</code></pre></td></tr></table>
</div>
</div><p>ä¸åƒä¸€ä¸ªå®ä¾‹, å½“æ‰¾ä¸åˆ°ä¸€ä¸ªå±æ€§çš„æ—¶å€™ç±»å‹çš„<code>get</code>å‡½æ•°ä¸ä¼šæŸ¥è¯¢å®ƒçš„ç±», å–è€Œä»£ä¹‹çš„æ˜¯æŸ¥è¯¢å®ƒçš„åŸºç±». ç±»ä¸éœ€è¦è¿›è¡Œæ–¹æ³•ç»‘å®š.</p>
<p><strong>åˆå§‹åŒ–</strong>. åœ¨<code>make_class</code>çš„<code>new</code>å‡½æ•°è°ƒç”¨<code>init_instance</code>, é¦–å…ˆä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹, ç„¶åè°ƒç”¨å«åš<code>__init__</code>çš„æ–¹æ³•.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">init_instance</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;Return a new object with type cls, initialized with args.&#34;&#34;&#34;</span>
        <span class="n">instance</span> <span class="o">=</span> <span class="n">make_instance</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
        <span class="n">init</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">[</span><span class="s1">&#39;get&#39;</span><span class="p">](</span><span class="s1">&#39;__init__&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">init</span><span class="p">:</span>
            <span class="n">init</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">instance</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿™æœ€åçš„å‡½æ•°å®Œæˆäº†æˆ‘ä»¬çš„å¯¹è±¡ç³»ç»Ÿ. æˆ‘ä»¬ç°åœ¨æœ‰ä¼šåœ¨å±€éƒ¨<code>set</code>ä½†æ˜¯<code>get</code>æ—¶å¯å›é€€åˆ°å®ƒä»¬çš„ç±»çš„å®ä¾‹. ä¸€ä¸ªå®ä¾‹åœ¨å®ƒçš„ç±»ä¸­æŸ¥æ‰¾åç§°ä¹‹å, å®ƒç»‘å®šå®ƒè‡ªå·±æœ¬èº«åˆ°ä¸€ä¸ªå‡½æ•°å€¼æ¥åˆ›å»ºä¸€ä¸ªæ–¹æ³•. æœ€å, ç±»å¯ä»¥åˆ›å»ºæ–°(<code>new</code>)å®ä¾‹, ç„¶åå®ƒä»¬åœ¨å®ä¾‹åˆ›å»ºä¹‹åç«‹å³åº”ç”¨å®ƒä»¬çš„<code>__init__</code>æ„é€ å™¨å‡½æ•°.</p>
<p>åœ¨è¿™ä¸ªå¯¹è±¡ç³»ç»Ÿ, å”¯ä¸€åº”è¯¥é€šè¿‡ç”¨æˆ·è°ƒç”¨çš„å‡½æ•°æ˜¯<code>make_class</code>. æ‰€æœ‰å…¶ä»–çš„åŠŸèƒ½é€šè¿‡æ¶ˆæ¯ä¼ é€’æ¥æ¿€æ´». åŒæ ·åœ°, Pythonçš„å¯¹è±¡ç³»ç»Ÿæ˜¯é€šè¿‡<code>class</code>å£°æ˜æ¥è°ƒç”¨, ä»¥åŠæ‰€æœ‰å®ƒçš„å…¶ä»–åŠŸèƒ½é€šè¿‡ç‚¹è¯­æ³•ä»¥åŠè°ƒç”¨ç±»æ¥æ¿€æ´».</p>
<h4 id="263-ä½¿ç”¨å·²ç»å®ç°çš„å¯¹è±¡">2.6.3 ä½¿ç”¨å·²ç»å®ç°çš„å¯¹è±¡</h4>
<p>æˆ‘ä»¬ç°åœ¨å›åˆ°ä¹‹å‰ç« èŠ‚çš„ä½¿ç”¨é“¶è¡Œè´¦æˆ·çš„ä¾‹å­. ä½¿ç”¨æˆ‘ä»¬å®ç°äº†çš„å¯¹è±¡ç³»ç»Ÿ, æˆ‘ä»¬ä¼šåˆ›å»ºä¸€ä¸ª<code>Account</code>ç±», ä¸€ä¸ª<code>CheckingAccount</code>å­ç±», ä»¥åŠä¸€ä¸ªå„è‡ªçš„å®ä¾‹.</p>
<p><code>Account</code>ç±»æ˜¯é€šè¿‡<code>make_account_class</code>å‡½æ•°åˆ›å»ºçš„, ä¹Ÿå°±æ˜¯è·Ÿåœ¨Pythonä¸­çš„<code>class</code>å£°æ˜æœ‰ç›¸ä¼¼ç»“æ„çš„å‡½æ•°, ä½†æ˜¯ä»¥è°ƒç”¨<code>make_class</code>ç»“æŸ.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">make_account_class</span><span class="p">():</span>
        <span class="s2">&#34;&#34;&#34;Return the Account class, which has deposit and withdraw methods.&#34;&#34;&#34;</span>
        <span class="n">interest</span> <span class="o">=</span> <span class="mf">0.02</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">account_holder</span><span class="p">):</span>
            <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;set&#39;</span><span class="p">](</span><span class="s1">&#39;holder&#39;</span><span class="p">,</span> <span class="n">account_holder</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;set&#39;</span><span class="p">](</span><span class="s1">&#39;balance&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">deposit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
            <span class="s2">&#34;&#34;&#34;Increase the account balance by amount and return the new balance.&#34;&#34;&#34;</span>
            <span class="n">new_balance</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;get&#39;</span><span class="p">](</span><span class="s1">&#39;balance&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">amount</span>
            <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;set&#39;</span><span class="p">](</span><span class="s1">&#39;balance&#39;</span><span class="p">,</span> <span class="n">new_balance</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;get&#39;</span><span class="p">](</span><span class="s1">&#39;balance&#39;</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">withdraw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
            <span class="s2">&#34;&#34;&#34;Decrease the account balance by amount and return the new balance.&#34;&#34;&#34;</span>
            <span class="n">balance</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;get&#39;</span><span class="p">](</span><span class="s1">&#39;balance&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">amount</span> <span class="o">&gt;</span> <span class="n">balance</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;Insufficient funds&#39;</span>
            <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;set&#39;</span><span class="p">](</span><span class="s1">&#39;balance&#39;</span><span class="p">,</span> <span class="n">balance</span> <span class="o">-</span> <span class="n">amount</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;get&#39;</span><span class="p">](</span><span class="s1">&#39;balance&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">make_class</span><span class="p">(</span><span class="nb">locals</span><span class="p">())</span>
</code></pre></td></tr></table>
</div>
</div><p>æœ€åè°ƒç”¨<code>locals</code>è¿”å›ä¸€ä¸ªæœ‰å­—ç¬¦ä¸²ä¸ºé”®çš„å­—å…¸, å®ƒåœ¨å±€éƒ¨å¸§ä¸­åŒ…å«æ–°çš„åå€¼ç»‘å®š.</p>
<p><code>Account</code>ç±»æœ€åæ˜¯é€šè¿‡èµ‹å€¼æ¥å®ä¾‹åŒ–çš„.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">Account</span> <span class="o">=</span> <span class="n">make_account_class</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p>ç„¶å, ä¸€ä¸ªè´¦æˆ·å®ä¾‹é€šè¿‡<code>new</code>æ¶ˆæ¯æ¥åˆ›å»º, ä¹Ÿå°±æ˜¯éœ€è¦ä¸€ä¸ªåç§°æ¥ç»™æ–°åˆ›å»ºçš„è´¦æˆ·.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">kirk_account</span> <span class="o">=</span> <span class="n">Account</span><span class="p">[</span><span class="s1">&#39;new&#39;</span><span class="p">](</span><span class="s1">&#39;Kirk&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>ç„¶å, <code>get</code>æ¶ˆæ¯ä¼ é€’ç»™<code>kirk_account</code>æ¥æ£€ç´¢å±æ€§ä»¥åŠæ–¹æ³•. æ–¹æ³•å¯ä»¥è¢«è°ƒç”¨æ¥æ›´æ–°è´¦æˆ·çš„ä½™é¢.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">kirk_account</span><span class="p">[</span><span class="s1">&#39;get&#39;</span><span class="p">](</span><span class="s1">&#39;holder&#39;</span><span class="p">)</span>
<span class="s1">&#39;Kirk&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">kirk_account</span><span class="p">[</span><span class="s1">&#39;get&#39;</span><span class="p">](</span><span class="s1">&#39;interest&#39;</span><span class="p">)</span>
<span class="mf">0.02</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">kirk_account</span><span class="p">[</span><span class="s1">&#39;get&#39;</span><span class="p">](</span><span class="s1">&#39;deposit&#39;</span><span class="p">)(</span><span class="mi">20</span><span class="p">)</span>
<span class="mi">20</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">kirk_account</span><span class="p">[</span><span class="s1">&#39;get&#39;</span><span class="p">](</span><span class="s1">&#39;withdraw&#39;</span><span class="p">)(</span><span class="mi">5</span><span class="p">)</span>
<span class="mi">15</span>
</code></pre></td></tr></table>
</div>
</div><p>å°±åƒPythonçš„å¯¹è±¡ç³»ç»Ÿ, è®¾ç½®ä¸€ä¸ªå®ä¾‹çš„å±æ€§ä¸ä¼šä¿®æ”¹å®ƒå¯¹åº”çš„ç±»çš„å±æ€§.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">kirk_account</span><span class="p">[</span><span class="s1">&#39;set&#39;</span><span class="p">](</span><span class="s1">&#39;interest&#39;</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Account</span><span class="p">[</span><span class="s1">&#39;get&#39;</span><span class="p">](</span><span class="s1">&#39;interest&#39;</span><span class="p">)</span>
<span class="mf">0.02</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>ç»§æ‰¿</strong>. æˆ‘ä»¬å¯ä»¥é€šè¿‡é‡è½½ä¸€ä¸ªç±»çš„å±æ€§çš„å­é›†æ¥åˆ›å»ºä¸€ä¸ªå­ç±»<code>CheckingAccount</code>. åœ¨è¿™ä¸ªä¾‹å­ä¸­, æˆ‘ä»¬ä¿®æ”¹<code>withdraw</code>æ–¹æ³•å»å¾æ”¶è´¹ç”¨, åŒæ—¶æˆ‘ä»¬é™ä½åˆ©ç‡.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">make_checking_account_class</span><span class="p">():</span>
        <span class="s2">&#34;&#34;&#34;Return the CheckingAccount class, which imposes a $1 withdrawal fee.&#34;&#34;&#34;</span>
        <span class="n">interest</span> <span class="o">=</span> <span class="mf">0.01</span>
        <span class="n">withdraw_fee</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">def</span> <span class="nf">withdraw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
            <span class="n">fee</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;get&#39;</span><span class="p">](</span><span class="s1">&#39;withdraw_fee&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">Account</span><span class="p">[</span><span class="s1">&#39;get&#39;</span><span class="p">](</span><span class="s1">&#39;withdraw&#39;</span><span class="p">)(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span> <span class="o">+</span> <span class="n">fee</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">make_class</span><span class="p">(</span><span class="nb">locals</span><span class="p">(),</span> <span class="n">Account</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>åœ¨è¿™ä¸ªå®ç°ä¸­, æˆ‘ä»¬ä»å­ç±»çš„<code>withdraw</code>å‡½æ•°è°ƒç”¨åŸºç±»<code>Account</code>çš„<code>withdraw</code>å‡½æ•°, å°±åƒåœ¨Pythonçš„å†…å»ºå¯¹è±¡ç³»ç»Ÿä¸­ä¸€æ ·. æˆ‘ä»¬å¯ä»¥åƒä¹‹å‰ä¸€æ ·åˆ›å»ºå­ç±»æœ¬èº«ä»¥åŠä¸€ä¸ªå®ä¾‹.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">CheckingAccount</span> <span class="o">=</span> <span class="n">make_checking_account_class</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">jack_acct</span> <span class="o">=</span> <span class="n">CheckingAccount</span><span class="p">[</span><span class="s1">&#39;new&#39;</span><span class="p">](</span><span class="s1">&#39;Spock&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>å­˜æ¬¾çš„è¡Œä¸ºå®Œå…¨ç›¸åŒ, è·Ÿæ„é€ å‡½æ•°ä¸€æ ·. å–æ¬¾ä»ç‰¹æ®Šçš„<code>withdraw</code>æ–¹æ³•å¾æ”¶$1çš„è´¹ç”¨, åŒæ—¶<code>interest</code>æœ‰æ¥è‡ªäº<code>CheckingAccount</code>çš„æ–°çš„æ›´ä½çš„å€¼.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">jack_acct</span><span class="p">[</span><span class="s1">&#39;get&#39;</span><span class="p">](</span><span class="s1">&#39;interest&#39;</span><span class="p">)</span>
<span class="mf">0.01</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">jack_acct</span><span class="p">[</span><span class="s1">&#39;get&#39;</span><span class="p">](</span><span class="s1">&#39;deposit&#39;</span><span class="p">)(</span><span class="mi">20</span><span class="p">)</span>
<span class="mi">20</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">jack_acct</span><span class="p">[</span><span class="s1">&#39;get&#39;</span><span class="p">](</span><span class="s1">&#39;withdraw&#39;</span><span class="p">)(</span><span class="mi">5</span><span class="p">)</span>
<span class="mi">14</span>
</code></pre></td></tr></table>
</div>
</div><p>æˆ‘ä»¬çš„å»ºç«‹åœ¨å­—å…¸ä¹‹ä¸Šçš„å¯¹è±¡ç³»ç»Ÿè·ŸPythonå†…å»ºçš„å¯¹è±¡ç³»ç»Ÿçš„å®ç°æ˜¯ååˆ†ç±»ä¼¼çš„. åœ¨Pythonä¸­, ä»»ä½•ä¸€ä¸ªç”¨æˆ·å®šä¹‰ç±»çš„å®ä¾‹éƒ½å…·æœ‰ä¸€ä¸ªç‰¹åˆ«çš„å±æ€§<code>__dict__</code>ç”¨äºåœ¨å­—å…¸ä¸­ä¸ºè¿™ä¸ªå¯¹è±¡å­˜å‚¨æœ¬åœ°å®ä¾‹å±æ€§. å°±åƒæˆ‘ä»¬çš„å­—å…¸<code>attributes</code>. Pythonçš„ä¸åŒåœ¨äºå®ƒåŒºåˆ†æŸäº›è·Ÿå†…å»ºå‡½æ•°äº¤äº’çš„ç‰¹åˆ«æ–¹æ³•ä»¥ç¡®ä¿è¿™äº›å‡½æ•°è¡Œä¸ºå¯¹å¾ˆå¤šä¸åŒç±»å‹çš„å‚æ•°æ˜¯æ­£ç¡®çš„. åœ¨ä¸åŒç±»å‹ä¸Šæ“ä½œçš„å‡½æ•°æ˜¯ä¸‹ä¸€èŠ‚çš„ä¸»é¢˜.</p>
<h3 id="27-å¯¹è±¡æŠ½è±¡">2.7 å¯¹è±¡æŠ½è±¡</h3>
<p>å¯¹è±¡ç³»ç»Ÿå…è®¸ç¨‹åºå‘˜å»é«˜æ•ˆåœ°å»ºç«‹ä»¥åŠä½¿ç”¨æŠ½è±¡æ•°æ®è¡¨ç¤º. å®ƒåŒæ ·ä¹Ÿè®¾è®¡ä¸ºå…è®¸åœ¨åŒä¸€ç¨‹åºå†…å…±å­˜å¤šé‡æ•°æ®æŠ½è±¡è¡¨ç¤º.</p>
<p>å¯¹è±¡æŠ½è±¡çš„ä¸€ä¸ªä¸­å¿ƒæ¦‚å¿µæ˜¯æ³›å‹å‡½æ•°, ä¹Ÿå°±æ˜¯ä¸€ä¸ªå¯ä»¥æ¥å—å¤šç§ä¸åŒç±»å‹å€¼çš„å‡½æ•°, åœ¨å®ç°æ³›å‹å‡½æ•°ä¸­æˆ‘ä»¬ä¼šè€ƒè™‘ä¸‰ç§ä¸åŒçš„æŠ€æœ¯: å…±äº«å®ä¾‹, ç±»å‹æ´¾å‘, ä»¥åŠå¼ºåˆ¶ç±»å‹. åœ¨å»ºç«‹è¿™äº›æ¦‚å¿µçš„è¿‡ç¨‹ä¸­, æˆ‘ä»¬ä¹Ÿä¼šå‘ç°Pythonçš„å¯¹è±¡ç³»ç»Ÿä¸­çš„ç‰¹æ€§ä¹Ÿå°±æ˜¯æ”¯æŒæ³›å‹çš„åˆ›å»º.</p>
<h4 id="271-å­—ç¬¦ä¸²è½¬æ¢">2.7.1 å­—ç¬¦ä¸²è½¬æ¢</h4>
<p>ä¸ºäº†æœ‰æ•ˆåœ°è¡¨ç¤ºæ•°æ®, ä¸€ä¸ªå¯¹è±¡å€¼åº”è¯¥è¡¨ç°å¾—åƒå®ƒæ‰€ä»£è¡¨çš„ç±»å‹çš„æ•°æ®, åŒ…æ‹¬äº§å‡ºå®ƒè‡ªèº«æ‰€ä»£è¡¨çš„å­—ç¬¦ä¸². æ•°æ®å€¼çš„å­—ç¬¦ä¸²è¡¨ç¤ºåœ¨äº¤äº’å¼è¯­è¨€ä¸­æ˜¯ååˆ†é‡è¦çš„, ä¾‹å¦‚Pythonä¼šè‡ªåŠ¨åœ°å±•ç¤ºäº¤äº’å¼ä¼šè¯ä¸­çš„è¡¨è¾¾å¼çš„å€¼çš„å­—ç¬¦ä¸²è¡¨ç¤º.</p>
<p>å­—ç¬¦ä¸²å€¼æä¾›äº†åœ¨äººä¹‹é—´è¿›è¡Œä¼ è¾¾ä¿¡æ¯çš„åŸºæœ¬ä»‹è´¨. å­—ç¬¦åºåˆ—å¯ä»¥è¢«æ¸²æŸ“åˆ°å±å¹•ä¸Š, æ‰“å°åˆ°çº¸ä¸Š, å¤§å£°è¯», è½¬æ¢æˆç›²æ–‡, æˆ–è€…ä»¥æ‘©å°”æ–¯å¯†ç å¹¿æ’­. å­—ç¬¦ä¸²åŒæ ·ä¹Ÿæ˜¯ç¼–ç¨‹çš„æ ¹æœ¬å› ä¸ºå®ƒä»¬å¯ä»¥è¡¨ç¤ºPythonçš„è¡¨è¾¾å¼.</p>
<p>Pythonè§„å®šæ‰€æœ‰çš„å¯¹è±¡åº”è¯¥äº§å‡ºä¸¤ç§ä¸åŒçš„å­—ç¬¦ä¸²è¡¨ç¤º: ä¸€ç§æ˜¯å¯ä»¥è¢«äººç±»è§£é‡Šçš„æ–‡æœ¬ä»¥åŠä¸€ç§æ˜¯å¯ä»¥è¢«Pythonè§£é‡Šçš„è¡¨è¾¾å¼. å­—ç¬¦ä¸²çš„æ„é€ å‡½æ•°<code>str</code>, è¿”å›ä¸€ä¸ªå¯ä»¥è¢«äººç±»é˜…è¯»çš„å­—ç¬¦ä¸². åœ¨å¯èƒ½çš„æƒ…å†µä¸‹, <code>repr</code>å‡½æ•°è¿”å›ä¸€ä¸ªPythonè¡¨è¾¾å¼, å…¶è¿ç®—ç»“æœä¸ºç›¸ç­‰çš„å¯¹è±¡. <code>repr</code>çš„æ–‡æ¡£å­—ç¬¦ä¸²è§£é‡Šäº†è¿™ä¸ªå±æ€§:</p>
<pre><code>repr(object) -&gt; string
</code></pre><p>è¿”å›å¯¹è±¡è¡¨ç¤ºçš„æ ‡å‡†å­—ç¬¦ä¸².<br />
å¯¹å¤§å¤šæ•°å¯¹è±¡ç±»å‹æ¥è¯´, eval(repr(object)) == object.</p>
<p>å¯¹ä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼è°ƒç”¨<code>repr</code>çš„ç»“æœå°±æ˜¯Pythonæ‰“å°åœ¨äº¤äº’å¼å›è¯ä¸­æ‰€æ‰“å°çš„.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="mf">12e12</span>
<span class="mf">12000000000000.0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="mf">12e12</span><span class="p">))</span>
<span class="mf">12000000000000.0</span>
</code></pre></td></tr></table>
</div>
</div><p>åœ¨åŸå§‹å€¼æ²¡æœ‰è¡¨è¾¾å­˜åœ¨çš„æƒ…å†µä¸‹, Pythoné€šå¸¸ä¼šäº§å‡ºä¸€ä¸ªè¢«è§’æ‹¬å·åŒ…å›´çš„æè¿°.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">min</span><span class="p">)</span>
<span class="s1">&#39;&lt;built-in function min&gt;&#39;</span>
</code></pre></td></tr></table>
</div>
</div><p><code>str</code>æ„é€ å™¨é€šå¸¸è·Ÿ<code>repr</code>é‡åˆ, ä½†æ˜¯åœ¨æŸäº›æƒ…å†µä¸‹ä¼šæä¾›æ›´å¤šçš„å¯è§£é‡Šæ–‡æœ¬çš„è¡¨ç¤º. ä¾‹å¦‚, æˆ‘ä»¬ä¼šçœ‹åˆ°åœ¨<code>dates</code>å¯¹è±¡ä¸Š<code>str</code>ä¸<code>repr</code>ä¹‹é—´çš„ä¸åŒ.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">tues</span> <span class="o">=</span> <span class="n">date</span><span class="p">(</span><span class="mi">2011</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">repr</span><span class="p">(</span><span class="n">tues</span><span class="p">)</span>
<span class="s1">&#39;datetime.date(2011, 9, 12)&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">tues</span><span class="p">)</span>
<span class="s1">&#39;2011-09-12&#39;</span>
</code></pre></td></tr></table>
</div>
</div><p>å®šä¹‰<code>repr</code>å‡½æ•°æå‡ºäº†ä¸€ä¸ªæ–°çš„æŒ‘æˆ˜: æˆ‘ä»¬æƒ³è¦å®ƒåœ¨æ‰€æœ‰ç±»å‹çš„æ—¥æœŸä¸‹éƒ½èƒ½å¤Ÿæ­£ç¡®åº”ç”¨, å³ä½¿è¿™äº›ç±»å‹åœ¨<code>repr</code>å®ç°çš„æ—¶å€™è¿˜ä¸å­˜åœ¨. æˆ‘ä»¬ä¼šæƒ³è¦è®©å®ƒæˆä¸ºä¸€ä¸ªé€šç”¨æˆ–è€…å¤šæ€æ€§å‡½æ•°, ä¸€ä¸ªå¯ä»¥è¢«åº”ç”¨åœ¨å¾ˆå¤š(èšåˆ/poly)ä¸åŒç±»å‹(å˜å½¢/morph)çš„æ•°æ®.</p>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹, å¯¹è±¡ç³»ç»Ÿæä¾›ä¸€ä¸ªä¼˜é›…çš„è§£å†³åŠæ³•: <code>repr</code>å‡½æ•°æ€»æ˜¯è°ƒç”¨å®ƒå‚æ•°ä¸Šçš„ä¸€ä¸ªå«åš<code>__repr__</code>çš„æ–¹æ³•.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">tues</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>
<span class="s1">&#39;datetime.date(2011, 9, 12)&#39;</span>
</code></pre></td></tr></table>
</div>
</div><p>é€šè¿‡åœ¨ç”¨æˆ·å®šä¹‰ç±»ä¸Šå®ç°è¿™ä¸€ç›¸åŒçš„æ–¹æ³•, æˆ‘ä»¬å¯ä»¥æ‹“å±•<code>repr</code>çš„é€‚ç”¨æ€§åˆ°æœªæ¥æˆ‘ä»¬åˆ›å»ºçš„ä»»ä½•ç±»ä¸Š. æ€»çš„æ¥è¯´, è¿™ä¸€ä¾‹å­å¼ºè°ƒäº†ç‚¹è¡¨è¾¾å¼çš„å…¶ä»–å¥½å¤„, å°±æ˜¯å®ƒä»¬æä¾›äº†å°†ç°æœ‰å‡½æ•°çš„åŸŸæ‰©å±•ä¸ºæ–°å¯¹è±¡ç±»å‹çš„æœºåˆ¶.</p>
<p><code>str</code>æ„é€ å™¨ä¹Ÿæ˜¯ä»¥ç›¸ä¼¼çš„æ–¹å¼å®ç°: å®ƒè°ƒç”¨å‚æ•°ä¸Šçš„ä¸€ä¸ªå«åš<code>__str__</code>çš„æ–¹æ³•.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">tues</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>
<span class="s1">&#39;2011-09-12&#39;</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿™äº›å¤šæ€å‡½æ•°ç”¨äºæ¼”ç¤ºæ›´ä¸€èˆ¬çš„åŸç†: æŸäº›å‡½æ•°åº”è¯¥åº”ç”¨åˆ°å¤šç§æ•°æ®ç±»å‹ä¸Š. æ­¤å¤–, åˆ›å»ºæ­¤ç±»å‡½æ•°çš„ä¸€ç§æ–¹å¼æ˜¯åœ¨æ¯ä¸ªç±»ä¸Šä½¿ç”¨ä¸åŒå®šä¹‰çš„å…±äº«å±æ€§åç§°.</p>
<h4 id="272-ç‰¹æ®Šæ–¹æ³•">2.7.2 ç‰¹æ®Šæ–¹æ³•</h4>
<p>åœ¨Pythonä¸­, æŸäº›ç‰¹æ®Šæ–¹æ³•æ˜¯é€šè¿‡Pythonè§£æå™¨åœ¨ç‰¹æ®Šæƒ…å†µä¸‹è°ƒç”¨çš„. ä¾‹å¦‚, æ— è®ºä»€ä¹ˆæ—¶å€™ä¸€ä¸ªå¯¹è±¡è¢«åˆ›å»ºæ—¶ç±»çš„<code>__init__</code>æ–¹æ³•ä¼šè‡ªåŠ¨è¢«è°ƒç”¨. å½“è¿›è¡Œæ‰“å°æ—¶<code>__str__</code>ä¼šè‡ªåŠ¨è¢«è°ƒç”¨, ä»¥åŠ<code>__repr__</code>åœ¨äº’åŠ¨å¼å›è¯ä¸­è¢«è°ƒç”¨æ¥æ˜¾ç¤ºå€¼.</p>
<p>Pythonä¸­æœ‰è®¸å¤šå…¶ä»–è¡Œä¸ºçš„ç‰¹æ®Šåç§°. å…¶ä¸­ä¸€äº›æœ€å¸¸ä½¿ç”¨çš„å·²ç»æè¿°åœ¨ä¸‹é¢.</p>
<p><strong>çœŸå‡å€¼</strong>. å‰é¢æˆ‘ä»¬çœ‹åˆ°åœ¨Pythonä¸­æ•°å­—å…·æœ‰çœŸå®å€¼; æ›´è¿›ä¸€æ­¥æ¥è¯´, 0ä»£è¡¨å‡å€¼è€Œå…¶ä»–æ‰€æœ‰æ•°å­—ä»£è¡¨çœŸå€¼. å®é™…ä¸Š, åœ¨Pythonä¸­çš„æ‰€æœ‰å¯¹è±¡å…·æœ‰çœŸå€¼. é»˜è®¤åœ°, ç”¨æˆ·å®šä¹‰çš„ç±»çš„å¯¹è±¡éƒ½è®¤ä¸ºæ˜¯çœŸå€¼, ä½†æ˜¯ç‰¹æ®Šæ–¹æ³•<code>__bool__</code>å¯ä»¥ç”¨æ¥é‡è½½è¿™ä¸ªè¡Œä¸º. å¦‚æœä¸€ä¸ªå¯¹è±¡å®šä¹‰äº†<code>__bool__</code>æ–¹æ³•, é‚£ä¹ˆPythonå°†è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ¥åˆ¤æ–­å®ƒçš„çœŸå®å€¼.</p>
<p>ä¸¾ä¸ªä¾‹å­, å‡è®¾æˆ‘ä»¬æƒ³è¦è®©ä¸€ä¸ªä½™é¢ä¸º0çš„é“¶è¡Œè´¦æˆ·æ˜¯å‡å€¼. æˆ‘ä»¬å¯ä»¥æ·»åŠ ä¸€ä¸ª<code>__bool__</code>æ–¹æ³•åˆ°<code>Account</code>ç±»æ¥åˆ›é€ è¿™ä¸ªè¡Œä¸º.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">Account</span><span class="o">.</span><span class="n">__bool__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">!=</span> <span class="mi">0</span>
</code></pre></td></tr></table>
</div>
</div><p>æˆ‘ä»¬å¯ä»¥è°ƒç”¨å¸ƒå°”æ„é€ å™¨æ¥æŸ¥çœ‹ä¸€ä¸ªå¯¹è±¡çš„çœŸå®å€¼, ç„¶åæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¸ƒå°”ä¸Šä¸‹æ–‡ä¸­çš„ä»»ä½•å¯¹è±¡.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="nb">bool</span><span class="p">(</span><span class="n">Account</span><span class="p">(</span><span class="s1">&#39;jack&#39;</span><span class="p">))</span>
<span class="bp">False</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">Account</span><span class="p">(</span><span class="s1">&#39;jack&#39;</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;jack has nothing&#39;</span><span class="p">)</span>
<span class="n">jack</span> <span class="n">has</span> <span class="n">nothing</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>åºåˆ—æ“ä½œ</strong>. æˆ‘ä»¬å·²ç»çŸ¥é“å¯ä»¥ä½¿ç”¨<code>len</code>å‡½æ•°æ¥ç¡®å®šåºåˆ—çš„é•¿åº¦.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="s1">&#39;Go Bears!&#39;</span><span class="p">)</span>
<span class="mi">9</span>
</code></pre></td></tr></table>
</div>
</div><p><code>len</code>å‡½æ•°è°ƒç”¨å®ƒçš„å‚æ•°çš„<code>__len__</code>æ–¹æ³•æ¥åˆ¤æ–­å‚æ•°çš„é•¿åº¦. æ‰€æœ‰å…§å»ºåºåˆ—ç±»å‹éƒ½å®ç°è¿™ä¸€æ–¹æ³•.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="s1">&#39;Go Bears!&#39;</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span>
<span class="mi">9</span>
</code></pre></td></tr></table>
</div>
</div><p>å¦‚æœä¸€ä¸ªåºåˆ—æ²¡æœ‰æä¾›<code>__bool__</code>æ–¹æ³•, Pythonä¼šä½¿ç”¨ä¸€ä¸ªåºåˆ—çš„é•¿åº¦æ¥åˆ¤æ–­å®ƒçš„çœŸå®å€¼. ç©ºåºåˆ—ä¸ºå‡å€¼, è€Œéç©ºåºåˆ—åˆ™ä¸ºçœŸå€¼.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="nb">bool</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="bp">False</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">bool</span><span class="p">([])</span>
<span class="bp">False</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">bool</span><span class="p">(</span><span class="s1">&#39;Go Bears!&#39;</span><span class="p">)</span>
<span class="bp">True</span>
</code></pre></td></tr></table>
</div>
</div><p><code>__getitem__</code>æ–¹æ³•é€šè¿‡å…ƒç´ é€‰æ‹©æ“ä½œç¬¦æ¥è°ƒç”¨, ä½†å®ƒä¹Ÿå¯ä»¥è¢«ç›´æ¥è°ƒç”¨.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="s1">&#39;Go Bears!&#39;</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="s1">&#39;B&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="s1">&#39;Go Bears!&#39;</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="s1">&#39;B&#39;</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>å¯è°ƒç”¨å¯¹è±¡</strong>. åœ¨Python, å‡½æ•°æ˜¯ä¸€ç­‰å¯¹è±¡, å› æ­¤å®ƒä»¬å¯ä»¥ä½œä¸ºæ•°æ®è¿›è¡Œä¼ é€’ä»¥åŠå¯ä»¥åƒå…¶ä»–å¯¹è±¡ä¸€æ ·å…·æœ‰å±æ€§å€¼. Pythonä¹Ÿå…è®¸æˆ‘ä»¬é€šè¿‡å¼•å…¥ä¸€ä¸ª<code>__call__</code>æ–¹æ³•æ¥å®šä¹‰ä¸€ä¸ªåƒå‡½æ•°ä¸€æ ·å¯ä»¥&quot;è°ƒç”¨&quot;çš„å¯¹è±¡. ä½¿ç”¨è¿™ç§æ–¹æ³•, æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªè¡Œä¸ºåƒé«˜é˜¶å‡½æ•°çš„ç±».</p>
<p>ä¸¾ä¸ªä¾‹å­, è€ƒè™‘ä¸‹æ¥ä¸‹æ¥çš„é«˜é˜¶å‡½æ•°, å®ƒä¼šè¿”å›ä¸€ä¸ªå‡½æ•°è¿™ä¸ªå‡½æ•°ä¼šæ·»åŠ ä¸€ä¸ªå¸¸é‡å€¼åˆ°å®ƒçš„å‚æ•°ä¸Š.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">make_adder</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">adder</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">n</span> <span class="o">+</span> <span class="n">k</span>
        <span class="k">return</span> <span class="n">adder</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">add_three</span> <span class="o">=</span> <span class="n">make_adder</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">add_three</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="mi">7</span>
</code></pre></td></tr></table>
</div>
</div><p>æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªå®šä¹‰äº†<code>__call__</code>æ–¹æ³•å¹¶æä¾›ç›¸åŒåŠŸèƒ½çš„<code>Adder</code>ç±».</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">Adder</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span>
        <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">+</span> <span class="n">k</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">add_three_obj</span> <span class="o">=</span> <span class="n">Adder</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">add_three_obj</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="mi">7</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿™é‡Œ, <code>Adder</code>ç±»çš„è¡Œä¸ºè·Ÿé«˜é˜¶å‡½æ•°<code>make_adder</code>ç›¸ä¼¼, <code>add_three_obj</code>å¯¹è±¡çš„è¡Œä¸ºè·Ÿ<code>add_three</code>å‡½æ•°çš„è¡Œä¸ºç›¸ä¼¼. æˆ‘ä»¬è¿›ä¸€æ­¥åœ°æ¨¡ç³Šäº†æ•°æ®ä¸å‡½æ•°ä¹‹é—´çš„ç•Œé™.</p>
<p><strong>ç®—æœ¯</strong>. ç‰¹æ®Šæ–¹æ³•è¿˜å¯ä»¥å®šä¹‰åº”ç”¨äºç”¨æˆ·å®šä¹‰å¯¹è±¡çš„å†…ç½®è¿ç®—ç¬¦çš„è¡Œä¸º. ä¸ºäº†æä¾›è¿™ç§ä¸€èˆ¬æ€§, Pythonéµå¾ªç‰¹æ®Šåè®®æ¥åº”ç”¨æ¯ä¸€ä¸ªæ“ä½œç¬¦. ä¾‹å¦‚, è¦è¿è¡Œå«æœ‰<code>+</code>æ“ä½œç¬¦çš„è¡¨è¾¾å¼, Pythonæ£€æŸ¥ç‰¹æ®Šæ–¹æ³•è¡¨è¾¾å¼å·¦å³ä¸¤è¾¹çš„æ“ä½œæ•°. é¦–å…ˆ, Pythonæ£€æŸ¥å·¦æ“ä½œæ•°çš„<code>__add__</code>æ–¹æ³•çš„å€¼, ç„¶åæ£€æŸ¥å³æ“ä½œæ•°çš„<code>__radd__</code>æ–¹æ³•çš„å€¼. å¦‚æœä»»æ„ä¸€ä¸ªèƒ½æ‰¾åˆ°, è¿™ä¸ªæ–¹æ³•ä¼šä»¥å…¶ä»–æ“ä½œæ•°çš„å€¼ä½œä¸ºå‚æ•°è¢«è°ƒç”¨. ä¸€äº›ä¾‹å­å°†åœ¨ä¸‹é¢çš„ç« èŠ‚ä¸­ç»™å‡º. å¯¹äºæƒ³è¦è¿›ä¸€æ­¥äº†è§£ç»†èŠ‚çš„è¯»è€…, Pythonæ–‡æ¡£æè¿°äº†å®Œæ•´çš„<a href="http://docs.python.org/py3k/reference/datamodel.html#special-method-names">æ“ä½œç¬¦åç§°é›†</a>. Dive into Python 3 ä¹Ÿæœ‰ä¸€ä¸ª<a href="http://getpython3.com/diveintopython3/special-method-names.html">ç‰¹æ®Šæ–¹æ³•åç§°é›†</a>ç« èŠ‚, å®ƒæè¿°äº†æœ‰å¤šå°‘è¿™äº›ç‰¹æ®Šæ–¹æ³•åç§°è¢«ä½¿ç”¨.</p>
<h4 id="273-å¤šé‡è¡¨ç¤º">2.7.3 å¤šé‡è¡¨ç¤º</h4>
<p>æŠ½è±¡å±éšœå…è®¸æˆ‘ä»¬åˆ†ç¦»æ•°æ®çš„ä½¿ç”¨ä»¥åŠè¡¨ç¤º. ç„¶è€Œ, åœ¨å¤§å‹ç¨‹åºä¸­, å¯¹ç¨‹åºä¸­çš„æ•°æ®ç±»å‹è¡¨ç¤ºä¸º&quot;åº•å±‚è¡¨ç¤º&quot;å¹¶ä¸æ€»æ˜¯æœ‰æ„ä¹‰çš„. ä¸€æ–¹é¢, å¯¹æ•°æ®å¯¹è±¡å¯èƒ½æœ‰å¤šä¸ªæœ‰ç”¨çš„è¡¨ç¤º, åŒæ—¶æˆ‘ä»¬å¯èƒ½å–œæ¬¢å»è®¾è®¡å¯ä»¥å¤„ç†å¤šé‡è¡¨ç¤ºçš„ç³»ç»Ÿ</p>
<p>ä¸¾ä¸ªç®€å•çš„ä¾‹å­, å¤æ•°å¯èƒ½ä¼šç”¨ä¸¤ç§ç›¸ç­‰çš„æ–¹å¼æ¥è¡¨ç¤º: ä»¥ç›´è§’åæ ‡å½¢å¼(å®éƒ¨å’Œè™šéƒ¨)ä»¥åŠä»¥æåæ ‡å½¢å¼(å¹…åº¦å’Œè§’åº¦). æœ‰æ—¶å€™ç›´è§’åæ ‡å½¢å¼æ›´åŠ é€‚åˆ, è€Œæœ‰æ—¶å€™æåæ ‡å½¢å¼æ›´åŠ é€‚åˆ. å®é™…ä¸Š, è€ƒè™‘è¿™æ ·çš„ä¸€ä¸ªéœ€è¦è¡¨ç¤ºä¸¤ç§å½¢å¼çš„å¤æ•°ç³»ç»Ÿä»¥åŠèƒ½åœ¨å…¶ä¸­ä¸€ç§è¡¨ç¤ºä¸‹æ“çºµå¤æ•°æ¥å·¥ä½œçš„å‡½æ•°æ˜¯ååˆ†åˆç†çš„. æˆ‘ä»¬ä¼šåœ¨ä¸‹é¢å®ç°è¿™æ ·çš„ä¸€ä¸ªç³»ç»Ÿ. ä½œä¸ºé™„æ³¨, æˆ‘ä»¬æ­£åœ¨å¼€å‘ä¸€ä¸ªç³»ç»Ÿ, å®ƒä¼šå¯¹å¤æ•°æ‰§è¡Œç®—æœ¯è¿ç®—æ¥ä½œä¸ºä½¿ç”¨é€šç”¨æ“ä½œçš„ç¨‹åºçš„ç®€å•ä½†ä¸ç°å®çš„ä¾‹å­. <a href="http://docs.python.org/py3k/library/stdtypes.html#typesnumeric">å¤æ•°ç±»å‹</a>åœ¨Pythonä¸­æ˜¯å…§å»ºç±»å‹, ä½†å¯¹äºè¿™ä¸ªä¾‹å­æˆ‘ä»¬ä¼šå®ç°è‡ªå·±çš„å¤æ•°ç±»å‹.</p>
<p>å…è®¸æ•°æ®è¿›è¡Œå¤šé‡è¡¨ç¤ºçš„æƒ³æ³•å¸¸å¸¸ä¼šå‡ºç°. å¤§å‹è½¯ä»¶ç³»ç»Ÿé€šå¸¸ç”±è®¸å¤šé•¿æœŸå·¥ä½œçš„äººè®¾è®¡, ä¸”å—åˆ¶äºéšæ—¶é—´å˜åŒ–çš„è¦æ±‚. åœ¨è¿™æ ·çš„ç¯å¢ƒä¸‹, å…è®¸ä¸ºæ¯ä¸ªäººæå‰é€‰æ‹©å¥½æ•°æ®çš„è¡¨ç¤ºæ˜¯æ ¹æœ¬ä¸å¯èƒ½çš„. æ­¤å¤–, æ•°æ®æŠ½è±¡å±éšœä»ä½¿ç”¨ä¸­éš”ç¦»äº†è¡¨ç¤º, æˆ‘ä»¬éœ€è¦éš”ç¦»å½¼æ­¤ä¸åŒçš„è®¾è®¡é€‰æ‹©çš„æŠ½è±¡å±éšœå¹¶å…è®¸ä¸åŒè®¾è®¡é€‰æ‹©åœ¨å•ä¸ªç¨‹åºä¸­å…±å­˜.</p>
<p>æˆ‘ä»¬ä¼šåœ¨é«˜å±‚æ¬¡çš„æŠ½è±¡ä»¥åŠæœå®ç°å…·ä½“è¡¨ç¤ºä¸Šæ¥è®¾è®¡è‡ªå·±çš„å®ç°. ä¸€ä¸ª<code>Complex</code>æ˜¯ä¸€ä¸ª<code>Number</code>, è€Œæ•°å­—å¯ä»¥åŠ æˆ–è€…ä¹˜åœ¨ä¸€èµ·. æŠ½è±¡äº†çš„æ•°å­—å¦‚ä½•èƒ½å¤Ÿé€šè¿‡åä¸º<code>add</code>ä»¥åŠ<code>mul</code>çš„æ–¹æ³•è¢«åŠ æˆ–è€…ä¹˜åœ¨ä¸€èµ·.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">Number</span><span class="p">:</span>
        <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿™ä¸ªç±»è¦æ±‚æ•°å­—å¯¹è±¡å…·æœ‰<code>add</code>ä»¥åŠ<code>mul</code>æ–¹æ³•, ä½†æ˜¯æ²¡æœ‰å®šä¹‰å®ƒä»¬. å®ƒç”šè‡³æ²¡æœ‰æä¾›ä¸€ä¸ª<code>__init__</code>æ–¹æ³•. <code>Number</code>çš„ç›®çš„ä¸æ˜¯ç”¨æ¥ç›´æ¥å®ä¾‹åŒ–, è€Œæ˜¯ä½œä¸ºè¶…ç±»ä¸ºå„ç§æŒ‡å®šæ•°å­—ç±»å‹æä¾›æœåŠ¡. æˆ‘ä»¬çš„ä¸‹ä¸€ä¸ªä»»åŠ¡æ˜¯å®šä¹‰é€‚åˆäºå¤æ•°çš„<code>add</code>ä»¥åŠ<code>mul</code>æ–¹æ³•.</p>
<p>ä¸€ä¸ªå¤æ•°å¯ä»¥æƒ³è±¡æˆæ˜¯ç”±ä¸¤ä¸ªæ­£äº¤è½´å½¢æˆçš„äºŒç»´ç©ºé—´ä¸­çš„ä¸€ä¸ªç‚¹, å®è½´ä»¥åŠè™šè½´. ä»è¿™ä¸ªè§’åº¦çœ‹, å¤æ•°<code>c = real + imag * i(è¿™é‡Œçš„i * i = -1)</code>å¯ä»¥è®¤ä¸ºæ˜¯ä¸€ä¸ªå¹³é¢ä¸Šçš„ç‚¹, å®ƒçš„æ°´å¹³åæ ‡æ˜¯<code>real</code>, å‚ç›´åæ ‡æ˜¯<code>imag</code>. å¤æ•°åŠ æ³•æ¶‰åŠåˆ°å¢åŠ å®ƒä»¬å„è‡ªçš„<code>real</code>è½´ä»¥åŠ<code>imag</code>è½´çš„åæ ‡.</p>
<p>å½“ä¹˜ä»¥å¤æ•°æ—¶, å°†å…¶æƒ³è±¡æˆä¸€ä¸ªæåæ ‡ä¸Šä»¥å¹…åº¦å’Œè§’åº¦è¡¨ç¤ºçš„å¤æ•°ä¼šæ›´åŠ è‡ªç„¶. ä¸¤ä¸ªå¤æ•°çš„ä¹˜ç§¯çš„ç»“æœå°±æ˜¯çš„åˆ°ä¸€ä¸ªå‘é‡å€¼, ç”±å…¶ä¸­ä¸€ä¸ªå¤æ•°çš„å‘é‡å€¼è·Ÿå¦ä¸€ä¸ªå¤æ•°çš„å‘é‡å€¼é•¿åº¦å› å­çš„ä¹˜ç§¯çš„å¾—åˆ°, ç„¶ååŠ ä¸Šä¸€ä¸ªè§’åº¦å€¼, ç”±å…¶ä¸­ä¸€ä¸ªå¤æ•°çš„è§’åº¦, æ—‹è½¬å€¼ä¸ºå¦ä¸€ä¸ªå‘é‡çš„è§’åº¦å¾—åˆ°.</p>
<p><code>Complex</code>ç±»ç»§æ‰¿è‡ª<code>Number</code>ç±», å¹¶æè¿°äº†å¤æ•°çš„ç®—æœ¯.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">Complex</span><span class="p">(</span><span class="n">Number</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">ComplexRI</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">real</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">imag</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">mul</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
            <span class="n">magnitude</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">magnitude</span> <span class="o">*</span> <span class="n">other</span><span class="o">.</span><span class="n">magnitude</span>
            <span class="k">return</span> <span class="n">ComplexMA</span><span class="p">(</span><span class="n">magnitude</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿™ä¸ªå®ç°å‡è®¾å¯¹äºå¤æ•°å­˜åœ¨ä¸¤ä¸ªç±», è·Ÿå¤æ•°çš„ä¸¤ä¸ªè‡ªç„¶è¡¨ç¤ºç›¸å¯¹åº”:</p>
<ul>
<li><code>ComplexRI</code>ä»å®éƒ¨å’Œè™šéƒ¨æ¥æ„é€ ä¸€ä¸ªå¤æ•°</li>
<li><code>ComplexMA</code>ä»å‘é‡å’Œè§’åº¦æ¥æ„é€ ä¸€ä¸ªå¤æ•°</li>
</ul>
<p><strong>æ¥å£</strong>. å¯¹è±¡å±æ€§æ˜¯æ¶ˆæ¯ä¼ é€’çš„ä¸€ç§å½¢å¼, å…è®¸ä¸åŒæ•°æ®ç±»å‹ä»¥ä¸åŒçš„æ–¹å¼æ¥å“åº”ç›¸åŒçš„æ¶ˆæ¯. ä»ä¸åŒç±»ä¸­å¼•å‡ºç›¸åŒè¡Œä¸ºçš„ä¸€ç»„å…±äº«æ¶ˆæ¯æ˜¯ä¸€ç§å¼ºå¤§çš„æŠ½è±¡æ–¹æ³•. ä¸€ä¸ª_æ¥å£_å°±æ˜¯ä¸€ä¸ªå…±äº«å±æ€§åä»¥åŠå®ƒä»¬çš„è¡Œä¸ºè§„èŒƒçš„é›†åˆ. åœ¨å¤æ•°çš„ä¾‹å­ä¸­, æ¥å£éœ€è¦å®ç°ç”±å››ä¸ªå±æ€§ç»„æˆçš„ç®—æ³•: <code>real</code>, <code>imag</code>, <code>magnitude</code>å’Œ<code>angle</code>.</p>
<p>æƒ³è¦åœ¨å¤æ‚çš„ç®—æœ¯ä¸Šæ˜¯æ­£ç¡®çš„, è¿™äº›å±æ€§å¿…é¡»è¦ä¸€è‡´. ä¹Ÿå°±æ˜¯è¯´, ç›´è§’åæ ‡ç³»(real, imag)ä»¥åŠæåæ ‡ç³»(magnitude, angle)å¿…é¡»åœ¨å¤å¹³é¢ä¸Šæ˜¯æè¿°ç›¸åŒçš„ç‚¹. <code>Complex</code>ç±»é€šè¿‡å†³å®šè¿™äº›å±æ€§å¦‚ä½•ç”¨äºè·Ÿä¸€ä¸ªå¤æ•°æ¥è¿›è¡Œ<code>add</code>ä»¥åŠ<code>mul</code>ä»è€Œéšå¼å®šä¹‰è¿™ä¸ªæ¥å£.</p>
<p><strong>å±æ€§</strong>. è¦æ±‚ä¸¤ä¸ªæˆ–å¤šä¸ªå±æ€§å€¼ä¿æŒå½¼æ­¤ä¹‹é—´çš„å›ºå®šå…³ç³»æ˜¯ä¸€ä¸ªæ–°çš„é—®é¢˜. ä¸€ä¸ªè§£å†³åŠæ³•æ˜¯åªä¸ºå…¶ä¸­ä¸€ä¸ªè¡¨ç¤ºä¿å­˜å±æ€§å€¼ç„¶åå…¶ä»–è¡¨ç¤ºåˆ™åœ¨å®ƒä»¬éœ€è¦çš„æ—¶å€™è®¡ç®—å‡ºæ¥.</p>
<p>Pythonå…·æœ‰ä¸€ä¸ªç®€å•åŠŸèƒ½ç”¨äºä»é›¶å‚æ•°å‡½æ•°å³æ—¶è®¡ç®—å±æ€§. <code>@property</code>è£…é¥°å™¨å…è®¸è°ƒç”¨å‡½æ•°è€Œä¸è°ƒç”¨è¡¨è¾¾å¼è¯­æ³•(è·Ÿéšè¡¨è¾¾å¼åçš„æ‹¬å·). <code>ComplexRI</code>ç±»ä¿å­˜<code>real</code>ä»¥åŠ<code>imag</code>å±æ€§, åŒæ—¶ä¸€ç»è¯·æ±‚åˆ™è®¡ç®—<code>magnitude</code>å’Œ<code>angle</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">atan2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">ComplexRI</span><span class="p">(</span><span class="n">Complex</span><span class="p">):</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">real</span><span class="p">,</span> <span class="n">imag</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">real</span> <span class="o">=</span> <span class="n">real</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">imag</span> <span class="o">=</span> <span class="n">imag</span>
        <span class="nd">@property</span>
        <span class="k">def</span> <span class="nf">magnitude</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">real</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">imag</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
        <span class="nd">@property</span>
        <span class="k">def</span> <span class="nf">angle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">atan2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
        <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="s1">&#39;ComplexRI({0:g}, {1:g})&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿™ä¸ªå®ç°çš„ç»“æœæ˜¯, å…¨éƒ¨çš„å››ä¸ªå¤æ•°ç®—æ³•éœ€è¦çš„å±æ€§éƒ½å¯ä»¥ä¸ç”¨ä»»ä½•è°ƒç”¨è¡¨è¾¾å¼å°±è®¿é—®åˆ°, åŒæ—¶ä¿®æ”¹<code>real</code>ä»¥åŠ<code>imag</code>éƒ½ä¼šåæ˜ åˆ°<code>magnitude</code>ä»¥åŠ<code>angle</code>ä¸­.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">ri</span> <span class="o">=</span> <span class="n">ComplexRI</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ri</span><span class="o">.</span><span class="n">real</span>
<span class="mi">5</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ri</span><span class="o">.</span><span class="n">magnitude</span>
<span class="mf">13.0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ri</span><span class="o">.</span><span class="n">real</span> <span class="o">=</span> <span class="mi">9</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ri</span><span class="o">.</span><span class="n">real</span>
<span class="mi">9</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ri</span><span class="o">.</span><span class="n">magnitude</span>
<span class="mf">15.0</span>
</code></pre></td></tr></table>
</div>
</div><p>åŒæ ·åœ°, <code>ComplexMA</code>ç±»ä¿å­˜<code>magnitude</code>ä»¥åŠ<code>angle</code>, ä½†å½“<code>real</code>ä»¥åŠ<code>imag</code>è¢«æŸ¥æ‰¾æ—¶ä¼šç«‹é©¬è®¡ç®—å¾—å‡º.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">pi</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">ComplexMA</span><span class="p">(</span><span class="n">Complex</span><span class="p">):</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">magnitude</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">magnitude</span> <span class="o">=</span> <span class="n">magnitude</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">angle</span> <span class="o">=</span> <span class="n">angle</span>
        <span class="nd">@property</span>
        <span class="k">def</span> <span class="nf">real</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">magnitude</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angle</span><span class="p">)</span>
        <span class="nd">@property</span>
        <span class="k">def</span> <span class="nf">imag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">magnitude</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angle</span><span class="p">)</span>
        <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="s1">&#39;ComplexMA({0:g}, {1:g} * pi)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle</span><span class="o">/</span><span class="n">pi</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>ä¿®æ”¹<code>magnitude</code>æˆ–è€…<code>angle</code>éƒ½ä¼šç«‹é©¬åæ˜ åˆ°<code>real</code>ä»¥åŠ<code>imag</code>å±æ€§ä¸Š.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">ma</span> <span class="o">=</span> <span class="n">ComplexMA</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ma</span><span class="o">.</span><span class="n">imag</span>
<span class="mf">2.0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ma</span><span class="o">.</span><span class="n">angle</span> <span class="o">=</span> <span class="n">pi</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ma</span><span class="o">.</span><span class="n">real</span>
<span class="o">-</span><span class="mf">2.0</span>
</code></pre></td></tr></table>
</div>
</div><p>æˆ‘ä»¬ç°åœ¨å·²ç»å®Œæˆäº†å¤æ•°çš„å®ç°. å®ç°äº†å¤æ•°çš„ä»»æ„ç±»å¯ä»¥åœ¨ä»»æ„<code>Complex</code>çš„ç®—æ³•ä¸Šä½¿ç”¨ä»»æ„çš„å‚æ•°.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">pi</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ComplexRI</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">ComplexMA</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ComplexRI</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ComplexRI</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">ComplexRI</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ComplexMA</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">pi</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>ç¼–ç å¤šä¸ªè¡¨ç¤ºçš„å€Ÿå£æ–¹æ³•å…·æœ‰å¸å¼•äººçš„å±æ€§. ç±»å¯ä»¥ä¸ºæ¯ä¸ªè¡¨ç¤ºå•ç‹¬å¼€å‘; å®ƒä»¬å¿…é¡»ä¹Ÿåªéœ€å•†å®šå…±äº«çš„å±æ€§çš„åç§°, ä»¥åŠè¿™äº›å±æ€§çš„ä»»ä½•è¡Œä¸ºæ¡ä»¶. æ¥å£æ˜¯é¢å¤–é™„åŠ çš„. å¦‚æœå…¶ä»–ç¨‹åºå‘˜æƒ³è¦æ·»åŠ ç¬¬ä¸‰ä¸ªå¤æ•°çš„è¡¨ç¤ºåˆ°ç›¸åŒçš„ç¨‹åºä¸­, å®ƒä»¬åªéœ€è¦åˆ›å»ºå¦å¤–ä¸€ä¸ªå…·æœ‰ç›¸åŒå±æ€§çš„ç±».</p>
<p>æ•°æ®çš„å¤šé‡è¡¨ç¤ºè·Ÿæˆ‘ä»¬è¿™ç« çš„ä¸€å¼€å§‹çš„æ•°æ®æŠ½è±¡çš„æ€æƒ³å¯†åˆ‡ç›¸å…³. ä½¿ç”¨æ•°æ®æŠ½è±¡, æˆ‘ä»¬èƒ½å¤Ÿå»ä¿®æ”¹æ•°æ®ç±»å‹çš„å®ç°è€Œä¸ä¿®æ”¹ç¨‹åºçš„å«ä¹‰. é€šè¿‡æ¥å£ä»¥åŠæ¶ˆæ¯ä¼ é€’, æˆ‘ä»¬å¯ä»¥åœ¨ç›¸åŒçš„ç¨‹åºå†…æœ‰å¤šç§ä¸åŒçš„è¡¨ç¤º. è¿™ä¸¤ç§æƒ…å†µä¸‹, åç§°é›†åˆä»¥åŠå¯¹åº”çš„è¡Œä¸ºæ¡ä»¶å®šä¹‰äº†å®ç°è¿™ç§çµæ´»æ€§çš„æŠ½è±¡.</p>
<h4 id="274-é€šç”¨å‡½æ•°">2.7.4 é€šç”¨å‡½æ•°</h4>
<p>é€šç”¨å‡½æ•°æ˜¯ä¸€ä¸ªå¯åº”ç”¨åœ¨ä¸åŒç±»å‹å‚æ•°ä¸Šçš„æ–¹æ³•æˆ–è€…å‡½æ•°. æˆ‘ä»¬å·²ç»è§è¯†è¿‡å¾ˆå¤šçš„ä¾‹å­. <code>Complex.add</code>æ–¹æ³•æ˜¯é€šç”¨çš„, å› ä¸ºå®ƒé‡‡ç”¨<code>ComplexRI</code>æˆ–è€…<code>ComplexMA</code>ä½œä¸º<code>other</code>çš„å€¼. è¿™ä¸ªçµæ´»æ€§æ˜¯é€šè¿‡ç¡®ä¿<code>ComplexRI</code>ä»¥åŠ<code>ComplexMA</code>çš„å…±äº«åŒä¸€ä¸ªæ¥å£æ¥è·å¾—çš„. ä½¿ç”¨æ¥å£ä»¥åŠæ¶ˆæ¯ä¼ é€’åªæ˜¯ä¸€äº›ç”¨æ¥å®ç°é€šç”¨å‡½æ•°çš„æ–¹æ³•å…¶ä¸­çš„ä¸€ç§. åœ¨è¿™ä¸€èŠ‚ä¸­, æˆ‘ä»¬ä¼šè€ƒè™‘å…¶ä»–ä¸¤ä¸ª: ç±»å‹è°ƒåº¦ä»¥åŠç±»å‹å¼ºåˆ¶.</p>
<p>å‡è®¾, é™¤äº†æˆ‘ä»¬çš„å¤æ•°ç±»å‹, æˆ‘ä»¬å®ç°äº†ä¸€ä¸ª<code>Rational</code>ç±»æ¥ä»£è¡¨å‡†ç¡®çš„åˆ†æ•°. <code>add</code>ä»¥åŠ<code>mul</code>æ–¹æ³•è·Ÿæœ¬ç« ä¹‹å‰çš„<code>add_rational</code>ä»¥åŠ<code>mul_rational</code>è¡¨ç¤ºç›¸åŒçš„è®¡ç®—.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">fractions</span> <span class="kn">import</span> <span class="n">gcd</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">Rational</span><span class="p">(</span><span class="n">Number</span><span class="p">):</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">numer</span><span class="p">,</span> <span class="n">denom</span><span class="p">):</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">gcd</span><span class="p">(</span><span class="n">numer</span><span class="p">,</span> <span class="n">denom</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">numer</span> <span class="o">=</span> <span class="n">numer</span> <span class="o">//</span> <span class="n">g</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">denom</span> <span class="o">=</span> <span class="n">denom</span> <span class="o">//</span> <span class="n">g</span>
        <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="s1">&#39;Rational({0}, {1})&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">numer</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">denom</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
            <span class="n">nx</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">numer</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">denom</span>
            <span class="n">ny</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">numer</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">denom</span>
            <span class="k">return</span> <span class="n">Rational</span><span class="p">(</span><span class="n">nx</span> <span class="o">*</span> <span class="n">dy</span> <span class="o">+</span> <span class="n">ny</span> <span class="o">*</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">dy</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">mul</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
            <span class="n">numer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">numer</span> <span class="o">*</span> <span class="n">other</span><span class="o">.</span><span class="n">numer</span>
            <span class="n">denom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">denom</span> <span class="o">*</span> <span class="n">other</span><span class="o">.</span><span class="n">denom</span>
            <span class="k">return</span> <span class="n">Rational</span><span class="p">(</span><span class="n">numer</span><span class="p">,</span> <span class="n">denom</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>æˆ‘ä»¬é€šè¿‡ç»™è¶…ç±»åŒ…å«<code>add</code>è®°å¿†<code>mul</code>æ–¹æ³•å·²ç»å®ç°äº†æ¥å£. ç»“æœæ˜¯, æˆ‘ä»¬å¯ä»¥ç”¨ç†Ÿæ‚‰çš„æ“ä½œæ¥åŠ ä¸Šä»¥åŠç›¸ä¹˜æœ‰ç†æ•°.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">Rational</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="n">Rational</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>ç„¶è€Œ, æˆ‘ä»¬è¿˜æ˜¯ä¸èƒ½å°†ä¸€ä¸ªæœ‰ç†æ•°åŠ åˆ°ä¸€ä¸ªå¤æ•°ä¸Š, å³ä½¿åœ¨æ•°å­¦ä¸Šå·²ç»æ˜ç¡®å®šä¹‰äº†è¿™æ ·çš„ç»„åˆ. æˆ‘ä»¬æƒ³è¦ä»¥ä¸€äº›å°å¿ƒæ§åˆ¶çš„æ–¹å¼æ¥ä»‹ç»è¿™ç§è·¨ç±»å‹æ“ä½œ, å› æ­¤æˆ‘ä»¬å¯ä»¥å‡è®¾å®ƒæ²¡æœ‰ä¸¥é‡è¿åæˆ‘ä»¬çš„æŠ½è±¡å±éšœ. è¿™è·Ÿæˆ‘ä»¬æ‰€æœŸæœ›çš„ç»“æœä¹‹å‰å­˜åœ¨ç´§å¯†çš„å…³ç³»: æˆ‘ä»¬æƒ³è¦èƒ½å¤Ÿå°†ä¸€ä¸ªå¤æ•°æ·»åŠ åˆ°ä¸€ä¸ªæœ‰ç†æ•°ä¸Š, ä»¥åŠæˆ‘ä»¬æƒ³è¦ä¸€èˆ¬æ–¹æ³•<code>__add__</code>èƒ½å¤Ÿå¯¹æ‰€æœ‰çš„æ•°å­—ç±»å‹éƒ½åšæ­£ç¡®çš„äº‹æƒ…. åŒæ—¶, ä¸ºäº†ç»´æŠ¤ç¨‹åºçš„æ¨¡å—åŒ–, æˆ‘ä»¬æƒ³è¦å°½å¯èƒ½åˆ†ç¦»å¤æ•°ä¸æœ‰ç†æ•°çš„å…³æ³¨.</p>
<p><strong>ç±»å‹è°ƒåº¦</strong>. ä¸€ç§å®ç°è·¨ç±»å‹æ“ä½œçš„æ–¹å¼æ˜¯åŸºäºå‡½æ•°æˆ–æ–¹æ³•çš„å‚æ•°çš„ç±»å‹æ¥é€‰æ‹©è¡Œä¸º. ç±»å‹è°ƒåº¦çš„æ€æƒ³æ˜¯å»å†™ä¸€ä¸ªå‡½æ•°æ¥æ£€æŸ¥å®ƒä»¬æ¥æ”¶çš„å‚æ•°çš„ç±»å‹, ç„¶åä¸ºè¿™äº›ç±»å‹æ‰§è¡Œåˆé€‚çš„ä»£ç .</p>
<p>å…§å»ºå‡½æ•°<code>isinstance</code>æ¥å—ä¸€ä¸ªå¯¹è±¡ä»¥åŠä¸€ä¸ªç±». å¦‚æœå¯¹è±¡æ‰€å…·æœ‰çš„ç±»æ˜¯è¿™ä¸ªç±»æˆ–è€…æ˜¯ç»§æ‰¿è‡ªè¿™ä¸ªç±»çš„è¯å°±è¿”å›çœŸå€¼.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">ComplexRI</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">ComplexRI</span><span class="p">)</span>
<span class="bp">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">Complex</span><span class="p">)</span>
<span class="bp">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">ComplexMA</span><span class="p">)</span>
<span class="bp">False</span>
</code></pre></td></tr></table>
</div>
</div><p>ç±»å‹æ´¾å‘çš„ä¸€ä¸ªç®€å•çš„ä¾‹å­æ˜¯ä¸€ä¸ªä¸ºä¸åŒç±»å‹çš„å¤æ•°ä½¿ç”¨ä¸åŒçš„å®ç°çš„<code>is_real</code>å‡½æ•°.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">is_real</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;Return whether c is a real number with no imaginary part.&#34;&#34;&#34;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">ComplexRI</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">c</span><span class="o">.</span><span class="n">imag</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">ComplexMA</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">c</span><span class="o">.</span><span class="n">angle</span> <span class="o">%</span> <span class="n">pi</span> <span class="o">==</span> <span class="mi">0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">is_real</span><span class="p">(</span><span class="n">ComplexRI</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="bp">False</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">is_real</span><span class="p">(</span><span class="n">ComplexMA</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">pi</span><span class="p">))</span>
<span class="bp">True</span>
</code></pre></td></tr></table>
</div>
</div><p>ç±»å‹æ´¾å‘å¹¶ä¸æ€»æ˜¯ä½¿ç”¨<code>isinstance</code>æ¥æ‰§è¡Œçš„. å¯¹äºç®—æœ¯, æˆ‘ä»¬ä¼šä¸ºå­—ç¬¦ç±»å‹çš„<code>Rational</code>ä»¥åŠ<code>Complex</code>çš„å®ä¾‹æä¾›ä¸€ä¸ª<code>type_tag</code>å±æ€§, è¿™ä¸ªå±æ€§æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²å€¼. å½“ä¸¤ä¸ªå€¼xä»¥åŠyéƒ½å…·æœ‰<code>type_tag</code>, é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç”¨<code>x.add(y)</code>ç›´æ¥åˆå¹¶å®ƒä»¬. å¦‚æœæ²¡æœ‰, æˆ‘ä»¬éœ€è¦ä¸€ä¸ªè·¨ç±»å‹æ“ä½œ.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">Rational</span><span class="o">.</span><span class="n">type_tag</span> <span class="o">=</span> <span class="s1">&#39;rat&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Complex</span><span class="o">.</span><span class="n">type_tag</span> <span class="o">=</span> <span class="s1">&#39;com&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Rational</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">type_tag</span> <span class="o">==</span> <span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">type_tag</span>
<span class="bp">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ComplexRI</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">type_tag</span> <span class="o">==</span> <span class="n">ComplexMA</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">type_tag</span>
<span class="bp">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Rational</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">type_tag</span> <span class="o">==</span> <span class="n">ComplexRI</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">type_tag</span>
<span class="bp">False</span>
</code></pre></td></tr></table>
</div>
</div><p>è¦å°†å¤æ•°è·Ÿæœ‰ç†æ•°ç»“åˆ, æˆ‘ä»¬éœ€è¦ç¼–å†™åŒæ—¶ä¾èµ–å®ƒä»¬è¡¨ç°ç±»å‹çš„å‡½æ•°. æ¥ä¸‹æ¥, æˆ‘ä»¬ä¾èµ–ä¸€ä¸ªäº‹å®, é‚£å°±æ˜¯ä¸€ä¸ª<code>Rational</code>å¯ä»¥è¿‘ä¼¼è½¬æ¢ä¸ºä¸€ä¸ªå®æ•°çš„<code>float</code>ç±»å‹å€¼. è¿™ä¸ªç»“æœå¯ä»¥ç”¨å¤æ•°æ¥è¿›è¡Œç»„åˆ.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">add_complex_and_rational</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">ComplexRI</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">real</span> <span class="o">+</span> <span class="n">r</span><span class="o">.</span><span class="n">number</span><span class="o">/</span><span class="n">r</span><span class="o">.</span><span class="n">denom</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>ä¹˜æ³•æ¶‰åŠåˆ°ç›¸ä¼¼çš„è½¬æ¢, åœ¨æåæ ‡ä¸‹, åœ¨å¤å¹³é¢ä¸Šçš„å®æ•°æ€»æ˜¯å…·æœ‰ä¸€ä¸ªæ­£çš„å‘é‡. è§’åº¦0è¡¨ç¤ºä¸€ä¸ªæ­£æ•°, è§’åº¦piè¡¨ç¤ºä¸€ä¸ªè´Ÿæ•°.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">mul_complex_and_rational</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
        <span class="n">r_magnitude</span><span class="p">,</span> <span class="n">r_angle</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">numer</span><span class="o">/</span><span class="n">r</span><span class="o">.</span><span class="n">denom</span><span class="p">,</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">r_magnitude</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">r_magnitude</span><span class="p">,</span> <span class="n">r_angle</span> <span class="o">=</span> <span class="o">-</span><span class="n">r_magnitude</span><span class="p">,</span> <span class="n">pi</span>
        <span class="k">return</span> <span class="n">ComplexMA</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">magnitude</span> <span class="o">*</span> <span class="n">r_magnitude</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">angle</span> <span class="o">+</span> <span class="n">r_angle</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>ä¹˜æ³•è·ŸåŠ æ³•éƒ½æ˜¯å¯äº¤æ¢çš„, å› æ­¤äº¤æ¢å‚æ•°é¡ºåºå¯ä»¥ç”¨è¿™äº›è·¨ç±»å‹æ“ä½œçš„ç›¸åŒå®ç°.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">add_rational_and_complex</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">add_complex_and_rational</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">mul_rational_and_complex</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">mul_complex_and_rational</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>ç±»å‹è°ƒåº¦æ‰®æ¼”çš„è§’è‰²æ˜¯å»ç¡®ä¿è¿™äº›è·¨ç±»å‹æ“ä½œåœ¨é€‚å½“çš„æ—¶å€™ä½¿ç”¨. ä¸‹é¢, æˆ‘ä»¬é‡å†™<code>Number</code>è¶…ç±»ä¸ºå…¶<code>__add__</code>ä»¥åŠ<code>__mul__</code>æ¥ä½¿ç”¨ç±»å‹è°ƒåº¦.</p>
<p>æˆ‘ä»¬ä½¿ç”¨<code>type_tag</code>å±æ€§æ¥åŒºåˆ†å‚æ•°çš„ç±»å‹. ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨å…§å»ºçš„<code>isinstance</code>æ–¹æ³•, ä½†æ˜¯<code>tags</code>ç®€åŒ–äº†å®ç°. ä½¿ç”¨ç±»å‹æ ‡ç­¾ä¹Ÿè¡¨æ˜äº†ç±»å‹è°ƒåº¦ä¸éœ€è¦è·ŸPythonçš„ç±»å‹ç³»ç»Ÿç›¸é“¾æ¥, è€Œæ˜¯ç”¨äºåœ¨å¼‚æ„åŸŸä¸Šåˆ›å»ºé€šç”¨å‡½æ•°çš„ä¸€èˆ¬æŠ€æœ¯.</p>
<p><code>__add__</code>æ–¹æ³•è€ƒè™‘ä¸¤ç§æƒ…å†µ. é¦–å…ˆ, å¦‚æœä¸¤ä¸ªå‚æ•°å…·æœ‰ç›¸åŒçš„ç±»å‹çš„æ ‡ç­¾, é‚£ä¹ˆå®ƒå‡è®¾ç¬¬ä¸€ä¸ªå‚æ•°çš„<code>add</code>æ–¹æ³•å¯ä»¥ä»¥ç¬¬äºŒä¸ªå‚æ•°ä½œä¸ºå®ƒçš„å‚æ•°. å¦åˆ™, å®ƒæ£€æŸ¥æ˜¯å¦ä¸€ä¸ªè·¨ç±»å‹çš„å­—å…¸å®ç°, å«åš<code>adders</code>, åŒ…å«ä¸€ä¸ªå¯ä»¥å¯¹å…·æœ‰è¿™äº›ç±»å‹æ ‡ç­¾çš„å‚æ•°è¿›è¡Œç›¸åŠ çš„å‡½æ•°. å¦‚æœæœ‰è¿™æ ·çš„ä¸€ä¸ªå‡½æ•°, <code>cross_apply</code>æ–¹æ³•å¹¶åº”ç”¨å®ƒ. <code>__mul__</code>æ–¹æ³•å…·æœ‰ç›¸ä¼¼çš„ç»“æ„.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">Number</span><span class="p">:</span>
        <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_tag</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">type_tag</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
            <span class="k">elif</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type_tag</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">type_tag</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">adders</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cross_apply</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">adders</span><span class="p">)</span>
        <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_tag</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">type_tag</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
            <span class="k">elif</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type_tag</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">type_tag</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">multipliers</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cross_apply</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">multipliers</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">cross_apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">cross_fns</span><span class="p">):</span>
            <span class="n">cross_fn</span> <span class="o">=</span> <span class="n">cross_fns</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">type_tag</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">type_tag</span><span class="p">)]</span>
            <span class="k">return</span> <span class="n">cross_fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
        <span class="n">adders</span> <span class="o">=</span> <span class="p">{(</span><span class="s2">&#34;com&#34;</span><span class="p">,</span> <span class="s2">&#34;rat&#34;</span><span class="p">):</span> <span class="n">add_complex_and_rational</span><span class="p">,</span>
                  <span class="p">(</span><span class="s2">&#34;rat&#34;</span><span class="p">,</span> <span class="s2">&#34;com&#34;</span><span class="p">):</span> <span class="n">add_rational_and_complex</span><span class="p">}</span>
        <span class="n">multipliers</span> <span class="o">=</span> <span class="p">{(</span><span class="s2">&#34;com&#34;</span><span class="p">,</span> <span class="s2">&#34;rat&#34;</span><span class="p">):</span> <span class="n">mul_complex_and_rational</span><span class="p">,</span>
                       <span class="p">(</span><span class="s2">&#34;rat&#34;</span><span class="p">,</span> <span class="s2">&#34;com&#34;</span><span class="p">):</span> <span class="n">mul_rational_and_complex</span><span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>åœ¨æ–°çš„<code>Number</code>ç±»ä¸­, æ‰€æœ‰è·¨ç±»å‹å®ç°éƒ½é€šè¿‡ä¸€å¯¹ç±»å‹æ ‡ç­¾æ ‡è®°åœ¨<code>adders</code>ä»¥åŠ<code>multipliers</code>å­—å…¸ä¸­.</p>
<p>è¿™ç§åŸºäºå­—å…¸çš„ç±»å‹è°ƒåº¦æ–¹æ³•æ˜¯å¯æ‹“å±•çš„. æ–°çš„<code>Number</code>å­ç±»å‹å¯ä»¥é€šè¿‡å£°æ˜ä¸€ä¸ªç±»å‹æ ‡ç­¾ä»¥åŠæ·»åŠ è·¨ç±»å‹æ“ä½œåˆ°<code>Number.adders</code>ä»¥åŠ<code>Number.multipliers</code>ä»è€Œå®‰è£…åˆ°ç³»ç»Ÿä¸­. å®ƒä»¬ä¹Ÿå¯ä»¥å®šä¹‰åœ¨å­ç±»ä¸­å®šä¹‰è‡ªå·±çš„<code>adders</code>ä»¥åŠ<code>multipliers</code>.</p>
<p>è™½ç„¶æˆ‘ä»¬å¼•å…¥äº†ä¸€äº›å¤æ‚æ€§åˆ°ç³»ç»Ÿä¸­, ä½†æˆ‘ä»¬ç°åœ¨å¯ä»¥æ··åˆç±»å‹åœ¨åŠ æ³•ä»¥åŠä¹˜æ³•è¡¨è¾¾å¼ä¸­.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">ComplexRI</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">Rational</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ComplexRI</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Rational</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">ComplexMA</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ComplexMA</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">pi</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>å¼ºåˆ¶è½¬æ¢</strong>. ä¸€èˆ¬æƒ…å†µä¸‹å®Œå…¨ä¸ç›¸å…³çš„æ“ä½œä½œç”¨äºå®Œå…¨æ— å…³çš„ç±»å‹ä¸Š, å®ç°æ˜ç¡®çš„è·¨ç±»å‹æ“ä½œä¹Ÿè®¸æ˜¯å¯ä»¥æœŸæœ›çš„æœ€å¥½çš„æ–¹å¼, è™½ç„¶å®ƒå¯èƒ½ä¼šå¾ˆéº»çƒ¦. å¹¸è¿çš„æ˜¯, æœ‰æ—¶æˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ©ç”¨åœ¨æˆ‘ä»¬çš„ç³»ç»Ÿä¸­æ½œåœ¨çš„é™„åŠ ç»“æ„æ¥åšå¾—æ›´å¥½. ä¸åŒçš„æ•°æ®ç±»å‹é€šå¸¸æ˜¯ä¸å®Œå…¨ç‹¬ç«‹çš„, å¹¶ä¸”è¿™é‡Œæˆ–è®¸å­˜åœ¨å°†ä¸€ç§ç±»å‹çš„å¯¹è±¡çœ‹åšæ˜¯å¦å¤–ä¸€ç§ç±»å‹å¯¹è±¡çš„æ–¹å¼. è¿™è¿‡ç¨‹å«åšå¼ºåˆ¶è½¬æ¢. ä¾‹å¦‚, å¦‚æœæˆ‘ä»¬è¢«è¦æ±‚ä»¥ç®—æœ¯å°†æœ‰ç†æ•°å’Œå¤æ•°è¿›è¡Œç»“åˆ, æˆ‘ä»¬å¯ä»¥å°†æœ‰ç†æ•°çœ‹ä½œæ˜¯å¤æ•°ä¸”å®ƒçš„è™šéƒ¨æ˜¯0. è¿™æ ·åšäº†ä¹‹å, æˆ‘ä»¬å¯ä»¥ç”¨<code>Complex.add</code>ä»¥åŠ<code>Complex.mul</code>æ¥ç»“åˆå®ƒä»¬.</p>
<p>ä¸€èˆ¬æƒ…å†µä¸‹, æˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾è®¡å¼ºåˆ¶è½¬æ¢å‡½æ•°å®ç°è¿™ä¸ªæƒ³æ³•, è¿™ä¸ªå‡½æ•°å¯ä»¥è½¬æ¢ä¸€ç§ç±»å‹çš„å¯¹è±¡åˆ°å¦ä¸€ç§ç±»å‹çš„ç­‰é‡å¯¹è±¡. è¿™é‡Œæ˜¯ä¸€ä¸ªå…¸å‹çš„å¼ºåˆ¶è½¬æ¢å‡½æ•°, å®ƒå¯ä»¥è½¬æ¢ä¸€ä¸ªæœ‰ç†æ•°ä¸ºä¸€ä¸ªè™šéƒ¨æ˜¯0çš„å¤æ•°:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">rational_to_complex</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">ComplexRI</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">numer</span><span class="o">/</span><span class="n">r</span><span class="o">.</span><span class="n">denom</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p><code>Number</code>ç±»çš„æ›¿ä»£å®šä¹‰é€šè¿‡å°è¯•å¼ºåˆ¶è½¬æ¢ä¸¤ä¸ªå‚æ•°ä¸ºç›¸åŒçš„ç±»å‹æ¥æ‰§è¡Œè·¨ç±»å‹æ“ä½œ. <code>coercions</code>å­—å…¸é€šè¿‡ç±»å‹æ ‡ç­¾å…ƒç»„å¯¹ç´¢å¼•æ‰€æœ‰å¯èƒ½çš„å¼ºåˆ¶ç±»å‹, æŒ‡ç¤ºç›¸å¯¹åº”çš„å€¼å°†æ‰€è¿°ç¬¬ä¸€ç§ç±»å‹çš„å€¼å¼ºåˆ¶è½¬æ¢ä¸ºç¬¬äºŒç§ç±»å‹çš„å€¼.</p>
<p>é€šå¸¸ä¸å¯èƒ½æ¯ç§æ•°æ®ç±»å‹çš„ä»»æ„æ•°æ®å¯¹è±¡å¼ºåˆ¶è½¬æ¢æˆå…¶ä»–æ‰€æœ‰ç±»å‹. ä¾‹å¦‚, æ²¡æœ‰åŠæ³•å°†å¼ºåˆ¶è½¬æ¢ä¸€ä¸ªä»»æ„å¤æ•°ä¸ºæœ‰ç†æ•°, å› æ­¤æ²¡æœ‰è¿™æ ·çš„å¼ºåˆ¶è½¬æ¢å®ç°ä¼šå‡ºç°åœ¨<code>coercions</code>å­—å…¸ä¸­.</p>
<p><code>coerce</code>æ–¹æ³•è¿”å›ä¸¤ä¸ªå…·æœ‰ç›¸åŒç±»å‹æ ‡ç­¾çš„å€¼. å®ƒæ£€æŸ¥å®ƒçš„å‚æ•°çš„ç±»å‹æ ‡ç­¾çš„å€¼, å°†å®ƒä»¬è·Ÿ<code>coercions</code>å­—å…¸çš„æ¡ç›®å¯¹æ¯”, ç„¶åç”¨<code>coerce_to</code>è½¬æ¢ä¸€ä¸ªå‚æ•°ç±»å‹ä¸ºå¦ä¸€ä¸ªå‚æ•°çš„ç±»å‹. åœ¨<code>coercions</code>ä¸­åªéœ€è¦ä¸€ä¸ªæ¡ç›®æ¥å®Œæˆæˆ‘ä»¬çš„è·¨ç±»å‹ç®—æœ¯ç³»ç»Ÿ, å¹¶æ›¿æ¢ç±»å‹è°ƒåº¦ç‰ˆæœ¬çš„<code>Number</code>ä¸­çš„å››ä¸ªè·¨ç±»å‹å‡½æ•°.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">Number</span><span class="p">:</span>
        <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coerce</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coerce</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">coerce</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_tag</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">type_tag</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span>
            <span class="k">elif</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type_tag</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">type_tag</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coercions</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coerce_to</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">type_tag</span><span class="p">),</span> <span class="n">other</span><span class="p">)</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">type_tag</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_tag</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coercions</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">coerce_to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type_tag</span><span class="p">))</span>
        <span class="k">def</span> <span class="nf">coerce_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_tag</span><span class="p">):</span>
            <span class="n">coercion_fn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coercions</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">type_tag</span><span class="p">,</span> <span class="n">other_tag</span><span class="p">)]</span>
            <span class="k">return</span> <span class="n">coercion_fn</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">coercions</span> <span class="o">=</span> <span class="p">{(</span><span class="s1">&#39;rat&#39;</span><span class="p">,</span> <span class="s1">&#39;com&#39;</span><span class="p">):</span> <span class="n">rational_to_complex</span><span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿™ä¸ªå¼ºåˆ¶ç±»å‹æ–¹æ¡ˆè·Ÿå®šä¹‰æ˜¾ç¤ºè·¨ç±»å‹æ“ä½œçš„æ–¹æ³•ç›¸æ¯”æœ‰ä¸€äº›ä¼˜ç‚¹. è™½ç„¶æˆ‘ä»¬è¿˜æ˜¯éœ€è¦ç¼–å†™å¼ºåˆ¶è½¬æ¢å‡½æ•°æ¥å…³è”ç±»å‹, ä½†æˆ‘ä»¬åªéœ€è¦ä¸ºæ¯ä¸€å¯¹ç±»å‹ç¼–å†™ä¸€ä¸ªå‡½æ•°, è€Œä¸æ˜¯ä¸ºæ¯ä¸ªç±»å‹é›†åˆä»¥åŠæ¯ä¸ªé€šç”¨æ“ä½œä½¿ç”¨ä¸åŒçš„å‡½æ•°. æˆ‘ä»¬åœ¨è¿™é‡ŒæœŸæœ›è¦æŒ‡å‡ºçš„äº‹å®æ˜¯, ç±»å‹ä¹‹é—´çš„é€‚å½“è½¬æ¢ä»…ä¾èµ–äºç±»å‹æœ¬èº«, è€Œä¸æ˜¯ä»¥æ¥è¦åº”ç”¨çš„ç‰¹å®šæ“ä½œ.</p>
<p>æ›´è¿›ä¸€æ­¥çš„å¥½å¤„æ¥è‡ªäºæ‰©å±•å¼ºåˆ¶è½¬æ¢. ä¸€äº›æ›´å¤æ‚çš„å¼ºåˆ¶è½¬æ¢æ–¹æ¡ˆå¹¶ä¸æ˜¯ä»…ä»…æ˜¯å°è¯•å»å¼ºåˆ¶è½¬æ¢ä¸€ç§ç±»å‹åˆ°å¦ä¸€ç§, è€Œæ˜¯å¯èƒ½ä¼šå°è¯•å»å¼ºåˆ¶è½¬æ¢æ¯ä¸ªä¸åŒçš„ç±»å‹åˆ°ç¬¬ä¸‰ç§å¸¸è§ç±»å‹. è€ƒè™‘ä¸€ä¸ªè±å½¢ä»¥åŠä¸€ä¸ªçŸ©å½¢: ä¸¤è€…éƒ½ä¸æ˜¯å½¼æ­¤ç±»å‹çš„é¢å¤–æƒ…å†µ, ä½†æ˜¯éƒ½å¯ä»¥è¢«çœ‹ä½œæ˜¯å››è¾¹å½¢. å¦ä¸€ä¸ªå¼ºåˆ¶è½¬æ¢çš„æ‰©å±•æ˜¯å¼ºåˆ¶è½¬æ¢è¿­ä»£, ä¸€ç§æ•°æ®ç±»å‹é€šè¿‡ä¸­é—´ç±»å‹è¢«å¼ºåˆ¶è½¬æ¢æˆå¦ä¸€ç§ç±»å‹. æ€è€ƒä¸€ä¸‹ä¸€ä¸ªæ•´æ•°å¯ä»¥è¢«è½¬æ¢æˆä¸€ä¸ªå®æ•°åªè¦é¦–å…ˆå°†å®ƒè½¬æ¢æˆä¸€ä¸ªæœ‰ç†æ•°, ç„¶åå°†è¿™ä¸ªæœ‰ç†æ•°è½¬æ¢æˆå®æ•°. ä»¥è¿™ç§æ–¹å¼çš„é“¾æ¥å¼ºåˆ¶è½¬æ¢å¯ä»¥å‡å°‘ç¨‹åºæ‰€éœ€çš„å¼ºåˆ¶å‡½æ•°çš„æ€»æ•°.</p>
<p>å°½ç®¡å¼ºåˆ¶è½¬æ¢å…·æœ‰å¥½å¤„, ä½†ä¹Ÿæœ‰æ½œåœ¨çš„ç¼ºç‚¹. ä¸€ä¸ªæ˜¯å¼ºåˆ¶å‡½æ•°åœ¨åº”ç”¨å®ƒä»¬æ—¶å¯èƒ½ä¼šä¸¢å¤±ä¿¡æ¯. åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­, æœ‰ç†æ•°æ˜¯ç²¾ç¡®è¡¨ç¤º, ä½†æ˜¯å½“å®ƒä»¬è¢«è½¬æ¢æˆå¤æ•°æ—¶å°±æˆäº†è¿‘ä¼¼å€¼.</p>
<p>ä¸€äº›ç¼–ç¨‹è¯­è¨€æœ‰å…§å»ºè‡ªåŠ¨çš„å¼ºåˆ¶è½¬æ¢ç³»ç»Ÿ. å®é™…ä¸Š, æ—©æœŸç‰ˆæœ¬çš„Pythonæœ‰ä¸€ä¸ª<code>__coerce__</code>ç‰¹æ®Šæ–¹æ³•åœ¨å¯¹è±¡ä¸Š. æœ€å, å†…ç½®å¼ºåˆ¶ç³»ç»Ÿçš„å¤æ‚æ€§æ²¡æœ‰è¯æ˜å®ƒçš„ä½¿ç”¨æ˜¯æœ‰ç†çš„, å› æ­¤å®ƒè¢«ç§»é™¤äº†. è€Œæ˜¯, ç‰¹å®šè¿ç®—æ ¹æ®éœ€è¦å¯¹å®ƒä»¬çš„å‚æ•°åº”ç”¨å¼ºåˆ¶è½¬æ¢.</p>
<h3 id="28-æ•ˆç‡">2.8 æ•ˆç‡</h3>
<p>å†³å®šå¦‚ä½•è¡¨ç¤ºä»¥åŠä¼ è¾“æ•°æ®å¸¸å¸¸æ”¶å¯ä¾›é€‰æ‹©çš„æ•ˆç‡å½±å“. æ•ˆç‡æŒ‡çš„æ˜¯è¡¨ç¤ºæˆ–å¤„ç†è¿‡ç¨‹ä½¿ç”¨çš„è®¡ç®—èµ„æº, ä¾‹å¦‚å‡½æ•°è®¡ç®—ç»“æœæˆ–è€…è¡¨ç¤ºä¸€ä¸ªå¯¹è±¡éœ€è¦ç”¨åˆ°å¤šå°‘æ—¶é—´ä»¥åŠå†…å­˜. è¿™äº›æ•°é‡æ ¹æ®å®ç°çš„ç»†èŠ‚å¯ä»¥æœ‰å¾ˆå¤§çš„å·®å¼‚.</p>
<h4 id="281-æµ‹é‡æ•ˆç‡">2.8.1 æµ‹é‡æ•ˆç‡</h4>
<p>ç²¾ç¡®åœ°æµ‹é‡ä¸€ä¸ªç¨‹åºéœ€è¦å¤šé•¿æ—¶é—´æ¥è¿è¡Œæˆ–è€…æ¶ˆè€—å¤šå°‘å†…å­˜æ˜¯ä¸€ä¸ªæŒ‘æˆ˜, å› ä¸ºç»“æœå–å†³äºå¾ˆå¤šç”µè„‘é…ç½®çš„ç»†èŠ‚. ä¸€ä¸ªæ›´å¯é çš„æ–¹å¼å»æç»˜ç¨‹åºæ•ˆç‡ç‰¹å¾çš„æ–¹å¼æ˜¯å»æµ‹é‡æŸäº›äº‹ä»¶å‘ç”Ÿäº†å¤šå°‘æ¬¡, ä¾‹å¦‚å‡½æ•°çš„è°ƒç”¨.</p>
<p>è®©æˆ‘ä»¬å›åˆ°ç¬¬ä¸€ä¸ªæ•°é€’å½’å‡½æ•°, <code>fib</code>å‡½æ•°ç”¨äºè®¡ç®—æ–æ³¢é‚£å¥‘æ•°åˆ—ä¸­çš„æ•°å­—.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">fib</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">fib</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">fib</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">fib</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="mi">5</span>
</code></pre></td></tr></table>
</div>
</div><p>æ€è€ƒä¸€ä¸‹ä¸‹é¢æè¿°çš„æ¥è‡ªäºè®¡ç®—<code>fib(6)</code>çš„ç»“æœçš„è®¡ç®—æ¨¡å¼. å»è®¡ç®—<code>fib(5)</code>, æˆ‘ä»¬éœ€è¦è®¡ç®—<code>fib(3)</code>ä»¥åŠ<code>fib(4)</code>. è¦è®¡ç®—<code>fib(3)</code>, æˆ‘ä»¬éœ€è¦è®¡ç®—<code>fib(1)</code>ä»¥åŠ<code>fib(2)</code>. ä¸€èˆ¬æ¥è¯´, æ¼”è¿›çš„è¿‡ç¨‹çœ‹èµ·æ¥åƒä¸€æ£µæ ‘. æ¯ä¸ªè“è‰²ç‚¹è¡¨ç¤ºä¸€ä¸ªå®Œæ•´çš„è®¡ç®—æ–æ³¢é‚£å¥‘æ•°çš„è¿™æ£µæ ‘çš„éå†.</p>
<p><img src="http://www.composingprograms.com/img/fib.png" alt="æ–æ³¢é‚£å¥‘æ ‘" /></p>
<p>è¿™æ£µæ ‘æ˜¯å…¸å‹çš„ç”¨äºæŒ‡å¯¼æ ‘é€’å½’çš„ä¾‹å­, ä½†æ˜¯è¿™æ˜¯ä¸€ä¸ªéå¸¸æ²¡æœ‰æ•ˆç‡çš„è®¡ç®—æ–æ³¢é‚£å¥‘æ•°çš„æ–¹å¼, å› ä¸ºå®ƒåšäº†è®¸å¤šå†—ä½™çš„è®¡ç®—. <code>fib(3)</code>çš„æ•´ä¸ªè®¡ç®—è¿‡ç¨‹æ˜¯å¤šä½™çš„.</p>
<p>æˆ‘ä»¬å¯ä»¥æµ‹é‡è¿™ç§ä½æ•ˆç‡. é«˜ç­‰çº§çš„<code>count</code>å‡½æ•°è¿”å›ä¸€ä¸ªè·Ÿå®ƒçš„å‚æ•°(ä¹Ÿç»´æŒä¸€ä¸ª<code>call_count</code>å±æ€§)çš„ç­‰æ•ˆå‡½æ•°. ç”¨è¿™ç§æ–¹æ³•, æˆ‘ä»¬å¯ä»¥æ£€æŸ¥<code>fib</code>è°ƒç”¨äº†å¤šå°‘æ¬¡.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">count</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">counted</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
            <span class="n">counted</span><span class="o">.</span><span class="n">call_count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="n">counted</span><span class="o">.</span><span class="n">call_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">counted</span>
</code></pre></td></tr></table>
</div>
</div><p>é€šè¿‡ç»Ÿè®¡è°ƒç”¨<code>fib</code>çš„æ¬¡æ•°, æˆ‘ä»¬å¯ä»¥çœ‹åˆ°éœ€è¦çš„è°ƒç”¨æ¬¡æ•°å¢é•¿å¾—æ¯”æ–æ³¢é‚£å¥‘æ•°å­—æœ¬èº«è¦å¿«å¾ˆå¤š. è¿™ç§å¿«é€Ÿå¢é•¿çš„è°ƒç”¨æ¬¡æ•°å°±æ˜¯æ ‘é€’å½’å‡½æ•°çš„ç‰¹å¾.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">fib</span> <span class="o">=</span> <span class="n">count</span><span class="p">(</span><span class="n">fib</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fib</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
<span class="mi">4181</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fib</span><span class="o">.</span><span class="n">call_count</span>
<span class="mi">13529</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>ç©ºé—´</strong>. è¦æ˜ç™½å‡½æ•°å¯¹ç©ºé—´çš„è¦æ±‚, æˆ‘ä»¬å¿…é¡»è¦æŒ‡å‡ºåœ¨æˆ‘ä»¬çš„è®¡ç®—ç¯å¢ƒæ¨¡å‹ä¸­ä¸€èˆ¬ä¼šæœ‰å¤šå°‘ç©ºé—´è¢«ä½¿ç”¨, ä¿å­˜ä»¥åŠå›æ”¶. åœ¨è®¡ç®—è¡¨è¾¾å¼æ—¶, è§£æå™¨ä¿å­˜æ‰€æœ‰çš„æ´»åŠ¨ç¯å¢ƒä»¥åŠè¢«è¿™äº›ç¯å¢ƒæ‰€å¼•ç”¨çš„æ‰€æœ‰çš„å€¼å’Œå¸§. ä¸€ä¸ªç¯å¢ƒå¦‚æœå®ƒéœ€è¦ä¸ºæŸäº›éœ€è¦å°†è¦è¿è¡Œçš„è¡¨è¾¾å¼æä¾›æ‰§è¡Œä¸Šä¸‹æ–‡é‚£ä¹ˆå®ƒå°±æ˜¯æ´»åŠ¨çš„. ä»»ä½•æ—¶å€™å½“åˆ›å»ºå‡½æ•°è°ƒç”¨çš„ç¬¬ä¸€ä¸ªå¸§æœ€åè¿”å›çš„æ—¶å€™, è¿™ä¸ªç¯å¢ƒå°±å˜ä¸ºéæ´»åŠ¨çŠ¶æ€.</p>
<p>ä¾‹å¦‚, å½“è®¡ç®—<code>fib</code>, è§£æå™¨æŒ‰ç…§å‰é¢å±•ç¤ºçš„é¡ºåºå¯¹æ¯ä¸ªå€¼è¿›è¡Œè®¡ç®—, éå†æ ‘ç»“æ„. è¿™æ ·åš, åªéœ€è¦åœ¨è®¡ç®—æ ‘ä¸­çš„ä»»ä½•èŠ‚ç‚¹æ—¶å¯¹å½“å‰èŠ‚ç‚¹çš„ä¸Šä¸€ä¸ªèŠ‚ç‚¹ä¿æŒè·Ÿè¸ª. ç”¨äºæ‰§è¡Œå‰©ä¸‹çš„åˆ†æ”¯çš„å†…å­˜æ˜¯å¯å›æ”¶çš„, å› ä¸ºå®ƒä¸èƒ½å½±å“åˆ°æœªæ¥çš„è®¡ç®—. ä¸€èˆ¬æ¥è¯´, æ ‘é€’å½’å‡½æ•°éœ€è¦çš„ç©ºé—´è·Ÿæ ‘çš„æœ€å¤§æ·±åº¦æˆæ­£æ¯”.</p>
<p>ä¸‹é¢çš„å›¾ä¾‹æç»˜äº†æ‰§è¡Œ<code>fib(3)</code>æ—¶åˆ›å»ºçš„ç¯å¢ƒ. åœ¨æ‰§è¡Œæœ€åˆçš„<code>fib</code>ç¨‹åºçš„è¿”å›çš„è¡¨è¾¾å¼çš„è¿‡ç¨‹ä¸­, è¡¨è¾¾å¼<code>fib(n-2)</code>è¢«è¿è¡Œ, äº§ç”Ÿå€¼0. ä¸€æ—¦è¿™ä¸ªå€¼è®¡ç®—å®Œæˆ, ç›¸åº”çš„ç¯å¢ƒå¸§(ç°è‰²æ·¡å‡ºçš„é‚£ä¸ª)å°±ä¸å†éœ€è¦äº†: å®ƒä¸å†æ˜¯æ´»åŠ¨ç¯å¢ƒçš„ä¸€éƒ¨åˆ†. å› æ­¤, ä¸€ä¸ªè®¾è®¡è‰¯å¥½çš„è§£æå™¨å¯ä»¥å›æ”¶ç”¨äºå­˜å‚¨è¿™ä¸ªå¸§çš„å†…å­˜. å¦ä¸€æ–¹é¢, å¦‚æœè¿™ä¸ªè§£æå™¨å½“å‰æ­£åœ¨æ‰§è¡Œ<code>fib(n-1)</code>, é‚£ä¹ˆä¸€ä¸ªç¯å¢ƒä¼šé€šè¿‡<code>fib</code>ç¨‹åº(åœ¨è¿™é‡Œçš„næ˜¯2)åˆ›å»ºä¸”æ˜¯æ´»åŠ¨çš„. åè¿‡æ¥, åŸæ¥åˆ›å»ºçš„åº”ç”¨3çš„<code>fib</code>ç¯å¢ƒä¾ç„¶æ˜¯æ´»åŠ¨çš„, å› ä¸ºå®ƒçš„è¿”å›å€¼è¿˜æ²¡æœ‰è¢«è®¡ç®—å‡ºæ¥.</p>
<iframe width="800" height="500" frameborder="0" src="http://pythontutor.com/iframe-embed.html#code=def%20fib%28n%29%3A%0A%20%20%20%20if%20n%20%3D%3D%200%3A%0A%20%20%20%20%20%20%20%20return%200%0A%20%20%20%20if%20n%20%3D%3D%201%3A%0A%20%20%20%20%20%20%20%20return%201%0A%20%20%20%20return%20fib%28n-2%29%20%2B%20fib%28n-1%29%0A%0Aresult%20%3D%20fib%282%29&codeDivHeight=400&codeDivWidth=350&cumulative=true&curInstr=0&origin=composingprograms.js&py=3&rawInputLstJSON=%5B%5D"> </iframe>
<p>é«˜é˜¶çš„<code>count_frames</code>å‡½æ•°è¿½è¸ª<code>open_count</code>å‡½æ•°, è°ƒç”¨å‡½æ•°å‡½æ•°fçš„æ¬¡æ•°ä¾ç„¶æ²¡æœ‰è¿”å›. <code>max_count</code>å±æ€§æ˜¯é€šè¿‡<code>open_count</code>è€Œè·å¾—çš„æœ€å¤§å€¼, è€Œä¸”å®ƒè·Ÿåœ¨è®¡ç®—è¿‡ç¨‹ä¸­åŒæ—¶å¤„äºæ´»åŠ¨çŠ¶æ€çš„å¸§çš„æœ€å¤§æ•°ç›¸å¯¹åº”.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">count_frames</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">counted</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
            <span class="n">counted</span><span class="o">.</span><span class="n">open_count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">counted</span><span class="o">.</span><span class="n">max_count</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">counted</span><span class="o">.</span><span class="n">max_count</span><span class="p">,</span> <span class="n">counted</span><span class="o">.</span><span class="n">open_count</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
            <span class="n">counted</span><span class="o">.</span><span class="n">open_count</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="n">counted</span><span class="o">.</span><span class="n">open_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">counted</span><span class="o">.</span><span class="n">max_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">counted</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">fib</span> <span class="o">=</span> <span class="n">count_frames</span><span class="p">(</span><span class="n">fib</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fib</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
<span class="mi">4181</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fib</span><span class="o">.</span><span class="n">open_count</span>
<span class="mi">0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fib</span><span class="o">.</span><span class="n">max_count</span>
<span class="mi">19</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fib</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<span class="mi">46368</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fib</span><span class="o">.</span><span class="n">max_count</span>
<span class="mi">24</span>
</code></pre></td></tr></table>
</div>
</div><p>æ€»çš„æ¥è¯´, åœ¨æ´»åŠ¨å¸§ä¸­æµ‹é‡çš„<code>fib</code>å‡½æ•°éœ€è¦çš„ç©ºé—´å°äºè¾“å…¥, å…¶è¶‹åŠ¿æ˜¯è¶‹å‘æ›´å°çš„. åœ¨æ€»çš„é€’å½’è°ƒç”¨ä¸­æµ‹é‡çš„æ—¶é—´éœ€æ±‚æ˜¯å¤§äºè¾“å‡ºçš„, å…¶è¶‹åŠ¿æ˜¯è¶‹å‘æ›´å¤§çš„.</p>
<h4 id="282-è®°å¿†åŒ–">2.8.2 è®°å¿†åŒ–</h4>
<p>æ ‘é€’å½’è®¡ç®—è¿‡ç¨‹é€šå¸¸å¯ä»¥é€šè¿‡è®°å¿†åŒ–æŠ€æœ¯æ¥æé«˜æ•ˆç‡, ä¸€ä¸ªå¼ºæœ‰åŠ›çš„æé«˜é€’å½’å‡½æ•°é‡å¤è®¡ç®—çš„æ•ˆç‡çš„æŠ€æœ¯. ä¸€ä¸ªè®°å¿†åŒ–å‡½æ•°ä¼šå¯¹ä¹‹å‰æ”¶åˆ°çš„ä»»ä½•å‚æ•°çš„è¿”å›å€¼è¿›è¡Œå­˜å‚¨. ç¬¬äºŒæ¬¡è°ƒç”¨<code>fib(25)</code>ä¸ä¼šå†æ¬¡é€’å½’è®¡ç®—è¿”å›å€¼, è€Œæ˜¯è¿”å›å·²ç»è¢«æ„é€ è€Œå­˜åœ¨çš„é‚£ä¸ªå€¼.</p>
<p>è®°å¿†åŒ–å¯ä»¥å¾ˆè‡ªç„¶åœ°ä»¥é«˜é˜¶å‡½æ•°æ¥è¡¨ç¤º, ä¹Ÿå¯ä»¥ä½œä¸ºä¸€ä¸ªè£…é¥°å™¨æ¥ä½¿ç”¨. ä¸‹é¢çš„å®šä¹‰ä¸ºä¹‹å‰çš„è®¡ç®—ç»“æœåˆ›å»ºä¸€ä¸ª<code>cache</code>, å¹¶ä»¥è®¡ç®—å®ƒä»¬çš„å‚æ•°ä½œä¸ºç´¢å¼•. å­—å…¸çš„ä½¿ç”¨éœ€è¦ä¼ ç»™è®°å¿†åŒ–å‡½æ•°çš„å‚æ•°æ˜¯ä¸å¯å˜çš„.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">memo</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="n">cache</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">def</span> <span class="nf">memoized</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">n</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cache</span><span class="p">:</span>
                <span class="n">cache</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">cache</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">memoized</span>
</code></pre></td></tr></table>
</div>
</div><p>å¦‚æœæˆ‘ä»¬åº”ç”¨<code>memo</code>åˆ°æ–æ³¢é‚£å¥‘æ•°çš„é€’å½’è®¡ç®—å½“ä¸­, å°±æ¼”å˜å‡ºä¸€ç§æ–°çš„è®¡ç®—æ¨¡å¼, å¦‚ä¸‹æ‰€ç¤º.</p>
<p><img src="http://composingprograms.com/img/fib_memo.png" alt="è®°å¿†åŒ–æ–æ³¢é‚£å¥‘æ•°è®¡ç®—" /></p>
<p>åœ¨<code>fib(5)</code>çš„è®¡ç®—å½“ä¸­, åœ¨æ ‘å³ä¾§çš„åˆ†æ”¯ä¸Š<code>fib(2)</code>ä»¥åŠ<code>fib(3)</code>çš„è®¡ç®—ç»“æœåœ¨è®¡ç®—<code>fib(4)</code>æ—¶è¢«é‡ç”¨. ç»“æœå°±æ˜¯, æ ‘é€’å½’çš„è®¸å¤šè®¡ç®—ç»“æœæ˜¯ä¸å¿…è¦çš„.</p>
<p>ä½¿ç”¨<code>count</code>, æˆ‘ä»¬å¯ä»¥çœ‹åˆ°<code>fib</code>å‡½æ•°å®é™…ä¸Šåªå¯¹äº<code>fib</code>çš„æ¯ä¸ªå”¯ä¸€è¾“å…¥è°ƒç”¨ä¸€æ¬¡.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">counted_fib</span> <span class="o">=</span> <span class="n">count</span><span class="p">(</span><span class="n">fib</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fib</span>  <span class="o">=</span> <span class="n">memo</span><span class="p">(</span><span class="n">counted_fib</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fib</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
<span class="mi">4181</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">counted_fib</span><span class="o">.</span><span class="n">call_count</span>
<span class="mi">20</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fib</span><span class="p">(</span><span class="mi">34</span><span class="p">)</span>
<span class="mi">5702887</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">counted_fib</span><span class="o">.</span><span class="n">call_count</span>
<span class="mi">35</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="283-å¢é•¿çš„é¡ºåº">2.8.3 å¢é•¿çš„é¡ºåº</h4>
<p>è¿›ç¨‹åœ¨æ¶ˆè€—è®¡ç®—æœºæ—¶é—´ä»¥åŠç©ºé—´èµ„æºä¸Šå¯ä»¥æœ‰å·¨å¤§çš„ä¸åŒ, å°±åƒå…ˆå‰çš„ä¾‹å­æ¼”ç¤ºçš„é‚£æ ·. ç„¶è€Œ, å½“è°ƒç”¨å‡½æ•°æ—¶ç²¾å‡†åœ°ç¡®å®šå¤šå°‘ç©ºé—´æˆ–æ—¶é—´ä¼šè¢«ä½¿ç”¨æ˜¯éå¸¸å›°éš¾çš„ä»»åŠ¡, è¿™ä¾èµ–äºå¾ˆå¤šå› ç´ . ä¸€ä¸ªåˆ†æè¿›ç¨‹çš„æœ‰ç”¨çš„æ–¹å¼æ˜¯å°†å…¶åˆ†ç±»ä¸ºä¸€ç»„å…·æœ‰ç±»ä¼¼éœ€æ±‚çš„è¿›ç¨‹ç»„. æœ‰æ•ˆçš„åˆ†ç±»æ˜¯ä»¥è¿›ç¨‹çš„_å¢é•¿é¡ºåº_æ¥è¿›è¡Œ, ç®€å•æ¥è¯´å°±æ˜¯è¿›ç¨‹çš„èµ„æºéœ€æ±‚éšç€å‡½æ•°çš„è¾“å…¥è€Œå¦‚ä½•å¢é•¿.</p>
<p>ä½œä¸ºå¢é•¿çš„é¡ºåºçš„ä»‹ç», æˆ‘ä»¬ä¼šåœ¨ä¸‹é¢åˆ†æå‡½æ•°<code>count_factors</code>, å®ƒä¼šç»Ÿè®¡å¯ä»¥å°†è¾“å…¥å‡åˆ†çš„æ•´æ•°çš„ä¸ªæ•°. è¿™ä¸ªå‡½æ•°ä¼šå°è¯•å»æŠŠnè·Ÿæ¯ä¸ªå°äºæˆ–è€…ç­‰äºå®ƒçš„å¹³æ–¹æ ¹çš„æ•°è¿›è¡Œç›¸é™¤. è¿™ä¸ªå®ç°åˆ©ç”¨<code>å¦‚æœkå¯ä»¥æ•´é™¤nåŒæ—¶k &lt; æ ¹å·n, é‚£ä¹ˆå°±æœ‰å¦ä¸€ä¸ªå› å­j = n / k, è¿™æ ·çš„j &gt; æ ¹å·n</code>è¿™ä¸€äº‹å®.</p>
<iframe width="800" height="500" frameborder="0" src="http://pythontutor.com/iframe-embed.html#code=from%20math%20import%20sqrt%0Adef%20count_factors%28n%29%3A%0A%20%20%20%20sqrt_n%20%3D%20sqrt%28n%29%0A%20%20%20%20k,%20factors%20%3D%201,%200%0A%20%20%20%20while%20k%20%3C%20sqrt_n%3A%0A%20%20%20%20%20%20%20%20if%20n%20%25%20k%20%3D%3D%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20factors%20%2B%3D%202%0A%20%20%20%20%20%20%20%20k%20%2B%3D%201%0A%20%20%20%20if%20k%20*%20k%20%3D%3D%20n%3A%0A%20%20%20%20%20%20%20%20factors%20%2B%3D%201%0A%20%20%20%20return%20factors%0A%0Aresult%20%3D%20count_factors%28576%29&codeDivHeight=400&codeDivWidth=350&cumulative=true&curInstr=0&origin=composingprograms.js&py=3&rawInputLstJSON=%5B%5D"> </iframe>
<p>æ‰§è¡Œ<code>count_factors</code>éœ€è¦å¤šå°‘æ—¶é—´? ç²¾ç¡®çš„å›ç­”ä¼šéšç€æœºå™¨çš„ä¸åŒè€Œå˜åŒ–, ä½†æ˜¯æˆ‘ä»¬å¯ä»¥åšä¸€äº›æœ‰ç”¨çš„æ¶‰åŠåˆ°è®¡ç®—é‡çš„ä¸€èˆ¬æ€§è§‚å¯Ÿ. è¿™ä¸ªè¿›ç¨‹æ‰§è¡Œå†…éƒ¨çš„<code>while</code>è¯­å¥ä¸»ä½“çš„æ€»æ¬¡æ•°æ˜¯å°äºæ ¹å·nçš„æœ€å¤§æ•´æ•°. åœ¨whileè¯­å¥ä¹‹å‰æˆ–è€…ä¹‹åçš„è¯­å¥éƒ½åªæ‰§è¡Œä¸€æ¬¡. å› æ­¤, æ€»çš„æ‰§è¡Œè¯­å¥çš„æ¬¡æ•°æ˜¯<code>w * æ ¹å·n + v</code>, è¿™é‡Œçš„wæ˜¯æŒ‡åœ¨whileä½“å†…çš„è¯­å¥çš„æ•°é‡, è€Œvæ˜¯æŒ‡åœ¨whileè¯­å¥å¤–é¢çš„è¯­å¥. è™½ç„¶è¿™æ ·å¹¶ä¸ç²¾ç¡®, è¿™ä¸ªå…¬å¼é€šå¸¸èƒ½å¤Ÿè¡¨æ˜æ‰§è¡Œä»¥nä¸ºè¾“å…¥çš„<code>count_factors</code>å‡½æ•°éœ€è¦å¤šå°‘æ—¶é—´.</p>
<p>ä¸€ä¸ªæ›´åŠ å‡†ç¡®çš„æè¿°æ˜¯å¾ˆéš¾å®ç°çš„. å¸¸é‡wä»¥åŠvå¹¶ä¸æ˜¯çœŸæ­£çš„å¸¸é‡, å› ä¸ºèµ‹å€¼è¯­å¥æœ‰æ—¶å€™ä¼šå¯¹å› å­æ‰§è¡Œæœ‰æ—¶å€™ä¸ä¼š. å¢é•¿çš„é¡ºåºåˆ†æå…è®¸æˆ‘ä»¬å»æ©é¥°è¿™äº›ç»†èŠ‚ä»è€Œåˆ†æå¢é•¿çš„æ€»ä½“å½¢æ€. å°¤å…¶æ˜¯, <code>count_factors</code>å¢é•¿çš„é¡ºåºç²¾ç¡®åœ°è¡¨ç¤ºä¸ºä¸€ä¸ªæœ¯è¯­, é‚£å°±æ˜¯è®¡ç®—<code>count_factors</code>éœ€è¦çš„æ—¶é—´é‡ä¸æ ¹å·nç­‰æ¯”ä¾‹ç¼©æ”¾, å¤–åŠ ä¸€äº›å¸¸é‡å› æ•°.</p>
<p><strong>Thetaç¬¦å·</strong>. è®©næˆä¸ºä¸€ä¸ªå‚æ•°ç”¨æ¥è¡¡é‡è¾“å…¥åˆ°æŸäº›è¿‡ç¨‹çš„å¤§å°, åŒæ—¶è®©$R(n)$æˆä¸ºè¾“å…¥å¤§å°ä¸ºnçš„è¿‡ç¨‹æ‰€éœ€è¦ç”¨åˆ°çš„èµ„æºçš„æ€»æ•°. åœ¨æˆ‘ä»¬ä¹‹å‰çš„ä¾‹å­ä¸­, æˆ‘ä»¬è®©nä½œä¸ºæˆ‘ä»¬çš„ç»™å®šçš„å‡½æ•°éœ€è¦å»è®¡ç®—çš„æ•°å­—, ä½†ä¹Ÿæœ‰å…¶ä»–çš„å¯èƒ½æ€§. ä¾‹å¦‚, å¦‚æœæˆ‘ä»¬çš„ç›®æ ‡æ˜¯å»è®¡ç®—ä¸€ä¸ªæ•°å­—çš„å¹³æ–¹æ ¹çš„è¿‘ä¼¼å€¼, æˆ‘ä»¬å¯èƒ½ä¼šå–nä¸ºæ‰€éœ€ç²¾åº¦çš„ä½æ•°.</p>
<p>$R(n)$å¯èƒ½ä¼šæµ‹é‡æ‰€éœ€è¦ä½¿ç”¨çš„å†…å­˜, æ‰§è¡Œçš„åŸºæœ¬æœºå™¨æ­¥éª¤çš„æ•°é‡ç­‰ç­‰. åœ¨è®¡ç®—æœºä¸­æ¯ä¸€æ­¥åªç”¨å›ºå®šçš„æ—¶é—´æ¥æ‰§è¡Œ, è¿è¡Œè¡¨è¾¾å¼æ‰€ç”¨çš„æ—¶é—´å°†ä¸åœ¨è¿è¡Œè¿‡ç¨‹ä¸­æ‰§è¡Œçš„åŸºæœ¬æœºå™¨æ­¥éª¤çš„æ•°é‡æˆæ¯”ä¾‹.</p>
<p>æˆ‘ä»¬è¯´$R(n)$å¢é•¿çš„é¡ºåºä¸º$R(n)$, å†™ä½œ$R(n) = \Theta(f(n))$ (è¯»ä½œ&quot;theta f(n)&quot;), å¦‚æœæœ‰æ­£çš„å¸¸æ•°<code>k1</code>ä»¥åŠ<code>k2</code>ç‹¬ç«‹äº<code>n</code>åƒä¸‹é¢è¿™æ ·:</p>
<p>$$<br />
\begin{equation*}<br />
k_1 \cdot f(n) \leq R(n) \leq k_2 \cdot f(n)<br />
\end{equation*}<br />
$$</p>
<p>å¯¹äºä»»ä½•å¤§äºæŸä¸ªæœ€å°å€¼mçš„å€¼n. æ¢å¥è¯è¯´, å¯¹äºå¤§n, å€¼$R(n)$æ€»æ˜¯å¤¹åœ¨ä¸¤ä¸ªä»¥$f(n)$ä¸ºè§„æ¨¡å¢é•¿çš„åŒºé—´å½“ä¸­:</p>
<ul>
<li>ä¸€ä¸ªä¸‹é™$k_1 \cdot f(n)$ä»¥åŠ</li>
<li>ä¸€ä¸ªä¸Šé™$k_2 \cdot f(n)$</li>
</ul>
<p>æˆ‘ä»¬å¯ä»¥ç”¨åº”ç”¨è¿™ä¸ªå®šä¹‰æ¥å±•ç¤ºè¿è¡Œ<code>count_factors(n)</code>æ‰€éœ€è¦çš„æ­¥éª¤æ•°, é€šè¿‡æ£€æŸ¥å‡½æ•°å¯çŸ¥å…¶å¢é•¿ä¸º$\Theta(\sqrt{n})$.</p>
<p>é¦–å…ˆ, æˆ‘ä»¬é€‰æ‹©$k_1=1$ä»¥åŠ$m=0$, ä½¿å¾—<code>count_factors(n)</code>çš„ä¸‹é™çŠ¶æ€ä¸ºå¯¹äºç»™å®šçš„$n&gt;0$éœ€è¦æ‰§è¡Œè‡³å°‘$1 \cdot\sqrt{n}$æ­¥. è¿™é‡Œè‡³å°‘æœ‰4è¡Œæ˜¯åœ¨<code>while</code>å£°æ˜ä¹‹å¤–æ‰§è¡Œçš„, æ¯ä¸€è¡Œè‡³å°‘éœ€è¦ä¸€ä¸ªæ­¥éª¤æ¥æ‰§è¡Œ. è¿™é‡Œè‡³å°‘æœ‰ä¸¤è¡Œæ˜¯åœ¨<code>while</code>ä½“å†…æ‰§è¡Œçš„, åŒ…æ‹¬whileå¤´éƒ¨æœ¬èº«. æ‰€æœ‰è¿™äº›è‡³å°‘éœ€è¦ä¸€ä¸ªæ­¥éª¤. <code>while</code>ä½“è‡³å°‘æ‰§è¡Œ$\sqrt{n}-1$æ¬¡. å°†è¿™äº›ä¸‹é™è¿›è¡Œåˆå¹¶, æˆ‘ä»¬å¯ä»¥çœ‹åˆ°, è¿‡ç¨‹è‡³å°‘éœ€è¦$4 + 3\cdot (\sqrt{n}-1)$æ­¥, ä¹Ÿå°±æ˜¯æ€»æ˜¯å¤§äº$k_1 \cdot\sqrt{n}$.</p>
<p>å…¶æ¬¡, æˆ‘ä»¬å¯ä»¥ç¡®è®¤ä¸Šé™. æˆ‘ä»¬å‡è®¾åœ¨<code>count_factors</code>ä½“å†…çš„ä»»ä½•å•ä¸€çš„ä¸€è¡Œæœ€å¤šéœ€è¦pä¸ªæ­¥éª¤. è¿™ä¸ªå‡è®¾å¯¹äºPythonä¸­çš„æ¯ä¸€è¡Œéƒ½ä¸æ˜¯çœŸçš„, ä½†å¯ä»¥é€‚ç”¨äºè¿™ç§æƒ…å†µ. ç„¶å, æ‰§è¡Œ<code>count_factors(n)</code>è‡³å¤šéœ€è¦$p \cdot(5 + 4 \sqrt{n})$æ­¥, å› ä¸ºè¿™é‡Œæœ‰5è¡Œåœ¨<code>while</code>å£°æ˜ä¹‹å¤–, ä»¥åŠ4è¡Œ(åŒ…æ‹¬å¤´éƒ¨)åœ¨<code>while</code>ä¹‹å†…. è¿™ä¸ªä¸Šé™èƒ½å¤Ÿä¿è¯å³ä½¿<code>if</code>å¤´éƒ¨æ‰§è¡Œä¸ºçœŸçš„æƒ…å†µä¹Ÿé€‚ç”¨. æœ€å, å¦‚æœæˆ‘ä»¬é€‰æ‹©$k_2=5p$, é‚£ä¹ˆéœ€è¦çš„æ­¥éª¤æ€»æ˜¯å°äº$k_2 \cdot \sqrt{n}$. æˆ‘ä»¬çš„è®ºç‚¹æ˜¯å®Œæ•´çš„.</p>
<h4 id="284-ä¾‹å­-æŒ‡æ•°">2.8.4 ä¾‹å­: æŒ‡æ•°</h4>
<p>æ€è€ƒä¸€ä¸‹è®¡ç®—ä¸€ä¸ªç»™å®šæ•°å­—çš„æŒ‡æ•°çš„é—®é¢˜. æˆ‘ä»¬ä¼šæƒ³è¦ä¸€ä¸ªå‡½æ•°æ¥æ¥å—ä¸€ä¸ªåŸºç¡€å€¼bä»¥åŠä¸€ä¸ªæ­£æ•´æ•°çš„æŒ‡æ•°nç„¶åè®¡ç®—$b^n$. ä¸€ä¸ªè§£å†³æ–¹å¼æ˜¯é€šè¿‡ä¸€ä¸ªé€’å½’å®šä¹‰æ¥å®ç°.</p>
<p>$$<br />
\begin{align*}<br />
b^n &amp;= b \cdot b^{n-1} \<br />
b^0 &amp;= 1<br />
\end{align*}<br />
$$</p>
<p>è¿™å¾ˆå®¹æ˜“è½¬æ¢æˆä¸ºé€’å½’å‡½æ•°</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">exp</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">b</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿™æ˜¯ä¸€ä¸ªçº¿æ€§é€’å½’è¿‡ç¨‹, éœ€è¦$\Theta(n)$éƒ¨ä»¥åŠ$\Theta(n)$çš„ç©ºé—´. æ­£å¦‚é˜¶ä¹˜ä¸€æ ·, æˆ‘ä»¬å¯ä»¥å®¹æ˜“åœ°åˆ¶å®šä¸€ä¸ªç›¸ç­‰çš„çº¿æ€§è¿­ä»£å‡½æ•°, å®ƒéœ€è¦ç›¸ä¼¼æ•°é‡çš„æ­¥æ•°, ä½†åªéœ€è¦å›ºå®šçš„ç©ºé—´.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">exp_iter</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">*</span> <span class="n">b</span>
        <span class="k">return</span> <span class="n">result</span>
</code></pre></td></tr></table>
</div>
</div><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿ç»­å¹³æ–¹ä»¥æ›´å°‘çš„æ­¥æ•°æ¥è®¡ç®—æŒ‡æ•°. ä¾‹å¦‚, ä¸æ˜¯è¿™æ ·è®¡ç®—$b^8$:</p>
<p>$$<br />
\begin{equation*}<br />
b \cdot (b \cdot (b \cdot (b \cdot (b \cdot (b \cdot (b \cdot b))))))<br />
\end{equation*}<br />
$$</p>
<p>æˆ‘ä»¬å¯ä»¥ç”¨ä¸‰ä¸ªä¹˜æ³•æ¥è®¡ç®—å®ƒ:</p>
<p>$$<br />
\begin{align*}<br />
b^2 &amp;= b \cdot b \<br />
b^4 &amp;= b^2 \cdot b^2 \<br />
b^8 &amp;= b^4 \cdot b^4<br />
\end{align*}<br />
$$</p>
<p>è¿™ä¸ªæ–¹æ³•åœ¨æŒ‡æ•°æ˜¯2çš„å€æ•°çš„æ—¶å€™å¯ä»¥å¾ˆå¥½åœ°å·¥ä½œ. ä¸€èˆ¬æ¥è¯´, å¦‚æœæˆ‘ä»¬ä½¿ç”¨é€’å½’è§„åˆ™, æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨è®¡ç®—æŒ‡æ•°ä¸Šåˆ©ç”¨è¿ç»­å¹³æ–¹.</p>
<p>$$<br />
\begin{equation*}<br />
b^n = \begin{cases} (b^{\frac{1}{2} n})^2 &amp; \text{if $n$ is even} \<br />
b \cdot b^{n-1}     &amp; \text{if $n$ is odd}<br />
\end{cases}<br />
\end{equation*}<br />
$$</p>
<p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ä»¥ä¸€ä¸ªé€’å½’å‡½æ•°æ¥è¡¨ç¤ºè¿™ä¸ªæ–¹æ³•:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">square</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">fast_exp</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">square</span><span class="p">(</span><span class="n">fast_exp</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">2</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">b</span> <span class="o">*</span> <span class="n">fast_exp</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">fast_exp</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="mi">1267650600228229401496703205376</span>
</code></pre></td></tr></table>
</div>
</div><p>æ¼”åŒ–ä¸º<code>fast_exp</code>çš„è¿‡ç¨‹å…¶ç©ºé—´ä»¥åŠæ­¥æ•°éƒ½ä»¥nçš„å¯¹æ•°çš„è§„æ¨¡æ¥å¢é•¿. ä¸ºäº†çœ‹åˆ°è¿™ä¸€ç‚¹, è§‚å¯Ÿç”¨<code>fast_exp</code>è®¡ç®—$b^{2n}$åªéœ€è¦æ¯”$b^n$å¤šè®¡ç®—ä¸€ä¸ªä¹˜æ³•. å› æ­¤, æˆ‘ä»¬å¯ä»¥è®¡ç®—çš„æŒ‡æ•°çš„å¤§å°è¢«å…è®¸æ˜¯æ¯ä¸ªæ–°çš„ä¹˜æ³•çš„ç¿»å€(å¤§çº¦). ç”±æ­¤, ä¹˜æ³•çš„æ¬¡æ•°éœ€è¦ä¸€ä¸ªæŒ‡æ•°n, è¿™ä¹˜æ³•çš„æ¬¡æ•°çš„å¢é•¿è·Ÿä»¥2ä¸ºåº•æ•°çš„nçš„å¯¹æ•°å¢é•¿å¾—ä¸€æ ·å¿«. è¿™è¿‡ç¨‹å¢é•¿ä¸º$\Theta(\log n)$. $\Theta(\log n)$å¢é•¿ä¸$\Theta(n)$å¢é•¿çš„ä¸åŒéšç€nçš„å¢å¤§è€Œå˜å¾—æ˜æ˜¾. ä¾‹å¦‚, <code>fast_exp</code>å¯¹äºnä¸º1000çš„æƒ…å†µåªéœ€è¦14æ¬¡ä¹˜æ³•è€Œä¸æ˜¯1000æ¬¡.</p>
<h4 id="285-å¢é•¿ç±»åˆ«">2.8.5 å¢é•¿ç±»åˆ«</h4>
<p>å¢é•¿é¡ºåºçš„è®¾è®¡æ—¨åœ¨è®¡ç®—ç®€åŒ–è®¡ç®—è¿‡ç¨‹çš„åˆ†æä»¥åŠæ¯”è¾ƒ. å¾ˆå¤šä¸åŒçš„è®¡ç®—è¿‡ç¨‹éƒ½å¯ä»¥å…·æœ‰ç›¸åŒçš„å¢é•¿é¡ºåº, è¿™è¡¨ç¤ºå®ƒä»¬è§„æ¨¡å¢é•¿çš„æ–¹å¼æ˜¯ç›¸ä¼¼çš„. è®¡ç®—æœºç§‘å­¦å®¶å¿…é¡»çŸ¥é“å¹¶è¯†åˆ«å¸¸è§çš„å¢é•¿é¡ºåºä»¥åŠé‰´åˆ«å…·æœ‰ç›¸åŒé¡ºåºçš„è¿‡ç¨‹.</p>
<p><strong>å¸¸é‡</strong>. å¸¸é‡å¹¶ä¸ä¼šå½±å“è¿‡ç¨‹çš„å¢é•¿é¡ºåº. å› æ­¤, ä¾‹å¦‚, $\Theta(n)$ä»¥åŠ$\Theta(500 \cdot n)$å…·æœ‰ç›¸åŒçš„å¢é•¿é¡ºåº. è¿™ä¸ªå±æ€§éµå¾ª<code>theta</code>ç¬¦å·çš„å®šä¹‰, ä¹Ÿå°±æ˜¯å…è®¸æˆ‘ä»¬å»ä¸ºä¸Šä¸‹é™é€‰æ‹©ä»»æ„å¸¸é‡$k_1$ä»¥åŠ$k_2$(ä¾‹å¦‚$\frac{1}{500}$). ä¸ºäº†ç®€å•èµ·è§, å¸¸é‡åœ¨å¢é•¿åºåˆ—ä¸­æ€»æ˜¯è¢«çœå»çš„.</p>
<p><strong>å¯¹æ•°</strong>. å¯¹æ•°çš„åŸºæ•°å¹¶ä¸ä¼šå½±å“å¢é•¿é¡ºåºçš„è¿‡ç¨‹, ä¾‹å¦‚, $\log_2 n$ä»¥åŠ$\log_{10} nå…·æœ‰ç›¸åŒçš„å¢é•¿é¡ºåº. ä¿®æ”¹å¯¹æ•°çš„åŸºæ•°ç­‰äºä¹˜ä»¥å¸¸æ•°å› å­.</p>
<p><strong>åµŒå¥—</strong>. å½“ä¸€ä¸ªå†…éƒ¨è®¡ç®—è¿‡ç¨‹åœ¨å¤–éƒ¨è®¡ç®—è¿‡ç¨‹çš„æ¯ä¸€æ­¥ä¸­éƒ½é‡å¤(æ‰§è¡Œ), é‚£ä¹ˆæ•´ä¸ªè¿‡ç¨‹çš„å¢é•¿çš„é¡ºåºå°±æ˜¯å†…éƒ¨å’Œå¤–éƒ¨è¿‡ç¨‹çš„ä¸­çš„æ­¥éª¤æ•°çš„ä¹˜ç§¯.</p>
<p>ä¾‹å¦‚, ä¸‹é¢çš„å‡½æ•°<code>overlap</code>è®¡ç®—å…±åŒå­˜åœ¨äºåˆ—è¡¨aä»¥åŠåˆ—è¡¨bä¸­çš„å…ƒç´ çš„ä¸ªæ•°.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">overlap</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">a</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">b</span><span class="p">:</span>
                <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="n">count</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">overlap</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="mi">3</span>
</code></pre></td></tr></table>
</div>
</div><p><code>in</code>æ“ä½œç¬¦å¯¹äºåˆ—è¡¨è€Œè¨€éœ€è¦$\Theta(n)$çš„è¿è¡Œæ—¶é—´, è¿™é‡Œçš„næ˜¯åˆ—è¡¨bçš„é•¿åº¦. å®ƒå‡ºç°äº†$\Theta(m)$æ¬¡, è¿™é‡Œçš„mæŒ‡çš„æ˜¯åˆ—è¡¨açš„é•¿åº¦. è¡¨è¾¾å¼<code>item in b</code>æ˜¯ä¸€ä¸ªå†…éƒ¨çš„è¿‡ç¨‹, è€Œè¡¨è¾¾å¼<code>for item in a</code>å¾ªç¯æ˜¯å¤–éƒ¨è¿‡ç¨‹. è¿™ä¸ªå‡½æ•°çš„æ€»çš„å¢é•¿é¡ºåºæ˜¯$\Theta(m \cdot n)$.</p>
<p><strong>ä½é˜¶é¡¹</strong>. éšç€å¯¹è¿‡ç¨‹è¾“å…¥çš„å¢é•¿, è®¡ç®—ä¸­å¢é•¿æœ€å¿«çš„éƒ¨åˆ†ä¸»å®°ç€æ€»çš„èµ„æºçš„æ¶ˆè€—. <code>Theta</code>ç¬¦å·èƒ½æ•æ‰è¿™ç§ç›´è§‰. æ€»çš„æ¥è¯´, é™¤äº†å¢é•¿æœ€å¿«çš„éƒ¨åˆ†, å…¶ä»–éƒ¨åˆ†éƒ½å¯ä»¥æŠ›å¼ƒæ‰è€Œä¸ä¼šå¯¹å¢é•¿çš„é¡ºåºæœ‰ä»€ä¹ˆå½±å“.</p>
<p>ä¾‹å¦‚, è€ƒè™‘ä¸€ä¸‹<code>one_more</code>å‡½æ•°, å®ƒä¼šè¿”å›åˆ—è¡¨aä¸­æœ‰å¤šå°‘ä¸ªå…ƒç´ æ˜¯æ¯”aä¸­çš„å…¶ä¸­ä¸€ä¸ªå…ƒç´ å¤šä¸€çš„æƒ…å†µ. ä¹Ÿå°±æ˜¯è¯´, åˆ—è¡¨<code>[3, 14, 15, 9]</code>, å…ƒç´ 15æ¯”14å¤šä¸€, å› æ­¤<code>one_more</code>ä¼šè¿”å›1.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">one_more</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">overlap</span><span class="p">([</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">a</span><span class="p">],</span> <span class="n">a</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">one_more</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
<span class="mi">1</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿™ä¸ªè®¡ç®—æœ‰ä¸¤ä¸ªéƒ¨åˆ†: åˆ—è¡¨è§£æä»¥åŠè°ƒç”¨<code>overlap</code>. å¯¹äºé•¿åº¦ä¸ºnçš„åˆ—è¡¨a, åˆ—è¡¨è§£æå¼éœ€è¦$\Theta(n)$ä¸ªæ­¥éª¤, è€Œè°ƒç”¨<code>overlap</code>éœ€è¦$\Theta(n^2)$ä¸ªæ­¥éª¤. æ€»çš„æ­¥æ•°æ˜¯$\Theta(n + n^2)$, ä½†è¿™ä¸æ˜¯è¡¨è¾¾å¢é•¿é¡ºåºçš„æœ€ç®€å•çš„æ–¹æ³•.</p>
<p>$\Theta(n^2 + k \cdot n)$ä»¥åŠ$\Theta(n^2)$å¯¹äºä»»æ„çš„å¸¸é‡kéƒ½æ˜¯ç›¸ç­‰çš„, å› ä¸º$n^2$é¡¹å¯¹ä»»ä½•kæœ€ç»ˆéƒ½ä¼šæ”¯é…æ€»é‡. äº‹å®ä¸Šå»ºç«‹è¿™ç§ç­‰ä»·æ€§è¾¹ç•Œå¿…é¡»è¦ä¿æŒnå¤§äºæŸä¸ªæœ€å°å€¼m. ä¸ºäº†ç®€å•èµ·è§, ä½é˜¶é¡¹æ€»æ˜¯åœ¨å¢é•¿é¡ºåºä¸­èˆå», å› æ­¤æˆ‘ä»¬æ°¸è¿œä¸ä¼šåœ¨ä¸€ä¸ªthetaè¡¨è¾¾å¼ä¸­çœ‹åˆ°æ€»å’Œ.</p>
<p><strong>å¸¸è§ç±»åˆ«</strong>. ç»™å®šè¿™ç§ç­‰ä»·æ€§, å‡ºç°äº†ä¸€å°ç»„å¸¸è§ç±»åˆ«çš„é›†åˆç”¨äºæè¿°å¤§å¤šæ•°å¸¸è§çš„è®¡ç®—è¿‡ç¨‹. æœ€å¸¸è§çš„å·²ç»æŒ‰ç…§æœ€æ…¢çš„å¢é•¿åˆ°æœ€å¿«çš„å¢é•¿é¡ºåºåˆ—ä¸¾åœ¨ä¸‹é¢, ä»¥åŠéšç€è¾“å…¥çš„å¢é•¿è€Œå¢é•¿çš„æè¿°. ä¸‹é¢æ˜¯æ¯ä¸ªç±»åˆ«çš„ä¾‹å­.</p>
<table>
<thead>
<tr>
<th>Category</th>
<th>Theta Notation</th>
<th>Growth Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td>Constant</td>
<td>$\Theta(1)$</td>
<td>Growth is independent of the input</td>
<td>abs</td>
</tr>
<tr>
<td>Logarithmic</td>
<td>$\Theta(\log{n})$</td>
<td>Multiplying input increments resources</td>
<td>fast_exp</td>
</tr>
<tr>
<td>Linear</td>
<td>$\Theta(n)$</td>
<td>Incrementing input increments resources</td>
<td>exp</td>
</tr>
<tr>
<td>Quadratic</td>
<td>$\Theta(n^2)$</td>
<td>Incrementing input adds n resources</td>
<td>one_more</td>
</tr>
<tr>
<td>Exponential</td>
<td>$\Theta(b^n)$</td>
<td>Incrementing input multiplies resources</td>
<td>fib</td>
</tr>
</tbody>
</table>
<p>ä¹Ÿå­˜åœ¨å…¶ä»–çš„ç±»åˆ«, ä¾‹å¦‚<code>count_factors</code>çš„å¢é•¿$\Theta(\sqrt{n})$. è¿™äº›ç±»åˆ«ä¹Ÿæ˜¯ç‰¹åˆ«å¸¸è§çš„.</p>
<p>æŒ‡æ•°å¢é•¿æè¿°äº†è®¸å¤šä¸åŒçš„å¢é•¿é¡ºåº, å› ä¸ºä¿®æ”¹åŸºæ•°bä¼šå½±å“å¢é•¿çš„é¡ºåº. ä¾‹å¦‚, æˆ‘ä»¬çš„æ ‘é€’å½’æ–æ³¢é‚£å¥‘è®¡ç®—å‡½æ•°<code>fib</code>çš„æ­¥æ•°éšç€å®ƒçš„è¾“å…¥nä»¥æŒ‡æ•°çº§å¢é•¿. ç‰¹åˆ«åœ°, å¯ä»¥è¯æ˜ç¬¬nä¸ªæ–æ³¢é‚£å¥‘æ•°æ˜¯æœ€æ¥è¿‘ä¸‹é¢ç­‰å¼çš„æ•´æ•°:</p>
<p>$$<br />
\begin{equation*}<br />
\frac{\phi^{n-2}}{\sqrt{5}}<br />
\end{equation*}<br />
$$</p>
<p>è¿™é‡Œçš„$\phi$æ˜¯é»„é‡‘åˆ†å‰²æ¯”ç‡:</p>
<p>$$<br />
\begin{equation*}<br />
\phi = \frac{1 + \sqrt{5}}{2} \approx 1.6180<br />
\end{equation*}<br />
$$</p>
<p>æˆ‘ä»¬è¿˜æŒ‡å‡ºæ‰€éœ€çš„æ­¥éª¤æ•°ä¸ç»“æœæˆæ¯”ä¾‹, å› æ­¤æ ‘é€’å½’è¿‡ç¨‹éœ€è¦$\Theta(\phi^n)$ä¸ªæ­¥éª¤, è¿™æ˜¯éšç€næŒ‡å¢é•¿çš„å‡½æ•°.</p>
<h3 id="29-é€’å½’å¯¹è±¡">2.9 é€’å½’å¯¹è±¡</h3>
<p>å¯¹è±¡å¯ä»¥å…·æœ‰å…¶ä»–å¯¹è±¡æ¥ä½œä¸ºå±æ€§å€¼, å½“æŸä¸ªç±»çš„å¯¹è±¡å…·æœ‰ä¸€ä¸ªå±æ€§å€¼, è¿™ä¸ªå±æ€§å€¼ä¹Ÿå±äºç›¸åŒçš„ç±», é‚£ä¹ˆè¿™å°±æ˜¯ä¸€ä¸ªé€’å½’å¯¹è±¡.</p>
<h4 id="291-é“¾æ¥åˆ—è¡¨ç±»">2.9.1 é“¾æ¥åˆ—è¡¨ç±»</h4>
<p>é“¾æ¥åˆ—è¡¨, åœ¨ä¹‹å‰çš„ç« èŠ‚é‡Œé¢ä»‹ç»è¿‡, ç”±ä¸€ä¸ªå…ƒç´ ä»¥åŠåˆ—è¡¨å…¶ä½™çš„éƒ¨åˆ†ç»„æˆ. åˆ—è¡¨çš„å…¶ä½™éƒ¨åˆ†æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªé“¾æ¥åˆ—è¡¨ &ndash; ä¸€ä¸ªé€’å½’å®šä¹‰. ç©ºåˆ—è¡¨æ˜¯é“¾è¡¨ä¸­çš„ä¸€ä¸ªç‰¹æ®Šçš„æƒ…å†µ, å®ƒæ²¡æœ‰ç¬¬ä¸€ä¸ªå…ƒç´ ä»¥åŠå…¶ä»–å…ƒç´ . ä¸€ä¸ªé“¾è¡¨æ˜¯ä¸€ä¸ªåºåˆ—: å®ƒå…·æœ‰æœ‰é™çš„é•¿åº¦ä»¥åŠæ”¯æŒé€šè¿‡ç´¢å¼•æ¥é€‰æ‹©å…ƒç´ .</p>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥å®ç°ä¸€ä¸ªå…·æœ‰ç›¸åŒè¡Œä¸ºçš„ç±». åœ¨è¿™ä¸ªç‰ˆæœ¬ä¸­, æˆ‘ä»¬ä¼šä½¿ç”¨ç‰¹æ®Šæ–¹æ³•åæ¥å®šä¹‰å®ƒçš„è¡Œä¸ºä»è€Œå…è®¸æˆ‘ä»¬çš„ç±»èƒ½è·Ÿå…§å»ºçš„<code>len</code>å‡½æ•°ä»¥åŠåœ¨Pythonä¸­çš„å…ƒç´ é€‰æ‹©æ“ä½œç¬¦(æ–¹æ‹¬å·æˆ–è€…<code>operator.getitem</code>)å·¥ä½œ. è¿™äº›å…§å»ºå‡½æ•°è°ƒç”¨ç±»ä¸­çš„ç‰¹æ®Šæ–¹æ³•å: é•¿åº¦æ˜¯é€šè¿‡<code>__len__</code>æ¥è®¡ç®—çš„, åŒæ—¶, å…ƒç´ é€‰æ‹©æ˜¯é€šè¿‡<code>__getitem__</code>æ¥è®¡ç®—çš„. ç©ºé“¾è¡¨æ˜¯é€šè¿‡ä¸€ä¸ªç©ºçš„å…ƒç»„æ¥è¡¨ç¤º, ä¹Ÿå°±æ˜¯å…·æœ‰çš„é•¿åº¦æ˜¯0åŒæ—¶æ²¡æœ‰å…ƒç´ .</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">Link</span><span class="p">:</span>
        <span class="s2">&#34;&#34;&#34;A linked list with a first element and the rest.&#34;&#34;&#34;</span>
        <span class="n">empty</span> <span class="o">=</span> <span class="p">()</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">first</span><span class="p">,</span> <span class="n">rest</span><span class="o">=</span><span class="n">empty</span><span class="p">):</span>
            <span class="k">assert</span> <span class="n">rest</span> <span class="ow">is</span> <span class="n">Link</span><span class="o">.</span><span class="n">empty</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rest</span><span class="p">,</span> <span class="n">Link</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">first</span> <span class="o">=</span> <span class="n">first</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rest</span> <span class="o">=</span> <span class="n">rest</span>
        <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">first</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rest</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rest</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">s</span> <span class="o">=</span> <span class="n">Link</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">Link</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">Link</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="mi">3</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="mi">4</span>
</code></pre></td></tr></table>
</div>
</div><p><code>__len__</code>ä»¥åŠ<code>__getitem__</code>çš„å®šä¹‰äº‹å®ä¸Šæ˜¯é€’å½’çš„. å½“ä»¥ç”¨æˆ·å®šä¹‰çš„å¯¹è±¡ä½œä¸ºå‚æ•°åº”ç”¨åˆ°å…§å»ºçš„Pythonå‡½æ•°<code>len</code>ä¸Šæ—¶ä¼šè°ƒç”¨ä¸€ä¸ªå«åš<code>__len__</code>çš„æ–¹æ³•. åŒæ ·çš„è¿˜æœ‰å…ƒç´ é€‰æ‹©æ“ä½œç¬¦ä¼šè°ƒç”¨å«åš<code>__getitem__</code>çš„æ–¹æ³•. å› æ­¤, è¿™ä¸¤ç§æ–¹æ³•çš„ä¸»ä½“å†…ä¼šé—´æ¥åœ°è°ƒç”¨å®ƒä»¬è‡ªå·±. å¯¹äº<code>__len__</code>, å½“<code>self.rest</code>ç­‰äºä¸€ä¸ªç©ºçš„å…ƒç»„æ—¶å°±åˆ°è¾¾åŸºæœ¬æƒ…å†µäº†, ä¹Ÿå°±æ˜¯<code>Link.empty</code>å…·æœ‰çš„é•¿åº¦ä¸º0.</p>
<p>å…§å»ºçš„<code>isinstance</code>å‡½æ•°è¿”å›ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¦æ˜¯ç¬¬äºŒä¸ªå‚æ•°çš„ç±»å‹æˆ–è€…ç»§æ‰¿è‡ªç¬¬äºŒä¸ªå‚æ•°çš„åˆ¤æ–­ç»“æœ. å¦‚æœ<code>rest</code>æ˜¯ä¸€ä¸ª<code>Link</code>çš„å®ä¾‹æˆ–è€…æ˜¯ä¸€ä¸ª<code>Link</code>å­ç±»çš„å®ä¾‹, é‚£ä¹ˆ<code>isinstance(rest, Link)</code>çš„ç»“æœå°±æ˜¯çœŸå€¼.</p>
<p>æˆ‘ä»¬çš„å®ç°å·²ç»å®Œæˆäº†, ä½†æ˜¯ç›®å‰å´å¾ˆéš¾æ£€æŸ¥ä¸€ä¸ªå®ä¾‹æ˜¯ä¸æ˜¯<code>Link</code>ç±». ä¸ºäº†æœ‰åŠ©äºè°ƒè¯•, æˆ‘ä»¬ä¹Ÿå¯ä»¥å®šä¹‰ä¸€ä¸ªå‡½æ•°æ¥å°†<code>Link</code>è½¬æ¢æˆä¸€ä¸ªå­—ç¬¦ä¸²è¡¨è¾¾å¼.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">link_expression</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;Return a string that would evaluate to s.&#34;&#34;&#34;</span>
        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">rest</span> <span class="ow">is</span> <span class="n">Link</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="n">rest</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rest</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="n">link_expression</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">rest</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;Link({0}{1})&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">rest</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">link_expression</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="s1">&#39;Link(3, Link(4, Link(5)))&#39;</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿™ç§å±•ç°<code>Link</code>åˆ—è¡¨çš„æ–¹å¼æ˜¯å¦‚æ­¤çš„æ–¹ä¾¿ä»¥è‡³äºæˆ‘ä»¬æƒ³è¦åœ¨ä»»ä½•æ—¶å€™éƒ½ä½¿ç”¨å®ƒæ¥å±•ç°<code>Link</code>çš„å®ä¾‹. æˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾å®š<code>link_expression</code>å‡½æ•°ä½œä¸ºç‰¹æ®Šçš„ç±»å±æ€§<code>__repr__</code>çš„çš„å€¼æ¥ç¡®ä¿è¿™ä¸ªè¡Œä¸º. Pythoné€šè¿‡è°ƒç”¨å®ä¾‹çš„<code>__repr__</code>æ–¹æ³•æ¥å±•ç°ç”¨æˆ·å®šä¹‰ç±»çš„å®ä¾‹.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">Link</span><span class="o">.</span><span class="fm">__repr__</span> <span class="o">=</span> <span class="n">link_expression</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s</span>
<span class="n">Link</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">Link</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">Link</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
</code></pre></td></tr></table>
</div>
</div><p><code>Link</code>ç±»å…·æœ‰é—­åˆå±æ€§. å°±åƒä¸€ä¸ªåˆ—è¡¨ä¸­çš„å…ƒç´ æœ¬èº«å¯ä»¥æ˜¯ä¸€ä¸ªåˆ—è¡¨, ä¸€ä¸ª<code>Link</code>å¯ä»¥åŒ…å«ä¸€ä¸ª<code>Link</code>ä½œä¸ºå®ƒçš„ç¬¬ä¸€ä¸ªå…ƒç´ .</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">s_first</span> <span class="o">=</span> <span class="n">Link</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">Link</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s_first</span>
<span class="n">Link</span><span class="p">(</span><span class="n">Link</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">Link</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">Link</span><span class="p">(</span><span class="mi">5</span><span class="p">))),</span> <span class="n">Link</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
</code></pre></td></tr></table>
</div>
</div><p><code>s_first</code>é“¾æ¥åˆ—è¡¨å®¤å‹ä¸¤ä¸ªå…ƒç´ , è€Œå®ƒçš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªåŒ…å«ä¸‰ä¸ªå…ƒç´ çš„é“¾æ¥åˆ—è¡¨.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">s_first</span><span class="p">)</span>
<span class="mi">2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">s_first</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="mi">3</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s_first</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
<span class="mi">5</span>
</code></pre></td></tr></table>
</div>
</div><p>é€’å½’å‡½æ•°å°¤å…¶é€‚åˆç”¨æ¥æ“ä½œé“¾è¡¨. ä¾‹å¦‚, é€’å½’å‡½æ•°<code>extend_link</code>å‡½æ•°æ„å»ºäº†ä¸€ä¸ªåŒ…å«ä¸€ä¸ª<code>Link</code>ç±»çš„å®ä¾‹sç´§è·Ÿç€å¦ä¸€ä¸ª<code>Link</code>ç±»çš„å®ä¾‹tçš„å…ƒç´ çš„é“¾è¡¨. å°†è¿™ä¸ªå‡½æ•°ä½œä¸º<code>__add__</code>æ–¹æ³•å®‰è£…åˆ°<code>Link</code>ç±»æ¥æ¨¡æ‹Ÿå†…éƒ¨åˆ—è¡¨çš„æ·»åŠ è¡Œä¸º.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">extend_link</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">s</span> <span class="ow">is</span> <span class="n">Link</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">t</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Link</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">extend_link</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">rest</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">extend_link</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="n">Link</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">Link</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">Link</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">Link</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">Link</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">Link</span><span class="p">(</span><span class="mi">5</span><span class="p">))))))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Link</span><span class="o">.</span><span class="fm">__add__</span> <span class="o">=</span> <span class="n">extend_link</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s</span> <span class="o">+</span> <span class="n">s</span>
<span class="n">Link</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">Link</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">Link</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">Link</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">Link</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">Link</span><span class="p">(</span><span class="mi">5</span><span class="p">))))))</span>
</code></pre></td></tr></table>
</div>
</div><p>é™¤äº†åˆ—è¡¨è¡¨è¾¾å¼, å¯ä»¥ä½¿ç”¨ä¸¤ä¸ªé«˜é˜¶å‡½æ•°æ¥ä»ä¸€ä¸ªé“¾è¡¨ç”Ÿæˆå¦ä¸€ä¸ªé“¾è¡¨: <code>map_link</code>ä»¥åŠ<code>filter_link</code>å‡½æ•°. ä¸‹é¢å®šä¹‰çš„<code>map_link</code>å‡½æ•°åº”ç”¨ä¸€ä¸ªå‡½æ•°<code>f</code>åˆ°é“¾è¡¨sçš„æ¯ä¸ªå…ƒç´ ä¸ŠåŒæ—¶æ„é€ ä¸€ä¸ªé“¾è¡¨æ¥åŒ…å«ç»“æœ.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">map_link</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">s</span> <span class="ow">is</span> <span class="n">Link</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">s</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Link</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">first</span><span class="p">),</span> <span class="n">map_link</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">rest</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">map_link</span><span class="p">(</span><span class="n">square</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="n">Link</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">Link</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">Link</span><span class="p">(</span><span class="mi">25</span><span class="p">)))</span>
</code></pre></td></tr></table>
</div>
</div><p><code>filter_link</code>å‡½æ•°è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰é“¾è¡¨sä¸­ç»få‡½æ•°å¤„ç†å¹¶è¿”å›çœŸå€¼çš„å…ƒç´ çš„é“¾è¡¨. <code>map_link</code>ä»¥åŠ<code>filter_link</code>çš„ç»„åˆå¯ä»¥è¡¨è¾¾ä¸åˆ—è¡¨è¡¨è¾¾å¼ç›¸åŒçš„é€»è¾‘.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">filter_link</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">s</span> <span class="ow">is</span> <span class="n">Link</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">s</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">filtered</span> <span class="o">=</span> <span class="n">filter_link</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">rest</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">f</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">first</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">Link</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">filtered</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">filtered</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">odd</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">map_link</span><span class="p">(</span><span class="n">square</span><span class="p">,</span> <span class="n">filter_link</span><span class="p">(</span><span class="n">odd</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
<span class="n">Link</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">Link</span><span class="p">(</span><span class="mi">25</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">square</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="k">if</span> <span class="n">odd</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
<span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">25</span><span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><p><code>join_link</code>å‡½æ•°é€’å½’æ„é€ ä¸€ä¸ªå­—ç¬¦ä¸², å®ƒåŒ…å«é“¾è¡¨å…ƒç´ å¹¶ä»¥æŸäº›<code>separator</code>å­—ç¬¦ä¸²æ¥åˆ†éš”å¼€. ç»“æœæ¯”<code>link_expression</code>çš„è¾“å‡ºæ›´åŠ ç´§å‡‘.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">join_link</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">separator</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">s</span> <span class="ow">is</span> <span class="n">Link</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&#34;&#34;</span>
        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">rest</span> <span class="ow">is</span> <span class="n">Link</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">first</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">first</span><span class="p">)</span> <span class="o">+</span> <span class="n">separator</span> <span class="o">+</span> <span class="n">join_link</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">rest</span><span class="p">,</span> <span class="n">separator</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">join_link</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s2">&#34;, &#34;</span><span class="p">)</span>
<span class="s1">&#39;3, 4, 5&#39;</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>é€’å½’æ„é€ </strong>. å½“éœ€è¦é€’å¢åœ°æ„é€ åºåˆ—çš„æ—¶å€™é“¾è¡¨å°¤å…¶æœ‰ç”¨. è¿™åœ¨é€’å½’è®¡ç®—ä¸­ç»å¸¸ä¼šå‡ºç°è¿™ç§æƒ…å†µ.</p>
<p>ç¬¬ä¸€ç« çš„<code>count_partitions</code>å‡½æ•°é€šè¿‡æ ‘é€’å½’è¿‡ç¨‹ç»Ÿè®¡ç”¨æœ€å¤§é€’å¢åˆ°mçš„æ•´æ•°æ¥åˆ’åˆ†æ•´æ•°nçš„æ–¹æ³•çš„æ€»æ•°. ä½¿ç”¨åºåˆ—, æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨ç±»ä¼¼çš„è¿‡ç¨‹æ¥æ˜¾å¼åœ°æšä¸¾è¿™äº›åŒºé—´.</p>
<p>æˆ‘ä»¬æŒ‰ç…§ä¸è®¡æ•°æ—¶ç›¸åŒçš„é€»è¾‘æ¥é€’å½’åˆ†æè¿™äº›é—®é¢˜: ä½¿ç”¨æœ€å¤§é€’å¢ä¸ºmçš„æ•´æ•°åˆ’åˆ†æ•´æ•°næ¶‰åŠä¸‹é¢ä¸¤è€…ä¹‹ä¸€:</p>
<ol>
<li>åŒºé—´<code>n-m</code>ä½¿ç”¨æœ€å¤§é€’å¢åˆ°mçš„æ•´æ•°, æˆ–è€…</li>
<li>åŒºé—´<code>n</code>ä½¿ç”¨æœ€å¤§é€’å¢åˆ°m-1çš„æ•´æ•°</li>
</ol>
<p>å¯¹äºæœ€åŸºæœ¬çš„æƒ…å†µ, æˆ‘ä»¬å‘ç°0å…·æœ‰ç©ºçš„åˆ’åˆ†, å½“åˆ’åˆ†ä¸€ä¸ªè´Ÿæ•´æ•°æˆ–è€…ä½¿ç”¨å°äº1çš„éƒ¨åˆ†æ˜¯ä¸å¯èƒ½çš„.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">partitions</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;Return a linked list of partitions of n using parts of up to m.
</span><span class="s2">        Each partition is represented as a linked list.
</span><span class="s2">        &#34;&#34;&#34;</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Link</span><span class="p">(</span><span class="n">Link</span><span class="o">.</span><span class="n">empty</span><span class="p">)</span> <span class="c1"># A list containing the empty partition</span>
        <span class="k">elif</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Link</span><span class="o">.</span><span class="n">empty</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">using_m</span> <span class="o">=</span> <span class="n">partitions</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">m</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
            <span class="n">with_m</span> <span class="o">=</span> <span class="n">map_link</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">Link</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">s</span><span class="p">),</span> <span class="n">using_m</span><span class="p">)</span>
            <span class="n">without_m</span> <span class="o">=</span> <span class="n">partitions</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">with_m</span> <span class="o">+</span> <span class="n">without_m</span>
</code></pre></td></tr></table>
</div>
</div><p>åœ¨é€’å½’çš„æƒ…å†µä¸‹, æˆ‘ä»¬æ„é€ äº†ä¸¤ä¸ªåˆ†åŒºå­åˆ—è¡¨. ç¬¬ä¸€ä¸ªä½¿ç”¨m, åŒæ—¶æˆ‘ä»¬æ·»åŠ måˆ°æ¥è‡ªäº<code>with_m</code>çš„ç»“æœ<code>using_m</code>çš„æ¯ä¸€ä¸ªå…ƒç´ ä¸­.</p>
<p><code>partitions</code>çš„ç»“æœæ˜¯é«˜åº¦åµŒå¥—çš„: é“¾è¡¨çš„é“¾è¡¨. é€šè¿‡ç”¨æ°å½“çš„åˆ†å‰²ç¬¦æ¥ä½¿ç”¨<code>join_link</code>, æˆ‘ä»¬å¯ä»¥ä»¥äººç±»å¯è¯»çš„æ–¹å¼æ¥æ˜¾ç¤ºåˆ†åŒº.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">print_partitions</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
        <span class="n">lists</span> <span class="o">=</span> <span class="n">partitions</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">map_link</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">join_link</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s2">&#34; + &#34;</span><span class="p">),</span> <span class="n">lists</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">join_link</span><span class="p">(</span><span class="n">strings</span><span class="p">,</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">print_partitions</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span>
<span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span>
<span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span>
<span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
<span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span>
<span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span>
<span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span>
<span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span>
<span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="292-æ ‘ç±»">2.9.2 æ ‘ç±»</h4>
<p>æ ‘ä¹Ÿå¯ä»¥ç”¨ç”¨æˆ·å®šä¹‰çš„ç±»æ¥è¡¨ç¤º, è€Œä¸æ˜¯åµŒå¥—å…§å»ºçš„åºåˆ—ç±»å‹çš„å®ä¾‹. ä¸€æ£µæ ‘å¯ä»¥æ˜¯ä»»ä½•çš„æ•°æ®ç±»å‹, å®ƒå…·æœ‰ä¸€ä¸ªåŒæ ·ä¹Ÿæ˜¯æ ‘çš„å±æ€§æ¥ä½œä¸ºçš„åˆ†æ”¯.</p>
<p><strong>å†…éƒ¨å€¼</strong>. ä¹‹å‰, æˆ‘ä»¬ä»¥è¿™æ ·çš„æ–¹å¼æ¥å®šä¹‰æ ‘, é‚£å°±æ˜¯æ‰€æœ‰å€¼éƒ½å‡ºç°åœ¨æ ‘çš„å¶å­èŠ‚ç‚¹ä¸­. è¿™ä¹Ÿæ˜¯é€šå¸¸ç”¨æ¥å®šä¹‰æ¯ä¸ªå­æ ‘çš„æ ¹èŠ‚ç‚¹å…·æœ‰å†…éƒ¨å€¼çš„æ ‘çš„å¸¸è§æ–¹æ³•. ä¸€ä¸ªå†…éƒ¨å€¼åœ¨æ ‘å†…è¢«ç§°ä¸º<code>entry</code>. ä¸‹é¢çš„<code>Tree</code>ç±»å±•ç¤ºäº†è¿™æ ·çš„ä¸€æ£µæ ‘, å…¶ä¸­æ¯æ£µæ ‘å…·æœ‰ä¸€ä¸ªåºåˆ—åˆ†æ”¯, è¿™ä¸ªåˆ†æ”¯åŒæ ·ä¹Ÿæ˜¯æ ‘.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">Tree</span><span class="p">:</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry</span><span class="p">,</span> <span class="n">branches</span><span class="o">=</span><span class="p">()):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">entry</span> <span class="o">=</span> <span class="n">entry</span>
            <span class="k">for</span> <span class="n">branch</span> <span class="ow">in</span> <span class="n">branches</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">branch</span><span class="p">,</span> <span class="n">Tree</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">branches</span> <span class="o">=</span> <span class="n">branches</span>
        <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">branches</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;Tree({0}, {1})&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">branches</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;Tree({0})&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="p">))</span>
        <span class="k">def</span> <span class="nf">is_leaf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">branches</span>
</code></pre></td></tr></table>
</div>
</div><p>æ ‘ç±»å¯ä»¥è¿›è¡Œè¡¨ç¤º, ä¾‹å¦‚, åœ¨è¡¨è¾¾å¼æ ‘ä¸­è¡¨è¾¾<code>fib</code>è¿™ä¸ªè®¡ç®—æ–æ³¢é‚£å¥‘æ•°çš„å‡½æ•°é€’å½’å®ç°çš„è®¡ç®—å€¼, ä¸‹é¢çš„<code>fib_tree(n)</code>å‡½æ•°è¿”å›ä¸€ä¸ª<code>Tree</code>, è¿™ä¸ªå€¼å…·æœ‰ç¬¬nä¸ªæ–æ³¢é‚£å¥‘æ•°ä½œä¸ºå®ƒçš„<code>entry</code>å±æ€§çš„å€¼ä»¥åŠåœ¨å…¶åˆ†æ”¯å†…ä¿æŒä¸€ä¸ªå¯¹å…ˆå‰æ‰€æœ‰è®¡ç®—çš„æ–æ³¢é‚£å¥‘æ•°çš„è·Ÿè¸ª.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">fib_tree</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Tree</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Tree</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">left</span> <span class="o">=</span> <span class="n">fib_tree</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">right</span> <span class="o">=</span> <span class="n">fib_tree</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">Tree</span><span class="p">(</span><span class="n">left</span><span class="o">.</span><span class="n">entry</span> <span class="o">+</span> <span class="n">right</span><span class="o">.</span><span class="n">entry</span><span class="p">,</span> <span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">))</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">fib_tree</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">Tree</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="n">Tree</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">Tree</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Tree</span><span class="p">(</span><span class="mi">1</span><span class="p">))),</span> <span class="n">Tree</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">Tree</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Tree</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">Tree</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Tree</span><span class="p">(</span><span class="mi">1</span><span class="p">)))))))</span>
</code></pre></td></tr></table>
</div>
</div><p>ä»¥è¿™ç§æ–¹å¼è¡¨ç¤ºçš„æ ‘ä¹Ÿæ˜¯ç”¨é€’å½’å‡½æ•°æ¥å¤„ç†çš„. ä¾‹å¦‚, æˆ‘ä»¬å¯ä»¥åˆè®¡æ ‘çš„æ¡ç›®. æœ€åŸºæœ¬çš„æƒ…å†µ, æˆ‘ä»¬ä¼šè¿”å›ä¸€ä¸ªç©ºçš„æ²¡æœ‰æ¡ç›®çš„åˆ†æ”¯.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">sum_entries</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;Sum the entries of a Tree instance, which may be None.&#34;&#34;&#34;</span>
        <span class="k">return</span> <span class="n">t</span><span class="o">.</span><span class="n">entry</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">([</span><span class="n">sum_entries</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">branches</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sum_entries</span><span class="p">(</span><span class="n">fib_tree</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="mi">10</span>
</code></pre></td></tr></table>
</div>
</div><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥åº”ç”¨<code>memo</code>æ¥æ„é€ ä¸€ä¸ªæ–æ³¢é‚£å¥‘æ ‘, è¿™ä¸ªæ ‘ä¸­é‡å¤çš„å­æ ‘åªä¼šé€šè¿‡è®°å¿†åŒ–ç‰ˆæœ¬çš„<code>fib_tree</code>åˆ›å»ºä¸€é, ä½†æ˜¯ä¼šè¢«ä¸åŒçš„æ›´å¤§çš„æ ‘å¤šæ¬¡ä½¿ç”¨.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">fib_tree</span> <span class="o">=</span> <span class="n">memo</span><span class="p">(</span><span class="n">fib_tree</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">big_fib_tree</span> <span class="o">=</span> <span class="n">fib_tree</span><span class="p">(</span><span class="mi">35</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">big_fib_tree</span><span class="o">.</span><span class="n">entry</span>
<span class="mi">5702887</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">big_fib_tree</span><span class="o">.</span><span class="n">branches</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="n">big_fib_tree</span><span class="o">.</span><span class="n">branches</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">branches</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="bp">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sum_entries</span> <span class="o">=</span> <span class="n">memo</span><span class="p">(</span><span class="n">sum_entries</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sum_entries</span><span class="p">(</span><span class="n">big_fib_tree</span><span class="p">)</span>
<span class="mi">142587180</span>
</code></pre></td></tr></table>
</div>
</div><p>åœ¨è¿™äº›æƒ…å†µä¸‹, é€šè¿‡è®°å¿†ä¿å­˜çš„è®¡ç®—æ—¶é—´å’Œå­˜å‚¨å™¨çš„é‡æ˜¯ç›¸å½“å¤§çš„. ä¸æ˜¯åˆ›å»º18,454,929ä¸ª<code>Tree</code>ç±»å‹çš„å®ä¾‹, æˆ‘ä»¬ç°åœ¨åªéœ€è¦åˆ›å»º35ä¸ª.</p>
<h4 id="293-é›†åˆ">2.9.3 é›†åˆ</h4>
<p>é™¤äº†åˆ—è¡¨, å…ƒç»„ä»¥åŠå­—å…¸, Pythonè¿˜æœ‰ç¬¬å››ç§å…§å»ºå®¹å™¨ç±»å‹å«åš<code>set</code>(é›†åˆ). é›†åˆå­—é¢é‡éµå¾ªçš„æ•°å­¦ç¬¦å·æ˜¯ç”¨å¤§æ‹¬å·åŒ…è£¹å…ƒç´ . é‡å¤çš„å…ƒç´ å°†ä¼šåœ¨æ„é€ æ—¶è¢«ç§»é™¤. é›†åˆæ˜¯ä¸€ä¸ªæ— åºé›†, å› æ­¤æ‰“å°å‡ºæ¥çš„é¡ºåºå¯èƒ½ä¸é›†åˆå­—é¢é‡ä¸­è®¾ç½®çš„é¡ºåºä¸åŒ.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">s</span> <span class="o">=</span> <span class="p">{</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s</span>
<span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Pythoné›†åˆæ”¯æŒå„ç§æ“ä½œ, åŒ…æ‹¬æˆå‘˜æµ‹è¯•, é•¿åº¦è®¡ç®—, ä»¥åŠå–äº¤é›†å’Œå¹¶é›†è¿™æ ·çš„æ ‡å‡†é›†åˆæ“ä½œ.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="mi">3</span> <span class="ow">in</span> <span class="n">s</span>
<span class="bp">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="mi">4</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s</span><span class="o">.</span><span class="n">union</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">})</span>
<span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s</span><span class="o">.</span><span class="n">intersection</span><span class="p">({</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">})</span>
<span class="p">{</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>é™¤äº†å¹¶é›†ä»¥åŠäº¤é›†, Pythoné›†åˆè¿˜æ”¯æŒå‡ ä¸ªå…¶ä»–çš„æ–¹æ³•. æ–­è¨€<code>isdisjoint</code>, <code>issubset</code>ä»¥åŠ<code>issuperset</code>æä¾›é›†åˆæ¯”è¾ƒ(èƒ½åŠ›). é›†åˆæ˜¯å¯å˜çš„, å¯ä»¥é€šè¿‡<code>add</code>, <code>remove</code>ä»¥åŠ<code>pop</code>ä¸€æ¬¡ä¿®æ”¹ä¸€ä¸ªå…ƒç´ . å…¶ä½™çš„æ–¹æ³•æä¾›å¤šå…ƒç´ æ”¹åŠ¨, ä¾‹å¦‚<code>clear</code>ä»¥åŠ<code>update</code>. åœ¨è¯¾ç¨‹è®²è¿°çš„è¿™ä¸ªç‚¹ä¸Š, Pythonçš„<a href="http://docs.python.org/py3k/library/stdtypes.html#set">é›†åˆæ–‡æ¡£</a>åº”è¯¥è¶³å¤Ÿç”¨æ¥ç†è§£å¹¶å¡«å……ç»†èŠ‚äº†.</p>
<p><strong>å®ç°é›†åˆ</strong>. æŠ½è±¡åœ°, ä¸€ä¸ªé›†åˆæ˜¯ä¸€ä¸ªä¸åŒå¯¹è±¡çš„é›†, å®ƒæ”¯æŒæˆå‘˜æµ‹è¯•, å¹¶é›†, äº¤é›†, ä»¥åŠé™„åŠ . é™„åŠ ä¸€ä¸ªå…ƒç´ åŒæ—¶é›†åˆä¼šè¿”å›ä¸€ä¸ªæ–°çš„é›†åˆ, è¿™ä¸ªæ–°é›†åˆåŒ…å«æ‰€æœ‰çš„åŸæ¥é›†åˆçš„å…ƒç´ ä»¥åŠæ–°çš„å…ƒç´ , å‰ææ˜¯è¿™äº›æ–°çš„å…ƒç´ ä¸åŒäºåŸæ¥é›†åˆçš„å…ƒç´ çš„è¯. å¹¶é›†å’Œäº¤é›†è¿”å›ä¸€ä¸ªé›†åˆåŒ…å«çš„å…ƒç´ æ˜¯åˆ†åˆ«å‡ºç°åœ¨ä»»ä¸€é›†åˆæˆ–è€…ä¸¤ä¸ªé›†åˆéƒ½å‡ºç°çš„å…ƒç´ . ä¸ä»»ä½•æ•°æ®æŠ½è±¡ä¸€æ ·, æˆ‘ä»¬å¯ä»¥è‡ªç”±åœ°åœ¨ä»»æ„é›†åˆçš„è¡¨ç¤ºä¹‹ä¸Šå®ç°ä»»ä½•å‡½æ•°æ¥æä¾›è¿™ä¸ªé›†åˆçš„è¡Œä¸º.</p>
<p>åœ¨è¿™ä¸€èŠ‚å‰©ä¸‹çš„å†…å®¹å½“ä¸­, æˆ‘ä»¬è€ƒè™‘ä¸‰ç§ä¸åŒçš„æ–¹æ³•æ¥å®ç°ä¸€ä¸ªé›†åˆçš„ä¸åŒçš„è¡¨ç°å½¢å¼. æˆ‘ä»¬ä¼šé€šè¿‡åˆ†æé›†åˆæ“ä½œå¢é•¿çš„é¡ºåºæ¥æè¿°è¿™äº›ä¸åŒè¡¨ç¤ºçš„æ•ˆç‡. æˆ‘ä»¬ä¼šä½¿ç”¨åˆ°æ¥è‡ªäºæœ¬ç« å‰é¢éƒ¨åˆ†çš„<code>Link</code>ä»¥åŠ<code>Tree</code>ç±»å‹, è¿™äº›ç±»å‹å…è®¸å®ç°ç®€å•è€Œä¸”ä¼˜é›…çš„é€’å½’è§£å†³æ–¹æ¡ˆç”¨äºåˆçº§çš„é›†åˆæ“ä½œ.</p>
<p><strong>é›†åˆä½œä¸ºæ— åºåºåˆ—</strong>. ä¸€ç§è¡¨ç¤ºé›†åˆçš„æ–¹å¼æ˜¯ä½œä¸ºä¸€ä¸ªæ²¡æœ‰å…ƒç´ å‡ºç°å¤šäºä¸€æ¬¡çš„åºåˆ—. ç©ºé›†åˆæ˜¯é€šè¿‡ç©ºåºåˆ—è¡¨ç¤º. æˆå‘˜æµ‹è¯•åˆ™æ˜¯ä»¥é€’å½’çš„æ–¹å¼éå†åˆ—è¡¨.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">empty</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">s</span> <span class="ow">is</span> <span class="n">Link</span><span class="o">.</span><span class="n">empty</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">set_contains</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;Return True if and only if set a constains v.&#34;&#34;&#34;</span>
        <span class="k">if</span> <span class="n">empty</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">first</span> <span class="o">==</span> <span class="n">v</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">set_contains</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">rest</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">s</span> <span class="o">=</span> <span class="n">Link</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">Link</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Link</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">set_contains</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="bp">False</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">set_contains</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="bp">True</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿™ä¸ª<code>set_contains</code>çš„å®ç°å¹³å‡éœ€è¦$\Theta(n)$çš„æ—¶é—´æ¥æµ‹è¯•æˆå‘˜æ˜¯å¦åŒ…å«å…ƒç´ , è¿™é‡Œçš„næ˜¯æŒ‡é›†åˆsçš„å¤§å°. å¯¹åŒ…å«çš„æˆå‘˜ä½¿ç”¨è¿™ä¸ªçº¿æ€§æ—¶é—´çš„å‡½æ•°, æˆ‘ä»¬å¯ä»¥è¿æ¥ä¸€ä¸ªå…ƒç´ åˆ°é›†åˆä¸­, è¿™ä¸ªæ“ä½œä¹Ÿæ˜¯çº¿æ€§çš„.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">adjoin_set</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;Return a set containing all elements of s and element v.&#34;&#34;&#34;</span>
        <span class="k">if</span> <span class="n">set_contains</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">s</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Link</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">t</span> <span class="o">=</span> <span class="n">adjoin_set</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">t</span>
<span class="n">Link</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">Link</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">Link</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Link</span><span class="p">(</span><span class="mi">5</span><span class="p">))))</span>
</code></pre></td></tr></table>
</div>
</div><p>åœ¨è®¾è®¡è¡¨ç¤ºæ—¶, ä¸€ä¸ªæˆ‘ä»¬éœ€è¦è€ƒè™‘åˆ°çš„é—®é¢˜æ˜¯æ•ˆç‡. å¯¹ä¸¤ä¸ªé›†åˆ<code>set1</code>ä»¥åŠ<code>set2</code>è¿›è¡Œå–äº¤é›†ä¹Ÿéœ€è¦ç”¨åˆ°æˆå‘˜æµ‹è¯•, ä½†æ˜¯è¿™ä¸€æ¬¡, æ¯ä¸€ä¸ªåœ¨<code>set1</code>ä¸­çš„å…ƒç´ å¿…é¡»åœ¨<code>set2</code>ä¸­è¿›è¡Œæˆå‘˜æµ‹è¯•, è¿™å¯¼è‡´æŒ‡ä»¤çš„å¢é•¿ä¸ºæ­¥æ•°çš„äºŒæ¬¡æ–¹, $\Theta(n^2)$, næ˜¯ä¸¤ä¸ªé›†åˆçš„å¤§å°.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">intersect_set</span><span class="p">(</span><span class="n">set1</span><span class="p">,</span> <span class="n">set2</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;Return a set containing all elements common to set1 and set2.&#34;&#34;&#34;</span>
        <span class="k">return</span> <span class="n">keep_if_link</span><span class="p">(</span><span class="n">set1</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">set_contains</span><span class="p">(</span><span class="n">set2</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">intersect_set</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">apply_to_all_link</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">square</span><span class="p">))</span>
<span class="n">Link</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">Link</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</code></pre></td></tr></table>
</div>
</div><p>å½“è®¡ç®—ä¸¤ä¸ªé›†åˆçš„å¹¶é›†, æˆ‘ä»¬å¿…é¡»è¦å°å¿ƒä¸è¦å»åŒ…å«ä»»ä½•å…ƒç´ ä¸¤æ¬¡. <code>union_set</code>å‡½æ•°ä¹Ÿéœ€è¦çº¿æ€§æ¬¡æ•°çš„éš¶å±æµ‹è¯•, åˆ›å»ºä¸€ä¸ªè¿‡ç¨‹ä¹ŸåŒ…å«$\Theta(n^2)$ä¸ªæ­¥éª¤.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">union_set</span><span class="p">(</span><span class="n">set1</span><span class="p">,</span> <span class="n">set2</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;Return a set containing all elements either in set1 or set2.&#34;&#34;&#34;</span>
        <span class="n">set1_not_set2</span> <span class="o">=</span> <span class="n">keep_if_link</span><span class="p">(</span><span class="n">set1</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="ow">not</span> <span class="n">set_contains</span><span class="p">(</span><span class="n">set2</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">extend_link</span><span class="p">(</span><span class="n">set1_not_set2</span><span class="p">,</span> <span class="n">set2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">union_set</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="n">Link</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">Link</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">Link</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Link</span><span class="p">(</span><span class="mi">5</span><span class="p">))))</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>é›†åˆä½œä¸ºæœ‰åºåºåˆ—</strong>. ä¸€ä¸ªæé«˜æˆ‘ä»¬é›†åˆæ“ä½œçš„æ–¹å¼æ˜¯ä¿®æ”¹è¡¨ç¤ºä»¥ä¾¿è®©é›†åˆå…ƒç´ ä»¥é€’å¢çš„é¡ºåºåˆ—å‡º. è¦åšåˆ°è¿™ä¸ª, æˆ‘ä»¬éœ€è¦ä¸€äº›æ–¹æ³•æ¥æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡ä»¥ä¾¿äºè®©æˆ‘ä»¬å¯ä»¥è¯´å‡ºé‚£ä¸ªæ›´å¤§. åœ¨Python, å¾ˆå¤šä¸åŒç±»å‹çš„å¯¹è±¡å¯ä»¥ç”¨<code>&lt;</code>ä»¥åŠ<code>&gt;</code>æ¥è¿›è¡Œæ¯”è¾ƒ, ä½†æ˜¯åœ¨è¿™ä¸ªä¾‹å­ä¸­æˆ‘ä»¬ä¼šé›†ä¸­åœ¨æ•°å­—ä¸Š. æˆ‘ä»¬ä¼šé€šè¿‡é€’å¢çš„æ–¹å¼æ¥åˆ—å‡ºå®ƒçš„å…ƒç´ æ¥é€šè¿‡ä¸€ä¸ªæ•°å­—è¡¨ç¤ºä¸€ä¸ªé›†åˆ.</p>
<p>æŒ‰é¡ºåºçš„ä¸€ä¸ªå¥½å¤„å‡ºç°åœ¨<code>set_contains</code>é‡Œé¢: åœ¨æ£€æŸ¥ä¸€ä¸ªå¯¹è±¡æ˜¯å¦å‡ºç°ä¸Š, æˆ‘ä»¬ä¸ç”¨å†å»æ‰«ææ•´ä¸ªé›†åˆ. å¦‚æœæˆ‘ä»¬æ‹¿åˆ°ä¸€ä¸ªé›†åˆçš„å…ƒç´ , å®ƒå¤§äºæˆ‘ä»¬éœ€è¦çš„å…ƒç´ , é‚£ä¹ˆæˆ‘ä»¬å°±çŸ¥é“å…ƒç´ ä¸åœ¨è¿™ä¸ªé›†åˆä¸­:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">set_contains</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">empty</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="ow">or</span> <span class="n">s</span><span class="o">.</span><span class="n">first</span> <span class="o">&gt;</span> <span class="n">v</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">first</span> <span class="o">==</span> <span class="n">v</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">set_contains</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">rest</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">u</span> <span class="o">=</span> <span class="n">Link</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Link</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">Link</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">set_contains</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="bp">False</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">set_contains</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="bp">True</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿™æ ·çš„åšæ³•èŠ‚çœäº†å¤šå°‘æ­¥éª¤å‘¢? åœ¨æœ€ç³Ÿç³•çš„æƒ…å†µä¸‹, æˆ‘ä»¬æŸ¥æ‰¾çš„é¡¹å¯èƒ½æ˜¯åœ¨é›†åˆä¸­æœ€å¤§çš„é‚£é¡¹, å› æ­¤æ­¥éª¤æ•°è·Ÿæ— åºè¡¨ç¤ºæ–¹å¼ç”¨çš„æ­¥éª¤æ•°ä¸€æ ·. å¦ä¸€æ–¹é¢, å¦‚æœæˆ‘ä»¬æŸ¥æ‰¾çš„é¡¹æœ‰å¾ˆå¤šä¸åŒçš„å¤§å°æˆ‘ä»¬å¯ä»¥é¢„æœŸæœ‰æ—¶æˆ‘ä»¬èƒ½å¤Ÿåœ¨åˆ—è¡¨çš„å¼€å§‹ä¹‹åˆå°±åœæ­¢æœç´¢, è€Œå…¶ä»–æ—¶é—´æˆ‘ä»¬è¿˜æ˜¯éœ€è¦æ£€æŸ¥åˆ—è¡¨çš„å¤§éƒ¨åˆ†. å¹³å‡æ¥è¯´, æˆ‘ä»¬å¯ä»¥é¢„æœŸéœ€è¦æ£€æŸ¥ç»“åˆä¸­çš„åŠæ•°. å› æ­¤, å¹³å‡éœ€è¦çš„æ­¥æ•°ä¼šè¿‘ä¹$\frac{n}{2}$. è¿™ä¾ç„¶æ˜¯$\Theta(n)$çº§å¢é•¿, ä½†æ˜¯å®ƒåœ¨å®è·µä¸­æ¯”ä»¥å‰çš„å®ç°èŠ‚çœäº†æˆ‘ä»¬ä¸€äº›æ—¶é—´.</p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡é‡æ–°å®ç°<code>intersect_set</code>æ¥å–å¾—æ›´å¥½çš„é€Ÿåº¦ä¸Šçš„æå‡. åœ¨æ— åºè¡¨ç¤ºä¸­, è¿™ä¸ªæ“ä½œéœ€è¦$\Theta(n^2)$ä¸ªæ­¥éª¤, å› ä¸ºæˆ‘ä»¬çš„å®ç°æ˜¯ä¸º<code>set1</code>çš„æ¯ä¸ªå…ƒç´ æ¥å¯¹<code>set2</code>è¿›è¡Œå®Œå…¨æ‰«æ. ä½†æ˜¯åœ¨æœ‰åºè¡¨ç¤ºä¸­, æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªæ›´åŠ èªæ˜çš„åŠæ³•. æˆ‘ä»¬åŒæ—¶è¿­ä»£ä¸¤ä¸ªé›†åˆ, è·Ÿè¸ªåœ¨<code>set1</code>ä¸­çš„å…ƒç´ <code>e1</code>ä»¥åŠ<code>set2</code>ä¸­çš„å…ƒç´ <code>e2</code>. å½“<code>e1</code>å’Œ<code>e2</code>ç›¸ç­‰æ—¶, æˆ‘ä»¬å°†è¿™ä¸ªå…ƒç´ å›Šæ‹¬åœ¨äº¤é›†ä¸­.</p>
<p>ç„¶è€Œå‡è®¾, <code>e1</code>æ¯”<code>e2</code>å°. å› ä¸º<code>e2</code>æ¯”<code>set2</code>ä¸­çš„å‰©ä¸‹çš„å…ƒç´ éƒ½è¦å°, æˆ‘ä»¬å¯ä»¥ç«‹é©¬å¾—å‡ºç»“è®º<code>e1</code>ä¸å¯èƒ½å‡ºç°åœ¨<code>set2</code>ä¸­å‰©ä½™çš„ä»»ä½•å…ƒç´ ä¸­, å› æ­¤, å®ƒå°±ä¸ä¼šåœ¨äº¤é›†ä¸­å‡ºç°. ç”±æ­¤, æˆ‘ä»¬å°±ä¸éœ€è¦å†è€ƒè™‘<code>e1</code>; æˆ‘ä»¬ä¸¢å¼ƒå®ƒå¹¶å¼€å§‹å¤„ç†ä¸‹ä¸€ä¸ª<code>set1</code>çš„å…ƒç´ . ä¹Ÿå¯ä»¥ç”¨ç›¸ä¼¼çš„é€»è¾‘æ¥å¤„ç†<code>set2</code>å½“<code>e2</code> &lt; <code>e1</code>æ—¶. è¿™é‡Œæ˜¯å‡½æ•°å®ç°:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">intersect_set</span><span class="p">(</span><span class="n">set1</span><span class="p">,</span> <span class="n">set2</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">empty</span><span class="p">(</span><span class="n">set1</span><span class="p">)</span> <span class="ow">or</span> <span class="n">empty</span><span class="p">(</span><span class="n">set2</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Link</span><span class="o">.</span><span class="n">empty</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">e1</span><span class="p">,</span> <span class="n">e2</span> <span class="o">=</span> <span class="n">set1</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">set2</span><span class="o">.</span><span class="n">first</span>
            <span class="k">if</span> <span class="n">e1</span> <span class="o">==</span> <span class="n">e2</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Link</span><span class="p">(</span><span class="n">e1</span><span class="p">,</span> <span class="n">intersect_set</span><span class="p">(</span><span class="n">set1</span><span class="o">.</span><span class="n">rest</span><span class="p">,</span> <span class="n">set2</span><span class="o">.</span><span class="n">rest</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">e1</span> <span class="o">&lt;</span> <span class="n">e2</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">intersect_set</span><span class="p">(</span><span class="n">set1</span><span class="o">.</span><span class="n">rest</span><span class="p">,</span> <span class="n">set2</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">e2</span> <span class="o">&lt;</span> <span class="n">e1</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">intersect_set</span><span class="p">(</span><span class="n">set1</span><span class="p">,</span> <span class="n">set2</span><span class="o">.</span><span class="n">rest</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">intersect_set</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">rest</span><span class="p">)</span>
<span class="n">Link</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">Link</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
</code></pre></td></tr></table>
</div>
</div><p>å»é¢„ä¼°è¿™ä¸ªè¿‡ç¨‹æ‰€éœ€çš„æ­¥éª¤, å¯ä»¥è§‚å¯Ÿåˆ°åœ¨æ¯ä¸€æ­¥ä¸­æˆ‘ä»¬è‡³å°‘ç¼©å°é›†åˆä¸€ä¸ªå…ƒç´ çš„å¤§å°. å› æ­¤, éœ€è¦çš„æ­¥æ•°æœ€å¤šå°±æ˜¯<code>set1</code>ä»¥åŠ<code>set2</code>åŠ èµ·æ¥çš„æ€»å’Œ, è€Œä¸æ˜¯åƒæ— åºè¡¨ç¤ºé‚£æ ·ç»“æœä¸ºä¸¤ä¸ªé›†åˆå¤§å°çš„ä¹˜ç§¯. è¿™æ˜¯$\Theta(n)$çš„å¢é•¿é€Ÿåº¦è€Œä¸æ˜¯$\Theta(n^2)$çš„å¢é•¿é€Ÿåº¦, ç”šè‡³å¯¹ä¸­ç­‰å¤§å°çš„é›†åˆè€Œè¨€, è¿™ä¹Ÿæ˜¯ä¸€ä¸ªå¯è§‚çš„é€Ÿåº¦æå‡. ä¾‹å¦‚, å–ä¸¤ä¸ªå¤§å°ä¸º100çš„é›†åˆçš„äº¤é›†ä¼šéœ€è¦200æ­¥, è€Œä¸æ˜¯æ— åºè¡¨ç¤ºçš„10,000æ­¥.</p>
<p>ä»¥æœ‰åºåºåˆ—è¡¨ç¤ºçš„é›†åˆçš„è¿æ¥å’Œè”åˆä¹Ÿå¯ä»¥ç”¨çº¿æ€§æ—¶é—´è®¡ç®—å‡ºæ¥. è¿™äº›å®ç°å°±ç•™ä½œç»ƒä¹ ç”¨.</p>
<p><strong>ä»¥æœç´¢æ ‘è¡¨ç¤ºçš„é›†åˆ</strong>. æˆ‘ä»¬æ¯”æœ‰åºè¡¨ç¤ºåšå¾—æ›´å¥½, é€šè¿‡æ’åˆ—é›†åˆå…ƒç´ å½¢æˆä¸€ä¸ªåªå…·æœ‰ä¸¤ä¸ªåˆ†æ”¯çš„æ ‘ä¸­. æ ‘çš„æ ¹èŠ‚ç‚¹<code>entry</code>æŒæœ‰ä¸€ä¸ªé›†åˆçš„å…ƒç´ . è¿™ä¸ªæ¡ç›®ä¸­å·¦è¾¹çš„åˆ†æ”¯å†…åŒ…å«æ‰€æœ‰å°äºæ ¹èŠ‚ç‚¹çš„å…ƒç´ . å³è¾¹çš„åˆ†æ”¯åŒ…å«æ‰€æœ‰å¤§äºåœ¨æ ¹èŠ‚ç‚¹çš„å…ƒç´ . ä¸‹é¢çš„å›¾åƒå±•ç¤ºäº†ä¸€äº›æ ‘ç”¨æ¥è¡¨ç¤ºç»“åˆ<code>{1, 3, 5, 7, 9, 11}</code>. ç›¸åŒçš„é›†åˆå¯èƒ½ä¼šé€šè¿‡æ ‘ä»¥å¤šç§ä¸åŒçš„æ–¹å¼æ¥è¡¨ç¤º. åœ¨æ‰€æœ‰çš„äºŒå‰æœç´¢æ ‘ä¸­, æ‰€æœ‰åœ¨å·¦è¾¹çš„å…ƒç´ å¿…é¡»å°äºæ ¹èŠ‚ç‚¹çš„æ¡ç›®, è€Œæ‰€æœ‰åœ¨å³è¾¹çš„å­æ ‘å¿…é¡»æ¯”æ ¹èŠ‚ç‚¹æ¡ç›®å¤§.</p>
<p><img src="http://composingprograms.com/img/set_trees.png" alt="é›†åˆäºŒå‰æ ‘è¡¨ç¤º" /></p>
<p>æ ‘è¡¨ç¤ºçš„å¥½å¤„æœ‰è¿™äº›: å‡è®¾æˆ‘ä»¬æƒ³è¦æ£€æŸ¥ä¸€ä¸ªå€¼væ˜¯å¦åŒ…å«åœ¨é›†åˆä¸­, æˆ‘ä»¬é€šè¿‡æ¯”è¾ƒvä¸è¿›å…¥ç‚¹<code>entry</code>å¼€å§‹. å¦‚æœvæ˜¯æ¯”å®ƒå°çš„è¯, æˆ‘ä»¬å°±çŸ¥é“æˆ‘ä»¬åªéœ€è¦æœç´¢å·¦è¾¹çš„å­æ ‘; å¦‚æœvæ˜¯æ¯”å®ƒå¤§çš„è¯, æˆ‘ä»¬åªéœ€è¦æœç´¢å³è¾¹çš„å­æ ‘. ç°åœ¨, å¦‚æœè¿™ä¸ªæ ‘æ˜¯&quot;å‡è¡¡çš„&rdquo;, æ¯ä¸€ä¸ªè¿™äº›å­æ ‘ä¼šå¤§çº¦æ˜¯åŸå§‹å°ºå¯¸çš„ä¸€åŠ. é‚£ä¹ˆ, åœ¨ä¸€ä¸ªæ­¥éª¤ä¸­, æˆ‘ä»¬å°±å·²ç»å°†æœç´¢å¤§å°ä¸ºnçš„æ ‘çš„é—®é¢˜å‡å°‘ä¸ºæœç´¢å¤§å°ä¸º$\frac{n}{2}$çš„é—®é¢˜. å› æ­¤æ ‘çš„å¤§å°åœ¨æ¯ä¸€æ­¥éƒ½ç¼©å‡ä¸€åŠ, æˆ‘ä»¬åº”è¯¥å¯ä»¥é‡è§éœ€è¦å»æœç´¢æ ‘çš„æ­¥éª¤æ•°å¢é•¿ä¸º$\Theta(\log n)$. å¯¹äºå¤§å‹çš„é›†åˆ, è¿™å°†ä¼šæ¯”å‰é¢çš„è¡¨ç¤ºæœ‰æ›´åŠ æ˜¾è‘—çš„åŠ é€Ÿ. è¿™ä¸ª<code>set_contains</code>å‡½æ•°é‡‡ç”¨æ ‘ç»“æ„é›†çš„æ’åºç»“æ„.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">set_contains</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">s</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">entry</span> <span class="o">==</span> <span class="n">v</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">entry</span> <span class="o">&lt;</span> <span class="n">v</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">set_contains</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">right</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">entry</span> <span class="o">&gt;</span> <span class="n">v</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">set_contains</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>é“¾æ¥ä¸€ä¸ªé¡¹åˆ°é›†åˆä¸­çš„å®ç°ä¹Ÿæ˜¯ç±»ä¼¼çš„, åŒæ—¶å®ƒéœ€è¦çš„æ­¥æ•°ä¹Ÿæ˜¯$\Theta(\log n)$. å»é“¾æ¥ä¸€ä¸ªå€¼v, æˆ‘ä»¬å°†vä¸entryè¿›è¡Œæ¯”è¾ƒæ¥åˆ¤æ–­væ˜¯å¦åº”è¯¥æ·»åŠ åˆ°å·¦è¾¹æˆ–è€…å³è¾¹çš„åˆ†æ”¯ä¸Š, ä»¥åŠé“¾æ¥våˆ°æ°å½“çš„åˆ†æ”¯å, æˆ‘ä»¬å°†è¿™äº›æ–°çš„æ„é€ åˆ†æ”¯è·ŸåŸå§‹çš„entryé¡¹ä»¥åŠå…¶ä»–åˆ†æ”¯æ‹¼å‡‘åœ¨ä¸€èµ·. å¦‚æœvç­‰äºå…¥å£entryé¡¹, æˆ‘ä»¬å°±åªæ˜¯è¿”å›èŠ‚ç‚¹å°±å¯ä»¥äº†. å¦‚æœæˆ‘ä»¬è¢«è¦æ±‚é“¾æ¥våˆ°ä¸€ä¸ªç©ºçš„æ ‘, æˆ‘ä»¬å°±æ„é€ ä¸€ä¸ªå…·æœ‰vå¹¶ä»¥å…¶ä½œä¸ºentryå…¥å£çš„å·¦å³åˆ†æ”¯ä¸ºç©ºçš„Tree. è¿™é‡Œæ˜¯å®ƒçš„å‡½æ•°å®ç°:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">adjoin_set</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">s</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Tree</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">entry</span> <span class="o">==</span> <span class="n">v</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">s</span>
        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">entry</span> <span class="o">&lt;</span> <span class="n">v</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Tree</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">entry</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">adjoin_set</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">right</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">entry</span> <span class="o">&gt;</span> <span class="n">v</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Tree</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">entry</span><span class="p">,</span> <span class="n">adjoin_set</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">v</span><span class="p">),</span> <span class="n">s</span><span class="o">.</span><span class="n">right</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">adjoin_set</span><span class="p">(</span><span class="n">adjoin_set</span><span class="p">(</span><span class="n">adjoin_set</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">Tree</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">Tree</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Tree</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</code></pre></td></tr></table>
</div>
</div><p>æˆ‘ä»¬å£°ç§°æœç´¢è¿™äº›æ ‘å¯ä»¥ä»¥å¯¹æ•°çš„æ­¥éª¤æ•°æ¥æ‰§è¡Œæ˜¯åŸºäºæ ‘æ˜¯&quot;å‡è¡¡çš„&quot;è¿™ä¸€ä¸ªå‡è®¾, å³æ¯æ£µæ ‘çš„å·¦ä»¥åŠå³å­æ ‘å…·æœ‰å¤§çº¦ç›¸åŒçš„æ•°é‡çš„å…ƒç´ , å› æ­¤æ¯æ£µå­æ ‘åŒ…å«æœ‰å®ƒçš„çˆ¶çº§çš„ä¸€åŠçš„å…ƒç´ . ä½†æ˜¯ç°åœ¨æˆ‘ä»¬å¯ä»¥ç¡®å®šæˆ‘ä»¬æ„é€ çš„æ ‘ä¼šæ˜¯å‡è¡¡çš„å—? å³ä½¿æˆ‘ä»¬ç”±ä¸€ä¸ªå‡è¡¡çš„å­æ ‘å¼€å§‹, é€šè¿‡<code>adjoin_set</code>æ·»åŠ å…ƒç´ åä¹Ÿå¯èƒ½ä¼šäº§å‡ºä¸€ä¸ªä¸å‡è¡¡çš„ç»“æœ. å› ä¸ºæ–°é“¾æ¥çš„å…ƒç´ çš„ä½ç½®å–å†³äºå…ƒç´ æ˜¯å¦‚ä½•ä¸å·²ç»å­˜åœ¨é›†åˆä¸­çš„é¡¹ç›®è¿›è¡Œæ¯”è¾ƒ, æˆ‘ä»¬å¯ä»¥é¢„æœŸå¦‚æœæˆ‘ä»¬æ·»åŠ å…ƒç´ æ˜¯&quot;éšæœºçš„&rdquo;, é‚£ä¹ˆå¹³å‡æ¥è¯´, æ ‘ä¼šè¶‹äºå‡è¡¡.</p>
<p>ä½†å¹¶ä¸èƒ½å¤Ÿä¿è¯ä¸€å®šæ˜¯è¿™æ ·çš„. ä¾‹å¦‚, å¦‚æœæˆ‘ä»¬å¼€å§‹äºä¸€ä¸ªç©ºçš„é›†åˆ, ç„¶åæŒ‰é¡ºåºé“¾æ¥1åˆ°7åˆ°é›†åˆä¸­, æˆ‘ä»¬æœ€ç»ˆä¼šå¾—åˆ°ä¸€ä¸ªé«˜åº¦ä¸å‡è¡¡çš„æ ‘, å®ƒçš„æ‰€æœ‰å·¦å­æ ‘éƒ½æ˜¯ç©ºçš„, å› æ­¤å®ƒç›¸æ¯”äºç®€å•çš„é¡ºåºåˆ—è¡¨æ²¡æœ‰ä»»ä½•ä¼˜åŠ¿, ä¸€ä¸ªè§£å†³åŠæ³•æ˜¯å»å®šä¹‰ä¸€ä¸ªæ“ä½œæ¥è½¬æ¢ä¸€ä¸ªä»»æ„çš„æ ‘ä¸ºå…·æœ‰ç›¸åŒçš„å…ƒç´ çš„ä¸€ä¸ªå¹³è¡¡æ ‘. æˆ‘ä»¬å¯ä»¥åœ¨æ¯å‡ ä¸ª<code>adjoin_set</code>æ“ä½œä¹‹åæ‰§è¡Œè¿™ä¸ªè½¬æ¢æ¥ä¿æŒé›†åˆçš„å¹³è¡¡.</p>
<p>äº¤é›†å’Œå¹¶é›†æ“ä½œå¯ä»¥ä»¥çº¿æ€§æ—¶é—´åœ¨æ ‘ç»“æ„çš„é›†åˆä¸Šæ‰§è¡Œ, é€šè¿‡è½¬æ¢å®ƒä»¬ä¸ºæœ‰åºåˆ—è¡¨ç„¶åè½¬æ¢å›æ¥. ç»†èŠ‚å®ç°å°±ç•™ä½œç»ƒä¹ .</p>
<p><strong>Pythoné›†åˆå®ç°</strong>. <code>set</code>ç±»å‹æ˜¯å…§å»ºåœ¨Pythonä¸­ä¸”æ²¡æœ‰åœ¨å†…éƒ¨ä½¿ç”¨ä»»ä½•è¿™äº›è¡¨ç¤º. ç›¸ååœ°, Pythonä½¿ç”¨ä¸€ä¸ªè¡¨ç¤º, æŸ¥æ‰¾ä»¥åŠé“¾æ¥æ“ä½œåªéœ€è¦æ’å®šæ—¶é—´æ‰§è¡Œ, å…¶å®ç°åŸºäºä¸€ä¸ªè¢«ç§°ä¸º_å“ˆå¸Œ_çš„æŠ€æœ¯, è€Œè¿™æ˜¯å¦å¤–çš„ä¸€ä¸ªè¯¾ç¨‹çš„ä¸»é¢˜. å…§å»ºPythoné›†åˆä¸èƒ½åŒ…å«å¯å˜æ•°æ®ç±»å‹, ä¾‹å¦‚, åˆ—è¡¨, å­—å…¸, æˆ–è€…å…¶ä»–é›†åˆ. ä¸ºäº†å…è®¸é›†åˆåµŒå¥—, Pythonä¹ŸåŒ…å«äº†ä¸€ä¸ªå…§å»ºçš„ä¸å¯å˜<code>frozenset</code>ç±», å®ƒå…±äº«<code>set</code>ç±»å‹çš„æ–¹æ³•, é™¤äº†å¯å˜æ–¹æ³•ä»¥åŠæ“ä½œ.</p>
    </article>
    
    <script>
  'use strict';
  
  function wrap(el, wrapper) {
    el.parentNode.insertBefore(wrapper, el);
    wrapper.appendChild(el);
  }

  (function () {
    var singleContentsElem = document.querySelector('.single__contents');
    singleContentsElem ? 
    singleContentsElem.querySelectorAll('pre > code').forEach(function(elem) {
      var dataLang = elem.getAttribute('data-lang');
      var dataLangWrapper = document.createElement('div');
      var code = null;
      var codeTitle = null;

      if (dataLang && dataLang.includes(':')) {
        code = dataLang.split(':')[0];
        codeTitle = dataLang.split(':')[1];

        dataLangWrapper.className = 'language-' + code;
        dataLangWrapper.setAttribute('data-lang', codeTitle);

        elem.className = 'language-' + code;
        elem.setAttribute('data-lang', codeTitle);
        elem.setAttribute('id', codeTitle);
      } else if (!dataLang) {
        dataLangWrapper.setAttribute('data-lang', 'Code');
        dataLangWrapper.className = 'language-code';
      }

      if (!dataLang || codeTitle) {
        wrap(elem.parentNode, dataLangWrapper);
      }

    }) : null;
  })();

  var langCodeElem = document.querySelectorAll('.language-code');
  langCodeElem ? langCodeElem.forEach(function (elem) {
    var newElem = document.createElement('span');
    newElem.className = 'copy-to-clipboard';
    newElem.setAttribute('title', 'Copy to clipboard');
    elem.append(newElem);
  }) : null;
  
</script>
    
<div class="donation">
  <div class="donation__message">
    Share on
  </div>
  <div class="donation__icons">
    
    
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fjmwill.github.io%2fblog%2f2017%2f06%2f11%2f%25E7%25A8%258B%25E5%25BA%258F%25E6%259E%2584%25E6%2588%2590-%25E7%25AC%25AC%25E4%25BA%258C%25E7%25AB%25A0%2f" title="Facebook" aria-label="Facebook Share Button" class="donation__item" target="_blank" rel="noreferrer" data-type="share">
          <svg data-name="facebook" enable-background="new 0 0 24 24" viewBox="0 0 24 24" width="35" height="35" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="m15.997 3.985h2.191v-3.816c-.378-.052-1.678-.169-3.192-.169-3.159 0-5.323 1.987-5.323 5.639v3.361h-3.486v4.266h3.486v10.734h4.274v-10.733h3.345l.531-4.266h-3.877v-2.939c.001-1.233.333-2.077 2.051-2.077z"/></svg>
        </a>
      
    
      
        <a href="https://twitter.com/intent/tweet?text=%e7%a8%8b%e5%ba%8f%e6%9e%84%e6%88%90-%e7%ac%ac%e4%ba%8c%e7%ab%a0&url=https%3a%2f%2fjmwill.github.io%2fblog%2f2017%2f06%2f11%2f%25E7%25A8%258B%25E5%25BA%258F%25E6%259E%2584%25E6%2588%2590-%25E7%25AC%25AC%25E4%25BA%258C%25E7%25AB%25A0%2f&hashtags=%e8%af%91%e6%96%87%2cDesign%20Programs&via=" title="Twitter" aria-label="Twitter Share Button" class="donation__item" target="_blank" rel="noreferrer" data-type="share">
          <svg data-name="twitter" enable-background="new 0 0 24 24" viewBox="0 0 24 24" width="35" height="35" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="m21.534 7.113c.976-.693 1.797-1.558 2.466-2.554v-.001c-.893.391-1.843.651-2.835.777 1.02-.609 1.799-1.566 2.165-2.719-.951.567-2.001.967-3.12 1.191-.903-.962-2.19-1.557-3.594-1.557-2.724 0-4.917 2.211-4.917 4.921 0 .39.033.765.114 1.122-4.09-.2-7.71-2.16-10.142-5.147-.424.737-.674 1.58-.674 2.487 0 1.704.877 3.214 2.186 4.089-.791-.015-1.566-.245-2.223-.606v.054c0 2.391 1.705 4.377 3.942 4.835-.401.11-.837.162-1.29.162-.315 0-.633-.018-.931-.084.637 1.948 2.447 3.381 4.597 3.428-1.674 1.309-3.8 2.098-6.101 2.098-.403 0-.79-.018-1.177-.067 2.18 1.405 4.762 2.208 7.548 2.208 8.683 0 14.342-7.244 13.986-14.637z"/></svg>
        </a>
      
    
  </div>
</div>

    
    
<div class="whoami__gutter"></div>
<hr class="hr-slash whoami-hr"/>
<section class="whoami">
  <div class="whoami__image-wrapper">
    
    
      
        <img data-src="/blog/images/whoami/avatar.jpg" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" alt="Will" class="lazyload whoami__image"/>
      
    
  </div>
  <div class="whoami__contents">
    <div class="whoami__written-by">
      WRITTEN BY
    </div>
    <div class="whoami__title">
      
        Will
      
    </div>
    <div class="whoami__desc">
      
        Web Developer
      
    </div>
    <div class="whoami__social">
      
      
      
      
      
      
      
      
      <a href="mailto:willsurpriseyou@foxmail.com" title="email" aria-label="email">
        <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path fill="currentColor" d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-.4 4.25l-7.07 4.42c-.32.2-.74.2-1.06 0L4.4 8.25c-.25-.16-.4-.43-.4-.72 0-.67.73-1.07 1.3-.72L12 11l6.7-4.19c.57-.35 1.3.05 1.3.72 0 .29-.15.56-.4.72z"/></svg>
      </a>
      
      
      
      <a href="http://example.org/" title="facebook" aria-label="facebook">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" viewBox="0 0 24 24" version="1.1">
<g id="surface2747">
<path fill="currentColor" d="M 11.664062 2.003906 C 6.621094 2.171875 2.375 6.25 2.023438 11.289062 C 1.65625 16.617188 5.46875 21.121094 10.507812 21.878906 L 10.507812 14.648438 L 8.890625 14.648438 C 8.164062 14.648438 7.578125 14.0625 7.578125 13.335938 C 7.578125 12.609375 8.164062 12.023438 8.890625 12.023438 L 10.503906 12.023438 L 10.503906 10.273438 C 10.503906 7.378906 11.914062 6.105469 14.324219 6.105469 C 14.679688 6.105469 14.984375 6.113281 15.242188 6.128906 C 15.878906 6.15625 16.371094 6.6875 16.371094 7.324219 C 16.371094 7.988281 15.835938 8.523438 15.171875 8.523438 L 14.730469 8.523438 C 13.710938 8.523438 13.351562 9.492188 13.351562 10.585938 L 13.351562 12.023438 L 15.222656 12.023438 C 15.8125 12.023438 16.265625 12.550781 16.175781 13.132812 L 16.066406 13.835938 C 15.992188 14.304688 15.589844 14.652344 15.113281 14.652344 L 13.351562 14.652344 L 13.351562 21.898438 C 18.234375 21.234375 22 17.0625 22 12 C 22 6.367188 17.339844 1.820312 11.664062 2.003906 Z M 11.664062 2.003906 "/>
</g>
</svg>

      </a>
      
      
      
      
      
      <a href="https://github.com/jmwill" title="github" aria-label="github">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" viewBox="0 0 24 24" version="1.1">
<g id="surface3680">
<path fill="currentColor" d="M 10.898438 2.101562 C 6.300781 2.601562 2.601562 6.300781 2.101562 10.800781 C 1.601562 15.5 4.300781 19.699219 8.398438 21.300781 C 8.699219 21.398438 9 21.199219 9 20.800781 L 9 19.199219 C 9 19.199219 8.601562 19.300781 8.101562 19.300781 C 6.699219 19.300781 6.101562 18.101562 6 17.398438 C 5.898438 17 5.699219 16.699219 5.398438 16.398438 C 5.101562 16.300781 5 16.300781 5 16.199219 C 5 16 5.300781 16 5.398438 16 C 6 16 6.5 16.699219 6.699219 17 C 7.199219 17.800781 7.800781 18 8.101562 18 C 8.5 18 8.800781 17.898438 9 17.800781 C 9.101562 17.101562 9.398438 16.398438 10 16 C 7.699219 15.5 6 14.199219 6 12 C 6 10.898438 6.5 9.800781 7.199219 9 C 7.101562 8.800781 7 8.300781 7 7.601562 C 7 7.199219 7 6.601562 7.300781 6 C 7.300781 6 8.699219 6 10.101562 7.300781 C 10.601562 7.101562 11.300781 7 12 7 C 12.699219 7 13.398438 7.101562 14 7.300781 C 15.300781 6 16.800781 6 16.800781 6 C 17 6.601562 17 7.199219 17 7.601562 C 17 8.398438 16.898438 8.800781 16.800781 9 C 17.5 9.800781 18 10.800781 18 12 C 18 14.199219 16.300781 15.5 14 16 C 14.601562 16.5 15 17.398438 15 18.300781 L 15 20.898438 C 15 21.199219 15.300781 21.5 15.699219 21.398438 C 19.398438 19.898438 22 16.300781 22 12.101562 C 22 6.101562 16.898438 1.398438 10.898438 2.101562 Z M 10.898438 2.101562 "/>
</g>
</svg>

      </a>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <a href="https://twitter.com/j_mwill" title="twitter" aria-label="twitter">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" viewBox="0 0 32 32" version="1.1">
<g id="surface676">
<path fill="currentColor" d="M 28 8.558594 C 27.117188 8.949219 26.167969 9.214844 25.171875 9.332031 C 26.1875 8.722656 26.96875 7.757812 27.335938 6.609375 C 26.386719 7.171875 25.332031 7.582031 24.210938 7.804688 C 23.3125 6.847656 22.03125 6.246094 20.617188 6.246094 C 17.898438 6.246094 15.691406 8.453125 15.691406 11.171875 C 15.691406 11.558594 15.734375 11.933594 15.820312 12.292969 C 11.726562 12.089844 8.097656 10.128906 5.671875 7.148438 C 5.246094 7.875 5.003906 8.722656 5.003906 9.625 C 5.003906 11.332031 5.871094 12.839844 7.195312 13.722656 C 6.386719 13.695312 5.628906 13.476562 4.964844 13.105469 C 4.964844 13.128906 4.964844 13.148438 4.964844 13.167969 C 4.964844 15.554688 6.660156 17.546875 8.914062 17.996094 C 8.5 18.109375 8.066406 18.171875 7.617188 18.171875 C 7.300781 18.171875 6.988281 18.140625 6.691406 18.082031 C 7.316406 20.039062 9.136719 21.460938 11.289062 21.503906 C 9.605469 22.824219 7.480469 23.609375 5.175781 23.609375 C 4.777344 23.609375 4.386719 23.585938 4 23.539062 C 6.179688 24.9375 8.765625 25.753906 11.546875 25.753906 C 20.605469 25.753906 25.558594 18.25 25.558594 11.742188 C 25.558594 11.53125 25.550781 11.316406 25.542969 11.105469 C 26.503906 10.410156 27.339844 9.542969 28 8.558594 Z M 28 8.558594 "/>
</g>
</svg>

      </a>
      
      
      
      
      
      
      
      
      
      
      
      
    </div>
  </div>
</section>
<hr class="hr-slash whoami-hr" />


    <section class="related">
    
    
    <h1 class="related__title">
      <hr class="hr-dots"/>
      <div>
        See Also
      </div>
      <hr class="hr-dots"/>
    </h1>
    <ul class="related-ul">
        
        <li>
          <a href="/blog/2017/03/09/%E7%A8%8B%E5%BA%8F%E6%9E%84%E6%88%90-%E7%AC%AC%E4%B8%80%E7%AB%A0/" class="related__link">ç¨‹åºæ„æˆ-ç¬¬ä¸€ç« </a>
        </li>
        
        <li>
          <a href="/blog/2016/12/16/%E8%AF%91es6%E7%9A%84350%E4%B8%AA%E8%A6%81%E7%82%B9%E6%A6%82%E8%BF%B0/" class="related__link">ã€è¯‘ã€‘ES6çš„350ä¸ªè¦ç‚¹æ¦‚è¿°</a>
        </li>
        
    </ul>
    
  </section>
    <div class="grow"></div>
<nav class="pagination-single">
  
    
      <a href="https://jmwill.github.io/blog/2017/03/09/%E7%A8%8B%E5%BA%8F%E6%9E%84%E6%88%90-%E7%AC%AC%E4%B8%80%E7%AB%A0/" class="pagination-single__left">
        <div class="pagination-single__icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path fill="currentColor" d="M19 11H7.83l4.88-4.88c.39-.39.39-1.03 0-1.42-.39-.39-1.02-.39-1.41 0l-6.59 6.59c-.39.39-.39 1.02 0 1.41l6.59 6.59c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L7.83 13H19c.55 0 1-.45 1-1s-.45-1-1-1z"/></svg>
        </div>
        <div class="pagination-single__left-title">ç¨‹åºæ„æˆ-ç¬¬ä¸€ç« </div>      
      </a>
    
    <div class="grow"></div>
    
      <a href="https://jmwill.github.io/blog/2017/06/11/%E7%A8%8B%E5%BA%8F%E6%9E%84%E6%88%90-%E7%AC%AC%E4%B8%89%E7%AB%A0/" class="pagination-single__right">      
        <div class="pagination-single__right-title">ç¨‹åºæ„æˆ-ç¬¬ä¸‰ç« </div>
        <div class="pagination-single__icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path fill="currentColor" d="M5 13h11.17l-4.88 4.88c-.39.39-.39 1.03 0 1.42.39.39 1.02.39 1.41 0l6.59-6.59c.39-.39.39-1.02 0-1.41l-6.58-6.6c-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41L16.17 11H5c-.55 0-1 .45-1 1s.45 1 1 1z"/></svg>
        </div>
      </a>
    
  
</nav>
    
  

    <div class="modal micromodal-slide" id="modal" aria-hidden="true">
  <div class="modal__overlay" tabindex="-1" data-micromodal-close>
    <div class="modal__container" role="dialog" aria-modal="true" aria-labelledby="modal-title">
      
      <div class="modal__content" id="modal-content">
        <div id="mySwipe" class="swipe">
          <div class="swipe-wrap">
          </div>
        </div>
      </div>

      <span class="modal__items">
        
        <span class="modal__header">
          <div class="modal__paging" title="Page Info" aria-label="Current Page">
          </div>
          <div class="modal__icon modal__toolbar modal__toolbar--close" title="Close" aria-label="Close Button" data-micromodal-close>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" width="25" height="25"><path fill="currentColor" d="M 21.734375 19.640625 L 19.636719 21.734375 C 19.253906 22.121094 18.628906 22.121094 18.242188 21.734375 L 13 16.496094 L 7.761719 21.734375 C 7.375 22.121094 6.746094 22.121094 6.363281 21.734375 L 4.265625 19.640625 C 3.878906 19.253906 3.878906 18.628906 4.265625 18.242188 L 9.503906 13 L 4.265625 7.761719 C 3.882813 7.371094 3.882813 6.742188 4.265625 6.363281 L 6.363281 4.265625 C 6.746094 3.878906 7.375 3.878906 7.761719 4.265625 L 13 9.507813 L 18.242188 4.265625 C 18.628906 3.878906 19.257813 3.878906 19.636719 4.265625 L 21.734375 6.359375 C 22.121094 6.746094 22.121094 7.375 21.738281 7.761719 L 16.496094 13 L 21.734375 18.242188 C 22.121094 18.628906 22.121094 19.253906 21.734375 19.640625 Z"/></svg>
          </div>
          <div class="modal__icon modal__toolbar modal__toolbar--full" title="Full Screen" aria-label="Full Screen Button">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="25" height="25"><path fill="currentColor" d="M 5 3 C 3.9069372 3 3 3.9069372 3 5 L 3 8 A 1.0001 1.0001 0 1 0 5 8 L 5 5 L 8 5 A 1.0001 1.0001 0 1 0 8 3 L 5 3 z M 16 3 A 1.0001 1.0001 0 1 0 16 5 L 19 5 L 19 8 A 1.0001 1.0001 0 1 0 21 8 L 21 5 C 21 3.9069372 20.093063 3 19 3 L 16 3 z M 3.984375 14.986328 A 1.0001 1.0001 0 0 0 3 16 L 3 19 C 3 20.093063 3.9069372 21 5 21 L 8 21 A 1.0001 1.0001 0 1 0 8 19 L 5 19 L 5 16 A 1.0001 1.0001 0 0 0 3.984375 14.986328 z M 19.984375 14.986328 A 1.0001 1.0001 0 0 0 19 16 L 19 19 L 16 19 A 1.0001 1.0001 0 1 0 16 21 L 19 21 C 20.093063 21 21 20.093063 21 19 L 21 16 A 1.0001 1.0001 0 0 0 19.984375 14.986328 z"/></svg>
          </div>
          <div class="modal__icon modal__toolbar modal__toolbar--normal" title="Normal Screen" aria-label="Normal Screen Button">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="25" height="25"><path fill="currentColor" d="M 16.96875 4.972656 C 15.867188 4.988281 14.984375 5.894531 15 7 L 15 15 L 7 15 C 6.277344 14.988281 5.609375 15.367188 5.246094 15.992188 C 4.878906 16.613281 4.878906 17.386719 5.246094 18.007813 C 5.609375 18.632813 6.277344 19.011719 7 19 L 19 19 L 19 7 C 19.007813 6.460938 18.796875 5.941406 18.414063 5.558594 C 18.03125 5.175781 17.511719 4.964844 16.96875 4.972656 Z M 32.96875 4.972656 C 31.921875 4.988281 31.0625 5.8125 31.003906 6.859375 C 31 6.90625 31 6.953125 31 7 L 31 19 L 43 19 C 43.066406 19 43.132813 19 43.199219 18.992188 C 44.269531 18.894531 45.070313 17.972656 45.015625 16.902344 C 44.964844 15.828125 44.074219 14.988281 43 15 L 35 15 L 35 7 C 35.007813 6.460938 34.796875 5.941406 34.414063 5.558594 C 34.03125 5.175781 33.511719 4.964844 32.96875 4.972656 Z M 7 31 C 6.277344 30.988281 5.609375 31.367188 5.246094 31.992188 C 4.878906 32.613281 4.878906 33.386719 5.246094 34.007813 C 5.609375 34.632813 6.277344 35.011719 7 35 L 15 35 L 15 43 C 14.988281 43.722656 15.367188 44.390625 15.992188 44.753906 C 16.613281 45.121094 17.386719 45.121094 18.007813 44.753906 C 18.632813 44.390625 19.011719 43.722656 19 43 L 19 31 Z M 31 31 L 31 43 C 30.988281 43.722656 31.367188 44.390625 31.992188 44.753906 C 32.613281 45.121094 33.386719 45.121094 34.007813 44.753906 C 34.632813 44.390625 35.011719 43.722656 35 43 L 35 35 L 43 35 C 43.722656 35.011719 44.390625 34.632813 44.753906 34.007813 C 45.121094 33.386719 45.121094 32.613281 44.753906 31.992188 C 44.390625 31.367188 43.722656 30.988281 43 31 Z"/></svg>
          </div>
        </span>
        
        <div class="modal__icon modal__arrow modal__arrow--left" title="Arrow Left" aria-label="Arrow Left Button">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" width="28" height="28"><path fill="currentColor" d="M 23.28125 11 L 10 10 L 10 6.851563 C 10 6.523438 9.839844 6.277344 9.519531 6.03125 C 9.199219 5.949219 8.878906 5.949219 8.640625 6.113281 C 5.359375 8.410156 2.238281 12.257813 2.160156 12.421875 C 2.082031 12.578125 2.007813 12.8125 2.003906 12.976563 C 2.003906 12.980469 2 12.988281 2 12.992188 C 2 13.15625 2.078125 13.402344 2.160156 13.484375 C 2.238281 13.648438 5.28125 17.507813 8.640625 19.804688 C 8.960938 19.96875 9.28125 20.050781 9.519531 19.886719 C 9.839844 19.722656 10 19.476563 10 19.148438 L 10 16 L 23.28125 15 C 23.679688 14.679688 24 13.875 24 12.992188 C 24 12.195313 23.761719 11.320313 23.28125 11 Z"/></svg>
        </div>
        
        <div class="modal__icon modal__arrow modal__arrow--right" title="Arrow Right" aria-label="Arrow Right Button">

          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" width="28" height="28"><path fill="currentColor" d="M 2.71875 11.023438 L 16 10.023438 L 16 6.875 C 16 6.546875 16.160156 6.300781 16.480469 6.054688 C 16.800781 5.972656 17.121094 5.972656 17.359375 6.136719 C 20.640625 8.433594 23.761719 12.28125 23.839844 12.445313 C 23.917969 12.601563 23.992188 12.835938 23.996094 13 C 23.996094 13.003906 24 13.011719 24 13.015625 C 24 13.179688 23.921875 13.425781 23.839844 13.507813 C 23.761719 13.671875 20.71875 17.53125 17.359375 19.828125 C 17.039063 19.992188 16.71875 20.074219 16.480469 19.910156 C 16.160156 19.746094 16 19.5 16 19.171875 L 16 16.023438 L 2.71875 15.023438 C 2.320313 14.703125 2 13.898438 2 13.015625 C 2 12.21875 2.238281 11.34375 2.71875 11.023438 Z"/></svg>
        </div>

        <div class="modal__caption">
          <div class="modal__caption--text">
          </div>
        </div>

      </span>
    </div>
  </div>
</div>


<script defer src="/blog/js/swipe.min.08ff2be1b74347bad9e267f732f1388d271b2f9d97b6a8a87bd6a510f17c5ad2.js"></script>

<script defer src="/blog/js/micromodal.min.de01b44b2f383056bbcaf6ee921fd385d79108ec1129afd0eb2f3f5a07e11f45.js"></script>

<script defer src="/blog/js/helper/fadeinout.min.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function () {
  
   
  var docElem = document.documentElement;

   
  function openFullscreen() {
    if (docElem.requestFullscreen) {
      docElem.requestFullscreen();
    } else if (docElem.mozRequestFullScreen) {  
      docElem.mozRequestFullScreen();
    } else if (docElem.webkitRequestFullscreen) {  
      docElem.webkitRequestFullscreen();
    } else if (docElem.msRequestFullscreen) {  
      docElem.msRequestFullscreen();
    }
  }

   
  function closeFullscreen() {
    if (document.fullscreenElement ||
      document.webkitFullscreenElement ||
      document.mozFullScreenElement) {
      if (document.exitFullscreen) {
        document.exitFullscreen();
      } else if (document.mozCancelFullScreen) {  
        document.mozCancelFullScreen();
      } else if (document.webkitExitFullscreen) {  
        document.webkitExitFullscreen();
      } else if (document.msExitFullscreen) {  
        document.msExitFullscreen();
      }
    }
  }

  var modal = document.getElementById('modal');
  var galleryContainerElem = document.querySelector('.gallery__container');
  var swipeWrapElem = document.querySelector('.swipe-wrap');
  var mySwipeElem = document.getElementById('mySwipe');
  var arrowLeftElem = document.querySelector('.modal__arrow--left');
  var arrowRightElem = document.querySelector('.modal__arrow--right');
  var closeElem = document.querySelector('.modal__toolbar--close');
  var fullElem = document.querySelector('.modal__toolbar--full');
  var normalElem = document.querySelector('.modal__toolbar--normal');
  var captionElem = document.querySelector('.modal__caption');
  var pagingElem = document.querySelector('.modal__paging');
  var itemsElem = document.querySelector('.modal__items');
  var imgTotalNum = null;
  var myFadeTimeout = null;
  var mySwipe = null;
  var keydownFunction = function (e) {
    if (e.key === 'ArrowRight') {
      if (modal && modal.classList.contains('is-open')) {
        mySwipe.next();
      }
    } else if (e.key === 'ArrowLeft') {
      if (modal && modal.classList.contains('is-open')) {
        mySwipe.prev();
      }
    }
  }

  if (galleryContainerElem) {
    imgTotalNum = galleryContainerElem.querySelectorAll('img').length;
  } else {
    galleryContainerElem = document.querySelector('.single__contents');
    imgTotalNum = galleryContainerElem.querySelectorAll('img').length;
  }

  MicroModal.init({
    onClose: function () {
      if (mySwipe) {
        mySwipe.kill();
        mySwipe = null;
        closeFullscreen();
      }
      window.removeEventListener('keydown', keydownFunction);
    },
    disableScroll: true,
    disableFocus: true,
    awaitOpenAnimation: false,
    awaitCloseAnimation: false,
    debugMode: false,
  });

  var imageLoad = function(src) {
    return new Promise(function(resolve, reject) {
      var newImg = new Image;
      newImg.onload = function() {
        resolve(newImg);
      }
      newImg.onerror = reject;
      newImg.src = src;
    });
  }

  galleryContainerElem.querySelectorAll('img').forEach(function (elem, idx) {
    elem.style.cursor = 'pointer';

    var clonedElem = elem.cloneNode(true);
    clonedElem.style.maxHeight = '100%';
    clonedElem.style.maxWidth = '100%';
    clonedElem.onclick = function (e) {
      e.stopPropagation();
    }

    var wrapper = document.createElement('div');
    wrapper.style.width = '100%';
    wrapper.style.height = '100vh';
    wrapper.setAttribute('data-micromodal-close', '');
    wrapper.onclick = function () {
      if (mySwipe) {
        mySwipe.kill();
        mySwipe = null;
      }
    }
    wrapper.onmouseenter = function () {
      clearTimeout(myFadeTimeout);
      fadeIn(itemsElem, 200);
    };
    wrapper.onmouseleave = function () {
      myFadeTimeout = setTimeout(function () {
        fadeOut(itemsElem, 200);
      }, 2500);
    }
    wrapper.ontouchstart = function() {
      fadeIn(itemsElem, 200);
    }
    wrapper.append(clonedElem);
    swipeWrapElem.append(wrapper);

    elem.addEventListener('click', async function (e) {
      MicroModal.show('modal');
      if (mySwipe) {
        mySwipe.kill();
        mySwipe = null;
      }

      var imgSrc = e.target.getAttribute('data-src') || e.target.getAttribute('src');
      var img = await imageLoad(imgSrc);
      clonedElem.style.width = img.width + 'px';
      clonedElem.style.height = img.height + 'px';
      
      
      mySwipe = new Swipe(mySwipeElem, {
        startSlide: idx,
        draggable: true,
        autoRestart: false,
        continuous: false,
        disableScroll: true,
        stopPropagation: true,
        callback: async function (index, element) {
          
          var imgElem = element.querySelector('img');
          var imgSrc = imgElem.getAttribute('data-src') || imgElem.getAttribute('src');
          var img = await imageLoad(imgSrc);
          imgElem.style.width = img.width + 'px';
          imgElem.style.height = img.height + 'px';

          
          if (captionElem && imgElem) {
            var caption = null;
            if (imgElem.getAttribute('data-caption')) {
              caption = imgElem.getAttribute('data-caption');
            } else if (imgElem.getAttribute('title')) {
              caption = imgElem.getAttribute('title');
            } else if (imgElem.getAttribute('alt')) {
              caption = imgElem.getAttribute('alt');
            } else {
              caption = imgElem.getAttribute('src');
            }

            captionElem.querySelector('.modal__caption--text').innerText = caption;
            pagingElem.innerText = (index + 1) + ' / ' + imgTotalNum;

            clearTimeout(myFadeTimeout);
            fadeIn(itemsElem, 200);
          }
        },
      });

      fadeIn(itemsElem);

      
      if (captionElem) {
        var caption = null;
        if (e.target.getAttribute('data-caption')) {
          caption = e.target.getAttribute('data-caption');
        } else if (e.target.getAttribute('title')) {
          caption = e.target.getAttribute('title');
        } else if (e.target.getAttribute('alt')) {
          caption = e.target.getAttribute('alt');
        } else {
          caption = e.target.getAttribute('src');
        }

        captionElem.querySelector('.modal__caption--text').innerText = caption;
        pagingElem.innerText = (idx + 1) + ' / ' + imgTotalNum;
      }

      if (normalElem && fullElem) {
        normalElem.style.zIndex = -1;
        normalElem.style.opacity = 0;
        fullElem.style.zIndex = 25;
        fullElem.style.opacity = 1;
      }
    });

    window.addEventListener('keydown', keydownFunction);
  });

  arrowLeftElem ?
    arrowLeftElem.addEventListener('click', function (e) {
      if (mySwipe) {
        mySwipe.prev();
      }
    }) : null;
  arrowRightElem ?
    arrowRightElem.addEventListener('click', function (e) {
      if (mySwipe) {
        mySwipe.next();
      }
    }) : null;

  closeElem ?
    closeElem.addEventListener('click', function () {
      if (mySwipe) {
        mySwipe.kill();
        mySwipe = null;
      }
      closeFullscreen();
      MicroModal.close('modal');
    }) : null;

  fullElem ?
    fullElem.addEventListener('click', function (e) {
      openFullscreen();
      if (normalElem) {
        normalElem.style.zIndex = 25;
        normalElem.style.opacity = 1;
        fullElem.style.zIndex = -1;
        fullElem.style.opacity = 0;
      }
    }) : null;

  normalElem ?
    normalElem.addEventListener('click', function (e) {
      closeFullscreen();
      if (fullElem) {
        fullElem.style.zIndex = 25;
        fullElem.style.opacity = 1;
        normalElem.style.zIndex = -1;
        normalElem.style.opacity = 0;
      }
    }) : null;
  
});
</script>

    <div class="hide">
      

<div class="search">
  <span class="icon">
    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M15.5 14h-.79l-.28-.27c1.2-1.4 1.82-3.31 1.48-5.34-.47-2.78-2.79-5-5.59-5.34-4.23-.52-7.79 3.04-7.27 7.27.34 2.8 2.56 5.12 5.34 5.59 2.03.34 3.94-.28 5.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
  </span>
  <input id="search" aria-label="Site Search" class="input" type="text" placeholder="Search" autocomplete="off">
  <div id="search-results" class="dropdown">
    <div id="search-menu" class="dropdown-menu" role="menu">
    </div>
  </div>
</div>


    </div>
  </div>
</main>


<aside class="single__side main-side">
  


<section class="sidebar hide">
  <script>document.querySelector('.sidebar').classList.remove('hide')</script>
  <div class="toc__flexbox" data-position="fixed">
    <h6 class="toc__title" data-ani="true">What&#39;s on this Page</h6>
    
      <label class="switch" data-ani="true">
        <input id="toggle-toc" aria-label="Toggle TOC" type="checkbox" checked>
        <span class="slider round"></span>
      </label>
    
  </div>
  <div class="toc " data-dir="ltr" data-folding="false" data-ani="true">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#ç¬¬äºŒç« -æ„ç­‘æŠ½è±¡æ•°æ®">ç¬¬äºŒç« : æ„ç­‘æŠ½è±¡æ•°æ®</a>
      <ul>
        <li><a href="#21-ä»‹ç»">2.1 ä»‹ç»</a></li>
        <li><a href="#22-æ•°æ®æŠ½è±¡">2.2 æ•°æ®æŠ½è±¡</a></li>
        <li><a href="#23-åºåˆ—">2.3 åºåˆ—</a></li>
        <li><a href="#24-å¯å˜æ•°æ®">2.4 å¯å˜æ•°æ®</a></li>
        <li><a href="#25-é¢å‘å¯¹è±¡ç¼–ç¨‹">2.5 é¢å‘å¯¹è±¡ç¼–ç¨‹</a></li>
        <li><a href="#26-å®ç°ç±»ä»¥åŠå¯¹è±¡">2.6 å®ç°ç±»ä»¥åŠå¯¹è±¡</a></li>
        <li><a href="#27-å¯¹è±¡æŠ½è±¡">2.7 å¯¹è±¡æŠ½è±¡</a></li>
        <li><a href="#28-æ•ˆç‡">2.8 æ•ˆç‡</a></li>
        <li><a href="#29-é€’å½’å¯¹è±¡">2.9 é€’å½’å¯¹è±¡</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</section>



</aside>

<script>
  
  
  

  var enableToc = JSON.parse("true");
  var toc = JSON.parse("null");
  var tocPosition = JSON.parse("\"inner\"");
  
  var singleMainElem = document.querySelector('.single__main');
  var singleSideElem = document.querySelector('.single__side');

  enquire.register("screen and (max-width: 769px)", {
    match: function () {
      if ((enableToc || toc) && tocPosition !== "outer") {
        if (singleMainElem && singleSideElem) {
          singleMainElem.classList.remove('main-main');
          singleMainElem.classList.add('main');
          singleSideElem.classList.remove('main-side');
          singleSideElem.classList.add('hide');
        }
      } else if (tocPosition === "outer") {
        if (singleMainElem && !singleMainElem.classList.contains('main-main')) {
          singleMainElem.classList.remove('main-main');
          singleMainElem.classList.add('main');
        }
        if (singleSideElem && !singleSideElem.classList.contains('hide')) {
          singleSideElem.classList.add('hide');
        }
      }
    },
    unmatch: function () {
      if ((enableToc || toc) && tocPosition !== "outer") {
        singleMainElem.classList.remove('main');
        singleMainElem.classList.add('main-main');
        singleSideElem.classList.remove('hide');
        singleSideElem.classList.add('main-side');
      } else if (tocPosition === "outer") {
        if (singleMainElem && !singleMainElem.classList.contains('main-main')) {
          singleMainElem.classList.remove('main-main');
          singleMainElem.classList.add('main');
        }
        if (singleSideElem && !singleSideElem.classList.contains('hide')) {
          singleSideElem.classList.add('hide');
        }
      }

      var navCollapseBtn = document.querySelector('.navbar__burger');
      var navCollapse = document.getElementsByClassName('navbarm__collapse')[0];
      if (navCollapse) {
        navCollapse.setAttribute('data-open', false);
        navCollapse.style.maxHeight = 0;
        navCollapseBtn.classList.remove('is-active');
      }
      document.getElementsByClassName('navbar__menu')[0].classList.remove('is-active');
      document.getElementsByClassName('mobile-search')[0].classList.add('hide');
    },
    setup: function () { },
    deferSetup: true,
    destroy: function () { },
  });
</script>




<script defer src="/blog/js/clipboard.min.1626706afc88d95ebe1173b553ec732c6dc82a576989315fdf5e7779af738a44.js"></script>

<script defer src="/blog/js/helper/getParents.min.js"></script>

<script defer src="/blog/js/helper/closest.min.js"></script>

<script defer src="/blog/js/helper/prev.min.js"></script>

<script defer src="/blog/js/helper/prop.min.js"></script>

<script defer src="/blog/js/helper/fadeinout.min.js"></script>

















<script>
  'use strict';

  window.onload = function() {
    var navbar = document.querySelector('.navbar');
    var singleContentsElem = document.querySelector('.single__contents');

    
    
    
    var enableBusuanzi = JSON.parse("false");
    var busuanziPagePV = JSON.parse("true");
    
    if (enableBusuanzi && busuanziPagePV) {
      var pagePvElem = document.querySelector('#busuanzi_value_page_pv');
      pagePvElem.textContent = pagePvElem.textContent.replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1,");
    }    
    


    
    
    
    
    
    
    var enableToc = JSON.parse("true");
    var toc = JSON.parse("null");
    var hideToc = JSON.parse("false");
    var tocFlexbox = document.querySelector('.toc__flexbox');
    var tocFlexboxOuter = document.querySelector('.toc__flexbox--outer');
    var tocFolding = JSON.parse("false");
    
    if ((enableToc || toc) && document.querySelector('.toc')) {
      var tableOfContentsElem = document.querySelector('.toc').querySelector('#TableOfContents');

      if (false === tocFolding) {

      } else {
        tableOfContentsElem.querySelectorAll('ul') ?
          tableOfContentsElem.querySelectorAll('ul').forEach(function (rootUl) {
            rootUl.querySelectorAll('li').forEach(function (liElem) {
              liElem.querySelectorAll('ul').forEach(function (ulElem) {
                ulElem.style.display = 'none';
              });
            });
          }) : null;
      }

      if (tableOfContentsElem) {
        if (tableOfContentsElem.querySelectorAll('a').length > 0) {
          tableOfContentsElem.querySelectorAll('a').forEach(function (elem) {
            elem.addEventListener('click', function () {
              var id = elem.getAttribute('id');
              navbar.classList.remove('navbar--show');
              navbar.classList.remove('navbar--hide');
              navbar.classList.add('navbar--hide');

              document.querySelector('.toc').querySelectorAll('a').forEach(function (elem) {
                elem.classList.remove('active');
              });
              elem.classList.add('active');

              var curElem = tableOfContentsElem.querySelector('[href="#' + id + '"]');
              if (curElem && curElem.nextElementSibling) {
                curElem.nextElementSibling.style.display = 'block';
              }
              if (curElem) {
                getParents(curElem, 'ul') ?
                  getParents(curElem, 'ul').forEach(function (elem) {
                    elem.style.display = 'block';
                  }) : null;
              }
            });
          });
        } else {
          if (tocFlexbox) {
            tocFlexbox.setAttribute('data-position', '');
            if (!tocFlexbox.classList.contains('hide')) {
              tocFlexbox.classList.add('hide');
            }
          }
          if (tocFlexboxOuter) {
            tocFlexboxOuter.setAttribute('data-position', '');
            if (!tocFlexboxOuter.classList.contains('hide')) {
              tocFlexboxOuter.classList.add('hide');
            }
          }
        }
      }

      
      var toggleTocElem = document.getElementById("toggle-toc");
      var visibleTocElem = document.getElementById('visible-toc');
      var tocElem = document.querySelector('.toc');
      var mainElem = document.querySelector('main');
      var sideElem = document.querySelector('side');
      var tocFlexboxElem = document.querySelector('.toc__flexbox');

      toggleTocElem ? 
      toggleTocElem.addEventListener('change', function(e) {
        if (e.target.checked) {
          if (tocElem) {
            fadeIn(tocElem, 200);
          }
          if (tocFlexboxElem) {
            tocFlexboxElem.setAttribute('data-position', 'fixed');
          }

          if (mainElem) {
            mainElem.classList.remove('main-main');
            mainElem.classList.remove('main');
            mainElem.classList.add('main-main');
          }
          if (sideElem) {
            sideElem.classList.remove('main-side');
          }
        } else {
          if (tocElem) {
            fadeOut(tocElem, 200);
          }
          if (tocFlexboxElem) {
            tocFlexboxElem.setAttribute('data-position', 'absolute');
          }

          if (mainElem) {
            mainElem.classList.remove('main-main');
            mainElem.classList.remove('main');
            mainElem.classList.add('main');
          }
          if (sideElem) {
            sideElem.classList.remove('main-side');
          }
        }
      }) : null;

      visibleTocElem ?
      visibleTocElem.addEventListener('change', function(e) {
        if (e.target.checked) {
          if (tocElem) {
            fadeIn(tocElem, 200);
          }
        } else {
          if (tocElem) {
            fadeOut(tocElem, 200);
          }
        }
      }) : null;
    }
    


    
    var tables = document.querySelectorAll('.single__contents > table');
    for (let i = 0; i < tables.length; i++) {
      var table = tables[i];
      var wrapper = document.createElement('div');
      wrapper.className = 'table-wrapper';
      table.parentElement.replaceChild(wrapper, table);
      wrapper.appendChild(table);
    }
    


    
    var text, clip = new ClipboardJS('.anchor');
    var headers = singleContentsElem.querySelectorAll("h1, h2, h3, h4");

    
    var languagedir = JSON.parse("\"ltr\"");

    headers ? 
    headers.forEach(function (elem) {
      var url = encodeURI(document.location.origin + document.location.pathname);
      var link = url + "#" + elem.getAttribute('id');
      var newElemOuter = document.createElement('span');
      newElemOuter.classList.add('anchor');
      newElemOuter.classList.add('hide');
      newElemOuter.setAttribute('data-clipboard-text', link);
      newElemOuter.style.position = 'relative';

      var newElemInner = document.createElement('span');
      newElemInner.style.fontSize = '1rem';
      newElemInner.style.position = 'absolute';
      newElemInner.style.top = '50%';
      newElemInner.style.transform = 'translateY(-50%)';
      newElemInner.innerText = "ğŸ”—";

      if (languagedir === "rtl") {
        newElemInner.style.left = '-2rem';
      } else {
        newElemInner.style.right = '-2rem';
      }

      newElemOuter.append(newElemInner);
      elem.append(newElemOuter);

      elem.addEventListener('mouseenter', function() {
        this.querySelector('.anchor').classList.remove('hide');
      });
      elem.addEventListener('mouseleave', function () {
        this.querySelector('.anchor').classList.add('hide');
      });
    }) : null;

    document.querySelectorAll('.anchor').forEach(function(elem) {
      elem.addEventListener('mouseleave', function() {
        elem.setAttribute('aria-label', null);
        elem.classList.remove('tooltipped');
        elem.classList.remove('tooltipped-s');
        elem.classList.remove('tooltipped-w');
      });
    });

    clip.on('success', function (e) {
      e.clearSelection();
      e.trigger.setAttribute('aria-label', 'Link copied to clipboard!');
      e.trigger.classList.add('tooltipped');
      e.trigger.classList.add('tooltipped-s');
    });
    


    
    var clipInit = false;
    var preChromaElem = document.querySelectorAll('pre.chroma');
    var langCodeElem = document.querySelectorAll('.language-code');
    var dollarCodeElem = document.querySelectorAll('div.language-\\$');
    var gtCodeElem = document.querySelectorAll('div.language-\\>');

    var makeClipboard = function(elem) {
      var code = elem,
        text = elem.textContent;
        
      if (text.length > 15) {
        if (!clipInit) {
          var text, clip = new ClipboardJS('.copy-to-clipboard', {
            text: function (trigger) {
              var codeElem = prev(trigger).querySelectorAll('code');
              if (codeElem.length > 1) {
                text = prev(trigger).querySelector('code[class^="language-"]').textContent;
              } else {
                text = prev(trigger).querySelector('code').textContent;
              }

              return text.replace(/^\$\s/gm, '');
            }
          });

          var inPre;
          clip.on('success', function (e) {
            e.clearSelection();
            inPre = prop(e.trigger.parentNode, 'tagName') == 'PRE';
            e.trigger.setAttribute('aria-label', 'Copied to clipboard!');
            e.trigger.classList.add('tooltipped');
            e.trigger.classList.add('tooltipped-w');
          });

          clip.on('error', function (e) {
            inPre = prop(e.trigger.parentNode, 'tagName') == 'PRE';
            e.trigger.setAttribute('aria-label', e.action.toString());
            e.trigger.classList.add('tooltipped');
            e.trigger.classList.add('tooltipped-w');
          });

          clipInit = true;
        }

        var notAllowedClass = ['language-mermaid', 'language-viz', 'language-wave', 'language-chart', 'language-msc', 'language-flowchart'];
        var isNotAllowedIncluded = false;
        var curClassName = code.getAttribute('class');

        for (var i = 0; i < notAllowedClass.length; i++) {
          if (curClassName && curClassName.startsWith(notAllowedClass[i])) {
            isNotAllowedIncluded = true;
            break;
          }
        }

        if (!isNotAllowedIncluded) {
          if (curClassName) {
            var newClipboardElem = document.createElement('span');
            newClipboardElem.setAttribute('class', 'copy-to-clipboard');
            newClipboardElem.setAttribute('title', 'Copy to clipboard');
            elem.parentNode.parentNode.insertBefore(newClipboardElem, elem.parentNode.nextElementSibling);
          }
        }
      }
    }

    var makeSymbolClipboard = function(elem) {
      var clipboardSpan = document.createElement('span');
      clipboardSpan.setAttribute('class', 'copy-to-clipboard');
      clipboardSpan.setAttribute('title', 'Copy to clipboard');
      elem.parentNode.parentNode.insertBefore(clipboardSpan, elem.parentNode.nextElementSibling);
    }

    preChromaElem ? 
    preChromaElem.forEach(function(elem) {
      elem.querySelectorAll('code').forEach(function(codeElem) {
        makeClipboard(codeElem);
      });
    }) : null;
    
    langCodeElem ? 
    langCodeElem.forEach(function(elem) {
      elem.querySelectorAll('code').forEach(function (codeElem) {
        makeClipboard(codeElem);
      });
    }) : null;

    dollarCodeElem ? 
    dollarCodeElem.forEach(function(elem) {
      elem.querySelectorAll('code').forEach(function (codeElem) {
        makeSymbolClipboard(codeElem);
      });
    }) : null;

    gtCodeElem ?
    gtCodeElem.forEach(function(elem) {
      elem.querySelectorAll('code').forEach(function (codeElem) {
        makeSymbolClipboard(codeElem);
      });
    }) : null;
    


    
    dollarCodeElem ?
    dollarCodeElem.forEach(function(elem) {
      var lnts = elem.parentNode.parentNode ? elem.parentNode.parentNode.querySelectorAll('.lnt') : null;
      lnts ? 
      lnts.forEach(function(lnt) {
        lnt.innerHTML = '$<br/>';
      }) : null;
    }) : null;

    gtCodeElem ?
    gtCodeElem.forEach(function(elem) {
      var lnts = elem.parentNode.parentNode ? elem.parentNode.parentNode.querySelectorAll('.lnt') : null;
      lnts ? 
      lnts.forEach(function(lnt) {
        lnt.innerHTML = '><br/>';
      }) : null;
    }) : null;
    


    
    
    var lib = JSON.parse("null");

    if (lib && lib.includes('mermaid')) {
      
      var themeVariant = localStorage.getItem('theme') || JSON.parse("\"solarized\"");

      if (themeVariant === "dark" || themeVariant === "hacker") {
        mermaid.initialize({ theme: 'dark' });
      } else {
        mermaid.initialize({ theme: 'default' });
      }
      
      var mermaids = [];
      [].push.apply(mermaids, document.getElementsByClassName('language-mermaid'));
      mermaids.forEach(function(elem) {
        var elemParentNode = elem.parentNode;

        if (elemParentNode !== document.body) {
          elemParentNode.parentNode.insertBefore(elem, elemParentNode);
          elemParentNode.parentNode.removeChild(elemParentNode);
        }

        var newElemWrapper = document.createElement('div');
        newElemWrapper.classList.add('mermaid');
        newElemWrapper.style.padding = '34px 4px 6px';
        newElemWrapper.innerHTML = elem.innerHTML;
        elem.replaceWith(newElemWrapper);
      });
    }
    
    

    
    if (lib && lib.includes('katex')) {
      var mathElements = document.getElementsByClassName('math');
      var options = {
        delimiters: [
          { left: "$$", right: "$$", display: true },
          { left: "\\[", right: "\\]", display: true },
          { left: "$", right: "$", display: false },
          { left: "\\(", right: "\\)", display: false }
        ],
      };

      renderMathInElement(document.querySelector('.single__contents'), options);
    }
    


    
    if (lib && lib.includes('flowchartjs')) {
      
      var options = JSON.parse("{\"arrow-end\":\"block\",\"element-color\":\"black\",\"fill\":\"white\",\"flowstate\":{\"approved\":{\"fill\":\"#58C4A3\",\"font-size\":12,\"no-text\":\"n/a\",\"yes-text\":\"APPROVED\"},\"current\":{\"fill\":\"yellow\",\"font-color\":\"red\",\"font-weight\":\"bold\"},\"future\":{\"fill\":\"#FFFF99\"},\"invalid\":{\"fill\":\"#444444\"},\"past\":{\"fill\":\"#CCCCCC\",\"font-size\":12},\"rejected\":{\"fill\":\"#C45879\",\"font-size\":12,\"no-text\":\"REJECTED\",\"yes-text\":\"n/a\"},\"request\":{\"fill\":\"blue\"}},\"font-color\":\"black\",\"font-size\":14,\"line-color\":\"black\",\"line-length\":50,\"line-width\":3,\"no-text\":\"no\",\"scale\":1,\"symbols\":{\"end\":{\"class\":\"end-element\"},\"start\":{\"element-color\":\"green\",\"fill\":\"yellow\",\"font-color\":\"red\"}},\"text-margin\":10,\"x\":0,\"y\":0,\"yes-text\":\"yes\"}");
      var jsonContent = null;

      var flowchartPrefix = "language-flowchart";
      var index = 0;
      Array.prototype.forEach.call(document.querySelectorAll("[class^=" + flowchartPrefix + "]"), function(x){
          x.style.display = 'none'
          x.parentNode.style.backgroundColor = "transparent"
          jsonContent = x.innerText;

          var node0 = document.createElement('div');
          node0.id = 'flowchart' + index;
          x.parentNode.insertBefore(node0, x);

          var diagram = flowchart.parse(jsonContent);
          diagram.drawSVG("flowchart"+index, options);

          index +=1;
      });      
    }
    


    
    


    
    if (lib && lib.includes('msc')) {
      
      var options = JSON.parse("{\"theme\":\"hand\"}");
      var jsonContent = null;

      var index = 0;
      var chartPrefix = "language-msc";
      Array.prototype.forEach.call(document.querySelectorAll("[class^=" + chartPrefix + "]"), function (x) {
        x.style.display = 'none'
        x.parentNode.style.backgroundColor = "transparent"
        jsonContent = x.innerText;
        var node0 = document.createElement('div');
        node0.id = 'msc' + index;
        x.parentNode.insertBefore(node0, x);
        var diagram = Diagram.parse(jsonContent);
        diagram.drawSVG("msc" + index, options);
        index += 1;
      });
    }
    


    
    if (lib && lib.includes('chart')) {
      var borderColor = "#666";
      var bgColor = "#ddd";
      var borderWidth = 2;

      Chart.defaults.global.elements.rectangle.borderWidth = borderWidth;
      Chart.defaults.global.elements.rectangle.borderColor = borderColor;
      Chart.defaults.global.elements.rectangle.backgroundColor = bgColor;

      Chart.defaults.global.elements.line.borderWidth = borderWidth;
      Chart.defaults.global.elements.line.borderColor = borderColor;
      Chart.defaults.global.elements.line.backgroundColor = bgColor;

      Chart.defaults.global.elements.point.borderWidth = borderWidth;
      Chart.defaults.global.elements.point.borderColor = borderColor;
      Chart.defaults.global.elements.point.backgroundColor = bgColor;

      var chartPrefix = "language-chart";
      var index = 0;
      var jsonContent = null;

      Array.prototype.forEach.call(document.querySelectorAll("[class^=" + chartPrefix + "]"), function (x) {
        x.style.display = 'none'
        x.parentNode.style.backgroundColor = "transparent"
        jsonContent = x.innerText;
        var node0 = document.createElement('canvas');
        var source = null;
        node0.height = 200;
        node0.style.height = 200;
        node0.id = 'myChart' + index;
        source = JSON.parse(jsonContent);
        x.parentNode.insertBefore(node0, x);
        var ctx = document.getElementById('myChart' + index).getContext('2d');
        var myChart = new Chart(ctx, source);
        index += 1;
      });            
    }
    


    
    if (lib && lib.includes('wavedrom')) {
      var wavePrefix = "language-wave";
      var index = 0;
      var jsonContent = null;
      
      Array.prototype.forEach.call(document.querySelectorAll("[class^=" + wavePrefix + "]"), function (x) {
        x.style.display = 'none'
        x.parentNode.style.backgroundColor = "transparent"
        jsonContent = x.innerText;
        var node0 = document.createElement('div');
        var source = null;
        node0.id = 'WaveDrom_Display_' + index;
        source = JSON.parse(jsonContent);
        x.parentNode.insertBefore(node0, x);
        WaveDrom.RenderWaveForm(index, source, "WaveDrom_Display_");
        index += 1;
      });
    }
    


    
    if (lib && lib.includes('viz')) {
      var vizPrefix = "language-viz-";
      Array.prototype.forEach.call(document.querySelectorAll("[class^=" + vizPrefix + "]"), function (x) {
        x.style.display = 'none'
        x.parentNode.style.backgroundColor = "transparent"
        var engine;
        x.getAttribute("class").split(" ").forEach(function (cls) {
          if (cls.startsWith(vizPrefix)) {
            engine = cls.substr(vizPrefix.length);
          }
        });
        var viz = new Viz();
        viz.renderSVGElement(x.innerText, { engine: engine })
          .then(function (element) {
            element.style.width = "100%";
            x.parentNode.insertBefore(element, x);
          })
      });
    }
    
    
  }
</script>


            
            <footer class="footer">
    
<div class="dropdown">
  <button class="dropdown-trigger" aria-label="Select Theme Button">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path fill="currentColor" d="M12.65 15.67c.14-.36.05-.77-.23-1.05l-2.09-2.06.03-.03c1.74-1.94 2.98-4.17 3.71-6.53h1.94c.54 0 .99-.45.99-.99v-.02c0-.54-.45-.99-.99-.99H10V3c0-.55-.45-1-1-1s-1 .45-1 1v1H1.99c-.54 0-.99.45-.99.99 0 .55.45.99.99.99h10.18C11.5 7.92 10.44 9.75 9 11.35c-.81-.89-1.49-1.86-2.06-2.88-.16-.29-.45-.47-.78-.47-.69 0-1.13.75-.79 1.35.63 1.13 1.4 2.21 2.3 3.21L3.3 16.87c-.4.39-.4 1.03 0 1.42.39.39 1.02.39 1.42 0L9 14l2.02 2.02c.51.51 1.38.32 1.63-.35zM17.5 10c-.6 0-1.14.37-1.35.94l-3.67 9.8c-.24.61.22 1.26.87 1.26.39 0 .74-.24.88-.61l.89-2.39h4.75l.9 2.39c.14.36.49.61.88.61.65 0 1.11-.65.88-1.26l-3.67-9.8c-.22-.57-.76-.94-1.36-.94zm-1.62 7l1.62-4.33L19.12 17h-3.24z"/></svg>
  </button>
  <div class="dropdown-content">
    
    
    
  </div>
</div>

    
<div class="footer__social">
  <div class="social">
    
            
    
            
    
            
    
      
      <a href="mailto:willsurpriseyou@foxmail.com" title="email" aria-label="email">
        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path fill="currentColor" d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-.4 4.25l-7.07 4.42c-.32.2-.74.2-1.06 0L4.4 8.25c-.25-.16-.4-.43-.4-.72 0-.67.73-1.07 1.3-.72L12 11l6.7-4.19c.57-.35 1.3.05 1.3.72 0 .29-.15.56-.4.72z"/></svg>
      </a>
            
    
      
      <a href="http://example.org/" title="facebook" aria-label="facebook">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 24 24" version="1.1">
<g id="surface2747">
<path fill="currentColor" d="M 11.664062 2.003906 C 6.621094 2.171875 2.375 6.25 2.023438 11.289062 C 1.65625 16.617188 5.46875 21.121094 10.507812 21.878906 L 10.507812 14.648438 L 8.890625 14.648438 C 8.164062 14.648438 7.578125 14.0625 7.578125 13.335938 C 7.578125 12.609375 8.164062 12.023438 8.890625 12.023438 L 10.503906 12.023438 L 10.503906 10.273438 C 10.503906 7.378906 11.914062 6.105469 14.324219 6.105469 C 14.679688 6.105469 14.984375 6.113281 15.242188 6.128906 C 15.878906 6.15625 16.371094 6.6875 16.371094 7.324219 C 16.371094 7.988281 15.835938 8.523438 15.171875 8.523438 L 14.730469 8.523438 C 13.710938 8.523438 13.351562 9.492188 13.351562 10.585938 L 13.351562 12.023438 L 15.222656 12.023438 C 15.8125 12.023438 16.265625 12.550781 16.175781 13.132812 L 16.066406 13.835938 C 15.992188 14.304688 15.589844 14.652344 15.113281 14.652344 L 13.351562 14.652344 L 13.351562 21.898438 C 18.234375 21.234375 22 17.0625 22 12 C 22 6.367188 17.339844 1.820312 11.664062 2.003906 Z M 11.664062 2.003906 "/>
</g>
</svg>

      </a>
            
    
            
    
      
      <a href="https://github.com/jmwill" title="github" aria-label="github">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 24 24" version="1.1">
<g id="surface3680">
<path fill="currentColor" d="M 10.898438 2.101562 C 6.300781 2.601562 2.601562 6.300781 2.101562 10.800781 C 1.601562 15.5 4.300781 19.699219 8.398438 21.300781 C 8.699219 21.398438 9 21.199219 9 20.800781 L 9 19.199219 C 9 19.199219 8.601562 19.300781 8.101562 19.300781 C 6.699219 19.300781 6.101562 18.101562 6 17.398438 C 5.898438 17 5.699219 16.699219 5.398438 16.398438 C 5.101562 16.300781 5 16.300781 5 16.199219 C 5 16 5.300781 16 5.398438 16 C 6 16 6.5 16.699219 6.699219 17 C 7.199219 17.800781 7.800781 18 8.101562 18 C 8.5 18 8.800781 17.898438 9 17.800781 C 9.101562 17.101562 9.398438 16.398438 10 16 C 7.699219 15.5 6 14.199219 6 12 C 6 10.898438 6.5 9.800781 7.199219 9 C 7.101562 8.800781 7 8.300781 7 7.601562 C 7 7.199219 7 6.601562 7.300781 6 C 7.300781 6 8.699219 6 10.101562 7.300781 C 10.601562 7.101562 11.300781 7 12 7 C 12.699219 7 13.398438 7.101562 14 7.300781 C 15.300781 6 16.800781 6 16.800781 6 C 17 6.601562 17 7.199219 17 7.601562 C 17 8.398438 16.898438 8.800781 16.800781 9 C 17.5 9.800781 18 10.800781 18 12 C 18 14.199219 16.300781 15.5 14 16 C 14.601562 16.5 15 17.398438 15 18.300781 L 15 20.898438 C 15 21.199219 15.300781 21.5 15.699219 21.398438 C 19.398438 19.898438 22 16.300781 22 12.101562 C 22 6.101562 16.898438 1.398438 10.898438 2.101562 Z M 10.898438 2.101562 "/>
</g>
</svg>

      </a>
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
      
      <a href="https://twitter.com/j_mwill" title="twitter" aria-label="twitter">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32" version="1.1">
<g id="surface676">
<path fill="currentColor" d="M 28 8.558594 C 27.117188 8.949219 26.167969 9.214844 25.171875 9.332031 C 26.1875 8.722656 26.96875 7.757812 27.335938 6.609375 C 26.386719 7.171875 25.332031 7.582031 24.210938 7.804688 C 23.3125 6.847656 22.03125 6.246094 20.617188 6.246094 C 17.898438 6.246094 15.691406 8.453125 15.691406 11.171875 C 15.691406 11.558594 15.734375 11.933594 15.820312 12.292969 C 11.726562 12.089844 8.097656 10.128906 5.671875 7.148438 C 5.246094 7.875 5.003906 8.722656 5.003906 9.625 C 5.003906 11.332031 5.871094 12.839844 7.195312 13.722656 C 6.386719 13.695312 5.628906 13.476562 4.964844 13.105469 C 4.964844 13.128906 4.964844 13.148438 4.964844 13.167969 C 4.964844 15.554688 6.660156 17.546875 8.914062 17.996094 C 8.5 18.109375 8.066406 18.171875 7.617188 18.171875 C 7.300781 18.171875 6.988281 18.140625 6.691406 18.082031 C 7.316406 20.039062 9.136719 21.460938 11.289062 21.503906 C 9.605469 22.824219 7.480469 23.609375 5.175781 23.609375 C 4.777344 23.609375 4.386719 23.585938 4 23.539062 C 6.179688 24.9375 8.765625 25.753906 11.546875 25.753906 C 20.605469 25.753906 25.558594 18.25 25.558594 11.742188 C 25.558594 11.53125 25.550781 11.316406 25.542969 11.105469 C 26.503906 10.410156 27.339844 9.542969 28 8.558594 Z M 28 8.558594 "/>
</g>
</svg>

      </a>
            
    
            
    
            
    
            
    
            
    
            
    
    
  
  
    
      <a href="https://jmwill.github.io/blog/posts//index.xml" type="application/rss+xml" title="RSS" aria-label="RSS Feed Link">
        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><circle fill="currentColor" cx="6.18" cy="17.82" r="2.18"/><path fill="currentColor" d="M5.59 10.23c-.84-.14-1.59.55-1.59 1.4 0 .71.53 1.28 1.23 1.4 2.92.51 5.22 2.82 5.74 5.74.12.7.69 1.23 1.4 1.23.85 0 1.54-.75 1.41-1.59-.68-4.2-3.99-7.51-8.19-8.18zm-.03-5.71C4.73 4.43 4 5.1 4 5.93c0 .73.55 1.33 1.27 1.4 6.01.6 10.79 5.38 11.39 11.39.07.73.67 1.28 1.4 1.28.84 0 1.5-.73 1.42-1.56-.73-7.34-6.57-13.19-13.92-13.92z"/></svg>
      </a>
    
  

  </div>
</div>

    
<div id="gtt">
  <div class="gtt">
    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="M8.12 14.71L12 10.83l3.88 3.88c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L12.7 8.71c-.39-.39-1.02-.39-1.41 0L6.7 13.3c-.39.39-.39 1.02 0 1.41.39.38 1.03.39 1.42 0z"/></svg>
  </div>
</div>

    <hr />

    <div class="basicflex">
        
            <a href="" class="footer__link" target="_blank" rel="noreferrer"></a>
        
            <a href="" class="footer__link" target="_blank" rel="noreferrer"></a>
        
    </div>

    <div class="footer__poweredby">
        
                
            <p class="caption">
                
                    Â©2020, All Rights Reserved
                
            </p>
        

        
            <p class="caption">Powered by <a href="https://gohugo.io/" target="_blank" rel="noreferrer">Hugo</a> and the <a href="https://github.com/zzossig/hugo-theme-zzo" target="_blank" rel="noreferrer">Zzo theme</a></p>
        
        
    </div> 
</footer>
        </div>
        





<div class="wrapper__right hide" data-pad="true" dir="ltr">
  <script>document.querySelector('.wrapper__right').classList.remove('hide')</script>
  
</div>

    </div>
</body>

</html>